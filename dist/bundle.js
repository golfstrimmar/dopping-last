/*! For license information please see bundle.js.LICENSE.txt */
!(function () {
  var e = {
      "./node_modules/plyr/dist/plyr.min.js": function (e, t, n) {
        var i = ["premium", "referrerPolicy"];
        function a(e) {
          return (
            (function (e) {
              if (Array.isArray(e)) return p(e);
            })(e) ||
            (function (e) {
              if (
                ("undefined" != typeof Symbol && null != e[Symbol.iterator]) ||
                null != e["@@iterator"]
              )
                return Array.from(e);
            })(e) ||
            h(e) ||
            (function () {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."
              );
            })()
          );
        }
        function r(e, t) {
          if (!(e instanceof t))
            throw new TypeError("Cannot call a class as a function");
        }
        function s(e, t) {
          for (var n = 0; n < t.length; n++) {
            var i = t[n];
            (i.enumerable = i.enumerable || !1),
              (i.configurable = !0),
              "value" in i && (i.writable = !0),
              Object.defineProperty(e, i.key, i);
          }
        }
        function o(e, t, n) {
          return (
            t && s(e.prototype, t),
            n && s(e, n),
            Object.defineProperty(e, "prototype", { writable: !1 }),
            e
          );
        }
        function l(e, t) {
          var n = Object.keys(e);
          if (Object.getOwnPropertySymbols) {
            var i = Object.getOwnPropertySymbols(e);
            t &&
              (i = i.filter(function (t) {
                return Object.getOwnPropertyDescriptor(e, t).enumerable;
              })),
              n.push.apply(n, i);
          }
          return n;
        }
        function c(e) {
          for (var t = 1; t < arguments.length; t++) {
            var n = null != arguments[t] ? arguments[t] : {};
            t % 2
              ? l(Object(n), !0).forEach(function (t) {
                  u(e, t, n[t]);
                })
              : Object.getOwnPropertyDescriptors
              ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n))
              : l(Object(n)).forEach(function (t) {
                  Object.defineProperty(
                    e,
                    t,
                    Object.getOwnPropertyDescriptor(n, t)
                  );
                });
          }
          return e;
        }
        function u(e, t, n) {
          return (
            t in e
              ? Object.defineProperty(e, t, {
                  value: n,
                  enumerable: !0,
                  configurable: !0,
                  writable: !0,
                })
              : (e[t] = n),
            e
          );
        }
        function d(e, t) {
          return (
            (function (e) {
              if (Array.isArray(e)) return e;
            })(e) ||
            (function (e, t) {
              var n =
                null == e
                  ? null
                  : ("undefined" != typeof Symbol && e[Symbol.iterator]) ||
                    e["@@iterator"];
              if (null != n) {
                var i,
                  a,
                  r = [],
                  s = !0,
                  o = !1;
                try {
                  for (
                    n = n.call(e);
                    !(s = (i = n.next()).done) &&
                    (r.push(i.value), !t || r.length !== t);
                    s = !0
                  );
                } catch (e) {
                  (o = !0), (a = e);
                } finally {
                  try {
                    s || null == n.return || n.return();
                  } finally {
                    if (o) throw a;
                  }
                }
                return r;
              }
            })(e, t) ||
            h(e, t) ||
            (function () {
              throw new TypeError(
                "Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."
              );
            })()
          );
        }
        function h(e, t) {
          if (e) {
            if ("string" == typeof e) return p(e, t);
            var n = Object.prototype.toString.call(e).slice(8, -1);
            return (
              "Object" === n && e.constructor && (n = e.constructor.name),
              "Map" === n || "Set" === n
                ? Array.from(e)
                : "Arguments" === n ||
                  /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)
                ? p(e, t)
                : void 0
            );
          }
        }
        function p(e, t) {
          (null == t || t > e.length) && (t = e.length);
          for (var n = 0, i = new Array(t); n < t; n++) i[n] = e[n];
          return i;
        }
        "object" == typeof navigator &&
          (e.exports = (function () {
            "use strict";
            function e(e, t, n) {
              return (
                t in e
                  ? Object.defineProperty(e, t, {
                      value: n,
                      enumerable: !0,
                      configurable: !0,
                      writable: !0,
                    })
                  : (e[t] = n),
                e
              );
            }
            function t(e, t) {
              for (var n = 0; n < t.length; n++) {
                var i = t[n];
                (i.enumerable = i.enumerable || !1),
                  (i.configurable = !0),
                  "value" in i && (i.writable = !0),
                  Object.defineProperty(e, i.key, i);
              }
            }
            function s(e, t, n) {
              return (
                t in e
                  ? Object.defineProperty(e, t, {
                      value: n,
                      enumerable: !0,
                      configurable: !0,
                      writable: !0,
                    })
                  : (e[t] = n),
                e
              );
            }
            function l(e, t) {
              var n = Object.keys(e);
              if (Object.getOwnPropertySymbols) {
                var i = Object.getOwnPropertySymbols(e);
                t &&
                  (i = i.filter(function (t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable;
                  })),
                  n.push.apply(n, i);
              }
              return n;
            }
            function u(e) {
              for (var t = 1; t < arguments.length; t++) {
                var n = null != arguments[t] ? arguments[t] : {};
                t % 2
                  ? l(Object(n), !0).forEach(function (t) {
                      s(e, t, n[t]);
                    })
                  : Object.getOwnPropertyDescriptors
                  ? Object.defineProperties(
                      e,
                      Object.getOwnPropertyDescriptors(n)
                    )
                  : l(Object(n)).forEach(function (t) {
                      Object.defineProperty(
                        e,
                        t,
                        Object.getOwnPropertyDescriptor(n, t)
                      );
                    });
              }
              return e;
            }
            var h = { addCSS: !0, thumbWidth: 15, watch: !0 };
            function p(e, t) {
              return function () {
                return Array.from(document.querySelectorAll(t)).includes(this);
              }.call(e, t);
            }
            var m = function (e) {
                return null != e ? e.constructor : null;
              },
              f = function (e, t) {
                return !!(e && t && e instanceof t);
              },
              g = function (e) {
                return m(e) === String;
              },
              y = function (e) {
                return Array.isArray(e);
              },
              v = function (e) {
                return f(e, NodeList);
              },
              b = g,
              w = y,
              k = v,
              T = function (e) {
                return f(e, Element);
              },
              S = function (e) {
                return f(e, Event);
              },
              A = function (e) {
                return (
                  (function (e) {
                    return null == e;
                  })(e) ||
                  ((g(e) || y(e) || v(e)) && !e.length) ||
                  ((function (e) {
                    return m(e) === Object;
                  })(e) &&
                    !Object.keys(e).length)
                );
              };
            var C = (function () {
                function e(t, n) {
                  (function (e, t) {
                    if (!(e instanceof t))
                      throw new TypeError("Cannot call a class as a function");
                  })(this, e),
                    T(t)
                      ? (this.element = t)
                      : b(t) && (this.element = document.querySelector(t)),
                    T(this.element) &&
                      A(this.element.rangeTouch) &&
                      ((this.config = u({}, h, {}, n)), this.init());
                }
                return (
                  (function (e, n, i) {
                    n && t(e.prototype, n), i && t(e, i);
                  })(
                    e,
                    [
                      {
                        key: "init",
                        value: function () {
                          e.enabled &&
                            (this.config.addCSS &&
                              ((this.element.style.userSelect = "none"),
                              (this.element.style.webKitUserSelect = "none"),
                              (this.element.style.touchAction =
                                "manipulation")),
                            this.listeners(!0),
                            (this.element.rangeTouch = this));
                        },
                      },
                      {
                        key: "destroy",
                        value: function () {
                          e.enabled &&
                            (this.config.addCSS &&
                              ((this.element.style.userSelect = ""),
                              (this.element.style.webKitUserSelect = ""),
                              (this.element.style.touchAction = "")),
                            this.listeners(!1),
                            (this.element.rangeTouch = null));
                        },
                      },
                      {
                        key: "listeners",
                        value: function (e) {
                          var t = this,
                            n = e ? "addEventListener" : "removeEventListener";
                          ["touchstart", "touchmove", "touchend"].forEach(
                            function (e) {
                              t.element[n](
                                e,
                                function (e) {
                                  return t.set(e);
                                },
                                !1
                              );
                            }
                          );
                        },
                      },
                      {
                        key: "get",
                        value: function (t) {
                          if (!e.enabled || !S(t)) return null;
                          var n,
                            i = t.target,
                            a = t.changedTouches[0],
                            r = parseFloat(i.getAttribute("min")) || 0,
                            s = parseFloat(i.getAttribute("max")) || 100,
                            o = parseFloat(i.getAttribute("step")) || 1,
                            l = i.getBoundingClientRect(),
                            c =
                              ((100 / l.width) * (this.config.thumbWidth / 2)) /
                              100;
                          return (
                            0 > (n = (100 / l.width) * (a.clientX - l.left))
                              ? (n = 0)
                              : 100 < n && (n = 100),
                            50 > n
                              ? (n -= (100 - 2 * n) * c)
                              : 50 < n && (n += 2 * (n - 50) * c),
                            r +
                              (function (e, t) {
                                if (1 > t) {
                                  var n = (function (e) {
                                    var t = ""
                                      .concat(e)
                                      .match(
                                        /(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/
                                      );
                                    return t
                                      ? Math.max(
                                          0,
                                          (t[1] ? t[1].length : 0) -
                                            (t[2] ? +t[2] : 0)
                                        )
                                      : 0;
                                  })(t);
                                  return parseFloat(e.toFixed(n));
                                }
                                return Math.round(e / t) * t;
                              })((n / 100) * (s - r), o)
                          );
                        },
                      },
                      {
                        key: "set",
                        value: function (t) {
                          e.enabled &&
                            S(t) &&
                            !t.target.disabled &&
                            (t.preventDefault(),
                            (t.target.value = this.get(t)),
                            (function (e, t) {
                              if (e && t) {
                                var n = new Event(t, { bubbles: !0 });
                                e.dispatchEvent(n);
                              }
                            })(
                              t.target,
                              "touchend" === t.type ? "change" : "input"
                            ));
                        },
                      },
                    ],
                    [
                      {
                        key: "setup",
                        value: function (t) {
                          var n =
                              1 < arguments.length && void 0 !== arguments[1]
                                ? arguments[1]
                                : {},
                            i = null;
                          if (
                            (A(t) || b(t)
                              ? (i = Array.from(
                                  document.querySelectorAll(
                                    b(t) ? t : 'input[type="range"]'
                                  )
                                ))
                              : T(t)
                              ? (i = [t])
                              : k(t)
                              ? (i = Array.from(t))
                              : w(t) && (i = t.filter(T)),
                            A(i))
                          )
                            return null;
                          var a = u({}, h, {}, n);
                          if (b(t) && a.watch) {
                            var r = new MutationObserver(function (n) {
                              Array.from(n).forEach(function (n) {
                                Array.from(n.addedNodes).forEach(function (n) {
                                  T(n) && p(n, t) && new e(n, a);
                                });
                              });
                            });
                            r.observe(document.body, {
                              childList: !0,
                              subtree: !0,
                            });
                          }
                          return i.map(function (t) {
                            return new e(t, n);
                          });
                        },
                      },
                      {
                        key: "enabled",
                        get: function () {
                          return "ontouchstart" in document.documentElement;
                        },
                      },
                    ]
                  ),
                  e
                );
              })(),
              E = function (e) {
                return null != e ? e.constructor : null;
              },
              P = function (e, t) {
                return Boolean(e && t && e instanceof t);
              },
              M = function (e) {
                return null == e;
              },
              x = function (e) {
                return E(e) === Object;
              },
              L = function (e) {
                return E(e) === String;
              },
              j = function (e) {
                return E(e) === Function;
              },
              N = function (e) {
                return Array.isArray(e);
              },
              I = function (e) {
                return P(e, NodeList);
              },
              _ = function (e) {
                return (
                  M(e) ||
                  ((L(e) || N(e) || I(e)) && !e.length) ||
                  (x(e) && !Object.keys(e).length)
                );
              },
              O = M,
              q = x,
              D = function (e) {
                return E(e) === Number && !Number.isNaN(e);
              },
              H = L,
              F = function (e) {
                return E(e) === Boolean;
              },
              R = j,
              V = N,
              B = I,
              U = function (e) {
                return (
                  null !== e &&
                  "object" == typeof e &&
                  1 === e.nodeType &&
                  "object" == typeof e.style &&
                  "object" == typeof e.ownerDocument
                );
              },
              W = function (e) {
                return P(e, Event);
              },
              z = function (e) {
                return P(e, KeyboardEvent);
              },
              K = function (e) {
                return P(e, TextTrack) || (!M(e) && L(e.kind));
              },
              Y = function (e) {
                if (P(e, window.URL)) return !0;
                if (!L(e)) return !1;
                var t = e;
                (e.startsWith("http://") && e.startsWith("https://")) ||
                  (t = "http://".concat(e));
                try {
                  return !_(new URL(t).hostname);
                } catch (e) {
                  return !1;
                }
              },
              $ = _,
              Q = (function () {
                var e = document.createElement("span"),
                  t = {
                    WebkitTransition: "webkitTransitionEnd",
                    MozTransition: "transitionend",
                    OTransition: "oTransitionEnd otransitionend",
                    transition: "transitionend",
                  },
                  n = Object.keys(t).find(function (t) {
                    return void 0 !== e.style[t];
                  });
                return !!H(n) && t[n];
              })();
            function X(e, t) {
              setTimeout(function () {
                try {
                  (e.hidden = !0), e.offsetHeight, (e.hidden = !1);
                } catch (e) {}
              }, t);
            }
            var J = {
              isIE: Boolean(window.document.documentMode),
              isEdge: window.navigator.userAgent.includes("Edge"),
              isWebkit:
                "WebkitAppearance" in document.documentElement.style &&
                !/Edge/.test(navigator.userAgent),
              isIPhone: /(iPhone|iPod)/gi.test(navigator.platform),
              isIos:
                ("MacIntel" === navigator.platform &&
                  navigator.maxTouchPoints > 1) ||
                /(iPad|iPhone|iPod)/gi.test(navigator.platform),
            };
            function G(e, t) {
              return t.split(".").reduce(function (e, t) {
                return e && e[t];
              }, e);
            }
            function Z() {
              for (
                var e =
                    arguments.length > 0 && void 0 !== arguments[0]
                      ? arguments[0]
                      : {},
                  t = arguments.length,
                  n = new Array(t > 1 ? t - 1 : 0),
                  i = 1;
                i < t;
                i++
              )
                n[i - 1] = arguments[i];
              if (!n.length) return e;
              var a = n.shift();
              return q(a)
                ? (Object.keys(a).forEach(function (t) {
                    q(a[t])
                      ? (Object.keys(e).includes(t) ||
                          Object.assign(e, { [t]: {} }),
                        Z(e[t], a[t]))
                      : Object.assign(e, { [t]: a[t] });
                  }),
                  Z.apply(void 0, [e].concat(n)))
                : e;
            }
            function ee(e, t) {
              var n = e.length ? e : [e];
              Array.from(n)
                .reverse()
                .forEach(function (e, n) {
                  var i = n > 0 ? t.cloneNode(!0) : t,
                    a = e.parentNode,
                    r = e.nextSibling;
                  i.appendChild(e), r ? a.insertBefore(i, r) : a.appendChild(i);
                });
            }
            function te(e, t) {
              U(e) &&
                !$(t) &&
                Object.entries(t)
                  .filter(function (e) {
                    var t = d(e, 2)[1];
                    return !O(t);
                  })
                  .forEach(function (t) {
                    var n = d(t, 2),
                      i = n[0],
                      a = n[1];
                    return e.setAttribute(i, a);
                  });
            }
            function ne(e, t, n) {
              var i = document.createElement(e);
              return q(t) && te(i, t), H(n) && (i.innerText = n), i;
            }
            function ie(e, t, n, i) {
              U(t) && t.appendChild(ne(e, n, i));
            }
            function ae(e) {
              B(e) || V(e)
                ? Array.from(e).forEach(ae)
                : U(e) && U(e.parentNode) && e.parentNode.removeChild(e);
            }
            function re(e) {
              if (U(e))
                for (var t = e.childNodes.length; t > 0; )
                  e.removeChild(e.lastChild), (t -= 1);
            }
            function se(e, t) {
              return U(t) && U(t.parentNode) && U(e)
                ? (t.parentNode.replaceChild(e, t), e)
                : null;
            }
            function oe(e, t) {
              if (!H(e) || $(e)) return {};
              var n = {},
                i = Z({}, t);
              return (
                e.split(",").forEach(function (e) {
                  var t = e.trim(),
                    a = t.replace(".", ""),
                    r = t.replace(/[[\]]/g, "").split("="),
                    s = d(r, 1)[0],
                    o = r.length > 1 ? r[1].replace(/["']/g, "") : "";
                  switch (t.charAt(0)) {
                    case ".":
                      H(i.class)
                        ? (n.class = "".concat(i.class, " ").concat(a))
                        : (n.class = a);
                      break;
                    case "#":
                      n.id = t.replace("#", "");
                      break;
                    case "[":
                      n[s] = o;
                  }
                }),
                Z(i, n)
              );
            }
            function le(e, t) {
              if (U(e)) {
                var n = t;
                F(n) || (n = !e.hidden), (e.hidden = n);
              }
            }
            function ce(e, t, n) {
              if (B(e))
                return Array.from(e).map(function (e) {
                  return ce(e, t, n);
                });
              if (U(e)) {
                var i = "toggle";
                return (
                  void 0 !== n && (i = n ? "add" : "remove"),
                  e.classList[i](t),
                  e.classList.contains(t)
                );
              }
              return !1;
            }
            function ue(e, t) {
              return U(e) && e.classList.contains(t);
            }
            function de(e, t) {
              var n = Element.prototype;
              return (
                n.matches ||
                n.webkitMatchesSelector ||
                n.mozMatchesSelector ||
                n.msMatchesSelector ||
                function () {
                  return Array.from(document.querySelectorAll(t)).includes(
                    this
                  );
                }
              ).call(e, t);
            }
            function he(e) {
              return this.elements.container.querySelectorAll(e);
            }
            function pe(e) {
              return this.elements.container.querySelector(e);
            }
            function me() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : null,
                t =
                  arguments.length > 1 &&
                  void 0 !== arguments[1] &&
                  arguments[1];
              U(e) &&
                (e.focus({ preventScroll: !0 }),
                t && ce(e, this.config.classNames.tabFocus));
            }
            var fe = {
                "audio/ogg": "vorbis",
                "audio/wav": "1",
                "video/webm": "vp8, vorbis",
                "video/mp4": "avc1.42E01E, mp4a.40.2",
                "video/ogg": "theora",
              },
              ge = {
                audio: "canPlayType" in document.createElement("audio"),
                video: "canPlayType" in document.createElement("video"),
                check(e, t, n) {
                  var i = J.isIPhone && n && ge.playsinline,
                    a = ge[e] || "html5" !== t;
                  return {
                    api: a,
                    ui:
                      a && ge.rangeInput && ("video" !== e || !J.isIPhone || i),
                  };
                },
                pip: !(
                  J.isIPhone ||
                  (!R(ne("video").webkitSetPresentationMode) &&
                    (!document.pictureInPictureEnabled ||
                      ne("video").disablePictureInPicture))
                ),
                airplay: R(window.WebKitPlaybackTargetAvailabilityEvent),
                playsinline: "playsInline" in document.createElement("video"),
                mime(e) {
                  if ($(e)) return !1;
                  var t = d(e.split("/"), 1)[0],
                    n = e;
                  if (!this.isHTML5 || t !== this.type) return !1;
                  Object.keys(fe).includes(n) &&
                    (n += '; codecs="'.concat(fe[e], '"'));
                  try {
                    return Boolean(
                      n && this.media.canPlayType(n).replace(/no/, "")
                    );
                  } catch (e) {
                    return !1;
                  }
                },
                textTracks: "textTracks" in document.createElement("video"),
                rangeInput: (function () {
                  var e = document.createElement("input");
                  return (e.type = "range"), "range" === e.type;
                })(),
                touch: "ontouchstart" in document.documentElement,
                transitions: !1 !== Q,
                reducedMotion:
                  "matchMedia" in window &&
                  window.matchMedia("(prefers-reduced-motion)").matches,
              },
              ye = (function () {
                var e = !1;
                try {
                  var t = Object.defineProperty({}, "passive", {
                    get: function () {
                      return (e = !0), null;
                    },
                  });
                  window.addEventListener("test", null, t),
                    window.removeEventListener("test", null, t);
                } catch (e) {}
                return e;
              })();
            function ve(e, t, n) {
              var i = this,
                a =
                  arguments.length > 3 &&
                  void 0 !== arguments[3] &&
                  arguments[3],
                r =
                  !(arguments.length > 4 && void 0 !== arguments[4]) ||
                  arguments[4],
                s =
                  arguments.length > 5 &&
                  void 0 !== arguments[5] &&
                  arguments[5];
              if (e && "addEventListener" in e && !$(t) && R(n)) {
                var o = t.split(" "),
                  l = s;
                ye && (l = { passive: r, capture: s }),
                  o.forEach(function (t) {
                    i &&
                      i.eventListeners &&
                      a &&
                      i.eventListeners.push({
                        element: e,
                        type: t,
                        callback: n,
                        options: l,
                      }),
                      e[a ? "addEventListener" : "removeEventListener"](
                        t,
                        n,
                        l
                      );
                  });
              }
            }
            function be(e) {
              var t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : "",
                n = arguments.length > 2 ? arguments[2] : void 0,
                i =
                  !(arguments.length > 3 && void 0 !== arguments[3]) ||
                  arguments[3],
                a =
                  arguments.length > 4 &&
                  void 0 !== arguments[4] &&
                  arguments[4];
              ve.call(this, e, t, n, !0, i, a);
            }
            function we(e) {
              var t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : "",
                n = arguments.length > 2 ? arguments[2] : void 0,
                i =
                  !(arguments.length > 3 && void 0 !== arguments[3]) ||
                  arguments[3],
                a =
                  arguments.length > 4 &&
                  void 0 !== arguments[4] &&
                  arguments[4];
              ve.call(this, e, t, n, !1, i, a);
            }
            function ke(e) {
              var t = this,
                n =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : "",
                i = arguments.length > 2 ? arguments[2] : void 0,
                a =
                  !(arguments.length > 3 && void 0 !== arguments[3]) ||
                  arguments[3],
                r =
                  arguments.length > 4 &&
                  void 0 !== arguments[4] &&
                  arguments[4],
                s = function s() {
                  for (
                    var o = arguments.length, l = new Array(o), c = 0;
                    c < o;
                    c++
                  )
                    l[c] = arguments[c];
                  we(e, n, s, a, r), i.apply(t, l);
                };
              ve.call(this, e, n, s, !0, a, r);
            }
            function Te(e) {
              var t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : "",
                n =
                  arguments.length > 2 &&
                  void 0 !== arguments[2] &&
                  arguments[2],
                i =
                  arguments.length > 3 && void 0 !== arguments[3]
                    ? arguments[3]
                    : {};
              if (U(e) && !$(t)) {
                var a = new CustomEvent(t, {
                  bubbles: n,
                  detail: c(c({}, i), {}, { plyr: this }),
                });
                e.dispatchEvent(a);
              }
            }
            function Se() {
              this &&
                this.eventListeners &&
                (this.eventListeners.forEach(function (e) {
                  var t = e.element,
                    n = e.type,
                    i = e.callback,
                    a = e.options;
                  t.removeEventListener(n, i, a);
                }),
                (this.eventListeners = []));
            }
            function Ae() {
              var e = this;
              return new Promise(function (t) {
                return e.ready
                  ? setTimeout(t, 0)
                  : be.call(e, e.elements.container, "ready", t);
              }).then(function () {});
            }
            function Ce(e) {
              (function (e) {
                return P(e, Promise) && j(e.then);
              })(e) && e.then(null, function () {});
            }
            function Ee(e) {
              return V(e)
                ? e.filter(function (t, n) {
                    return e.indexOf(t) === n;
                  })
                : e;
            }
            function Pe(e, t) {
              return V(e) && e.length
                ? e.reduce(function (e, n) {
                    return Math.abs(n - t) < Math.abs(e - t) ? n : e;
                  })
                : null;
            }
            function Me(e) {
              return !(!window || !window.CSS) && window.CSS.supports(e);
            }
            var xe = [
              [1, 1],
              [4, 3],
              [3, 4],
              [5, 4],
              [4, 5],
              [3, 2],
              [2, 3],
              [16, 10],
              [10, 16],
              [16, 9],
              [9, 16],
              [21, 9],
              [9, 21],
              [32, 9],
              [9, 32],
            ].reduce(function (e, t) {
              var n = d(t, 2),
                i = n[0],
                a = n[1];
              return c(c({}, e), {}, { [i / a]: [i, a] });
            }, {});
            function Le(e) {
              return (
                !!(V(e) || (H(e) && e.includes(":"))) &&
                (V(e) ? e : e.split(":")).map(Number).every(D)
              );
            }
            function je(e) {
              if (!V(e) || !e.every(D)) return null;
              var t = d(e, 2),
                n = t[0],
                i = t[1],
                a = (function e(t, n) {
                  return 0 === n ? t : e(n, t % n);
                })(n, i);
              return [n / a, i / a];
            }
            function Ne(e) {
              var t = function (e) {
                  return Le(e) ? e.split(":").map(Number) : null;
                },
                n = t(e);
              if (
                (null === n && (n = t(this.config.ratio)),
                null === n &&
                  !$(this.embed) &&
                  V(this.embed.ratio) &&
                  (n = this.embed.ratio),
                null === n && this.isHTML5)
              ) {
                var i = this.media;
                n = [i.videoWidth, i.videoHeight];
              }
              return je(n);
            }
            function Ie(e) {
              if (!this.isVideo) return {};
              var t = this.elements.wrapper,
                n = Ne.call(this, e);
              if (!V(n)) return {};
              var i = d(je(n), 2),
                a = i[0],
                r = i[1],
                s = (100 / a) * r;
              if (
                (Me("aspect-ratio: ".concat(a, "/").concat(r))
                  ? (t.style.aspectRatio = "".concat(a, "/").concat(r))
                  : (t.style.paddingBottom = "".concat(s, "%")),
                this.isVimeo && !this.config.vimeo.premium && this.supported.ui)
              ) {
                var o =
                    (100 / this.media.offsetWidth) *
                    parseInt(
                      window.getComputedStyle(this.media).paddingBottom,
                      10
                    ),
                  l = (o - s) / (o / 50);
                this.fullscreen.active
                  ? (t.style.paddingBottom = null)
                  : (this.media.style.transform = "translateY(-".concat(
                      l,
                      "%)"
                    ));
              } else
                this.isHTML5 &&
                  t.classList.add(this.config.classNames.videoFixedRatio);
              return { padding: s, ratio: n };
            }
            function _e(e, t) {
              var n =
                  arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : 0.05,
                i = e / t,
                a = Pe(Object.keys(xe), i);
              return Math.abs(a - i) <= n ? xe[a] : [e, t];
            }
            var Oe = {
              getSources() {
                var e = this;
                return this.isHTML5
                  ? Array.from(this.media.querySelectorAll("source")).filter(
                      function (t) {
                        var n = t.getAttribute("type");
                        return !!$(n) || ge.mime.call(e, n);
                      }
                    )
                  : [];
              },
              getQualityOptions() {
                return this.config.quality.forced
                  ? this.config.quality.options
                  : Oe.getSources
                      .call(this)
                      .map(function (e) {
                        return Number(e.getAttribute("size"));
                      })
                      .filter(Boolean);
              },
              setup() {
                if (this.isHTML5) {
                  var e = this;
                  (e.options.speed = e.config.speed.options),
                    $(this.config.ratio) || Ie.call(e),
                    Object.defineProperty(e.media, "quality", {
                      get() {
                        var t = Oe.getSources.call(e).find(function (t) {
                          return t.getAttribute("src") === e.source;
                        });
                        return t && Number(t.getAttribute("size"));
                      },
                      set(t) {
                        if (e.quality !== t) {
                          if (
                            e.config.quality.forced &&
                            R(e.config.quality.onChange)
                          )
                            e.config.quality.onChange(t);
                          else {
                            var n = Oe.getSources.call(e).find(function (e) {
                              return Number(e.getAttribute("size")) === t;
                            });
                            if (!n) return;
                            var i = e.media,
                              a = i.currentTime,
                              r = i.paused,
                              s = i.preload,
                              o = i.readyState,
                              l = i.playbackRate;
                            (e.media.src = n.getAttribute("src")),
                              ("none" !== s || o) &&
                                (e.once("loadedmetadata", function () {
                                  (e.speed = l),
                                    (e.currentTime = a),
                                    r || Ce(e.play());
                                }),
                                e.media.load());
                          }
                          Te.call(e, e.media, "qualitychange", !1, {
                            quality: t,
                          });
                        }
                      },
                    });
                }
              },
              cancelRequests() {
                this.isHTML5 &&
                  (ae(Oe.getSources.call(this)),
                  this.media.setAttribute("src", this.config.blankVideo),
                  this.media.load(),
                  this.debug.log("Cancelled network requests"));
              },
            };
            function qe(e) {
              for (
                var t = arguments.length,
                  n = new Array(t > 1 ? t - 1 : 0),
                  i = 1;
                i < t;
                i++
              )
                n[i - 1] = arguments[i];
              return $(e)
                ? e
                : e.toString().replace(/{(\d+)}/g, function (e, t) {
                    return n[t].toString();
                  });
            }
            var De = function () {
                var e =
                    arguments.length > 1 && void 0 !== arguments[1]
                      ? arguments[1]
                      : "",
                  t =
                    arguments.length > 2 && void 0 !== arguments[2]
                      ? arguments[2]
                      : "";
                return (
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : ""
                ).replace(
                  new RegExp(
                    e.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g, "\\$1"),
                    "g"
                  ),
                  t.toString()
                );
              },
              He = function () {
                return (
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : ""
                )
                  .toString()
                  .replace(/\w\S*/g, function (e) {
                    return e.charAt(0).toUpperCase() + e.slice(1).toLowerCase();
                  });
              };
            function Fe(e) {
              var t = document.createElement("div");
              return t.appendChild(e), t.innerHTML;
            }
            var Re = {
                pip: "PIP",
                airplay: "AirPlay",
                html5: "HTML5",
                vimeo: "Vimeo",
                youtube: "YouTube",
              },
              Ve = {
                get() {
                  var e =
                      arguments.length > 0 && void 0 !== arguments[0]
                        ? arguments[0]
                        : "",
                    t =
                      arguments.length > 1 && void 0 !== arguments[1]
                        ? arguments[1]
                        : {};
                  if ($(e) || $(t)) return "";
                  var n = G(t.i18n, e);
                  if ($(n)) return Object.keys(Re).includes(e) ? Re[e] : "";
                  var i = { "{seektime}": t.seekTime, "{title}": t.title };
                  return (
                    Object.entries(i).forEach(function (e) {
                      var t = d(e, 2),
                        i = t[0],
                        a = t[1];
                      n = De(n, i, a);
                    }),
                    n
                  );
                },
              },
              Be = (function () {
                function t(n) {
                  var i = this;
                  r(this, t),
                    e(this, "get", function (e) {
                      if (!t.supported || !i.enabled) return null;
                      var n = window.localStorage.getItem(i.key);
                      if ($(n)) return null;
                      var a = JSON.parse(n);
                      return H(e) && e.length ? a[e] : a;
                    }),
                    e(this, "set", function (e) {
                      if (t.supported && i.enabled && q(e)) {
                        var n = i.get();
                        $(n) && (n = {}), Z(n, e);
                        try {
                          window.localStorage.setItem(i.key, JSON.stringify(n));
                        } catch (e) {}
                      }
                    }),
                    (this.enabled = n.config.storage.enabled),
                    (this.key = n.config.storage.key);
                }
                return (
                  o(t, null, [
                    {
                      key: "supported",
                      get: function () {
                        try {
                          if (!("localStorage" in window)) return !1;
                          var e = "___test";
                          return (
                            window.localStorage.setItem(e, e),
                            window.localStorage.removeItem(e),
                            !0
                          );
                        } catch (e) {
                          return !1;
                        }
                      },
                    },
                  ]),
                  t
                );
              })();
            function Ue(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : "text";
              return new Promise(function (n, i) {
                try {
                  var a = new XMLHttpRequest();
                  if (!("withCredentials" in a)) return;
                  a.addEventListener("load", function () {
                    if ("text" === t)
                      try {
                        n(JSON.parse(a.responseText));
                      } catch (e) {
                        n(a.responseText);
                      }
                    else n(a.response);
                  }),
                    a.addEventListener("error", function () {
                      throw new Error(a.status);
                    }),
                    a.open("GET", e, !0),
                    (a.responseType = t),
                    a.send();
                } catch (e) {
                  i(e);
                }
              });
            }
            function We(e, t) {
              if (H(e)) {
                var n = H(t),
                  i = function () {
                    return null !== document.getElementById(t);
                  },
                  a = function (e, t) {
                    (e.innerHTML = t),
                      (n && i()) ||
                        document.body.insertAdjacentElement("afterbegin", e);
                  };
                if (!n || !i()) {
                  var r = Be.supported,
                    s = document.createElement("div");
                  if (
                    (s.setAttribute("hidden", ""),
                    n && s.setAttribute("id", t),
                    r)
                  ) {
                    var o = window.localStorage.getItem("cache-".concat(t));
                    if (null !== o) {
                      var l = JSON.parse(o);
                      a(s, l.content);
                    }
                  }
                  Ue(e)
                    .then(function (e) {
                      if (!$(e)) {
                        if (r)
                          try {
                            window.localStorage.setItem(
                              "cache-".concat(t),
                              JSON.stringify({ content: e })
                            );
                          } catch (e) {}
                        a(s, e);
                      }
                    })
                    .catch(function () {});
                }
              }
            }
            var ze = function (e) {
              return Math.trunc((e / 60 / 60) % 60, 10);
            };
            function Ke() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : 0,
                t =
                  arguments.length > 1 &&
                  void 0 !== arguments[1] &&
                  arguments[1],
                n =
                  arguments.length > 2 &&
                  void 0 !== arguments[2] &&
                  arguments[2];
              if (!D(e)) return Ke(void 0, t, n);
              var i,
                a = function (e) {
                  return "0".concat(e).slice(-2);
                },
                r = ze(e),
                s = ((i = e), Math.trunc((i / 60) % 60, 10)),
                o = (function (e) {
                  return Math.trunc(e % 60, 10);
                })(e);
              return (
                (r = t || r > 0 ? "".concat(r, ":") : ""),
                ""
                  .concat(n && e > 0 ? "-" : "")
                  .concat(r)
                  .concat(a(s), ":")
                  .concat(a(o))
              );
            }
            var Ye = {
              getIconUrl() {
                var e = new URL(this.config.iconUrl, window.location),
                  t = window.location.host
                    ? window.location.host
                    : window.top.location.host,
                  n = e.host !== t || (J.isIE && !window.svg4everybody);
                return { url: this.config.iconUrl, cors: n };
              },
              findElements() {
                try {
                  return (
                    (this.elements.controls = pe.call(
                      this,
                      this.config.selectors.controls.wrapper
                    )),
                    (this.elements.buttons = {
                      play: he.call(this, this.config.selectors.buttons.play),
                      pause: pe.call(this, this.config.selectors.buttons.pause),
                      restart: pe.call(
                        this,
                        this.config.selectors.buttons.restart
                      ),
                      rewind: pe.call(
                        this,
                        this.config.selectors.buttons.rewind
                      ),
                      fastForward: pe.call(
                        this,
                        this.config.selectors.buttons.fastForward
                      ),
                      mute: pe.call(this, this.config.selectors.buttons.mute),
                      pip: pe.call(this, this.config.selectors.buttons.pip),
                      airplay: pe.call(
                        this,
                        this.config.selectors.buttons.airplay
                      ),
                      settings: pe.call(
                        this,
                        this.config.selectors.buttons.settings
                      ),
                      captions: pe.call(
                        this,
                        this.config.selectors.buttons.captions
                      ),
                      fullscreen: pe.call(
                        this,
                        this.config.selectors.buttons.fullscreen
                      ),
                    }),
                    (this.elements.progress = pe.call(
                      this,
                      this.config.selectors.progress
                    )),
                    (this.elements.inputs = {
                      seek: pe.call(this, this.config.selectors.inputs.seek),
                      volume: pe.call(
                        this,
                        this.config.selectors.inputs.volume
                      ),
                    }),
                    (this.elements.display = {
                      buffer: pe.call(
                        this,
                        this.config.selectors.display.buffer
                      ),
                      currentTime: pe.call(
                        this,
                        this.config.selectors.display.currentTime
                      ),
                      duration: pe.call(
                        this,
                        this.config.selectors.display.duration
                      ),
                    }),
                    U(this.elements.progress) &&
                      (this.elements.display.seekTooltip =
                        this.elements.progress.querySelector(
                          ".".concat(this.config.classNames.tooltip)
                        )),
                    !0
                  );
                } catch (e) {
                  return (
                    this.debug.warn(
                      "It looks like there is a problem with your custom controls HTML",
                      e
                    ),
                    this.toggleNativeControls(!0),
                    !1
                  );
                }
              },
              createIcon(e, t) {
                var n = "http://www.w3.org/2000/svg",
                  i = Ye.getIconUrl.call(this),
                  a = ""
                    .concat(i.cors ? "" : i.url, "#")
                    .concat(this.config.iconPrefix),
                  r = document.createElementNS(n, "svg");
                te(r, Z(t, { "aria-hidden": "true", focusable: "false" }));
                var s = document.createElementNS(n, "use"),
                  o = "".concat(a, "-").concat(e);
                return (
                  "href" in s &&
                    s.setAttributeNS("http://www.w3.org/1999/xlink", "href", o),
                  s.setAttributeNS(
                    "http://www.w3.org/1999/xlink",
                    "xlink:href",
                    o
                  ),
                  r.appendChild(s),
                  r
                );
              },
              createLabel(e) {
                var t =
                    arguments.length > 1 && void 0 !== arguments[1]
                      ? arguments[1]
                      : {},
                  n = Ve.get(e, this.config);
                return ne(
                  "span",
                  c(
                    c({}, t),
                    {},
                    {
                      class: [t.class, this.config.classNames.hidden]
                        .filter(Boolean)
                        .join(" "),
                    }
                  ),
                  n
                );
              },
              createBadge(e) {
                if ($(e)) return null;
                var t = ne("span", {
                  class: this.config.classNames.menu.value,
                });
                return (
                  t.appendChild(
                    ne("span", { class: this.config.classNames.menu.badge }, e)
                  ),
                  t
                );
              },
              createButton(e, t) {
                var n = this,
                  i = Z({}, t),
                  a = (function () {
                    var e = (
                      arguments.length > 0 && void 0 !== arguments[0]
                        ? arguments[0]
                        : ""
                    ).toString();
                    return (
                      (e = (function () {
                        var e = (
                          arguments.length > 0 && void 0 !== arguments[0]
                            ? arguments[0]
                            : ""
                        ).toString();
                        return (
                          (e = De(e, "-", " ")),
                          (e = De(e, "_", " ")),
                          (e = He(e)),
                          De(e, " ", "")
                        );
                      })(e)),
                      e.charAt(0).toLowerCase() + e.slice(1)
                    );
                  })(e),
                  r = {
                    element: "button",
                    toggle: !1,
                    label: null,
                    icon: null,
                    labelPressed: null,
                    iconPressed: null,
                  };
                switch (
                  (["element", "icon", "label"].forEach(function (e) {
                    Object.keys(i).includes(e) && ((r[e] = i[e]), delete i[e]);
                  }),
                  "button" !== r.element ||
                    Object.keys(i).includes("type") ||
                    (i.type = "button"),
                  Object.keys(i).includes("class")
                    ? i.class.split(" ").some(function (e) {
                        return e === n.config.classNames.control;
                      }) ||
                      Z(i, {
                        class: ""
                          .concat(i.class, " ")
                          .concat(this.config.classNames.control),
                      })
                    : (i.class = this.config.classNames.control),
                  e)
                ) {
                  case "play":
                    (r.toggle = !0),
                      (r.label = "play"),
                      (r.labelPressed = "pause"),
                      (r.icon = "play"),
                      (r.iconPressed = "pause");
                    break;
                  case "mute":
                    (r.toggle = !0),
                      (r.label = "mute"),
                      (r.labelPressed = "unmute"),
                      (r.icon = "volume"),
                      (r.iconPressed = "muted");
                    break;
                  case "captions":
                    (r.toggle = !0),
                      (r.label = "enableCaptions"),
                      (r.labelPressed = "disableCaptions"),
                      (r.icon = "captions-off"),
                      (r.iconPressed = "captions-on");
                    break;
                  case "fullscreen":
                    (r.toggle = !0),
                      (r.label = "enterFullscreen"),
                      (r.labelPressed = "exitFullscreen"),
                      (r.icon = "enter-fullscreen"),
                      (r.iconPressed = "exit-fullscreen");
                    break;
                  case "play-large":
                    (i.class += " ".concat(
                      this.config.classNames.control,
                      "--overlaid"
                    )),
                      (a = "play"),
                      (r.label = "play"),
                      (r.icon = "play");
                    break;
                  default:
                    $(r.label) && (r.label = a), $(r.icon) && (r.icon = e);
                }
                var s = ne(r.element);
                return (
                  r.toggle
                    ? (s.appendChild(
                        Ye.createIcon.call(this, r.iconPressed, {
                          class: "icon--pressed",
                        })
                      ),
                      s.appendChild(
                        Ye.createIcon.call(this, r.icon, {
                          class: "icon--not-pressed",
                        })
                      ),
                      s.appendChild(
                        Ye.createLabel.call(this, r.labelPressed, {
                          class: "label--pressed",
                        })
                      ),
                      s.appendChild(
                        Ye.createLabel.call(this, r.label, {
                          class: "label--not-pressed",
                        })
                      ))
                    : (s.appendChild(Ye.createIcon.call(this, r.icon)),
                      s.appendChild(Ye.createLabel.call(this, r.label))),
                  Z(i, oe(this.config.selectors.buttons[a], i)),
                  te(s, i),
                  "play" === a
                    ? (V(this.elements.buttons[a]) ||
                        (this.elements.buttons[a] = []),
                      this.elements.buttons[a].push(s))
                    : (this.elements.buttons[a] = s),
                  s
                );
              },
              createRange(e, t) {
                var n = ne(
                  "input",
                  Z(
                    oe(this.config.selectors.inputs[e]),
                    {
                      type: "range",
                      min: 0,
                      max: 100,
                      step: 0.01,
                      value: 0,
                      autocomplete: "off",
                      role: "slider",
                      "aria-label": Ve.get(e, this.config),
                      "aria-valuemin": 0,
                      "aria-valuemax": 100,
                      "aria-valuenow": 0,
                    },
                    t
                  )
                );
                return (
                  (this.elements.inputs[e] = n),
                  Ye.updateRangeFill.call(this, n),
                  C.setup(n),
                  n
                );
              },
              createProgress(e, t) {
                var n = ne(
                  "progress",
                  Z(
                    oe(this.config.selectors.display[e]),
                    {
                      min: 0,
                      max: 100,
                      value: 0,
                      role: "progressbar",
                      "aria-hidden": !0,
                    },
                    t
                  )
                );
                if ("volume" !== e) {
                  n.appendChild(ne("span", null, "0"));
                  var i = { played: "played", buffer: "buffered" }[e],
                    a = i ? Ve.get(i, this.config) : "";
                  n.innerText = "% ".concat(a.toLowerCase());
                }
                return (this.elements.display[e] = n), n;
              },
              createTime(e, t) {
                var n = oe(this.config.selectors.display[e], t),
                  i = ne(
                    "div",
                    Z(n, {
                      class: ""
                        .concat(n.class ? n.class : "", " ")
                        .concat(this.config.classNames.display.time, " ")
                        .trim(),
                      "aria-label": Ve.get(e, this.config),
                    }),
                    "00:00"
                  );
                return (this.elements.display[e] = i), i;
              },
              bindMenuItemShortcuts(e, t) {
                var n = this;
                be.call(
                  this,
                  e,
                  "keydown keyup",
                  function (i) {
                    if (
                      ["Space", "ArrowUp", "ArrowDown", "ArrowRight"].includes(
                        i.key
                      ) &&
                      (i.preventDefault(),
                      i.stopPropagation(),
                      "keydown" !== i.type)
                    ) {
                      var a,
                        r = de(e, '[role="menuitemradio"]');
                      !r && ["Space", "ArrowRight"].includes(i.key)
                        ? Ye.showMenuPanel.call(n, t, !0)
                        : "Space" !== i.key &&
                          ("ArrowDown" === i.key ||
                          (r && "ArrowRight" === i.key)
                            ? ((a = e.nextElementSibling),
                              U(a) || (a = e.parentNode.firstElementChild))
                            : ((a = e.previousElementSibling),
                              U(a) || (a = e.parentNode.lastElementChild)),
                          me.call(n, a, !0));
                    }
                  },
                  !1
                ),
                  be.call(this, e, "keyup", function (e) {
                    "Return" === e.key &&
                      Ye.focusFirstMenuItem.call(n, null, !0);
                  });
              },
              createMenuItem(e) {
                var t = this,
                  n = e.value,
                  i = e.list,
                  a = e.type,
                  r = e.title,
                  s = e.badge,
                  o = void 0 === s ? null : s,
                  l = e.checked,
                  c = void 0 !== l && l,
                  u = oe(this.config.selectors.inputs[a]),
                  d = ne(
                    "button",
                    Z(u, {
                      type: "button",
                      role: "menuitemradio",
                      class: ""
                        .concat(this.config.classNames.control, " ")
                        .concat(u.class ? u.class : "")
                        .trim(),
                      "aria-checked": c,
                      value: n,
                    })
                  ),
                  h = ne("span");
                (h.innerHTML = r),
                  U(o) && h.appendChild(o),
                  d.appendChild(h),
                  Object.defineProperty(d, "checked", {
                    enumerable: !0,
                    get: function () {
                      return "true" === d.getAttribute("aria-checked");
                    },
                    set(e) {
                      e &&
                        Array.from(d.parentNode.children)
                          .filter(function (e) {
                            return de(e, '[role="menuitemradio"]');
                          })
                          .forEach(function (e) {
                            return e.setAttribute("aria-checked", "false");
                          }),
                        d.setAttribute("aria-checked", e ? "true" : "false");
                    },
                  }),
                  this.listeners.bind(
                    d,
                    "click keyup",
                    function (e) {
                      if (!z(e) || "Space" === e.key) {
                        switch (
                          (e.preventDefault(),
                          e.stopPropagation(),
                          (d.checked = !0),
                          a)
                        ) {
                          case "language":
                            t.currentTrack = Number(n);
                            break;
                          case "quality":
                            t.quality = n;
                            break;
                          case "speed":
                            t.speed = parseFloat(n);
                        }
                        Ye.showMenuPanel.call(t, "home", z(e));
                      }
                    },
                    a,
                    !1
                  ),
                  Ye.bindMenuItemShortcuts.call(this, d, a),
                  i.appendChild(d);
              },
              formatTime() {
                var e =
                    arguments.length > 0 && void 0 !== arguments[0]
                      ? arguments[0]
                      : 0,
                  t =
                    arguments.length > 1 &&
                    void 0 !== arguments[1] &&
                    arguments[1];
                return D(e) ? Ke(e, ze(this.duration) > 0, t) : e;
              },
              updateTimeDisplay() {
                var e =
                    arguments.length > 0 && void 0 !== arguments[0]
                      ? arguments[0]
                      : null,
                  t =
                    arguments.length > 1 && void 0 !== arguments[1]
                      ? arguments[1]
                      : 0,
                  n =
                    arguments.length > 2 &&
                    void 0 !== arguments[2] &&
                    arguments[2];
                U(e) && D(t) && (e.innerText = Ye.formatTime(t, n));
              },
              updateVolume() {
                this.supported.ui &&
                  (U(this.elements.inputs.volume) &&
                    Ye.setRange.call(
                      this,
                      this.elements.inputs.volume,
                      this.muted ? 0 : this.volume
                    ),
                  U(this.elements.buttons.mute) &&
                    (this.elements.buttons.mute.pressed =
                      this.muted || 0 === this.volume));
              },
              setRange(e) {
                var t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : 0;
                U(e) && ((e.value = t), Ye.updateRangeFill.call(this, e));
              },
              updateProgress(e) {
                var t = this;
                if (this.supported.ui && W(e)) {
                  var n,
                    i,
                    a = 0;
                  if (e)
                    switch (e.type) {
                      case "timeupdate":
                      case "seeking":
                      case "seeked":
                        (n = this.currentTime),
                          (i = this.duration),
                          (a =
                            0 === n ||
                            0 === i ||
                            Number.isNaN(n) ||
                            Number.isNaN(i)
                              ? 0
                              : ((n / i) * 100).toFixed(2)),
                          "timeupdate" === e.type &&
                            Ye.setRange.call(
                              this,
                              this.elements.inputs.seek,
                              a
                            );
                        break;
                      case "playing":
                      case "progress":
                        !(function (e, n) {
                          var i = D(n) ? n : 0,
                            a = U(e) ? e : t.elements.display.buffer;
                          if (U(a)) {
                            a.value = i;
                            var r = a.getElementsByTagName("span")[0];
                            U(r) && (r.childNodes[0].nodeValue = i);
                          }
                        })(this.elements.display.buffer, 100 * this.buffered);
                    }
                }
              },
              updateRangeFill(e) {
                var t = W(e) ? e.target : e;
                if (U(t) && "range" === t.getAttribute("type")) {
                  if (de(t, this.config.selectors.inputs.seek)) {
                    t.setAttribute("aria-valuenow", this.currentTime);
                    var n = Ye.formatTime(this.currentTime),
                      i = Ye.formatTime(this.duration),
                      a = Ve.get("seekLabel", this.config);
                    t.setAttribute(
                      "aria-valuetext",
                      a.replace("{currentTime}", n).replace("{duration}", i)
                    );
                  } else if (de(t, this.config.selectors.inputs.volume)) {
                    var r = 100 * t.value;
                    t.setAttribute("aria-valuenow", r),
                      t.setAttribute(
                        "aria-valuetext",
                        "".concat(r.toFixed(1), "%")
                      );
                  } else t.setAttribute("aria-valuenow", t.value);
                  J.isWebkit &&
                    t.style.setProperty(
                      "--value",
                      (t.value / t.max) * 100 + "%"
                    );
                }
              },
              updateSeekTooltip(e) {
                var t, n;
                if (
                  this.config.tooltips.seek &&
                  U(this.elements.inputs.seek) &&
                  U(this.elements.display.seekTooltip) &&
                  0 !== this.duration
                ) {
                  var i = this.elements.display.seekTooltip,
                    a = "".concat(this.config.classNames.tooltip, "--visible"),
                    r = function (e) {
                      return ce(i, a, e);
                    };
                  if (this.touch) r(!1);
                  else {
                    var s = 0,
                      o = this.elements.progress.getBoundingClientRect();
                    if (W(e)) s = (100 / o.width) * (e.pageX - o.left);
                    else {
                      if (!ue(i, a)) return;
                      s = parseFloat(i.style.left, 10);
                    }
                    s < 0 ? (s = 0) : s > 100 && (s = 100);
                    var l = (this.duration / 100) * s;
                    i.innerText = Ye.formatTime(l);
                    var c =
                      null === (t = this.config.markers) ||
                      void 0 === t ||
                      null === (n = t.points) ||
                      void 0 === n
                        ? void 0
                        : n.find(function (e) {
                            return e.time === Math.round(l);
                          });
                    c &&
                      i.insertAdjacentHTML(
                        "afterbegin",
                        "".concat(c.label, "<br>")
                      ),
                      (i.style.left = "".concat(s, "%")),
                      W(e) &&
                        ["mouseenter", "mouseleave"].includes(e.type) &&
                        r("mouseenter" === e.type);
                  }
                }
              },
              timeUpdate(e) {
                var t =
                  !U(this.elements.display.duration) && this.config.invertTime;
                Ye.updateTimeDisplay.call(
                  this,
                  this.elements.display.currentTime,
                  t ? this.duration - this.currentTime : this.currentTime,
                  t
                ),
                  (e && "timeupdate" === e.type && this.media.seeking) ||
                    Ye.updateProgress.call(this, e);
              },
              durationUpdate() {
                if (
                  this.supported.ui &&
                  (this.config.invertTime || !this.currentTime)
                ) {
                  if (this.duration >= Math.pow(2, 32))
                    return (
                      le(this.elements.display.currentTime, !0),
                      void le(this.elements.progress, !0)
                    );
                  U(this.elements.inputs.seek) &&
                    this.elements.inputs.seek.setAttribute(
                      "aria-valuemax",
                      this.duration
                    );
                  var e = U(this.elements.display.duration);
                  !e &&
                    this.config.displayDuration &&
                    this.paused &&
                    Ye.updateTimeDisplay.call(
                      this,
                      this.elements.display.currentTime,
                      this.duration
                    ),
                    e &&
                      Ye.updateTimeDisplay.call(
                        this,
                        this.elements.display.duration,
                        this.duration
                      ),
                    this.config.markers.enabled && Ye.setMarkers.call(this),
                    Ye.updateSeekTooltip.call(this);
                }
              },
              toggleMenuButton(e, t) {
                le(this.elements.settings.buttons[e], !t);
              },
              updateSetting(e, t, n) {
                var i = this.elements.settings.panels[e],
                  a = null,
                  r = t;
                if ("captions" === e) a = this.currentTrack;
                else {
                  if (
                    ((a = $(n) ? this[e] : n),
                    $(a) && (a = this.config[e].default),
                    !$(this.options[e]) && !this.options[e].includes(a))
                  )
                    return void this.debug.warn(
                      "Unsupported value of '".concat(a, "' for ").concat(e)
                    );
                  if (!this.config[e].options.includes(a))
                    return void this.debug.warn(
                      "Disabled value of '".concat(a, "' for ").concat(e)
                    );
                }
                if (
                  (U(r) || (r = i && i.querySelector('[role="menu"]')), U(r))
                ) {
                  this.elements.settings.buttons[e].querySelector(
                    ".".concat(this.config.classNames.menu.value)
                  ).innerHTML = Ye.getLabel.call(this, e, a);
                  var s = r && r.querySelector('[value="'.concat(a, '"]'));
                  U(s) && (s.checked = !0);
                }
              },
              getLabel(e, t) {
                switch (e) {
                  case "speed":
                    return 1 === t
                      ? Ve.get("normal", this.config)
                      : "".concat(t, "&times;");
                  case "quality":
                    if (D(t)) {
                      var n = Ve.get("qualityLabel.".concat(t), this.config);
                      return n.length ? n : "".concat(t, "p");
                    }
                    return He(t);
                  case "captions":
                    return Xe.getLabel.call(this);
                  default:
                    return null;
                }
              },
              setQualityMenu(e) {
                var t = this;
                if (U(this.elements.settings.panels.quality)) {
                  var n = "quality",
                    i =
                      this.elements.settings.panels.quality.querySelector(
                        '[role="menu"]'
                      );
                  V(e) &&
                    (this.options.quality = Ee(e).filter(function (e) {
                      return t.config.quality.options.includes(e);
                    }));
                  var a =
                    !$(this.options.quality) && this.options.quality.length > 1;
                  if (
                    (Ye.toggleMenuButton.call(this, n, a),
                    re(i),
                    Ye.checkMenu.call(this),
                    a)
                  ) {
                    var r = function (e) {
                      var n = Ve.get("qualityBadge.".concat(e), t.config);
                      return n.length ? Ye.createBadge.call(t, n) : null;
                    };
                    this.options.quality
                      .sort(function (e, n) {
                        var i = t.config.quality.options;
                        return i.indexOf(e) > i.indexOf(n) ? 1 : -1;
                      })
                      .forEach(function (e) {
                        Ye.createMenuItem.call(t, {
                          value: e,
                          list: i,
                          type: n,
                          title: Ye.getLabel.call(t, "quality", e),
                          badge: r(e),
                        });
                      }),
                      Ye.updateSetting.call(this, n, i);
                  }
                }
              },
              setCaptionsMenu() {
                var e = this;
                if (U(this.elements.settings.panels.captions)) {
                  var t = "captions",
                    n =
                      this.elements.settings.panels.captions.querySelector(
                        '[role="menu"]'
                      ),
                    i = Xe.getTracks.call(this),
                    a = Boolean(i.length);
                  if (
                    (Ye.toggleMenuButton.call(this, t, a),
                    re(n),
                    Ye.checkMenu.call(this),
                    a)
                  ) {
                    var r = i.map(function (t, i) {
                      return {
                        value: i,
                        checked: e.captions.toggled && e.currentTrack === i,
                        title: Xe.getLabel.call(e, t),
                        badge:
                          t.language &&
                          Ye.createBadge.call(e, t.language.toUpperCase()),
                        list: n,
                        type: "language",
                      };
                    });
                    r.unshift({
                      value: -1,
                      checked: !this.captions.toggled,
                      title: Ve.get("disabled", this.config),
                      list: n,
                      type: "language",
                    }),
                      r.forEach(Ye.createMenuItem.bind(this)),
                      Ye.updateSetting.call(this, t, n);
                  }
                }
              },
              setSpeedMenu() {
                var e = this;
                if (U(this.elements.settings.panels.speed)) {
                  var t = "speed",
                    n =
                      this.elements.settings.panels.speed.querySelector(
                        '[role="menu"]'
                      );
                  this.options.speed = this.options.speed.filter(function (t) {
                    return t >= e.minimumSpeed && t <= e.maximumSpeed;
                  });
                  var i =
                    !$(this.options.speed) && this.options.speed.length > 1;
                  Ye.toggleMenuButton.call(this, t, i),
                    re(n),
                    Ye.checkMenu.call(this),
                    i &&
                      (this.options.speed.forEach(function (i) {
                        Ye.createMenuItem.call(e, {
                          value: i,
                          list: n,
                          type: t,
                          title: Ye.getLabel.call(e, "speed", i),
                        });
                      }),
                      Ye.updateSetting.call(this, t, n));
                }
              },
              checkMenu() {
                var e = this.elements.settings.buttons,
                  t =
                    !$(e) &&
                    Object.values(e).some(function (e) {
                      return !e.hidden;
                    });
                le(this.elements.settings.menu, !t);
              },
              focusFirstMenuItem(e) {
                var t =
                  arguments.length > 1 &&
                  void 0 !== arguments[1] &&
                  arguments[1];
                if (!this.elements.settings.popup.hidden) {
                  var n = e;
                  U(n) ||
                    (n = Object.values(this.elements.settings.panels).find(
                      function (e) {
                        return !e.hidden;
                      }
                    ));
                  var i = n.querySelector('[role^="menuitem"]');
                  me.call(this, i, t);
                }
              },
              toggleMenu(e) {
                var t = this.elements.settings.popup,
                  n = this.elements.buttons.settings;
                if (U(t) && U(n)) {
                  var i = t.hidden,
                    a = i;
                  if (F(e)) a = e;
                  else if (z(e) && "Escape" === e.key) a = !1;
                  else if (W(e)) {
                    var r = R(e.composedPath) ? e.composedPath()[0] : e.target,
                      s = t.contains(r);
                    if (s || (!s && e.target !== n && a)) return;
                  }
                  n.setAttribute("aria-expanded", a),
                    le(t, !a),
                    ce(
                      this.elements.container,
                      this.config.classNames.menu.open,
                      a
                    ),
                    a && z(e)
                      ? Ye.focusFirstMenuItem.call(this, null, !0)
                      : a || i || me.call(this, n, z(e));
                }
              },
              getMenuSize(e) {
                var t = e.cloneNode(!0);
                (t.style.position = "absolute"),
                  (t.style.opacity = 0),
                  t.removeAttribute("hidden"),
                  e.parentNode.appendChild(t);
                var n = t.scrollWidth,
                  i = t.scrollHeight;
                return ae(t), { width: n, height: i };
              },
              showMenuPanel() {
                var e = this,
                  t =
                    arguments.length > 0 && void 0 !== arguments[0]
                      ? arguments[0]
                      : "",
                  n =
                    arguments.length > 1 &&
                    void 0 !== arguments[1] &&
                    arguments[1],
                  i = this.elements.container.querySelector(
                    "#plyr-settings-".concat(this.id, "-").concat(t)
                  );
                if (U(i)) {
                  var a = i.parentNode,
                    r = Array.from(a.children).find(function (e) {
                      return !e.hidden;
                    });
                  if (ge.transitions && !ge.reducedMotion) {
                    (a.style.width = "".concat(r.scrollWidth, "px")),
                      (a.style.height = "".concat(r.scrollHeight, "px"));
                    var s = Ye.getMenuSize.call(this, i);
                    be.call(this, a, Q, function t(n) {
                      n.target === a &&
                        ["width", "height"].includes(n.propertyName) &&
                        ((a.style.width = ""),
                        (a.style.height = ""),
                        we.call(e, a, Q, t));
                    }),
                      (a.style.width = "".concat(s.width, "px")),
                      (a.style.height = "".concat(s.height, "px"));
                  }
                  le(r, !0), le(i, !1), Ye.focusFirstMenuItem.call(this, i, n);
                }
              },
              setDownloadUrl() {
                var e = this.elements.buttons.download;
                U(e) && e.setAttribute("href", this.download);
              },
              create(e) {
                var t = this,
                  n = Ye.bindMenuItemShortcuts,
                  i = Ye.createButton,
                  a = Ye.createProgress,
                  r = Ye.createRange,
                  s = Ye.createTime,
                  o = Ye.setQualityMenu,
                  l = Ye.setSpeedMenu,
                  c = Ye.showMenuPanel;
                (this.elements.controls = null),
                  V(this.config.controls) &&
                    this.config.controls.includes("play-large") &&
                    this.elements.container.appendChild(
                      i.call(this, "play-large")
                    );
                var u = ne("div", oe(this.config.selectors.controls.wrapper));
                this.elements.controls = u;
                var d = { class: "plyr__controls__item" };
                return (
                  Ee(
                    V(this.config.controls) ? this.config.controls : []
                  ).forEach(function (o) {
                    if (
                      ("restart" === o &&
                        u.appendChild(i.call(t, "restart", d)),
                      "rewind" === o && u.appendChild(i.call(t, "rewind", d)),
                      "play" === o && u.appendChild(i.call(t, "play", d)),
                      "fast-forward" === o &&
                        u.appendChild(i.call(t, "fast-forward", d)),
                      "progress" === o)
                    ) {
                      var l = ne("div", {
                          class: "".concat(
                            d.class,
                            " plyr__progress__container"
                          ),
                        }),
                        h = ne("div", oe(t.config.selectors.progress));
                      if (
                        (h.appendChild(
                          r.call(t, "seek", { id: "plyr-seek-".concat(e.id) })
                        ),
                        h.appendChild(a.call(t, "buffer")),
                        t.config.tooltips.seek)
                      ) {
                        var p = ne(
                          "span",
                          { class: t.config.classNames.tooltip },
                          "00:00"
                        );
                        h.appendChild(p), (t.elements.display.seekTooltip = p);
                      }
                      (t.elements.progress = h),
                        l.appendChild(t.elements.progress),
                        u.appendChild(l);
                    }
                    if (
                      ("current-time" === o &&
                        u.appendChild(s.call(t, "currentTime", d)),
                      "duration" === o &&
                        u.appendChild(s.call(t, "duration", d)),
                      "mute" === o || "volume" === o)
                    ) {
                      var m = t.elements.volume;
                      if (
                        ((U(m) && u.contains(m)) ||
                          ((m = ne(
                            "div",
                            Z({}, d, {
                              class: "".concat(d.class, " plyr__volume").trim(),
                            })
                          )),
                          (t.elements.volume = m),
                          u.appendChild(m)),
                        "mute" === o && m.appendChild(i.call(t, "mute")),
                        "volume" === o && !J.isIos)
                      ) {
                        var f = { max: 1, step: 0.05, value: t.config.volume };
                        m.appendChild(
                          r.call(
                            t,
                            "volume",
                            Z(f, { id: "plyr-volume-".concat(e.id) })
                          )
                        );
                      }
                    }
                    if (
                      ("captions" === o &&
                        u.appendChild(i.call(t, "captions", d)),
                      "settings" === o && !$(t.config.settings))
                    ) {
                      var g = ne(
                        "div",
                        Z({}, d, {
                          class: "".concat(d.class, " plyr__menu").trim(),
                          hidden: "",
                        })
                      );
                      g.appendChild(
                        i.call(t, "settings", {
                          "aria-haspopup": !0,
                          "aria-controls": "plyr-settings-".concat(e.id),
                          "aria-expanded": !1,
                        })
                      );
                      var y = ne("div", {
                          class: "plyr__menu__container",
                          id: "plyr-settings-".concat(e.id),
                          hidden: "",
                        }),
                        v = ne("div"),
                        b = ne("div", {
                          id: "plyr-settings-".concat(e.id, "-home"),
                        }),
                        w = ne("div", { role: "menu" });
                      b.appendChild(w),
                        v.appendChild(b),
                        (t.elements.settings.panels.home = b),
                        t.config.settings.forEach(function (i) {
                          var a = ne(
                            "button",
                            Z(oe(t.config.selectors.buttons.settings), {
                              type: "button",
                              class: ""
                                .concat(t.config.classNames.control, " ")
                                .concat(
                                  t.config.classNames.control,
                                  "--forward"
                                ),
                              role: "menuitem",
                              "aria-haspopup": !0,
                              hidden: "",
                            })
                          );
                          n.call(t, a, i),
                            be.call(t, a, "click", function () {
                              c.call(t, i, !1);
                            });
                          var r = ne("span", null, Ve.get(i, t.config)),
                            s = ne("span", {
                              class: t.config.classNames.menu.value,
                            });
                          (s.innerHTML = e[i]),
                            r.appendChild(s),
                            a.appendChild(r),
                            w.appendChild(a);
                          var o = ne("div", {
                              id: "plyr-settings-".concat(e.id, "-").concat(i),
                              hidden: "",
                            }),
                            l = ne("button", {
                              type: "button",
                              class: ""
                                .concat(t.config.classNames.control, " ")
                                .concat(t.config.classNames.control, "--back"),
                            });
                          l.appendChild(
                            ne(
                              "span",
                              { "aria-hidden": !0 },
                              Ve.get(i, t.config)
                            )
                          ),
                            l.appendChild(
                              ne(
                                "span",
                                { class: t.config.classNames.hidden },
                                Ve.get("menuBack", t.config)
                              )
                            ),
                            be.call(
                              t,
                              o,
                              "keydown",
                              function (e) {
                                "ArrowLeft" === e.key &&
                                  (e.preventDefault(),
                                  e.stopPropagation(),
                                  c.call(t, "home", !0));
                              },
                              !1
                            ),
                            be.call(t, l, "click", function () {
                              c.call(t, "home", !1);
                            }),
                            o.appendChild(l),
                            o.appendChild(ne("div", { role: "menu" })),
                            v.appendChild(o),
                            (t.elements.settings.buttons[i] = a),
                            (t.elements.settings.panels[i] = o);
                        }),
                        y.appendChild(v),
                        g.appendChild(y),
                        u.appendChild(g),
                        (t.elements.settings.popup = y),
                        (t.elements.settings.menu = g);
                    }
                    if (
                      ("pip" === o &&
                        ge.pip &&
                        u.appendChild(i.call(t, "pip", d)),
                      "airplay" === o &&
                        ge.airplay &&
                        u.appendChild(i.call(t, "airplay", d)),
                      "download" === o)
                    ) {
                      var k = Z({}, d, {
                        element: "a",
                        href: t.download,
                        target: "_blank",
                      });
                      t.isHTML5 && (k.download = "");
                      var T = t.config.urls.download;
                      !Y(T) &&
                        t.isEmbed &&
                        Z(k, {
                          icon: "logo-".concat(t.provider),
                          label: t.provider,
                        }),
                        u.appendChild(i.call(t, "download", k));
                    }
                    "fullscreen" === o &&
                      u.appendChild(i.call(t, "fullscreen", d));
                  }),
                  this.isHTML5 && o.call(this, Oe.getQualityOptions.call(this)),
                  l.call(this),
                  u
                );
              },
              inject() {
                var e = this;
                if (this.config.loadSprite) {
                  var t = Ye.getIconUrl.call(this);
                  t.cors && We(t.url, "sprite-plyr");
                }
                this.id = Math.floor(1e4 * Math.random());
                var n = null;
                this.elements.controls = null;
                var i,
                  a = {
                    id: this.id,
                    seektime: this.config.seekTime,
                    title: this.config.title,
                  },
                  r = !0;
                if (
                  (R(this.config.controls) &&
                    (this.config.controls = this.config.controls.call(this, a)),
                  this.config.controls || (this.config.controls = []),
                  U(this.config.controls) || H(this.config.controls)
                    ? (n = this.config.controls)
                    : ((n = Ye.create.call(this, {
                        id: this.id,
                        seektime: this.config.seekTime,
                        speed: this.speed,
                        quality: this.quality,
                        captions: Xe.getLabel.call(this),
                      })),
                      (r = !1)),
                  r &&
                    H(this.config.controls) &&
                    (n = (function (e) {
                      var t = e;
                      return (
                        Object.entries(a).forEach(function (e) {
                          var n = d(e, 2),
                            i = n[0],
                            a = n[1];
                          t = De(t, "{".concat(i, "}"), a);
                        }),
                        t
                      );
                    })(n)),
                  H(this.config.selectors.controls.container) &&
                    (i = document.querySelector(
                      this.config.selectors.controls.container
                    )),
                  U(i) || (i = this.elements.container),
                  i[U(n) ? "insertAdjacentElement" : "insertAdjacentHTML"](
                    "afterbegin",
                    n
                  ),
                  U(this.elements.controls) || Ye.findElements.call(this),
                  !$(this.elements.buttons))
                ) {
                  var s = function (t) {
                    var n = e.config.classNames.controlPressed;
                    Object.defineProperty(t, "pressed", {
                      enumerable: !0,
                      get: function () {
                        return ue(t, n);
                      },
                      set() {
                        ce(
                          t,
                          n,
                          arguments.length > 0 &&
                            void 0 !== arguments[0] &&
                            arguments[0]
                        );
                      },
                    });
                  };
                  Object.values(this.elements.buttons)
                    .filter(Boolean)
                    .forEach(function (e) {
                      V(e) || B(e)
                        ? Array.from(e).filter(Boolean).forEach(s)
                        : s(e);
                    });
                }
                if ((J.isEdge && X(i), this.config.tooltips.controls)) {
                  var o = this.config,
                    l = o.classNames,
                    c = o.selectors,
                    u = ""
                      .concat(c.controls.wrapper, " ")
                      .concat(c.labels, " .")
                      .concat(l.hidden),
                    h = he.call(this, u);
                  Array.from(h).forEach(function (t) {
                    ce(t, e.config.classNames.hidden, !1),
                      ce(t, e.config.classNames.tooltip, !0);
                  });
                }
              },
              setMediaMetadata() {
                try {
                  "mediaSession" in navigator &&
                    (navigator.mediaSession.metadata = new window.MediaMetadata(
                      {
                        title: this.config.mediaMetadata.title,
                        artist: this.config.mediaMetadata.artist,
                        album: this.config.mediaMetadata.album,
                        artwork: this.config.mediaMetadata.artwork,
                      }
                    ));
                } catch (e) {}
              },
              setMarkers() {
                var e,
                  t,
                  n = this;
                if (this.duration && !this.elements.markers) {
                  var i =
                    null === (e = this.config.markers) ||
                    void 0 === e ||
                    null === (t = e.points) ||
                    void 0 === t
                      ? void 0
                      : t.filter(function (e) {
                          var t = e.time;
                          return t > 0 && t < n.duration;
                        });
                  if (null != i && i.length) {
                    var a = document.createDocumentFragment(),
                      r = document.createDocumentFragment(),
                      s = null,
                      o = "".concat(
                        this.config.classNames.tooltip,
                        "--visible"
                      ),
                      l = function (e) {
                        return ce(s, o, e);
                      };
                    i.forEach(function (e) {
                      var t = ne(
                          "span",
                          { class: n.config.classNames.marker },
                          ""
                        ),
                        i = (e.time / n.duration) * 100 + "%";
                      s &&
                        (t.addEventListener("mouseenter", function () {
                          e.label ||
                            ((s.style.left = i),
                            (s.innerHTML = e.label),
                            l(!0));
                        }),
                        t.addEventListener("mouseleave", function () {
                          l(!1);
                        })),
                        t.addEventListener("click", function () {
                          n.currentTime = e.time;
                        }),
                        (t.style.left = i),
                        r.appendChild(t);
                    }),
                      a.appendChild(r),
                      this.config.tooltips.seek ||
                        ((s = ne(
                          "span",
                          { class: this.config.classNames.tooltip },
                          ""
                        )),
                        a.appendChild(s)),
                      (this.elements.markers = { points: r, tip: s }),
                      this.elements.progress.appendChild(a);
                  }
                }
              },
            };
            function $e(e) {
              var t = e;
              if (
                !(arguments.length > 1 && void 0 !== arguments[1]) ||
                arguments[1]
              ) {
                var n = document.createElement("a");
                (n.href = t), (t = n.href);
              }
              try {
                return new URL(t);
              } catch (e) {
                return null;
              }
            }
            function Qe(e) {
              var t = new URLSearchParams();
              return (
                q(e) &&
                  Object.entries(e).forEach(function (e) {
                    var n = d(e, 2),
                      i = n[0],
                      a = n[1];
                    t.set(i, a);
                  }),
                t
              );
            }
            var Xe = {
                setup() {
                  if (this.supported.ui)
                    if (
                      !this.isVideo ||
                      this.isYouTube ||
                      (this.isHTML5 && !ge.textTracks)
                    )
                      V(this.config.controls) &&
                        this.config.controls.includes("settings") &&
                        this.config.settings.includes("captions") &&
                        Ye.setCaptionsMenu.call(this);
                    else {
                      var e, t;
                      if (
                        (U(this.elements.captions) ||
                          ((this.elements.captions = ne(
                            "div",
                            oe(this.config.selectors.captions)
                          )),
                          (e = this.elements.captions),
                          (t = this.elements.wrapper),
                          U(e) &&
                            U(t) &&
                            t.parentNode.insertBefore(e, t.nextSibling)),
                        J.isIE && window.URL)
                      ) {
                        var n = this.media.querySelectorAll("track");
                        Array.from(n).forEach(function (e) {
                          var t = e.getAttribute("src"),
                            n = $e(t);
                          null !== n &&
                            n.hostname !== window.location.href.hostname &&
                            ["http:", "https:"].includes(n.protocol) &&
                            Ue(t, "blob")
                              .then(function (t) {
                                e.setAttribute(
                                  "src",
                                  window.URL.createObjectURL(t)
                                );
                              })
                              .catch(function () {
                                ae(e);
                              });
                        });
                      }
                      var i = Ee(
                          (
                            navigator.languages || [
                              navigator.language ||
                                navigator.userLanguage ||
                                "en",
                            ]
                          ).map(function (e) {
                            return e.split("-")[0];
                          })
                        ),
                        a = (
                          this.storage.get("language") ||
                          this.config.captions.language ||
                          "auto"
                        ).toLowerCase();
                      "auto" === a && (a = d(i, 1)[0]);
                      var r = this.storage.get("captions");
                      if (
                        (F(r) || (r = this.config.captions.active),
                        Object.assign(this.captions, {
                          toggled: !1,
                          active: r,
                          language: a,
                          languages: i,
                        }),
                        this.isHTML5)
                      ) {
                        var s = this.config.captions.update
                          ? "addtrack removetrack"
                          : "removetrack";
                        be.call(
                          this,
                          this.media.textTracks,
                          s,
                          Xe.update.bind(this)
                        );
                      }
                      setTimeout(Xe.update.bind(this), 0);
                    }
                },
                update() {
                  var e = this,
                    t = Xe.getTracks.call(this, !0),
                    n = this.captions,
                    i = n.active,
                    a = n.language,
                    r = n.meta,
                    s = n.currentTrackNode,
                    o = Boolean(
                      t.find(function (e) {
                        return e.language === a;
                      })
                    );
                  this.isHTML5 &&
                    this.isVideo &&
                    t
                      .filter(function (e) {
                        return !r.get(e);
                      })
                      .forEach(function (t) {
                        e.debug.log("Track added", t),
                          r.set(t, { default: "showing" === t.mode }),
                          "showing" === t.mode && (t.mode = "hidden"),
                          be.call(e, t, "cuechange", function () {
                            return Xe.updateCues.call(e);
                          });
                      }),
                    ((o && this.language !== a) || !t.includes(s)) &&
                      (Xe.setLanguage.call(this, a),
                      Xe.toggle.call(this, i && o)),
                    this.elements &&
                      ce(
                        this.elements.container,
                        this.config.classNames.captions.enabled,
                        !$(t)
                      ),
                    V(this.config.controls) &&
                      this.config.controls.includes("settings") &&
                      this.config.settings.includes("captions") &&
                      Ye.setCaptionsMenu.call(this);
                },
                toggle(e) {
                  var t = this,
                    n =
                      !(arguments.length > 1 && void 0 !== arguments[1]) ||
                      arguments[1];
                  if (this.supported.ui) {
                    var i = this.captions.toggled,
                      r = this.config.classNames.captions.active,
                      s = O(e) ? !i : e;
                    if (s !== i) {
                      if (
                        (n ||
                          ((this.captions.active = s),
                          this.storage.set({ captions: s })),
                        !this.language && s && !n)
                      ) {
                        var o = Xe.getTracks.call(this),
                          l = Xe.findTrack.call(
                            this,
                            [this.captions.language].concat(
                              a(this.captions.languages)
                            ),
                            !0
                          );
                        return (
                          (this.captions.language = l.language),
                          void Xe.set.call(this, o.indexOf(l))
                        );
                      }
                      this.elements.buttons.captions &&
                        (this.elements.buttons.captions.pressed = s),
                        ce(this.elements.container, r, s),
                        (this.captions.toggled = s),
                        Ye.updateSetting.call(this, "captions"),
                        Te.call(
                          this,
                          this.media,
                          s ? "captionsenabled" : "captionsdisabled"
                        );
                    }
                    setTimeout(function () {
                      s &&
                        t.captions.toggled &&
                        (t.captions.currentTrackNode.mode = "hidden");
                    });
                  }
                },
                set(e) {
                  var t =
                      !(arguments.length > 1 && void 0 !== arguments[1]) ||
                      arguments[1],
                    n = Xe.getTracks.call(this);
                  if (-1 !== e)
                    if (D(e))
                      if (e in n) {
                        if (this.captions.currentTrack !== e) {
                          this.captions.currentTrack = e;
                          var i = n[e],
                            a = (i || {}).language;
                          (this.captions.currentTrackNode = i),
                            Ye.updateSetting.call(this, "captions"),
                            t ||
                              ((this.captions.language = a),
                              this.storage.set({ language: a })),
                            this.isVimeo && this.embed.enableTextTrack(a),
                            Te.call(this, this.media, "languagechange");
                        }
                        Xe.toggle.call(this, !0, t),
                          this.isHTML5 &&
                            this.isVideo &&
                            Xe.updateCues.call(this);
                      } else this.debug.warn("Track not found", e);
                    else this.debug.warn("Invalid caption argument", e);
                  else Xe.toggle.call(this, !1, t);
                },
                setLanguage(e) {
                  var t =
                    !(arguments.length > 1 && void 0 !== arguments[1]) ||
                    arguments[1];
                  if (H(e)) {
                    var n = e.toLowerCase();
                    this.captions.language = n;
                    var i = Xe.getTracks.call(this),
                      a = Xe.findTrack.call(this, [n]);
                    Xe.set.call(this, i.indexOf(a), t);
                  } else this.debug.warn("Invalid language argument", e);
                },
                getTracks() {
                  var e = this,
                    t =
                      arguments.length > 0 &&
                      void 0 !== arguments[0] &&
                      arguments[0];
                  return Array.from((this.media || {}).textTracks || [])
                    .filter(function (n) {
                      return !e.isHTML5 || t || e.captions.meta.has(n);
                    })
                    .filter(function (e) {
                      return ["captions", "subtitles"].includes(e.kind);
                    });
                },
                findTrack(e) {
                  var t,
                    n = this,
                    i =
                      arguments.length > 1 &&
                      void 0 !== arguments[1] &&
                      arguments[1],
                    a = Xe.getTracks.call(this),
                    r = function (e) {
                      return Number((n.captions.meta.get(e) || {}).default);
                    },
                    s = Array.from(a).sort(function (e, t) {
                      return r(t) - r(e);
                    });
                  return (
                    e.every(function (e) {
                      return (
                        (t = s.find(function (t) {
                          return t.language === e;
                        })),
                        !t
                      );
                    }),
                    t || (i ? s[0] : void 0)
                  );
                },
                getCurrentTrack() {
                  return Xe.getTracks.call(this)[this.currentTrack];
                },
                getLabel(e) {
                  var t = e;
                  return (
                    !K(t) &&
                      ge.textTracks &&
                      this.captions.toggled &&
                      (t = Xe.getCurrentTrack.call(this)),
                    K(t)
                      ? $(t.label)
                        ? $(t.language)
                          ? Ve.get("enabled", this.config)
                          : e.language.toUpperCase()
                        : t.label
                      : Ve.get("disabled", this.config)
                  );
                },
                updateCues(e) {
                  if (this.supported.ui)
                    if (U(this.elements.captions))
                      if (O(e) || Array.isArray(e)) {
                        var t = e;
                        if (!t) {
                          var n = Xe.getCurrentTrack.call(this);
                          t = Array.from((n || {}).activeCues || [])
                            .map(function (e) {
                              return e.getCueAsHTML();
                            })
                            .map(Fe);
                        }
                        var i = t
                          .map(function (e) {
                            return e.trim();
                          })
                          .join("\n");
                        if (i !== this.elements.captions.innerHTML) {
                          re(this.elements.captions);
                          var a = ne("span", oe(this.config.selectors.caption));
                          (a.innerHTML = i),
                            this.elements.captions.appendChild(a),
                            Te.call(this, this.media, "cuechange");
                        }
                      } else this.debug.warn("updateCues: Invalid input", e);
                    else this.debug.warn("No captions element to render to");
                },
              },
              Je = {
                enabled: !0,
                title: "",
                debug: !1,
                autoplay: !1,
                autopause: !0,
                playsinline: !0,
                seekTime: 10,
                volume: 1,
                muted: !1,
                duration: null,
                displayDuration: !0,
                invertTime: !0,
                toggleInvert: !0,
                ratio: null,
                clickToPlay: !0,
                hideControls: !0,
                resetOnEnd: !1,
                disableContextMenu: !0,
                loadSprite: !0,
                iconPrefix: "plyr",
                iconUrl: "https://cdn.plyr.io/3.7.2/plyr.svg",
                blankVideo: "https://cdn.plyr.io/static/blank.mp4",
                quality: {
                  default: 576,
                  options: [
                    4320, 2880, 2160, 1440, 1080, 720, 576, 480, 360, 240,
                  ],
                  forced: !1,
                  onChange: null,
                },
                loop: { active: !1 },
                speed: {
                  selected: 1,
                  options: [0.5, 0.75, 1, 1.25, 1.5, 1.75, 2, 4],
                },
                keyboard: { focused: !0, global: !1 },
                tooltips: { controls: !1, seek: !0 },
                captions: { active: !1, language: "auto", update: !1 },
                fullscreen: { enabled: !0, fallback: !0, iosNative: !1 },
                storage: { enabled: !0, key: "plyr" },
                controls: [
                  "play-large",
                  "play",
                  "progress",
                  "current-time",
                  "mute",
                  "volume",
                  "captions",
                  "settings",
                  "pip",
                  "airplay",
                  "fullscreen",
                ],
                settings: ["captions", "quality", "speed"],
                i18n: {
                  restart: "Restart",
                  rewind: "Rewind {seektime}s",
                  play: "Play",
                  pause: "Pause",
                  fastForward: "Forward {seektime}s",
                  seek: "Seek",
                  seekLabel: "{currentTime} of {duration}",
                  played: "Played",
                  buffered: "Buffered",
                  currentTime: "Current time",
                  duration: "Duration",
                  volume: "Volume",
                  mute: "Mute",
                  unmute: "Unmute",
                  enableCaptions: "Enable captions",
                  disableCaptions: "Disable captions",
                  download: "Download",
                  enterFullscreen: "Enter fullscreen",
                  exitFullscreen: "Exit fullscreen",
                  frameTitle: "Player for {title}",
                  captions: "Captions",
                  settings: "Settings",
                  pip: "PIP",
                  menuBack: "Go back to previous menu",
                  speed: "Speed",
                  normal: "Normal",
                  quality: "Quality",
                  loop: "Loop",
                  start: "Start",
                  end: "End",
                  all: "All",
                  reset: "Reset",
                  disabled: "Disabled",
                  enabled: "Enabled",
                  advertisement: "Ad",
                  qualityBadge: {
                    2160: "4K",
                    1440: "HD",
                    1080: "HD",
                    720: "HD",
                    576: "SD",
                    480: "SD",
                  },
                },
                urls: {
                  download: null,
                  vimeo: {
                    sdk: "https://player.vimeo.com/api/player.js",
                    iframe: "https://player.vimeo.com/video/{0}?{1}",
                    api: "https://vimeo.com/api/oembed.json?url={0}",
                  },
                  youtube: {
                    sdk: "https://www.youtube.com/iframe_api",
                    api: "https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}",
                  },
                  googleIMA: {
                    sdk: "https://imasdk.googleapis.com/js/sdkloader/ima3.js",
                  },
                },
                listeners: {
                  seek: null,
                  play: null,
                  pause: null,
                  restart: null,
                  rewind: null,
                  fastForward: null,
                  mute: null,
                  volume: null,
                  captions: null,
                  download: null,
                  fullscreen: null,
                  pip: null,
                  airplay: null,
                  speed: null,
                  quality: null,
                  loop: null,
                  language: null,
                },
                events: [
                  "ended",
                  "progress",
                  "stalled",
                  "playing",
                  "waiting",
                  "canplay",
                  "canplaythrough",
                  "loadstart",
                  "loadeddata",
                  "loadedmetadata",
                  "timeupdate",
                  "volumechange",
                  "play",
                  "pause",
                  "error",
                  "seeking",
                  "seeked",
                  "emptied",
                  "ratechange",
                  "cuechange",
                  "download",
                  "enterfullscreen",
                  "exitfullscreen",
                  "captionsenabled",
                  "captionsdisabled",
                  "languagechange",
                  "controlshidden",
                  "controlsshown",
                  "ready",
                  "statechange",
                  "qualitychange",
                  "adsloaded",
                  "adscontentpause",
                  "adscontentresume",
                  "adstarted",
                  "adsmidpoint",
                  "adscomplete",
                  "adsallcomplete",
                  "adsimpression",
                  "adsclick",
                ],
                selectors: {
                  editable: "input, textarea, select, [contenteditable]",
                  container: ".plyr",
                  controls: { container: null, wrapper: ".plyr__controls" },
                  labels: "[data-plyr]",
                  buttons: {
                    play: '[data-plyr="play"]',
                    pause: '[data-plyr="pause"]',
                    restart: '[data-plyr="restart"]',
                    rewind: '[data-plyr="rewind"]',
                    fastForward: '[data-plyr="fast-forward"]',
                    mute: '[data-plyr="mute"]',
                    captions: '[data-plyr="captions"]',
                    download: '[data-plyr="download"]',
                    fullscreen: '[data-plyr="fullscreen"]',
                    pip: '[data-plyr="pip"]',
                    airplay: '[data-plyr="airplay"]',
                    settings: '[data-plyr="settings"]',
                    loop: '[data-plyr="loop"]',
                  },
                  inputs: {
                    seek: '[data-plyr="seek"]',
                    volume: '[data-plyr="volume"]',
                    speed: '[data-plyr="speed"]',
                    language: '[data-plyr="language"]',
                    quality: '[data-plyr="quality"]',
                  },
                  display: {
                    currentTime: ".plyr__time--current",
                    duration: ".plyr__time--duration",
                    buffer: ".plyr__progress__buffer",
                    loop: ".plyr__progress__loop",
                    volume: ".plyr__volume--display",
                  },
                  progress: ".plyr__progress",
                  captions: ".plyr__captions",
                  caption: ".plyr__caption",
                },
                classNames: {
                  type: "plyr--{0}",
                  provider: "plyr--{0}",
                  video: "plyr__video-wrapper",
                  embed: "plyr__video-embed",
                  videoFixedRatio: "plyr__video-wrapper--fixed-ratio",
                  embedContainer: "plyr__video-embed__container",
                  poster: "plyr__poster",
                  posterEnabled: "plyr__poster-enabled",
                  ads: "plyr__ads",
                  control: "plyr__control",
                  controlPressed: "plyr__control--pressed",
                  playing: "plyr--playing",
                  paused: "plyr--paused",
                  stopped: "plyr--stopped",
                  loading: "plyr--loading",
                  hover: "plyr--hover",
                  tooltip: "plyr__tooltip",
                  cues: "plyr__cues",
                  marker: "plyr__progress__marker",
                  hidden: "plyr__sr-only",
                  hideControls: "plyr--hide-controls",
                  isIos: "plyr--is-ios",
                  isTouch: "plyr--is-touch",
                  uiSupported: "plyr--full-ui",
                  noTransition: "plyr--no-transition",
                  display: { time: "plyr__time" },
                  menu: {
                    value: "plyr__menu__value",
                    badge: "plyr__badge",
                    open: "plyr--menu-open",
                  },
                  captions: {
                    enabled: "plyr--captions-enabled",
                    active: "plyr--captions-active",
                  },
                  fullscreen: {
                    enabled: "plyr--fullscreen-enabled",
                    fallback: "plyr--fullscreen-fallback",
                  },
                  pip: {
                    supported: "plyr--pip-supported",
                    active: "plyr--pip-active",
                  },
                  airplay: {
                    supported: "plyr--airplay-supported",
                    active: "plyr--airplay-active",
                  },
                  tabFocus: "plyr__tab-focus",
                  previewThumbnails: {
                    thumbContainer: "plyr__preview-thumb",
                    thumbContainerShown: "plyr__preview-thumb--is-shown",
                    imageContainer: "plyr__preview-thumb__image-container",
                    timeContainer: "plyr__preview-thumb__time-container",
                    scrubbingContainer: "plyr__preview-scrubbing",
                    scrubbingContainerShown:
                      "plyr__preview-scrubbing--is-shown",
                  },
                },
                attributes: {
                  embed: {
                    provider: "data-plyr-provider",
                    id: "data-plyr-embed-id",
                    hash: "data-plyr-embed-hash",
                  },
                },
                ads: { enabled: !1, publisherId: "", tagUrl: "" },
                previewThumbnails: { enabled: !1, src: "" },
                vimeo: {
                  byline: !1,
                  portrait: !1,
                  title: !1,
                  speed: !0,
                  transparent: !1,
                  customControls: !0,
                  referrerPolicy: null,
                  premium: !1,
                },
                youtube: {
                  rel: 0,
                  showinfo: 0,
                  iv_load_policy: 3,
                  modestbranding: 1,
                  customControls: !0,
                  noCookie: !1,
                },
                mediaMetadata: {
                  title: "",
                  artist: "",
                  album: "",
                  artwork: [],
                },
                markers: { enabled: !1, points: [] },
              },
              Ge = "picture-in-picture",
              Ze = { html5: "html5", youtube: "youtube", vimeo: "vimeo" },
              et = "video",
              tt = function () {},
              nt = (function () {
                function e() {
                  var t =
                    arguments.length > 0 &&
                    void 0 !== arguments[0] &&
                    arguments[0];
                  r(this, e),
                    (this.enabled = window.console && t),
                    this.enabled && this.log("Debugging enabled");
                }
                return (
                  o(e, [
                    {
                      key: "log",
                      get: function () {
                        return this.enabled
                          ? Function.prototype.bind.call(console.log, console)
                          : tt;
                      },
                    },
                    {
                      key: "warn",
                      get: function () {
                        return this.enabled
                          ? Function.prototype.bind.call(console.warn, console)
                          : tt;
                      },
                    },
                    {
                      key: "error",
                      get: function () {
                        return this.enabled
                          ? Function.prototype.bind.call(console.error, console)
                          : tt;
                      },
                    },
                  ]),
                  e
                );
              })(),
              it = (function () {
                function t(n) {
                  var i = this;
                  r(this, t),
                    e(this, "onChange", function () {
                      if (i.enabled) {
                        var e = i.player.elements.buttons.fullscreen;
                        U(e) && (e.pressed = i.active);
                        var t =
                          i.target === i.player.media
                            ? i.target
                            : i.player.elements.container;
                        Te.call(
                          i.player,
                          t,
                          i.active ? "enterfullscreen" : "exitfullscreen",
                          !0
                        );
                      }
                    }),
                    e(this, "toggleFallback", function () {
                      var e =
                        arguments.length > 0 &&
                        void 0 !== arguments[0] &&
                        arguments[0];
                      if (
                        (e
                          ? (i.scrollPosition = {
                              x: window.scrollX || 0,
                              y: window.scrollY || 0,
                            })
                          : window.scrollTo(
                              i.scrollPosition.x,
                              i.scrollPosition.y
                            ),
                        (document.body.style.overflow = e ? "hidden" : ""),
                        ce(
                          i.target,
                          i.player.config.classNames.fullscreen.fallback,
                          e
                        ),
                        J.isIos)
                      ) {
                        var t = document.head.querySelector(
                            'meta[name="viewport"]'
                          ),
                          n = "viewport-fit=cover";
                        t ||
                          (t = document.createElement("meta")).setAttribute(
                            "name",
                            "viewport"
                          );
                        var a = H(t.content) && t.content.includes(n);
                        e
                          ? ((i.cleanupViewport = !a),
                            a || (t.content += ",".concat(n)))
                          : i.cleanupViewport &&
                            (t.content = t.content
                              .split(",")
                              .filter(function (e) {
                                return e.trim() !== n;
                              })
                              .join(","));
                      }
                      i.onChange();
                    }),
                    e(this, "trapFocus", function (e) {
                      if (!J.isIos && i.active && "Tab" === e.key) {
                        var t = document.activeElement,
                          n = he.call(
                            i.player,
                            "a[href], button:not(:disabled), input:not(:disabled), [tabindex]"
                          ),
                          a = d(n, 1)[0],
                          r = n[n.length - 1];
                        t !== r || e.shiftKey
                          ? t === a &&
                            e.shiftKey &&
                            (r.focus(), e.preventDefault())
                          : (a.focus(), e.preventDefault());
                      }
                    }),
                    e(this, "update", function () {
                      var e;
                      i.enabled
                        ? ((e = i.forceFallback
                            ? "Fallback (forced)"
                            : t.native
                            ? "Native"
                            : "Fallback"),
                          i.player.debug.log(
                            "".concat(e, " fullscreen enabled")
                          ))
                        : i.player.debug.log(
                            "Fullscreen not supported and fallback disabled"
                          ),
                        ce(
                          i.player.elements.container,
                          i.player.config.classNames.fullscreen.enabled,
                          i.enabled
                        );
                    }),
                    e(this, "enter", function () {
                      i.enabled &&
                        (J.isIos && i.player.config.fullscreen.iosNative
                          ? i.player.isVimeo
                            ? i.player.embed.requestFullscreen()
                            : i.target.webkitEnterFullscreen()
                          : !t.native || i.forceFallback
                          ? i.toggleFallback(!0)
                          : i.prefix
                          ? $(i.prefix) ||
                            i.target[
                              "".concat(i.prefix, "Request").concat(i.property)
                            ]()
                          : i.target.requestFullscreen({
                              navigationUI: "hide",
                            }));
                    }),
                    e(this, "exit", function () {
                      if (i.enabled)
                        if (J.isIos && i.player.config.fullscreen.iosNative)
                          i.target.webkitExitFullscreen(), Ce(i.player.play());
                        else if (!t.native || i.forceFallback)
                          i.toggleFallback(!1);
                        else if (i.prefix) {
                          if (!$(i.prefix)) {
                            var e = "moz" === i.prefix ? "Cancel" : "Exit";
                            document[
                              "".concat(i.prefix).concat(e).concat(i.property)
                            ]();
                          }
                        } else
                          (
                            document.cancelFullScreen || document.exitFullscreen
                          ).call(document);
                    }),
                    e(this, "toggle", function () {
                      i.active ? i.exit() : i.enter();
                    }),
                    (this.player = n),
                    (this.prefix = t.prefix),
                    (this.property = t.property),
                    (this.scrollPosition = { x: 0, y: 0 }),
                    (this.forceFallback =
                      "force" === n.config.fullscreen.fallback),
                    (this.player.elements.fullscreen =
                      n.config.fullscreen.container &&
                      (function (e, t) {
                        return (
                          Element.prototype.closest ||
                          function () {
                            var e = this;
                            do {
                              if (de.matches(e, t)) return e;
                              e = e.parentElement || e.parentNode;
                            } while (null !== e && 1 === e.nodeType);
                            return null;
                          }
                        ).call(e, t);
                      })(
                        this.player.elements.container,
                        n.config.fullscreen.container
                      )),
                    be.call(
                      this.player,
                      document,
                      "ms" === this.prefix
                        ? "MSFullscreenChange"
                        : "".concat(this.prefix, "fullscreenchange"),
                      function () {
                        i.onChange();
                      }
                    ),
                    be.call(
                      this.player,
                      this.player.elements.container,
                      "dblclick",
                      function (e) {
                        (U(i.player.elements.controls) &&
                          i.player.elements.controls.contains(e.target)) ||
                          i.player.listeners.proxy(e, i.toggle, "fullscreen");
                      }
                    ),
                    be.call(
                      this,
                      this.player.elements.container,
                      "keydown",
                      function (e) {
                        return i.trapFocus(e);
                      }
                    ),
                    this.update();
                }
                return (
                  o(
                    t,
                    [
                      {
                        key: "usingNative",
                        get: function () {
                          return t.native && !this.forceFallback;
                        },
                      },
                      {
                        key: "enabled",
                        get: function () {
                          return (
                            (t.native ||
                              this.player.config.fullscreen.fallback) &&
                            this.player.config.fullscreen.enabled &&
                            this.player.supported.ui &&
                            this.player.isVideo
                          );
                        },
                      },
                      {
                        key: "active",
                        get: function () {
                          if (!this.enabled) return !1;
                          if (!t.native || this.forceFallback)
                            return ue(
                              this.target,
                              this.player.config.classNames.fullscreen.fallback
                            );
                          var e = this.prefix
                            ? this.target.getRootNode()[
                                ""
                                  .concat(this.prefix)
                                  .concat(this.property, "Element")
                              ]
                            : this.target.getRootNode().fullscreenElement;
                          return e && e.shadowRoot
                            ? e === this.target.getRootNode().host
                            : e === this.target;
                        },
                      },
                      {
                        key: "target",
                        get: function () {
                          return J.isIos &&
                            this.player.config.fullscreen.iosNative
                            ? this.player.media
                            : this.player.elements.fullscreen ||
                                this.player.elements.container;
                        },
                      },
                    ],
                    [
                      {
                        key: "native",
                        get: function () {
                          return !!(
                            document.fullscreenEnabled ||
                            document.webkitFullscreenEnabled ||
                            document.mozFullScreenEnabled ||
                            document.msFullscreenEnabled
                          );
                        },
                      },
                      {
                        key: "prefix",
                        get: function () {
                          if (R(document.exitFullscreen)) return "";
                          var e = "";
                          return (
                            ["webkit", "moz", "ms"].some(function (t) {
                              return !(
                                (!R(document["".concat(t, "ExitFullscreen")]) &&
                                  !R(
                                    document["".concat(t, "CancelFullScreen")]
                                  )) ||
                                ((e = t), 0)
                              );
                            }),
                            e
                          );
                        },
                      },
                      {
                        key: "property",
                        get: function () {
                          return "moz" === this.prefix
                            ? "FullScreen"
                            : "Fullscreen";
                        },
                      },
                    ]
                  ),
                  t
                );
              })();
            function at(e) {
              var t =
                arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : 1;
              return new Promise(function (n, i) {
                var a = new Image(),
                  r = function () {
                    delete a.onload,
                      delete a.onerror,
                      (a.naturalWidth >= t ? n : i)(a);
                  };
                Object.assign(a, { onload: r, onerror: r, src: e });
              });
            }
            var rt = {
                addStyleHook() {
                  ce(
                    this.elements.container,
                    this.config.selectors.container.replace(".", ""),
                    !0
                  ),
                    ce(
                      this.elements.container,
                      this.config.classNames.uiSupported,
                      this.supported.ui
                    );
                },
                toggleNativeControls() {
                  arguments.length > 0 &&
                  void 0 !== arguments[0] &&
                  arguments[0] &&
                  this.isHTML5
                    ? this.media.setAttribute("controls", "")
                    : this.media.removeAttribute("controls");
                },
                build() {
                  var e = this;
                  if ((this.listeners.media(), !this.supported.ui))
                    return (
                      this.debug.warn(
                        "Basic support only for "
                          .concat(this.provider, " ")
                          .concat(this.type)
                      ),
                      void rt.toggleNativeControls.call(this, !0)
                    );
                  U(this.elements.controls) ||
                    (Ye.inject.call(this), this.listeners.controls()),
                    rt.toggleNativeControls.call(this),
                    this.isHTML5 && Xe.setup.call(this),
                    (this.volume = null),
                    (this.muted = null),
                    (this.loop = null),
                    (this.quality = null),
                    (this.speed = null),
                    Ye.updateVolume.call(this),
                    Ye.timeUpdate.call(this),
                    Ye.durationUpdate.call(this),
                    rt.checkPlaying.call(this),
                    ce(
                      this.elements.container,
                      this.config.classNames.pip.supported,
                      ge.pip && this.isHTML5 && this.isVideo
                    ),
                    ce(
                      this.elements.container,
                      this.config.classNames.airplay.supported,
                      ge.airplay && this.isHTML5
                    ),
                    ce(
                      this.elements.container,
                      this.config.classNames.isIos,
                      J.isIos
                    ),
                    ce(
                      this.elements.container,
                      this.config.classNames.isTouch,
                      this.touch
                    ),
                    (this.ready = !0),
                    setTimeout(function () {
                      Te.call(e, e.media, "ready");
                    }, 0),
                    rt.setTitle.call(this),
                    this.poster &&
                      rt.setPoster
                        .call(this, this.poster, !1)
                        .catch(function () {}),
                    this.config.duration && Ye.durationUpdate.call(this),
                    this.config.mediaMetadata && Ye.setMediaMetadata.call(this);
                },
                setTitle() {
                  var e = Ve.get("play", this.config);
                  if (
                    (H(this.config.title) &&
                      !$(this.config.title) &&
                      (e += ", ".concat(this.config.title)),
                    Array.from(this.elements.buttons.play || []).forEach(
                      function (t) {
                        t.setAttribute("aria-label", e);
                      }
                    ),
                    this.isEmbed)
                  ) {
                    var t = pe.call(this, "iframe");
                    if (!U(t)) return;
                    var n = $(this.config.title) ? "video" : this.config.title,
                      i = Ve.get("frameTitle", this.config);
                    t.setAttribute("title", i.replace("{title}", n));
                  }
                },
                togglePoster(e) {
                  ce(
                    this.elements.container,
                    this.config.classNames.posterEnabled,
                    e
                  );
                },
                setPoster(e) {
                  var t = this;
                  return (arguments.length > 1 &&
                    void 0 !== arguments[1] &&
                    !arguments[1]) ||
                    !this.poster
                    ? (this.media.setAttribute("data-poster", e),
                      this.elements.poster.removeAttribute("hidden"),
                      Ae.call(this)
                        .then(function () {
                          return at(e);
                        })
                        .catch(function (n) {
                          throw (
                            (e === t.poster && rt.togglePoster.call(t, !1), n)
                          );
                        })
                        .then(function () {
                          if (e !== t.poster)
                            throw new Error(
                              "setPoster cancelled by later call to setPoster"
                            );
                        })
                        .then(function () {
                          return (
                            Object.assign(t.elements.poster.style, {
                              backgroundImage: "url('".concat(e, "')"),
                              backgroundSize: "",
                            }),
                            rt.togglePoster.call(t, !0),
                            e
                          );
                        }))
                    : Promise.reject(new Error("Poster already set"));
                },
                checkPlaying(e) {
                  var t = this;
                  ce(
                    this.elements.container,
                    this.config.classNames.playing,
                    this.playing
                  ),
                    ce(
                      this.elements.container,
                      this.config.classNames.paused,
                      this.paused
                    ),
                    ce(
                      this.elements.container,
                      this.config.classNames.stopped,
                      this.stopped
                    ),
                    Array.from(this.elements.buttons.play || []).forEach(
                      function (e) {
                        Object.assign(e, { pressed: t.playing }),
                          e.setAttribute(
                            "aria-label",
                            Ve.get(t.playing ? "pause" : "play", t.config)
                          );
                      }
                    ),
                    (W(e) && "timeupdate" === e.type) ||
                      rt.toggleControls.call(this);
                },
                checkLoading(e) {
                  var t = this;
                  (this.loading = ["stalled", "waiting"].includes(e.type)),
                    clearTimeout(this.timers.loading),
                    (this.timers.loading = setTimeout(
                      function () {
                        ce(
                          t.elements.container,
                          t.config.classNames.loading,
                          t.loading
                        ),
                          rt.toggleControls.call(t);
                      },
                      this.loading ? 250 : 0
                    ));
                },
                toggleControls(e) {
                  var t = this.elements.controls;
                  if (t && this.config.hideControls) {
                    var n = this.touch && this.lastSeekTime + 2e3 > Date.now();
                    this.toggleControls(
                      Boolean(
                        e ||
                          this.loading ||
                          this.paused ||
                          t.pressed ||
                          t.hover ||
                          n
                      )
                    );
                  }
                },
                migrateStyles() {
                  var e = this;
                  Object.values(c({}, this.media.style))
                    .filter(function (e) {
                      return !$(e) && H(e) && e.startsWith("--plyr");
                    })
                    .forEach(function (t) {
                      e.elements.container.style.setProperty(
                        t,
                        e.media.style.getPropertyValue(t)
                      ),
                        e.media.style.removeProperty(t);
                    }),
                    $(this.media.style) && this.media.removeAttribute("style");
                },
              },
              st = (function () {
                function t(n) {
                  var i = this;
                  r(this, t),
                    e(this, "firstTouch", function () {
                      var e = i.player,
                        t = e.elements;
                      (e.touch = !0),
                        ce(t.container, e.config.classNames.isTouch, !0);
                    }),
                    e(this, "setTabFocus", function (e) {
                      var t = i.player,
                        n = t.elements,
                        a = e.key,
                        r = e.type,
                        s = e.timeStamp;
                      if (
                        (clearTimeout(i.focusTimer),
                        "keydown" !== r || "Tab" === a)
                      ) {
                        "keydown" === r && (i.lastKeyDown = s);
                        var o = s - i.lastKeyDown <= 20;
                        ("focus" !== r || o) &&
                          ((function () {
                            var e = t.config.classNames.tabFocus;
                            ce(he.call(t, ".".concat(e)), e, !1);
                          })(),
                          "focusout" !== r &&
                            (i.focusTimer = setTimeout(function () {
                              var e = document.activeElement;
                              n.container.contains(e) &&
                                ce(
                                  document.activeElement,
                                  t.config.classNames.tabFocus,
                                  !0
                                );
                            }, 10)));
                      }
                    }),
                    e(this, "global", function () {
                      var e =
                          !(arguments.length > 0 && void 0 !== arguments[0]) ||
                          arguments[0],
                        t = i.player;
                      t.config.keyboard.global &&
                        ve.call(t, window, "keydown keyup", i.handleKey, e, !1),
                        ve.call(t, document.body, "click", i.toggleMenu, e),
                        ke.call(t, document.body, "touchstart", i.firstTouch),
                        ve.call(
                          t,
                          document.body,
                          "keydown focus blur focusout",
                          i.setTabFocus,
                          e,
                          !1,
                          !0
                        );
                    }),
                    e(this, "container", function () {
                      var e = i.player,
                        t = e.config,
                        n = e.elements,
                        a = e.timers;
                      !t.keyboard.global &&
                        t.keyboard.focused &&
                        be.call(
                          e,
                          n.container,
                          "keydown keyup",
                          i.handleKey,
                          !1
                        ),
                        be.call(
                          e,
                          n.container,
                          "mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",
                          function (t) {
                            var i = n.controls;
                            i &&
                              "enterfullscreen" === t.type &&
                              ((i.pressed = !1), (i.hover = !1));
                            var r = 0;
                            ["touchstart", "touchmove", "mousemove"].includes(
                              t.type
                            ) &&
                              (rt.toggleControls.call(e, !0),
                              (r = e.touch ? 3e3 : 2e3)),
                              clearTimeout(a.controls),
                              (a.controls = setTimeout(function () {
                                return rt.toggleControls.call(e, !1);
                              }, r));
                          }
                        );
                      var r = function () {
                          if (e.isVimeo && !e.config.vimeo.premium) {
                            var t = n.wrapper,
                              i = e.fullscreen.active,
                              a = d(Ne.call(e), 2),
                              r = a[0],
                              s = a[1],
                              o = Me(
                                "aspect-ratio: ".concat(r, " / ").concat(s)
                              );
                            if (i) {
                              var l = [
                                  Math.max(
                                    document.documentElement.clientWidth || 0,
                                    window.innerWidth || 0
                                  ),
                                  Math.max(
                                    document.documentElement.clientHeight || 0,
                                    window.innerHeight || 0
                                  ),
                                ],
                                c = l[1],
                                u = l[0] / c > r / s;
                              o
                                ? ((t.style.width = u ? "auto" : "100%"),
                                  (t.style.height = u ? "100%" : "auto"))
                                : ((t.style.maxWidth = u
                                    ? (c / s) * r + "px"
                                    : null),
                                  (t.style.margin = u ? "0 auto" : null));
                            } else
                              o
                                ? ((t.style.width = null),
                                  (t.style.height = null))
                                : ((t.style.maxWidth = null),
                                  (t.style.margin = null));
                          }
                        },
                        s = function () {
                          clearTimeout(a.resized),
                            (a.resized = setTimeout(r, 50));
                        };
                      be.call(
                        e,
                        n.container,
                        "enterfullscreen exitfullscreen",
                        function (t) {
                          e.fullscreen.target === n.container &&
                            ((!e.isEmbed && $(e.config.ratio)) ||
                              (r(),
                              ("enterfullscreen" === t.type ? be : we).call(
                                e,
                                window,
                                "resize",
                                s
                              )));
                        }
                      );
                    }),
                    e(this, "media", function () {
                      var e = i.player,
                        t = e.elements;
                      if (
                        (be.call(
                          e,
                          e.media,
                          "timeupdate seeking seeked",
                          function (t) {
                            return Ye.timeUpdate.call(e, t);
                          }
                        ),
                        be.call(
                          e,
                          e.media,
                          "durationchange loadeddata loadedmetadata",
                          function (t) {
                            return Ye.durationUpdate.call(e, t);
                          }
                        ),
                        be.call(e, e.media, "ended", function () {
                          e.isHTML5 &&
                            e.isVideo &&
                            e.config.resetOnEnd &&
                            (e.restart(), e.pause());
                        }),
                        be.call(
                          e,
                          e.media,
                          "progress playing seeking seeked",
                          function (t) {
                            return Ye.updateProgress.call(e, t);
                          }
                        ),
                        be.call(e, e.media, "volumechange", function (t) {
                          return Ye.updateVolume.call(e, t);
                        }),
                        be.call(
                          e,
                          e.media,
                          "playing play pause ended emptied timeupdate",
                          function (t) {
                            return rt.checkPlaying.call(e, t);
                          }
                        ),
                        be.call(
                          e,
                          e.media,
                          "waiting canplay seeked playing",
                          function (t) {
                            return rt.checkLoading.call(e, t);
                          }
                        ),
                        e.supported.ui && e.config.clickToPlay && !e.isAudio)
                      ) {
                        var n = pe.call(
                          e,
                          ".".concat(e.config.classNames.video)
                        );
                        if (!U(n)) return;
                        be.call(e, t.container, "click", function (a) {
                          ([t.container, n].includes(a.target) ||
                            n.contains(a.target)) &&
                            ((e.touch && e.config.hideControls) ||
                              (e.ended
                                ? (i.proxy(a, e.restart, "restart"),
                                  i.proxy(
                                    a,
                                    function () {
                                      Ce(e.play());
                                    },
                                    "play"
                                  ))
                                : i.proxy(
                                    a,
                                    function () {
                                      Ce(e.togglePlay());
                                    },
                                    "play"
                                  )));
                        });
                      }
                      e.supported.ui &&
                        e.config.disableContextMenu &&
                        be.call(
                          e,
                          t.wrapper,
                          "contextmenu",
                          function (e) {
                            e.preventDefault();
                          },
                          !1
                        ),
                        be.call(e, e.media, "volumechange", function () {
                          e.storage.set({ volume: e.volume, muted: e.muted });
                        }),
                        be.call(e, e.media, "ratechange", function () {
                          Ye.updateSetting.call(e, "speed"),
                            e.storage.set({ speed: e.speed });
                        }),
                        be.call(e, e.media, "qualitychange", function (t) {
                          Ye.updateSetting.call(
                            e,
                            "quality",
                            null,
                            t.detail.quality
                          );
                        }),
                        be.call(e, e.media, "ready qualitychange", function () {
                          Ye.setDownloadUrl.call(e);
                        });
                      var a = e.config.events
                        .concat(["keyup", "keydown"])
                        .join(" ");
                      be.call(e, e.media, a, function (n) {
                        var i = n.detail,
                          a = void 0 === i ? {} : i;
                        "error" === n.type && (a = e.media.error),
                          Te.call(e, t.container, n.type, !0, a);
                      });
                    }),
                    e(this, "proxy", function (e, t, n) {
                      var a = i.player,
                        r = a.config.listeners[n],
                        s = !0;
                      R(r) && (s = r.call(a, e)),
                        !1 !== s && R(t) && t.call(a, e);
                    }),
                    e(this, "bind", function (e, t, n, a) {
                      var r =
                          !(arguments.length > 4 && void 0 !== arguments[4]) ||
                          arguments[4],
                        s = i.player,
                        o = s.config.listeners[a],
                        l = R(o);
                      be.call(
                        s,
                        e,
                        t,
                        function (e) {
                          return i.proxy(e, n, a);
                        },
                        r && !l
                      );
                    }),
                    e(this, "controls", function () {
                      var e = i.player,
                        t = e.elements,
                        n = J.isIE ? "change" : "input";
                      if (
                        (t.buttons.play &&
                          Array.from(t.buttons.play).forEach(function (t) {
                            i.bind(
                              t,
                              "click",
                              function () {
                                Ce(e.togglePlay());
                              },
                              "play"
                            );
                          }),
                        i.bind(
                          t.buttons.restart,
                          "click",
                          e.restart,
                          "restart"
                        ),
                        i.bind(
                          t.buttons.rewind,
                          "click",
                          function () {
                            (e.lastSeekTime = Date.now()), e.rewind();
                          },
                          "rewind"
                        ),
                        i.bind(
                          t.buttons.fastForward,
                          "click",
                          function () {
                            (e.lastSeekTime = Date.now()), e.forward();
                          },
                          "fastForward"
                        ),
                        i.bind(
                          t.buttons.mute,
                          "click",
                          function () {
                            e.muted = !e.muted;
                          },
                          "mute"
                        ),
                        i.bind(t.buttons.captions, "click", function () {
                          return e.toggleCaptions();
                        }),
                        i.bind(
                          t.buttons.download,
                          "click",
                          function () {
                            Te.call(e, e.media, "download");
                          },
                          "download"
                        ),
                        i.bind(
                          t.buttons.fullscreen,
                          "click",
                          function () {
                            e.fullscreen.toggle();
                          },
                          "fullscreen"
                        ),
                        i.bind(
                          t.buttons.pip,
                          "click",
                          function () {
                            e.pip = "toggle";
                          },
                          "pip"
                        ),
                        i.bind(
                          t.buttons.airplay,
                          "click",
                          e.airplay,
                          "airplay"
                        ),
                        i.bind(
                          t.buttons.settings,
                          "click",
                          function (t) {
                            t.stopPropagation(),
                              t.preventDefault(),
                              Ye.toggleMenu.call(e, t);
                          },
                          null,
                          !1
                        ),
                        i.bind(
                          t.buttons.settings,
                          "keyup",
                          function (t) {
                            ["Space", "Enter"].includes(t.key) &&
                              ("Enter" !== t.key
                                ? (t.preventDefault(),
                                  t.stopPropagation(),
                                  Ye.toggleMenu.call(e, t))
                                : Ye.focusFirstMenuItem.call(e, null, !0));
                          },
                          null,
                          !1
                        ),
                        i.bind(t.settings.menu, "keydown", function (t) {
                          "Escape" === t.key && Ye.toggleMenu.call(e, t);
                        }),
                        i.bind(
                          t.inputs.seek,
                          "mousedown mousemove",
                          function (e) {
                            var n = t.progress.getBoundingClientRect(),
                              i = (100 / n.width) * (e.pageX - n.left);
                            e.currentTarget.setAttribute("seek-value", i);
                          }
                        ),
                        i.bind(
                          t.inputs.seek,
                          "mousedown mouseup keydown keyup touchstart touchend",
                          function (t) {
                            var n = t.currentTarget,
                              i = "play-on-seeked";
                            if (
                              !z(t) ||
                              ["ArrowLeft", "ArrowRight"].includes(t.key)
                            ) {
                              e.lastSeekTime = Date.now();
                              var a = n.hasAttribute(i),
                                r = ["mouseup", "touchend", "keyup"].includes(
                                  t.type
                                );
                              a && r
                                ? (n.removeAttribute(i), Ce(e.play()))
                                : !r &&
                                  e.playing &&
                                  (n.setAttribute(i, ""), e.pause());
                            }
                          }
                        ),
                        J.isIos)
                      ) {
                        var a = he.call(e, 'input[type="range"]');
                        Array.from(a).forEach(function (e) {
                          return i.bind(e, n, function (e) {
                            return X(e.target);
                          });
                        });
                      }
                      i.bind(
                        t.inputs.seek,
                        n,
                        function (t) {
                          var n = t.currentTarget,
                            i = n.getAttribute("seek-value");
                          $(i) && (i = n.value),
                            n.removeAttribute("seek-value"),
                            (e.currentTime = (i / n.max) * e.duration);
                        },
                        "seek"
                      ),
                        i.bind(
                          t.progress,
                          "mouseenter mouseleave mousemove",
                          function (t) {
                            return Ye.updateSeekTooltip.call(e, t);
                          }
                        ),
                        i.bind(t.progress, "mousemove touchmove", function (t) {
                          var n = e.previewThumbnails;
                          n && n.loaded && n.startMove(t);
                        }),
                        i.bind(
                          t.progress,
                          "mouseleave touchend click",
                          function () {
                            var t = e.previewThumbnails;
                            t && t.loaded && t.endMove(!1, !0);
                          }
                        ),
                        i.bind(
                          t.progress,
                          "mousedown touchstart",
                          function (t) {
                            var n = e.previewThumbnails;
                            n && n.loaded && n.startScrubbing(t);
                          }
                        ),
                        i.bind(t.progress, "mouseup touchend", function (t) {
                          var n = e.previewThumbnails;
                          n && n.loaded && n.endScrubbing(t);
                        }),
                        J.isWebkit &&
                          Array.from(he.call(e, 'input[type="range"]')).forEach(
                            function (t) {
                              i.bind(t, "input", function (t) {
                                return Ye.updateRangeFill.call(e, t.target);
                              });
                            }
                          ),
                        e.config.toggleInvert &&
                          !U(t.display.duration) &&
                          i.bind(t.display.currentTime, "click", function () {
                            0 !== e.currentTime &&
                              ((e.config.invertTime = !e.config.invertTime),
                              Ye.timeUpdate.call(e));
                          }),
                        i.bind(
                          t.inputs.volume,
                          n,
                          function (t) {
                            e.volume = t.target.value;
                          },
                          "volume"
                        ),
                        i.bind(
                          t.controls,
                          "mouseenter mouseleave",
                          function (n) {
                            t.controls.hover =
                              !e.touch && "mouseenter" === n.type;
                          }
                        ),
                        t.fullscreen &&
                          Array.from(t.fullscreen.children)
                            .filter(function (e) {
                              return !e.contains(t.container);
                            })
                            .forEach(function (n) {
                              i.bind(n, "mouseenter mouseleave", function (n) {
                                t.controls &&
                                  (t.controls.hover =
                                    !e.touch && "mouseenter" === n.type);
                              });
                            }),
                        i.bind(
                          t.controls,
                          "mousedown mouseup touchstart touchend touchcancel",
                          function (e) {
                            t.controls.pressed = [
                              "mousedown",
                              "touchstart",
                            ].includes(e.type);
                          }
                        ),
                        i.bind(t.controls, "focusin", function () {
                          var n = e.config,
                            a = e.timers;
                          ce(t.controls, n.classNames.noTransition, !0),
                            rt.toggleControls.call(e, !0),
                            setTimeout(function () {
                              ce(t.controls, n.classNames.noTransition, !1);
                            }, 0);
                          var r = i.touch ? 3e3 : 4e3;
                          clearTimeout(a.controls),
                            (a.controls = setTimeout(function () {
                              return rt.toggleControls.call(e, !1);
                            }, r));
                        }),
                        i.bind(
                          t.inputs.volume,
                          "wheel",
                          function (t) {
                            var n = t.webkitDirectionInvertedFromDevice,
                              i = [t.deltaX, -t.deltaY].map(function (e) {
                                return n ? -e : e;
                              }),
                              a = d(i, 2),
                              r = a[0],
                              s = a[1],
                              o = Math.sign(Math.abs(r) > Math.abs(s) ? r : s);
                            e.increaseVolume(o / 50);
                            var l = e.media.volume;
                            ((1 === o && l < 1) || (-1 === o && l > 0)) &&
                              t.preventDefault();
                          },
                          "volume",
                          !1
                        );
                    }),
                    (this.player = n),
                    (this.lastKey = null),
                    (this.focusTimer = null),
                    (this.lastKeyDown = null),
                    (this.handleKey = this.handleKey.bind(this)),
                    (this.toggleMenu = this.toggleMenu.bind(this)),
                    (this.setTabFocus = this.setTabFocus.bind(this)),
                    (this.firstTouch = this.firstTouch.bind(this));
                }
                return (
                  o(t, [
                    {
                      key: "handleKey",
                      value: function (e) {
                        var t,
                          n = this.player,
                          i = n.elements,
                          a = e.key,
                          r = e.type,
                          s = e.altKey,
                          o = e.ctrlKey,
                          l = e.metaKey,
                          c = e.shiftKey,
                          u = "keydown" === r,
                          d = u && a === this.lastKey;
                        if (!(s || o || l || c) && a)
                          if (u) {
                            var h = document.activeElement;
                            if (U(h)) {
                              var p = n.config.selectors.editable;
                              if (h !== i.inputs.seek && de(h, p)) return;
                              if (
                                "Space" === e.key &&
                                de(h, 'button, [role^="menuitem"]')
                              )
                                return;
                            }
                            switch (
                              ([
                                "Space",
                                "ArrowLeft",
                                "ArrowUp",
                                "ArrowRight",
                                "ArrowDown",
                                "0",
                                "1",
                                "2",
                                "3",
                                "4",
                                "5",
                                "6",
                                "7",
                                "8",
                                "9",
                                "c",
                                "f",
                                "k",
                                "l",
                                "m",
                              ].includes(a) &&
                                (e.preventDefault(), e.stopPropagation()),
                              a)
                            ) {
                              case "0":
                              case "1":
                              case "2":
                              case "3":
                              case "4":
                              case "5":
                              case "6":
                              case "7":
                              case "8":
                              case "9":
                                d ||
                                  ((t = parseInt(a, 10)),
                                  (n.currentTime = (n.duration / 10) * t));
                                break;
                              case "Space":
                              case "k":
                                d || Ce(n.togglePlay());
                                break;
                              case "ArrowUp":
                                n.increaseVolume(0.1);
                                break;
                              case "ArrowDown":
                                n.decreaseVolume(0.1);
                                break;
                              case "m":
                                d || (n.muted = !n.muted);
                                break;
                              case "ArrowRight":
                                n.forward();
                                break;
                              case "ArrowLeft":
                                n.rewind();
                                break;
                              case "f":
                                n.fullscreen.toggle();
                                break;
                              case "c":
                                d || n.toggleCaptions();
                                break;
                              case "l":
                                n.loop = !n.loop;
                            }
                            "Escape" === a &&
                              !n.fullscreen.usingNative &&
                              n.fullscreen.active &&
                              n.fullscreen.toggle(),
                              (this.lastKey = a);
                          } else this.lastKey = null;
                      },
                    },
                    {
                      key: "toggleMenu",
                      value: function (e) {
                        Ye.toggleMenu.call(this.player, e);
                      },
                    },
                  ]),
                  t
                );
              })();
            "undefined" != typeof globalThis
              ? globalThis
              : "undefined" != typeof window
              ? window
              : void 0 !== n.g
              ? n.g
              : "undefined" != typeof self && self;
            var ot = (function (e, t) {
              return (
                (function (e, t) {
                  e.exports = (function () {
                    var e = function () {},
                      t = {},
                      n = {},
                      i = {};
                    function a(e, t) {
                      e = e.push ? e : [e];
                      var a,
                        r,
                        s,
                        o = [],
                        l = e.length,
                        c = l;
                      for (
                        a = function (e, n) {
                          n.length && o.push(e), --c || t(o);
                        };
                        l--;

                      )
                        (r = e[l]),
                          (s = n[r]) ? a(r, s) : (i[r] = i[r] || []).push(a);
                    }
                    function r(e, t) {
                      if (e) {
                        var a = i[e];
                        if (((n[e] = t), a))
                          for (; a.length; ) a[0](e, t), a.splice(0, 1);
                      }
                    }
                    function s(t, n) {
                      t.call && (t = { success: t }),
                        n.length ? (t.error || e)(n) : (t.success || e)(t);
                    }
                    function o(t, n, i, a) {
                      var r,
                        s,
                        l = document,
                        c = i.async,
                        u = (i.numRetries || 0) + 1,
                        d = i.before || e,
                        h = t.replace(/[\?|#].*$/, ""),
                        p = t.replace(/^(css|img)!/, "");
                      (a = a || 0),
                        /(^css!|\.css$)/.test(h)
                          ? (((s = l.createElement("link")).rel = "stylesheet"),
                            (s.href = p),
                            (r = "hideFocus" in s) &&
                              s.relList &&
                              ((r = 0), (s.rel = "preload"), (s.as = "style")))
                          : /(^img!|\.(png|gif|jpg|svg|webp)$)/.test(h)
                          ? ((s = l.createElement("img")).src = p)
                          : (((s = l.createElement("script")).src = t),
                            (s.async = void 0 === c || c)),
                        (s.onload =
                          s.onerror =
                          s.onbeforeload =
                            function (e) {
                              var l = e.type[0];
                              if (r)
                                try {
                                  s.sheet.cssText.length || (l = "e");
                                } catch (e) {
                                  18 != e.code && (l = "e");
                                }
                              if ("e" == l) {
                                if ((a += 1) < u) return o(t, n, i, a);
                              } else if ("preload" == s.rel && "style" == s.as)
                                return (s.rel = "stylesheet");
                              n(t, l, e.defaultPrevented);
                            }),
                        !1 !== d(t, s) && l.head.appendChild(s);
                    }
                    function l(e, t, n) {
                      var i,
                        a,
                        r = (e = e.push ? e : [e]).length,
                        s = r,
                        l = [];
                      for (
                        i = function (e, n, i) {
                          if (("e" == n && l.push(e), "b" == n)) {
                            if (!i) return;
                            l.push(e);
                          }
                          --r || t(l);
                        },
                          a = 0;
                        a < s;
                        a++
                      )
                        o(e[a], i, n);
                    }
                    function c(e, n, i) {
                      var a, o;
                      if (
                        (n && n.trim && (a = n), (o = (a ? i : n) || {}), a)
                      ) {
                        if (a in t) throw "LoadJS";
                        t[a] = !0;
                      }
                      function c(t, n) {
                        l(
                          e,
                          function (e) {
                            s(o, e),
                              t && s({ success: t, error: n }, e),
                              r(a, e);
                          },
                          o
                        );
                      }
                      if (o.returnPromise) return new Promise(c);
                      c();
                    }
                    return (
                      (c.ready = function (e, t) {
                        return (
                          a(e, function (e) {
                            s(t, e);
                          }),
                          c
                        );
                      }),
                      (c.done = function (e) {
                        r(e, []);
                      }),
                      (c.reset = function () {
                        (t = {}), (n = {}), (i = {});
                      }),
                      (c.isDefined = function (e) {
                        return e in t;
                      }),
                      c
                    );
                  })();
                })((t = { exports: {} })),
                t.exports
              );
            })();
            function lt(e) {
              return new Promise(function (t, n) {
                ot(e, { success: t, error: n });
              });
            }
            function ct(e) {
              e && !this.embed.hasPlayed && (this.embed.hasPlayed = !0),
                this.media.paused === e &&
                  ((this.media.paused = !e),
                  Te.call(this, this.media, e ? "play" : "pause"));
            }
            var ut = {
              setup() {
                var e = this;
                ce(e.elements.wrapper, e.config.classNames.embed, !0),
                  (e.options.speed = e.config.speed.options),
                  Ie.call(e),
                  q(window.Vimeo)
                    ? ut.ready.call(e)
                    : lt(e.config.urls.vimeo.sdk)
                        .then(function () {
                          ut.ready.call(e);
                        })
                        .catch(function (t) {
                          e.debug.warn(
                            "Vimeo SDK (player.js) failed to load",
                            t
                          );
                        });
              },
              ready() {
                var e = this,
                  t = this,
                  n = t.config.vimeo,
                  a = n.premium,
                  r = n.referrerPolicy,
                  s = (function (e, t) {
                    if (null == e) return {};
                    var n,
                      i,
                      a = (function (e, t) {
                        if (null == e) return {};
                        var n,
                          i,
                          a = {},
                          r = Object.keys(e);
                        for (i = 0; i < r.length; i++)
                          (n = r[i]), t.indexOf(n) >= 0 || (a[n] = e[n]);
                        return a;
                      })(e, t);
                    if (Object.getOwnPropertySymbols) {
                      var r = Object.getOwnPropertySymbols(e);
                      for (i = 0; i < r.length; i++)
                        (n = r[i]),
                          t.indexOf(n) >= 0 ||
                            (Object.prototype.propertyIsEnumerable.call(e, n) &&
                              (a[n] = e[n]));
                    }
                    return a;
                  })(n, i),
                  o = t.media.getAttribute("src"),
                  l = "";
                $(o)
                  ? ((o = t.media.getAttribute(t.config.attributes.embed.id)),
                    (l = t.media.getAttribute(t.config.attributes.embed.hash)))
                  : (l = (function (e) {
                      var t = e.match(
                        /^.*(vimeo.com\/|video\/)(\d+)(\?.*&*h=|\/)+([\d,a-f]+)/
                      );
                      return t && 5 === t.length ? t[4] : null;
                    })(o));
                var u = l ? { h: l } : {};
                a && Object.assign(s, { controls: !1, sidedock: !1 });
                var h,
                  p = Qe(
                    c(
                      c(
                        {
                          loop: t.config.loop.active,
                          autoplay: t.autoplay,
                          muted: t.muted,
                          gesture: "media",
                          playsinline: !this.config.fullscreen.iosNative,
                        },
                        u
                      ),
                      s
                    )
                  ),
                  m = $((h = o))
                    ? null
                    : D(Number(h))
                    ? h
                    : h.match(/^.*(vimeo.com\/|video\/)(\d+).*/)
                    ? RegExp.$2
                    : h,
                  f = ne("iframe"),
                  g = qe(t.config.urls.vimeo.iframe, m, p);
                if (
                  (f.setAttribute("src", g),
                  f.setAttribute("allowfullscreen", ""),
                  f.setAttribute(
                    "allow",
                    [
                      "autoplay",
                      "fullscreen",
                      "picture-in-picture",
                      "encrypted-media",
                      "accelerometer",
                      "gyroscope",
                    ].join("; ")
                  ),
                  $(r) || f.setAttribute("referrerPolicy", r),
                  a || !n.customControls)
                )
                  f.setAttribute("data-poster", t.poster),
                    (t.media = se(f, t.media));
                else {
                  var y = ne("div", {
                    class: t.config.classNames.embedContainer,
                    "data-poster": t.poster,
                  });
                  y.appendChild(f), (t.media = se(y, t.media));
                }
                n.customControls ||
                  Ue(qe(t.config.urls.vimeo.api, g)).then(function (e) {
                    !$(e) &&
                      e.thumbnail_url &&
                      rt.setPoster
                        .call(t, e.thumbnail_url)
                        .catch(function () {});
                  }),
                  (t.embed = new window.Vimeo.Player(f, {
                    autopause: t.config.autopause,
                    muted: t.muted,
                  })),
                  (t.media.paused = !0),
                  (t.media.currentTime = 0),
                  t.supported.ui && t.embed.disableTextTrack(),
                  (t.media.play = function () {
                    return ct.call(t, !0), t.embed.play();
                  }),
                  (t.media.pause = function () {
                    return ct.call(t, !1), t.embed.pause();
                  }),
                  (t.media.stop = function () {
                    t.pause(), (t.currentTime = 0);
                  });
                var v = t.media.currentTime;
                Object.defineProperty(t.media, "currentTime", {
                  get: function () {
                    return v;
                  },
                  set(e) {
                    var n = t.embed,
                      i = t.media,
                      a = t.paused,
                      r = t.volume,
                      s = a && !n.hasPlayed;
                    (i.seeking = !0),
                      Te.call(t, i, "seeking"),
                      Promise.resolve(s && n.setVolume(0))
                        .then(function () {
                          return n.setCurrentTime(e);
                        })
                        .then(function () {
                          return s && n.pause();
                        })
                        .then(function () {
                          return s && n.setVolume(r);
                        })
                        .catch(function () {});
                  },
                });
                var b = t.config.speed.selected;
                Object.defineProperty(t.media, "playbackRate", {
                  get: function () {
                    return b;
                  },
                  set(e) {
                    t.embed
                      .setPlaybackRate(e)
                      .then(function () {
                        (b = e), Te.call(t, t.media, "ratechange");
                      })
                      .catch(function () {
                        t.options.speed = [1];
                      });
                  },
                });
                var w = t.config.volume;
                Object.defineProperty(t.media, "volume", {
                  get: function () {
                    return w;
                  },
                  set(e) {
                    t.embed.setVolume(e).then(function () {
                      (w = e), Te.call(t, t.media, "volumechange");
                    });
                  },
                });
                var k = t.config.muted;
                Object.defineProperty(t.media, "muted", {
                  get: function () {
                    return k;
                  },
                  set(e) {
                    var n = !!F(e) && e;
                    t.embed
                      .setVolume(n ? 0 : t.config.volume)
                      .then(function () {
                        (k = n), Te.call(t, t.media, "volumechange");
                      });
                  },
                });
                var T,
                  S = t.config.loop;
                Object.defineProperty(t.media, "loop", {
                  get: function () {
                    return S;
                  },
                  set(e) {
                    var n = F(e) ? e : t.config.loop.active;
                    t.embed.setLoop(n).then(function () {
                      S = n;
                    });
                  },
                }),
                  t.embed
                    .getVideoUrl()
                    .then(function (e) {
                      (T = e), Ye.setDownloadUrl.call(t);
                    })
                    .catch(function (t) {
                      e.debug.warn(t);
                    }),
                  Object.defineProperty(t.media, "currentSrc", {
                    get: function () {
                      return T;
                    },
                  }),
                  Object.defineProperty(t.media, "ended", {
                    get: function () {
                      return t.currentTime === t.duration;
                    },
                  }),
                  Promise.all([
                    t.embed.getVideoWidth(),
                    t.embed.getVideoHeight(),
                  ]).then(function (n) {
                    var i = d(n, 2),
                      a = i[0],
                      r = i[1];
                    (t.embed.ratio = _e(a, r)), Ie.call(e);
                  }),
                  t.embed.setAutopause(t.config.autopause).then(function (e) {
                    t.config.autopause = e;
                  }),
                  t.embed.getVideoTitle().then(function (n) {
                    (t.config.title = n), rt.setTitle.call(e);
                  }),
                  t.embed.getCurrentTime().then(function (e) {
                    (v = e), Te.call(t, t.media, "timeupdate");
                  }),
                  t.embed.getDuration().then(function (e) {
                    (t.media.duration = e),
                      Te.call(t, t.media, "durationchange");
                  }),
                  t.embed.getTextTracks().then(function (e) {
                    (t.media.textTracks = e), Xe.setup.call(t);
                  }),
                  t.embed.on("cuechange", function (e) {
                    var n = e.cues,
                      i = (void 0 === n ? [] : n).map(function (e) {
                        return (function (e) {
                          var t = document.createDocumentFragment(),
                            n = document.createElement("div");
                          return (
                            t.appendChild(n),
                            (n.innerHTML = e),
                            t.firstChild.innerText
                          );
                        })(e.text);
                      });
                    Xe.updateCues.call(t, i);
                  }),
                  t.embed.on("loaded", function () {
                    t.embed.getPaused().then(function (e) {
                      ct.call(t, !e), e || Te.call(t, t.media, "playing");
                    }),
                      U(t.embed.element) &&
                        t.supported.ui &&
                        t.embed.element.setAttribute("tabindex", -1);
                  }),
                  t.embed.on("bufferstart", function () {
                    Te.call(t, t.media, "waiting");
                  }),
                  t.embed.on("bufferend", function () {
                    Te.call(t, t.media, "playing");
                  }),
                  t.embed.on("play", function () {
                    ct.call(t, !0), Te.call(t, t.media, "playing");
                  }),
                  t.embed.on("pause", function () {
                    ct.call(t, !1);
                  }),
                  t.embed.on("timeupdate", function (e) {
                    (t.media.seeking = !1),
                      (v = e.seconds),
                      Te.call(t, t.media, "timeupdate");
                  }),
                  t.embed.on("progress", function (e) {
                    (t.media.buffered = e.percent),
                      Te.call(t, t.media, "progress"),
                      1 === parseInt(e.percent, 10) &&
                        Te.call(t, t.media, "canplaythrough"),
                      t.embed.getDuration().then(function (e) {
                        e !== t.media.duration &&
                          ((t.media.duration = e),
                          Te.call(t, t.media, "durationchange"));
                      });
                  }),
                  t.embed.on("seeked", function () {
                    (t.media.seeking = !1), Te.call(t, t.media, "seeked");
                  }),
                  t.embed.on("ended", function () {
                    (t.media.paused = !0), Te.call(t, t.media, "ended");
                  }),
                  t.embed.on("error", function (e) {
                    (t.media.error = e), Te.call(t, t.media, "error");
                  }),
                  n.customControls &&
                    setTimeout(function () {
                      return rt.build.call(t);
                    }, 0);
              },
            };
            function dt(e) {
              e && !this.embed.hasPlayed && (this.embed.hasPlayed = !0),
                this.media.paused === e &&
                  ((this.media.paused = !e),
                  Te.call(this, this.media, e ? "play" : "pause"));
            }
            function ht(e) {
              return e.noCookie
                ? "https://www.youtube-nocookie.com"
                : "http:" === window.location.protocol
                ? "http://www.youtube.com"
                : void 0;
            }
            var pt = {
                setup() {
                  var e = this;
                  if (
                    (ce(
                      this.elements.wrapper,
                      this.config.classNames.embed,
                      !0
                    ),
                    q(window.YT) && R(window.YT.Player))
                  )
                    pt.ready.call(this);
                  else {
                    var t = window.onYouTubeIframeAPIReady;
                    (window.onYouTubeIframeAPIReady = function () {
                      R(t) && t(), pt.ready.call(e);
                    }),
                      lt(this.config.urls.youtube.sdk).catch(function (t) {
                        e.debug.warn("YouTube API failed to load", t);
                      });
                  }
                },
                getTitle(e) {
                  var t = this;
                  Ue(qe(this.config.urls.youtube.api, e))
                    .then(function (e) {
                      if (q(e)) {
                        var n = e.title,
                          i = e.height,
                          a = e.width;
                        (t.config.title = n),
                          rt.setTitle.call(t),
                          (t.embed.ratio = _e(a, i));
                      }
                      Ie.call(t);
                    })
                    .catch(function () {
                      Ie.call(t);
                    });
                },
                ready() {
                  var e = this,
                    t = e.config.youtube,
                    n = e.media && e.media.getAttribute("id");
                  if ($(n) || !n.startsWith("youtube-")) {
                    var i = e.media.getAttribute("src");
                    $(i) &&
                      (i = e.media.getAttribute(
                        this.config.attributes.embed.id
                      ));
                    var a,
                      r = $((a = i))
                        ? null
                        : a.match(
                            /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/
                          )
                        ? RegExp.$2
                        : a,
                      s = ne("div", {
                        id: ""
                          .concat(e.provider, "-")
                          .concat(Math.floor(1e4 * Math.random())),
                        "data-poster": t.customControls ? e.poster : void 0,
                      });
                    if (((e.media = se(s, e.media)), t.customControls)) {
                      var o = function (e) {
                        return "https://i.ytimg.com/vi/"
                          .concat(r, "/")
                          .concat(e, "default.jpg");
                      };
                      at(o("maxres"), 121)
                        .catch(function () {
                          return at(o("sd"), 121);
                        })
                        .catch(function () {
                          return at(o("hq"));
                        })
                        .then(function (t) {
                          return rt.setPoster.call(e, t.src);
                        })
                        .then(function (t) {
                          t.includes("maxres") ||
                            (e.elements.poster.style.backgroundSize = "cover");
                        })
                        .catch(function () {});
                    }
                    e.embed = new window.YT.Player(e.media, {
                      videoId: r,
                      host: ht(t),
                      playerVars: Z(
                        {},
                        {
                          autoplay: e.config.autoplay ? 1 : 0,
                          hl: e.config.hl,
                          controls: e.supported.ui && t.customControls ? 0 : 1,
                          disablekb: 1,
                          playsinline: e.config.fullscreen.iosNative ? 0 : 1,
                          cc_load_policy: e.captions.active ? 1 : 0,
                          cc_lang_pref: e.config.captions.language,
                          widget_referrer: window ? window.location.href : null,
                        },
                        t
                      ),
                      events: {
                        onError(t) {
                          if (!e.media.error) {
                            var n = t.data,
                              i =
                                {
                                  2: "The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",
                                  5: "The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",
                                  100: "The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",
                                  101: "The owner of the requested video does not allow it to be played in embedded players.",
                                  150: "The owner of the requested video does not allow it to be played in embedded players.",
                                }[n] || "An unknown error occured";
                            (e.media.error = { code: n, message: i }),
                              Te.call(e, e.media, "error");
                          }
                        },
                        onPlaybackRateChange(t) {
                          var n = t.target;
                          (e.media.playbackRate = n.getPlaybackRate()),
                            Te.call(e, e.media, "ratechange");
                        },
                        onReady(n) {
                          if (!R(e.media.play)) {
                            var i = n.target;
                            pt.getTitle.call(e, r),
                              (e.media.play = function () {
                                dt.call(e, !0), i.playVideo();
                              }),
                              (e.media.pause = function () {
                                dt.call(e, !1), i.pauseVideo();
                              }),
                              (e.media.stop = function () {
                                i.stopVideo();
                              }),
                              (e.media.duration = i.getDuration()),
                              (e.media.paused = !0),
                              (e.media.currentTime = 0),
                              Object.defineProperty(e.media, "currentTime", {
                                get: function () {
                                  return Number(i.getCurrentTime());
                                },
                                set(t) {
                                  e.paused &&
                                    !e.embed.hasPlayed &&
                                    e.embed.mute(),
                                    (e.media.seeking = !0),
                                    Te.call(e, e.media, "seeking"),
                                    i.seekTo(t);
                                },
                              }),
                              Object.defineProperty(e.media, "playbackRate", {
                                get: function () {
                                  return i.getPlaybackRate();
                                },
                                set(e) {
                                  i.setPlaybackRate(e);
                                },
                              });
                            var a = e.config.volume;
                            Object.defineProperty(e.media, "volume", {
                              get: function () {
                                return a;
                              },
                              set(t) {
                                (a = t),
                                  i.setVolume(100 * a),
                                  Te.call(e, e.media, "volumechange");
                              },
                            });
                            var s = e.config.muted;
                            Object.defineProperty(e.media, "muted", {
                              get: function () {
                                return s;
                              },
                              set(t) {
                                var n = F(t) ? t : s;
                                (s = n),
                                  i[n ? "mute" : "unMute"](),
                                  i.setVolume(100 * a),
                                  Te.call(e, e.media, "volumechange");
                              },
                            }),
                              Object.defineProperty(e.media, "currentSrc", {
                                get: function () {
                                  return i.getVideoUrl();
                                },
                              }),
                              Object.defineProperty(e.media, "ended", {
                                get: function () {
                                  return e.currentTime === e.duration;
                                },
                              });
                            var o = i.getAvailablePlaybackRates();
                            (e.options.speed = o.filter(function (t) {
                              return e.config.speed.options.includes(t);
                            })),
                              e.supported.ui &&
                                t.customControls &&
                                e.media.setAttribute("tabindex", -1),
                              Te.call(e, e.media, "timeupdate"),
                              Te.call(e, e.media, "durationchange"),
                              clearInterval(e.timers.buffering),
                              (e.timers.buffering = setInterval(function () {
                                (e.media.buffered = i.getVideoLoadedFraction()),
                                  (null === e.media.lastBuffered ||
                                    e.media.lastBuffered < e.media.buffered) &&
                                    Te.call(e, e.media, "progress"),
                                  (e.media.lastBuffered = e.media.buffered),
                                  1 === e.media.buffered &&
                                    (clearInterval(e.timers.buffering),
                                    Te.call(e, e.media, "canplaythrough"));
                              }, 200)),
                              t.customControls &&
                                setTimeout(function () {
                                  return rt.build.call(e);
                                }, 50);
                          }
                        },
                        onStateChange(n) {
                          var i = n.target;
                          switch (
                            (clearInterval(e.timers.playing),
                            e.media.seeking &&
                              [1, 2].includes(n.data) &&
                              ((e.media.seeking = !1),
                              Te.call(e, e.media, "seeked")),
                            n.data)
                          ) {
                            case -1:
                              Te.call(e, e.media, "timeupdate"),
                                (e.media.buffered = i.getVideoLoadedFraction()),
                                Te.call(e, e.media, "progress");
                              break;
                            case 0:
                              dt.call(e, !1),
                                e.media.loop
                                  ? (i.stopVideo(), i.playVideo())
                                  : Te.call(e, e.media, "ended");
                              break;
                            case 1:
                              t.customControls &&
                              !e.config.autoplay &&
                              e.media.paused &&
                              !e.embed.hasPlayed
                                ? e.media.pause()
                                : (dt.call(e, !0),
                                  Te.call(e, e.media, "playing"),
                                  (e.timers.playing = setInterval(function () {
                                    Te.call(e, e.media, "timeupdate");
                                  }, 50)),
                                  e.media.duration !== i.getDuration() &&
                                    ((e.media.duration = i.getDuration()),
                                    Te.call(e, e.media, "durationchange")));
                              break;
                            case 2:
                              e.muted || e.embed.unMute(), dt.call(e, !1);
                              break;
                            case 3:
                              Te.call(e, e.media, "waiting");
                          }
                          Te.call(e, e.elements.container, "statechange", !1, {
                            code: n.data,
                          });
                        },
                      },
                    });
                  }
                },
              },
              mt = {
                setup() {
                  this.media
                    ? (ce(
                        this.elements.container,
                        this.config.classNames.type.replace("{0}", this.type),
                        !0
                      ),
                      ce(
                        this.elements.container,
                        this.config.classNames.provider.replace(
                          "{0}",
                          this.provider
                        ),
                        !0
                      ),
                      this.isEmbed &&
                        ce(
                          this.elements.container,
                          this.config.classNames.type.replace("{0}", "video"),
                          !0
                        ),
                      this.isVideo &&
                        ((this.elements.wrapper = ne("div", {
                          class: this.config.classNames.video,
                        })),
                        ee(this.media, this.elements.wrapper),
                        (this.elements.poster = ne("div", {
                          class: this.config.classNames.poster,
                        })),
                        this.elements.wrapper.appendChild(
                          this.elements.poster
                        )),
                      this.isHTML5
                        ? Oe.setup.call(this)
                        : this.isYouTube
                        ? pt.setup.call(this)
                        : this.isVimeo && ut.setup.call(this))
                    : this.debug.warn("No media element found!");
                },
              },
              ft = (function () {
                function t(n) {
                  var i = this;
                  r(this, t),
                    e(this, "load", function () {
                      i.enabled &&
                        (q(window.google) && q(window.google.ima)
                          ? i.ready()
                          : lt(i.player.config.urls.googleIMA.sdk)
                              .then(function () {
                                i.ready();
                              })
                              .catch(function () {
                                i.trigger(
                                  "error",
                                  new Error("Google IMA SDK failed to load")
                                );
                              }));
                    }),
                    e(this, "ready", function () {
                      var e;
                      i.enabled ||
                        ((e = i).manager && e.manager.destroy(),
                        e.elements.displayContainer &&
                          e.elements.displayContainer.destroy(),
                        e.elements.container.remove()),
                        i.startSafetyTimer(12e3, "ready()"),
                        i.managerPromise.then(function () {
                          i.clearSafetyTimer("onAdsManagerLoaded()");
                        }),
                        i.listeners(),
                        i.setupIMA();
                    }),
                    e(this, "setupIMA", function () {
                      (i.elements.container = ne("div", {
                        class: i.player.config.classNames.ads,
                      })),
                        i.player.elements.container.appendChild(
                          i.elements.container
                        ),
                        google.ima.settings.setVpaidMode(
                          google.ima.ImaSdkSettings.VpaidMode.ENABLED
                        ),
                        google.ima.settings.setLocale(
                          i.player.config.ads.language
                        ),
                        google.ima.settings.setDisableCustomPlaybackForIOS10Plus(
                          i.player.config.playsinline
                        ),
                        (i.elements.displayContainer =
                          new google.ima.AdDisplayContainer(
                            i.elements.container,
                            i.player.media
                          )),
                        (i.loader = new google.ima.AdsLoader(
                          i.elements.displayContainer
                        )),
                        i.loader.addEventListener(
                          google.ima.AdsManagerLoadedEvent.Type
                            .ADS_MANAGER_LOADED,
                          function (e) {
                            return i.onAdsManagerLoaded(e);
                          },
                          !1
                        ),
                        i.loader.addEventListener(
                          google.ima.AdErrorEvent.Type.AD_ERROR,
                          function (e) {
                            return i.onAdError(e);
                          },
                          !1
                        ),
                        i.requestAds();
                    }),
                    e(this, "requestAds", function () {
                      var e = i.player.elements.container;
                      try {
                        var t = new google.ima.AdsRequest();
                        (t.adTagUrl = i.tagUrl),
                          (t.linearAdSlotWidth = e.offsetWidth),
                          (t.linearAdSlotHeight = e.offsetHeight),
                          (t.nonLinearAdSlotWidth = e.offsetWidth),
                          (t.nonLinearAdSlotHeight = e.offsetHeight),
                          (t.forceNonLinearFullSlot = !1),
                          t.setAdWillPlayMuted(!i.player.muted),
                          i.loader.requestAds(t);
                      } catch (e) {
                        i.onAdError(e);
                      }
                    }),
                    e(this, "pollCountdown", function () {
                      if (
                        !(
                          arguments.length > 0 &&
                          void 0 !== arguments[0] &&
                          arguments[0]
                        )
                      )
                        return (
                          clearInterval(i.countdownTimer),
                          void i.elements.container.removeAttribute(
                            "data-badge-text"
                          )
                        );
                      i.countdownTimer = setInterval(function () {
                        var e = Ke(Math.max(i.manager.getRemainingTime(), 0)),
                          t = ""
                            .concat(
                              Ve.get("advertisement", i.player.config),
                              " - "
                            )
                            .concat(e);
                        i.elements.container.setAttribute("data-badge-text", t);
                      }, 100);
                    }),
                    e(this, "onAdsManagerLoaded", function (e) {
                      if (i.enabled) {
                        var t = new google.ima.AdsRenderingSettings();
                        (t.restoreCustomPlaybackStateOnAdBreakComplete = !0),
                          (t.enablePreloading = !0),
                          (i.manager = e.getAdsManager(i.player, t)),
                          (i.cuePoints = i.manager.getCuePoints()),
                          i.manager.addEventListener(
                            google.ima.AdErrorEvent.Type.AD_ERROR,
                            function (e) {
                              return i.onAdError(e);
                            }
                          ),
                          Object.keys(google.ima.AdEvent.Type).forEach(
                            function (e) {
                              i.manager.addEventListener(
                                google.ima.AdEvent.Type[e],
                                function (e) {
                                  return i.onAdEvent(e);
                                }
                              );
                            }
                          ),
                          i.trigger("loaded");
                      }
                    }),
                    e(this, "addCuePoints", function () {
                      $(i.cuePoints) ||
                        i.cuePoints.forEach(function (e) {
                          if (0 !== e && -1 !== e && e < i.player.duration) {
                            var t = i.player.elements.progress;
                            if (U(t)) {
                              var n = (100 / i.player.duration) * e,
                                a = ne("span", {
                                  class: i.player.config.classNames.cues,
                                });
                              (a.style.left = "".concat(n.toString(), "%")),
                                t.appendChild(a);
                            }
                          }
                        });
                    }),
                    e(this, "onAdEvent", function (e) {
                      var t = i.player.elements.container,
                        n = e.getAd(),
                        a = e.getAdData();
                      switch (
                        ((function (e) {
                          Te.call(
                            i.player,
                            i.player.media,
                            "ads".concat(e.replace(/_/g, "").toLowerCase())
                          );
                        })(e.type),
                        e.type)
                      ) {
                        case google.ima.AdEvent.Type.LOADED:
                          i.trigger("loaded"),
                            i.pollCountdown(!0),
                            n.isLinear() ||
                              ((n.width = t.offsetWidth),
                              (n.height = t.offsetHeight));
                          break;
                        case google.ima.AdEvent.Type.STARTED:
                          i.manager.setVolume(i.player.volume);
                          break;
                        case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:
                          i.player.ended
                            ? i.loadAds()
                            : i.loader.contentComplete();
                          break;
                        case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:
                          i.pauseContent();
                          break;
                        case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:
                          i.pollCountdown(), i.resumeContent();
                          break;
                        case google.ima.AdEvent.Type.LOG:
                          a.adError &&
                            i.player.debug.warn(
                              "Non-fatal ad error: ".concat(
                                a.adError.getMessage()
                              )
                            );
                      }
                    }),
                    e(this, "onAdError", function (e) {
                      i.cancel(), i.player.debug.warn("Ads error", e);
                    }),
                    e(this, "listeners", function () {
                      var e,
                        t = i.player.elements.container;
                      i.player.on("canplay", function () {
                        i.addCuePoints();
                      }),
                        i.player.on("ended", function () {
                          i.loader.contentComplete();
                        }),
                        i.player.on("timeupdate", function () {
                          e = i.player.currentTime;
                        }),
                        i.player.on("seeked", function () {
                          var t = i.player.currentTime;
                          $(i.cuePoints) ||
                            i.cuePoints.forEach(function (n, a) {
                              e < n &&
                                n < t &&
                                (i.manager.discardAdBreak(),
                                i.cuePoints.splice(a, 1));
                            });
                        }),
                        window.addEventListener("resize", function () {
                          i.manager &&
                            i.manager.resize(
                              t.offsetWidth,
                              t.offsetHeight,
                              google.ima.ViewMode.NORMAL
                            );
                        });
                    }),
                    e(this, "play", function () {
                      var e = i.player.elements.container;
                      i.managerPromise || i.resumeContent(),
                        i.managerPromise
                          .then(function () {
                            i.manager.setVolume(i.player.volume),
                              i.elements.displayContainer.initialize();
                            try {
                              i.initialized ||
                                (i.manager.init(
                                  e.offsetWidth,
                                  e.offsetHeight,
                                  google.ima.ViewMode.NORMAL
                                ),
                                i.manager.start()),
                                (i.initialized = !0);
                            } catch (e) {
                              i.onAdError(e);
                            }
                          })
                          .catch(function () {});
                    }),
                    e(this, "resumeContent", function () {
                      (i.elements.container.style.zIndex = ""),
                        (i.playing = !1),
                        Ce(i.player.media.play());
                    }),
                    e(this, "pauseContent", function () {
                      (i.elements.container.style.zIndex = 3),
                        (i.playing = !0),
                        i.player.media.pause();
                    }),
                    e(this, "cancel", function () {
                      i.initialized && i.resumeContent(),
                        i.trigger("error"),
                        i.loadAds();
                    }),
                    e(this, "loadAds", function () {
                      i.managerPromise
                        .then(function () {
                          i.manager && i.manager.destroy(),
                            (i.managerPromise = new Promise(function (e) {
                              i.on("loaded", e), i.player.debug.log(i.manager);
                            })),
                            (i.initialized = !1),
                            i.requestAds();
                        })
                        .catch(function () {});
                    }),
                    e(this, "trigger", function (e) {
                      for (
                        var t = arguments.length,
                          n = new Array(t > 1 ? t - 1 : 0),
                          a = 1;
                        a < t;
                        a++
                      )
                        n[a - 1] = arguments[a];
                      var r = i.events[e];
                      V(r) &&
                        r.forEach(function (e) {
                          R(e) && e.apply(i, n);
                        });
                    }),
                    e(this, "on", function (e, t) {
                      return (
                        V(i.events[e]) || (i.events[e] = []),
                        i.events[e].push(t),
                        i
                      );
                    }),
                    e(this, "startSafetyTimer", function (e, t) {
                      i.player.debug.log(
                        "Safety timer invoked from: ".concat(t)
                      ),
                        (i.safetyTimer = setTimeout(function () {
                          i.cancel(), i.clearSafetyTimer("startSafetyTimer()");
                        }, e));
                    }),
                    e(this, "clearSafetyTimer", function (e) {
                      O(i.safetyTimer) ||
                        (i.player.debug.log(
                          "Safety timer cleared from: ".concat(e)
                        ),
                        clearTimeout(i.safetyTimer),
                        (i.safetyTimer = null));
                    }),
                    (this.player = n),
                    (this.config = n.config.ads),
                    (this.playing = !1),
                    (this.initialized = !1),
                    (this.elements = {
                      container: null,
                      displayContainer: null,
                    }),
                    (this.manager = null),
                    (this.loader = null),
                    (this.cuePoints = null),
                    (this.events = {}),
                    (this.safetyTimer = null),
                    (this.countdownTimer = null),
                    (this.managerPromise = new Promise(function (e, t) {
                      i.on("loaded", e), i.on("error", t);
                    })),
                    this.load();
                }
                return (
                  o(t, [
                    {
                      key: "enabled",
                      get: function () {
                        var e = this.config;
                        return (
                          this.player.isHTML5 &&
                          this.player.isVideo &&
                          e.enabled &&
                          (!$(e.publisherId) || Y(e.tagUrl))
                        );
                      },
                    },
                    {
                      key: "tagUrl",
                      get: function () {
                        var e = this.config;
                        return Y(e.tagUrl)
                          ? e.tagUrl
                          : "https://go.aniview.com/api/adserver6/vast/?".concat(
                              Qe({
                                AV_PUBLISHERID: "58c25bb0073ef448b1087ad6",
                                AV_CHANNELID: "5a0458dc28a06145e4519d21",
                                AV_URL: window.location.hostname,
                                cb: Date.now(),
                                AV_WIDTH: 640,
                                AV_HEIGHT: 480,
                                AV_CDIM2: e.publisherId,
                              })
                            );
                      },
                    },
                  ]),
                  t
                );
              })();
            function gt() {
              var e =
                  arguments.length > 0 && void 0 !== arguments[0]
                    ? arguments[0]
                    : 0,
                t =
                  arguments.length > 1 && void 0 !== arguments[1]
                    ? arguments[1]
                    : 0,
                n =
                  arguments.length > 2 && void 0 !== arguments[2]
                    ? arguments[2]
                    : 255;
              return Math.min(Math.max(e, t), n);
            }
            var yt,
              vt = function (e) {
                var t = [];
                return (
                  e.split(/\r\n\r\n|\n\n|\r\r/).forEach(function (e) {
                    var n = {};
                    e.split(/\r\n|\n|\r/).forEach(function (e) {
                      if (D(n.startTime)) {
                        if (!$(e.trim()) && $(n.text)) {
                          var t,
                            i,
                            a = e.trim().split("#xywh=");
                          (t = d(a, 1)),
                            (n.text = t[0]),
                            a[1] &&
                              ((i = d(a[1].split(","), 4)),
                              (n.x = i[0]),
                              (n.y = i[1]),
                              (n.w = i[2]),
                              (n.h = i[3]));
                        }
                      } else {
                        var r = e.match(
                          /([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/
                        );
                        r &&
                          ((n.startTime =
                            60 * Number(r[1] || 0) * 60 +
                            60 * Number(r[2]) +
                            Number(r[3]) +
                            Number("0.".concat(r[4]))),
                          (n.endTime =
                            60 * Number(r[6] || 0) * 60 +
                            60 * Number(r[7]) +
                            Number(r[8]) +
                            Number("0.".concat(r[9]))));
                      }
                    }),
                      n.text && t.push(n);
                  }),
                  t
                );
              },
              bt = function (e, t) {
                var n = {};
                return (
                  e > t.width / t.height
                    ? ((n.width = t.width), (n.height = (1 / e) * t.width))
                    : ((n.height = t.height), (n.width = e * t.height)),
                  n
                );
              },
              wt = (function () {
                function t(n) {
                  var i = this;
                  r(this, t),
                    e(this, "load", function () {
                      i.player.elements.display.seekTooltip &&
                        (i.player.elements.display.seekTooltip.hidden =
                          i.enabled),
                        i.enabled &&
                          i.getThumbnails().then(function () {
                            i.enabled &&
                              (i.render(),
                              i.determineContainerAutoSizing(),
                              (i.loaded = !0));
                          });
                    }),
                    e(this, "getThumbnails", function () {
                      return new Promise(function (e) {
                        var t = i.player.config.previewThumbnails.src;
                        if ($(t))
                          throw new Error(
                            "Missing previewThumbnails.src config attribute"
                          );
                        var n = function () {
                          i.thumbnails.sort(function (e, t) {
                            return e.height - t.height;
                          }),
                            i.player.debug.log(
                              "Preview thumbnails",
                              i.thumbnails
                            ),
                            e();
                        };
                        if (R(t))
                          t(function (e) {
                            (i.thumbnails = e), n();
                          });
                        else {
                          var a = (H(t) ? [t] : t).map(function (e) {
                            return i.getThumbnail(e);
                          });
                          Promise.all(a).then(n);
                        }
                      });
                    }),
                    e(this, "getThumbnail", function (e) {
                      return new Promise(function (t) {
                        Ue(e).then(function (n) {
                          var a = {
                            frames: vt(n),
                            height: null,
                            urlPrefix: "",
                          };
                          a.frames[0].text.startsWith("/") ||
                            a.frames[0].text.startsWith("http://") ||
                            a.frames[0].text.startsWith("https://") ||
                            (a.urlPrefix = e.substring(
                              0,
                              e.lastIndexOf("/") + 1
                            ));
                          var r = new Image();
                          (r.onload = function () {
                            (a.height = r.naturalHeight),
                              (a.width = r.naturalWidth),
                              i.thumbnails.push(a),
                              t();
                          }),
                            (r.src = a.urlPrefix + a.frames[0].text);
                        });
                      });
                    }),
                    e(this, "startMove", function (e) {
                      if (
                        i.loaded &&
                        W(e) &&
                        ["touchmove", "mousemove"].includes(e.type) &&
                        i.player.media.duration
                      ) {
                        if ("touchmove" === e.type)
                          i.seekTime =
                            i.player.media.duration *
                            (i.player.elements.inputs.seek.value / 100);
                        else {
                          var t,
                            n,
                            a =
                              i.player.elements.progress.getBoundingClientRect(),
                            r = (100 / a.width) * (e.pageX - a.left);
                          (i.seekTime = i.player.media.duration * (r / 100)),
                            i.seekTime < 0 && (i.seekTime = 0),
                            i.seekTime > i.player.media.duration - 1 &&
                              (i.seekTime = i.player.media.duration - 1),
                            (i.mousePosX = e.pageX),
                            (i.elements.thumb.time.innerText = Ke(i.seekTime));
                          var s =
                            null === (t = i.player.config.markers) ||
                            void 0 === t ||
                            null === (n = t.points) ||
                            void 0 === n
                              ? void 0
                              : n.find(function (e) {
                                  return e.time === Math.round(i.seekTime);
                                });
                          s &&
                            i.elements.thumb.time.insertAdjacentHTML(
                              "afterbegin",
                              "".concat(s.label, "<br>")
                            );
                        }
                        i.showImageAtCurrentTime();
                      }
                    }),
                    e(this, "endMove", function () {
                      i.toggleThumbContainer(!1, !0);
                    }),
                    e(this, "startScrubbing", function (e) {
                      (O(e.button) || !1 === e.button || 0 === e.button) &&
                        ((i.mouseDown = !0),
                        i.player.media.duration &&
                          (i.toggleScrubbingContainer(!0),
                          i.toggleThumbContainer(!1, !0),
                          i.showImageAtCurrentTime()));
                    }),
                    e(this, "endScrubbing", function () {
                      (i.mouseDown = !1),
                        Math.ceil(i.lastTime) ===
                        Math.ceil(i.player.media.currentTime)
                          ? i.toggleScrubbingContainer(!1)
                          : ke.call(
                              i.player,
                              i.player.media,
                              "timeupdate",
                              function () {
                                i.mouseDown || i.toggleScrubbingContainer(!1);
                              }
                            );
                    }),
                    e(this, "listeners", function () {
                      i.player.on("play", function () {
                        i.toggleThumbContainer(!1, !0);
                      }),
                        i.player.on("seeked", function () {
                          i.toggleThumbContainer(!1);
                        }),
                        i.player.on("timeupdate", function () {
                          i.lastTime = i.player.media.currentTime;
                        });
                    }),
                    e(this, "render", function () {
                      (i.elements.thumb.container = ne("div", {
                        class:
                          i.player.config.classNames.previewThumbnails
                            .thumbContainer,
                      })),
                        (i.elements.thumb.imageContainer = ne("div", {
                          class:
                            i.player.config.classNames.previewThumbnails
                              .imageContainer,
                        })),
                        i.elements.thumb.container.appendChild(
                          i.elements.thumb.imageContainer
                        );
                      var e = ne("div", {
                        class:
                          i.player.config.classNames.previewThumbnails
                            .timeContainer,
                      });
                      (i.elements.thumb.time = ne("span", {}, "00:00")),
                        e.appendChild(i.elements.thumb.time),
                        i.elements.thumb.imageContainer.appendChild(e),
                        U(i.player.elements.progress) &&
                          i.player.elements.progress.appendChild(
                            i.elements.thumb.container
                          ),
                        (i.elements.scrubbing.container = ne("div", {
                          class:
                            i.player.config.classNames.previewThumbnails
                              .scrubbingContainer,
                        })),
                        i.player.elements.wrapper.appendChild(
                          i.elements.scrubbing.container
                        );
                    }),
                    e(this, "destroy", function () {
                      i.elements.thumb.container &&
                        i.elements.thumb.container.remove(),
                        i.elements.scrubbing.container &&
                          i.elements.scrubbing.container.remove();
                    }),
                    e(this, "showImageAtCurrentTime", function () {
                      i.mouseDown
                        ? i.setScrubbingContainerSize()
                        : i.setThumbContainerSizeAndPos();
                      var e = i.thumbnails[0].frames.findIndex(function (e) {
                          return (
                            i.seekTime >= e.startTime && i.seekTime <= e.endTime
                          );
                        }),
                        t = e >= 0,
                        n = 0;
                      i.mouseDown || i.toggleThumbContainer(t),
                        t &&
                          (i.thumbnails.forEach(function (t, a) {
                            i.loadedImages.includes(t.frames[e].text) &&
                              (n = a);
                          }),
                          e !== i.showingThumb &&
                            ((i.showingThumb = e), i.loadImage(n)));
                    }),
                    e(this, "loadImage", function () {
                      var e =
                          arguments.length > 0 && void 0 !== arguments[0]
                            ? arguments[0]
                            : 0,
                        t = i.showingThumb,
                        n = i.thumbnails[e],
                        a = n.urlPrefix,
                        r = n.frames[t],
                        s = n.frames[t].text,
                        o = a + s;
                      if (
                        i.currentImageElement &&
                        i.currentImageElement.dataset.filename === s
                      )
                        i.showImage(i.currentImageElement, r, e, t, s, !1),
                          (i.currentImageElement.dataset.index = t),
                          i.removeOldImages(i.currentImageElement);
                      else {
                        i.loadingImage &&
                          i.usingSprites &&
                          (i.loadingImage.onload = null);
                        var l = new Image();
                        (l.src = o),
                          (l.dataset.index = t),
                          (l.dataset.filename = s),
                          (i.showingThumbFilename = s),
                          i.player.debug.log("Loading image: ".concat(o)),
                          (l.onload = function () {
                            return i.showImage(l, r, e, t, s, !0);
                          }),
                          (i.loadingImage = l),
                          i.removeOldImages(l);
                      }
                    }),
                    e(this, "showImage", function (e, t, n, a, r) {
                      var s =
                        !(arguments.length > 5 && void 0 !== arguments[5]) ||
                        arguments[5];
                      i.player.debug.log(
                        "Showing thumb: "
                          .concat(r, ". num: ")
                          .concat(a, ". qual: ")
                          .concat(n, ". newimg: ")
                          .concat(s)
                      ),
                        i.setImageSizeAndOffset(e, t),
                        s &&
                          (i.currentImageContainer.appendChild(e),
                          (i.currentImageElement = e),
                          i.loadedImages.includes(r) || i.loadedImages.push(r)),
                        i
                          .preloadNearby(a, !0)
                          .then(i.preloadNearby(a, !1))
                          .then(i.getHigherQuality(n, e, t, r));
                    }),
                    e(this, "removeOldImages", function (e) {
                      Array.from(i.currentImageContainer.children).forEach(
                        function (t) {
                          if ("img" === t.tagName.toLowerCase()) {
                            var n = i.usingSprites ? 500 : 1e3;
                            if (
                              t.dataset.index !== e.dataset.index &&
                              !t.dataset.deleting
                            ) {
                              t.dataset.deleting = !0;
                              var a = i.currentImageContainer;
                              setTimeout(function () {
                                a.removeChild(t),
                                  i.player.debug.log(
                                    "Removing thumb: ".concat(
                                      t.dataset.filename
                                    )
                                  );
                              }, n);
                            }
                          }
                        }
                      );
                    }),
                    e(this, "preloadNearby", function (e) {
                      var t =
                        !(arguments.length > 1 && void 0 !== arguments[1]) ||
                        arguments[1];
                      return new Promise(function (n) {
                        setTimeout(function () {
                          var a = i.thumbnails[0].frames[e].text;
                          if (i.showingThumbFilename === a) {
                            var r;
                            r = t
                              ? i.thumbnails[0].frames.slice(e)
                              : i.thumbnails[0].frames.slice(0, e).reverse();
                            var s = !1;
                            r.forEach(function (e) {
                              var t = e.text;
                              if (t !== a && !i.loadedImages.includes(t)) {
                                (s = !0),
                                  i.player.debug.log(
                                    "Preloading thumb filename: ".concat(t)
                                  );
                                var r = i.thumbnails[0].urlPrefix + t,
                                  o = new Image();
                                (o.src = r),
                                  (o.onload = function () {
                                    i.player.debug.log(
                                      "Preloaded thumb filename: ".concat(t)
                                    ),
                                      i.loadedImages.includes(t) ||
                                        i.loadedImages.push(t),
                                      n();
                                  });
                              }
                            }),
                              s || n();
                          }
                        }, 300);
                      });
                    }),
                    e(this, "getHigherQuality", function (e, t, n, a) {
                      if (e < i.thumbnails.length - 1) {
                        var r = t.naturalHeight;
                        i.usingSprites && (r = n.h),
                          r < i.thumbContainerHeight &&
                            setTimeout(function () {
                              i.showingThumbFilename === a &&
                                (i.player.debug.log(
                                  "Showing higher quality thumb for: ".concat(a)
                                ),
                                i.loadImage(e + 1));
                            }, 300);
                      }
                    }),
                    e(this, "toggleThumbContainer", function () {
                      var e =
                          arguments.length > 0 &&
                          void 0 !== arguments[0] &&
                          arguments[0],
                        t =
                          arguments.length > 1 &&
                          void 0 !== arguments[1] &&
                          arguments[1],
                        n =
                          i.player.config.classNames.previewThumbnails
                            .thumbContainerShown;
                      i.elements.thumb.container.classList.toggle(n, e),
                        !e &&
                          t &&
                          ((i.showingThumb = null),
                          (i.showingThumbFilename = null));
                    }),
                    e(this, "toggleScrubbingContainer", function () {
                      var e =
                          arguments.length > 0 &&
                          void 0 !== arguments[0] &&
                          arguments[0],
                        t =
                          i.player.config.classNames.previewThumbnails
                            .scrubbingContainerShown;
                      i.elements.scrubbing.container.classList.toggle(t, e),
                        e ||
                          ((i.showingThumb = null),
                          (i.showingThumbFilename = null));
                    }),
                    e(this, "determineContainerAutoSizing", function () {
                      (i.elements.thumb.imageContainer.clientHeight > 20 ||
                        i.elements.thumb.imageContainer.clientWidth > 20) &&
                        (i.sizeSpecifiedInCSS = !0);
                    }),
                    e(this, "setThumbContainerSizeAndPos", function () {
                      var e = i.elements.thumb.imageContainer;
                      if (i.sizeSpecifiedInCSS) {
                        if (e.clientHeight > 20 && e.clientWidth < 20) {
                          var t = Math.floor(
                            e.clientHeight * i.thumbAspectRatio
                          );
                          e.style.width = "".concat(t, "px");
                        } else if (e.clientHeight < 20 && e.clientWidth > 20) {
                          var n = Math.floor(
                            e.clientWidth / i.thumbAspectRatio
                          );
                          e.style.height = "".concat(n, "px");
                        }
                      } else {
                        var a = Math.floor(
                          i.thumbContainerHeight * i.thumbAspectRatio
                        );
                        (e.style.height = "".concat(
                          i.thumbContainerHeight,
                          "px"
                        )),
                          (e.style.width = "".concat(a, "px"));
                      }
                      i.setThumbContainerPos();
                    }),
                    e(this, "setThumbContainerPos", function () {
                      var e =
                          i.player.elements.progress.getBoundingClientRect(),
                        t = i.player.elements.container.getBoundingClientRect(),
                        n = i.elements.thumb.container,
                        a = t.left - e.left + 10,
                        r = t.right - e.left - n.clientWidth - 10,
                        s = i.mousePosX - e.left - n.clientWidth / 2,
                        o = gt(s, a, r);
                      (n.style.left = "".concat(o, "px")),
                        n.style.setProperty(
                          "--preview-arrow-offset",
                          s - o + "px"
                        );
                    }),
                    e(this, "setScrubbingContainerSize", function () {
                      var e = bt(i.thumbAspectRatio, {
                          width: i.player.media.clientWidth,
                          height: i.player.media.clientHeight,
                        }),
                        t = e.width,
                        n = e.height;
                      (i.elements.scrubbing.container.style.width = "".concat(
                        t,
                        "px"
                      )),
                        (i.elements.scrubbing.container.style.height =
                          "".concat(n, "px"));
                    }),
                    e(this, "setImageSizeAndOffset", function (e, t) {
                      if (i.usingSprites) {
                        var n = i.thumbContainerHeight / t.h;
                        (e.style.height = e.naturalHeight * n + "px"),
                          (e.style.width = e.naturalWidth * n + "px"),
                          (e.style.left = "-".concat(t.x * n, "px")),
                          (e.style.top = "-".concat(t.y * n, "px"));
                      }
                    }),
                    (this.player = n),
                    (this.thumbnails = []),
                    (this.loaded = !1),
                    (this.lastMouseMoveTime = Date.now()),
                    (this.mouseDown = !1),
                    (this.loadedImages = []),
                    (this.elements = { thumb: {}, scrubbing: {} }),
                    this.load();
                }
                return (
                  o(t, [
                    {
                      key: "enabled",
                      get: function () {
                        return (
                          this.player.isHTML5 &&
                          this.player.isVideo &&
                          this.player.config.previewThumbnails.enabled
                        );
                      },
                    },
                    {
                      key: "currentImageContainer",
                      get: function () {
                        return this.mouseDown
                          ? this.elements.scrubbing.container
                          : this.elements.thumb.imageContainer;
                      },
                    },
                    {
                      key: "usingSprites",
                      get: function () {
                        return Object.keys(
                          this.thumbnails[0].frames[0]
                        ).includes("w");
                      },
                    },
                    {
                      key: "thumbAspectRatio",
                      get: function () {
                        return this.usingSprites
                          ? this.thumbnails[0].frames[0].w /
                              this.thumbnails[0].frames[0].h
                          : this.thumbnails[0].width /
                              this.thumbnails[0].height;
                      },
                    },
                    {
                      key: "thumbContainerHeight",
                      get: function () {
                        return this.mouseDown
                          ? bt(this.thumbAspectRatio, {
                              width: this.player.media.clientWidth,
                              height: this.player.media.clientHeight,
                            }).height
                          : this.sizeSpecifiedInCSS
                          ? this.elements.thumb.imageContainer.clientHeight
                          : Math.floor(
                              this.player.media.clientWidth /
                                this.thumbAspectRatio /
                                4
                            );
                      },
                    },
                    {
                      key: "currentImageElement",
                      get: function () {
                        return this.mouseDown
                          ? this.currentScrubbingImageElement
                          : this.currentThumbnailImageElement;
                      },
                      set: function (e) {
                        this.mouseDown
                          ? (this.currentScrubbingImageElement = e)
                          : (this.currentThumbnailImageElement = e);
                      },
                    },
                  ]),
                  t
                );
              })(),
              kt = {
                insertElements(e, t) {
                  var n = this;
                  H(t)
                    ? ie(e, this.media, { src: t })
                    : V(t) &&
                      t.forEach(function (t) {
                        ie(e, n.media, t);
                      });
                },
                change(e) {
                  var t = this;
                  G(e, "sources.length")
                    ? (Oe.cancelRequests.call(this),
                      this.destroy.call(
                        this,
                        function () {
                          (t.options.quality = []),
                            ae(t.media),
                            (t.media = null),
                            U(t.elements.container) &&
                              t.elements.container.removeAttribute("class");
                          var n = e.sources,
                            i = e.type,
                            a = d(n, 1)[0],
                            r = a.provider,
                            s = void 0 === r ? Ze.html5 : r,
                            o = a.src,
                            l = "html5" === s ? i : "div",
                            c = "html5" === s ? {} : { src: o };
                          Object.assign(t, {
                            provider: s,
                            type: i,
                            supported: ge.check(i, s, t.config.playsinline),
                            media: ne(l, c),
                          }),
                            t.elements.container.appendChild(t.media),
                            F(e.autoplay) && (t.config.autoplay = e.autoplay),
                            t.isHTML5 &&
                              (t.config.crossorigin &&
                                t.media.setAttribute("crossorigin", ""),
                              t.config.autoplay &&
                                t.media.setAttribute("autoplay", ""),
                              $(e.poster) || (t.poster = e.poster),
                              t.config.loop.active &&
                                t.media.setAttribute("loop", ""),
                              t.config.muted &&
                                t.media.setAttribute("muted", ""),
                              t.config.playsinline &&
                                t.media.setAttribute("playsinline", "")),
                            rt.addStyleHook.call(t),
                            t.isHTML5 && kt.insertElements.call(t, "source", n),
                            (t.config.title = e.title),
                            mt.setup.call(t),
                            t.isHTML5 &&
                              Object.keys(e).includes("tracks") &&
                              kt.insertElements.call(t, "track", e.tracks),
                            (t.isHTML5 || (t.isEmbed && !t.supported.ui)) &&
                              rt.build.call(t),
                            t.isHTML5 && t.media.load(),
                            $(e.previewThumbnails) ||
                              (Object.assign(
                                t.config.previewThumbnails,
                                e.previewThumbnails
                              ),
                              t.previewThumbnails &&
                                t.previewThumbnails.loaded &&
                                (t.previewThumbnails.destroy(),
                                (t.previewThumbnails = null)),
                              t.config.previewThumbnails.enabled &&
                                (t.previewThumbnails = new wt(t))),
                            t.fullscreen.update();
                        },
                        !0
                      ))
                    : this.debug.warn("Invalid source format");
                },
              },
              Tt = (function () {
                function t(n, i) {
                  var a = this;
                  if (
                    (r(this, t),
                    e(this, "play", function () {
                      return R(a.media.play)
                        ? (a.ads &&
                            a.ads.enabled &&
                            a.ads.managerPromise
                              .then(function () {
                                return a.ads.play();
                              })
                              .catch(function () {
                                return Ce(a.media.play());
                              }),
                          a.media.play())
                        : null;
                    }),
                    e(this, "pause", function () {
                      return a.playing && R(a.media.pause)
                        ? a.media.pause()
                        : null;
                    }),
                    e(this, "togglePlay", function (e) {
                      return (F(e) ? e : !a.playing) ? a.play() : a.pause();
                    }),
                    e(this, "stop", function () {
                      a.isHTML5
                        ? (a.pause(), a.restart())
                        : R(a.media.stop) && a.media.stop();
                    }),
                    e(this, "restart", function () {
                      a.currentTime = 0;
                    }),
                    e(this, "rewind", function (e) {
                      a.currentTime -= D(e) ? e : a.config.seekTime;
                    }),
                    e(this, "forward", function (e) {
                      a.currentTime += D(e) ? e : a.config.seekTime;
                    }),
                    e(this, "increaseVolume", function (e) {
                      var t = a.media.muted ? 0 : a.volume;
                      a.volume = t + (D(e) ? e : 0);
                    }),
                    e(this, "decreaseVolume", function (e) {
                      a.increaseVolume(-e);
                    }),
                    e(this, "airplay", function () {
                      ge.airplay && a.media.webkitShowPlaybackTargetPicker();
                    }),
                    e(this, "toggleControls", function (e) {
                      if (a.supported.ui && !a.isAudio) {
                        var t = ue(
                            a.elements.container,
                            a.config.classNames.hideControls
                          ),
                          n = void 0 === e ? void 0 : !e,
                          i = ce(
                            a.elements.container,
                            a.config.classNames.hideControls,
                            n
                          );
                        if (
                          (i &&
                            V(a.config.controls) &&
                            a.config.controls.includes("settings") &&
                            !$(a.config.settings) &&
                            Ye.toggleMenu.call(a, !1),
                          i !== t)
                        ) {
                          var r = i ? "controlshidden" : "controlsshown";
                          Te.call(a, a.media, r);
                        }
                        return !i;
                      }
                      return !1;
                    }),
                    e(this, "on", function (e, t) {
                      be.call(a, a.elements.container, e, t);
                    }),
                    e(this, "once", function (e, t) {
                      ke.call(a, a.elements.container, e, t);
                    }),
                    e(this, "off", function (e, t) {
                      we(a.elements.container, e, t);
                    }),
                    e(this, "destroy", function (e) {
                      var t =
                        arguments.length > 1 &&
                        void 0 !== arguments[1] &&
                        arguments[1];
                      if (a.ready) {
                        var n = function () {
                          (document.body.style.overflow = ""),
                            (a.embed = null),
                            t
                              ? (Object.keys(a.elements).length &&
                                  (ae(a.elements.buttons.play),
                                  ae(a.elements.captions),
                                  ae(a.elements.controls),
                                  ae(a.elements.wrapper),
                                  (a.elements.buttons.play = null),
                                  (a.elements.captions = null),
                                  (a.elements.controls = null),
                                  (a.elements.wrapper = null)),
                                R(e) && e())
                              : (Se.call(a),
                                Oe.cancelRequests.call(a),
                                se(a.elements.original, a.elements.container),
                                Te.call(
                                  a,
                                  a.elements.original,
                                  "destroyed",
                                  !0
                                ),
                                R(e) && e.call(a.elements.original),
                                (a.ready = !1),
                                setTimeout(function () {
                                  (a.elements = null), (a.media = null);
                                }, 200));
                        };
                        a.stop(),
                          clearTimeout(a.timers.loading),
                          clearTimeout(a.timers.controls),
                          clearTimeout(a.timers.resized),
                          a.isHTML5
                            ? (rt.toggleNativeControls.call(a, !0), n())
                            : a.isYouTube
                            ? (clearInterval(a.timers.buffering),
                              clearInterval(a.timers.playing),
                              null !== a.embed &&
                                R(a.embed.destroy) &&
                                a.embed.destroy(),
                              n())
                            : a.isVimeo &&
                              (null !== a.embed && a.embed.unload().then(n),
                              setTimeout(n, 200));
                      }
                    }),
                    e(this, "supports", function (e) {
                      return ge.mime.call(a, e);
                    }),
                    (this.timers = {}),
                    (this.ready = !1),
                    (this.loading = !1),
                    (this.failed = !1),
                    (this.touch = ge.touch),
                    (this.media = n),
                    H(this.media) &&
                      (this.media = document.querySelectorAll(this.media)),
                    ((window.jQuery && this.media instanceof jQuery) ||
                      B(this.media) ||
                      V(this.media)) &&
                      (this.media = this.media[0]),
                    (this.config = Z(
                      {},
                      Je,
                      t.defaults,
                      i || {},
                      (function () {
                        try {
                          return JSON.parse(
                            a.media.getAttribute("data-plyr-config")
                          );
                        } catch (e) {
                          return {};
                        }
                      })()
                    )),
                    (this.elements = {
                      container: null,
                      fullscreen: null,
                      captions: null,
                      buttons: {},
                      display: {},
                      progress: {},
                      inputs: {},
                      settings: {
                        popup: null,
                        menu: null,
                        panels: {},
                        buttons: {},
                      },
                    }),
                    (this.captions = {
                      active: null,
                      currentTrack: -1,
                      meta: new WeakMap(),
                    }),
                    (this.fullscreen = { active: !1 }),
                    (this.options = { speed: [], quality: [] }),
                    (this.debug = new nt(this.config.debug)),
                    this.debug.log("Config", this.config),
                    this.debug.log("Support", ge),
                    !O(this.media) && U(this.media))
                  )
                    if (this.media.plyr)
                      this.debug.warn("Target already setup");
                    else if (this.config.enabled)
                      if (ge.check().api) {
                        var s = this.media.cloneNode(!0);
                        (s.autoplay = !1), (this.elements.original = s);
                        var o = this.media.tagName.toLowerCase(),
                          l = null,
                          c = null;
                        switch (o) {
                          case "div":
                            if (
                              ((l = this.media.querySelector("iframe")), U(l))
                            ) {
                              if (
                                ((c = $e(l.getAttribute("src"))),
                                (this.provider = (function (e) {
                                  return /^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(
                                    e
                                  )
                                    ? Ze.youtube
                                    : /^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(
                                        e
                                      )
                                    ? Ze.vimeo
                                    : null;
                                })(c.toString())),
                                (this.elements.container = this.media),
                                (this.media = l),
                                (this.elements.container.className = ""),
                                c.search.length)
                              ) {
                                var u = ["1", "true"];
                                u.includes(c.searchParams.get("autoplay")) &&
                                  (this.config.autoplay = !0),
                                  u.includes(c.searchParams.get("loop")) &&
                                    (this.config.loop.active = !0),
                                  this.isYouTube
                                    ? ((this.config.playsinline = u.includes(
                                        c.searchParams.get("playsinline")
                                      )),
                                      (this.config.youtube.hl =
                                        c.searchParams.get("hl")))
                                    : (this.config.playsinline = !0);
                              }
                            } else
                              (this.provider = this.media.getAttribute(
                                this.config.attributes.embed.provider
                              )),
                                this.media.removeAttribute(
                                  this.config.attributes.embed.provider
                                );
                            if (
                              $(this.provider) ||
                              !Object.values(Ze).includes(this.provider)
                            )
                              return void this.debug.error(
                                "Setup failed: Invalid provider"
                              );
                            this.type = et;
                            break;
                          case "video":
                          case "audio":
                            (this.type = o),
                              (this.provider = Ze.html5),
                              this.media.hasAttribute("crossorigin") &&
                                (this.config.crossorigin = !0),
                              this.media.hasAttribute("autoplay") &&
                                (this.config.autoplay = !0),
                              (this.media.hasAttribute("playsinline") ||
                                this.media.hasAttribute(
                                  "webkit-playsinline"
                                )) &&
                                (this.config.playsinline = !0),
                              this.media.hasAttribute("muted") &&
                                (this.config.muted = !0),
                              this.media.hasAttribute("loop") &&
                                (this.config.loop.active = !0);
                            break;
                          default:
                            return void this.debug.error(
                              "Setup failed: unsupported type"
                            );
                        }
                        (this.supported = ge.check(
                          this.type,
                          this.provider,
                          this.config.playsinline
                        )),
                          this.supported.api
                            ? ((this.eventListeners = []),
                              (this.listeners = new st(this)),
                              (this.storage = new Be(this)),
                              (this.media.plyr = this),
                              U(this.elements.container) ||
                                ((this.elements.container = ne("div", {
                                  tabindex: 0,
                                })),
                                ee(this.media, this.elements.container)),
                              rt.migrateStyles.call(this),
                              rt.addStyleHook.call(this),
                              mt.setup.call(this),
                              this.config.debug &&
                                be.call(
                                  this,
                                  this.elements.container,
                                  this.config.events.join(" "),
                                  function (e) {
                                    a.debug.log("event: ".concat(e.type));
                                  }
                                ),
                              (this.fullscreen = new it(this)),
                              (this.isHTML5 ||
                                (this.isEmbed && !this.supported.ui)) &&
                                rt.build.call(this),
                              this.listeners.container(),
                              this.listeners.global(),
                              this.config.ads.enabled &&
                                (this.ads = new ft(this)),
                              this.isHTML5 &&
                                this.config.autoplay &&
                                this.once("canplay", function () {
                                  return Ce(a.play());
                                }),
                              (this.lastSeekTime = 0),
                              this.config.previewThumbnails.enabled &&
                                (this.previewThumbnails = new wt(this)))
                            : this.debug.error("Setup failed: no support");
                      } else this.debug.error("Setup failed: no support");
                    else this.debug.error("Setup failed: disabled by config");
                  else
                    this.debug.error(
                      "Setup failed: no suitable element passed"
                    );
                }
                return (
                  o(
                    t,
                    [
                      {
                        key: "isHTML5",
                        get: function () {
                          return this.provider === Ze.html5;
                        },
                      },
                      {
                        key: "isEmbed",
                        get: function () {
                          return this.isYouTube || this.isVimeo;
                        },
                      },
                      {
                        key: "isYouTube",
                        get: function () {
                          return this.provider === Ze.youtube;
                        },
                      },
                      {
                        key: "isVimeo",
                        get: function () {
                          return this.provider === Ze.vimeo;
                        },
                      },
                      {
                        key: "isVideo",
                        get: function () {
                          return this.type === et;
                        },
                      },
                      {
                        key: "isAudio",
                        get: function () {
                          return "audio" === this.type;
                        },
                      },
                      {
                        key: "playing",
                        get: function () {
                          return Boolean(
                            this.ready && !this.paused && !this.ended
                          );
                        },
                      },
                      {
                        key: "paused",
                        get: function () {
                          return Boolean(this.media.paused);
                        },
                      },
                      {
                        key: "stopped",
                        get: function () {
                          return Boolean(this.paused && 0 === this.currentTime);
                        },
                      },
                      {
                        key: "ended",
                        get: function () {
                          return Boolean(this.media.ended);
                        },
                      },
                      {
                        key: "currentTime",
                        get: function () {
                          return Number(this.media.currentTime);
                        },
                        set: function (e) {
                          if (this.duration) {
                            var t = D(e) && e > 0;
                            (this.media.currentTime = t
                              ? Math.min(e, this.duration)
                              : 0),
                              this.debug.log(
                                "Seeking to ".concat(
                                  this.currentTime,
                                  " seconds"
                                )
                              );
                          }
                        },
                      },
                      {
                        key: "buffered",
                        get: function () {
                          var e = this.media.buffered;
                          return D(e)
                            ? e
                            : e && e.length && this.duration > 0
                            ? e.end(0) / this.duration
                            : 0;
                        },
                      },
                      {
                        key: "seeking",
                        get: function () {
                          return Boolean(this.media.seeking);
                        },
                      },
                      {
                        key: "duration",
                        get: function () {
                          var e = parseFloat(this.config.duration),
                            t = (this.media || {}).duration,
                            n = D(t) && t !== 1 / 0 ? t : 0;
                          return e || n;
                        },
                      },
                      {
                        key: "volume",
                        get: function () {
                          return Number(this.media.volume);
                        },
                        set: function (e) {
                          var t = e;
                          H(t) && (t = Number(t)),
                            D(t) || (t = this.storage.get("volume")),
                            D(t) || (t = this.config.volume),
                            t > 1 && (t = 1),
                            t < 0 && (t = 0),
                            (this.config.volume = t),
                            (this.media.volume = t),
                            !$(e) && this.muted && t > 0 && (this.muted = !1);
                        },
                      },
                      {
                        key: "muted",
                        get: function () {
                          return Boolean(this.media.muted);
                        },
                        set: function (e) {
                          var t = e;
                          F(t) || (t = this.storage.get("muted")),
                            F(t) || (t = this.config.muted),
                            (this.config.muted = t),
                            (this.media.muted = t);
                        },
                      },
                      {
                        key: "hasAudio",
                        get: function () {
                          return (
                            !this.isHTML5 ||
                            !!this.isAudio ||
                            Boolean(this.media.mozHasAudio) ||
                            Boolean(this.media.webkitAudioDecodedByteCount) ||
                            Boolean(
                              this.media.audioTracks &&
                                this.media.audioTracks.length
                            )
                          );
                        },
                      },
                      {
                        key: "speed",
                        get: function () {
                          return Number(this.media.playbackRate);
                        },
                        set: function (e) {
                          var t = this,
                            n = null;
                          D(e) && (n = e),
                            D(n) || (n = this.storage.get("speed")),
                            D(n) || (n = this.config.speed.selected);
                          var i = this.minimumSpeed,
                            a = this.maximumSpeed;
                          (n = gt(n, i, a)),
                            (this.config.speed.selected = n),
                            setTimeout(function () {
                              t.media && (t.media.playbackRate = n);
                            }, 0);
                        },
                      },
                      {
                        key: "minimumSpeed",
                        get: function () {
                          return this.isYouTube
                            ? Math.min.apply(Math, a(this.options.speed))
                            : this.isVimeo
                            ? 0.5
                            : 0.0625;
                        },
                      },
                      {
                        key: "maximumSpeed",
                        get: function () {
                          return this.isYouTube
                            ? Math.max.apply(Math, a(this.options.speed))
                            : this.isVimeo
                            ? 2
                            : 16;
                        },
                      },
                      {
                        key: "quality",
                        get: function () {
                          return this.media.quality;
                        },
                        set: function (e) {
                          var t = this.config.quality,
                            n = this.options.quality;
                          if (n.length) {
                            var i = [
                                !$(e) && Number(e),
                                this.storage.get("quality"),
                                t.selected,
                                t.default,
                              ].find(D),
                              a = !0;
                            if (!n.includes(i)) {
                              var r = Pe(n, i);
                              this.debug.warn(
                                "Unsupported quality option: "
                                  .concat(i, ", using ")
                                  .concat(r, " instead")
                              ),
                                (i = r),
                                (a = !1);
                            }
                            (t.selected = i),
                              (this.media.quality = i),
                              a && this.storage.set({ quality: i });
                          }
                        },
                      },
                      {
                        key: "loop",
                        get: function () {
                          return Boolean(this.media.loop);
                        },
                        set: function (e) {
                          var t = F(e) ? e : this.config.loop.active;
                          (this.config.loop.active = t), (this.media.loop = t);
                        },
                      },
                      {
                        key: "source",
                        get: function () {
                          return this.media.currentSrc;
                        },
                        set: function (e) {
                          kt.change.call(this, e);
                        },
                      },
                      {
                        key: "download",
                        get: function () {
                          var e = this.config.urls.download;
                          return Y(e) ? e : this.source;
                        },
                        set: function (e) {
                          Y(e) &&
                            ((this.config.urls.download = e),
                            Ye.setDownloadUrl.call(this));
                        },
                      },
                      {
                        key: "poster",
                        get: function () {
                          return this.isVideo
                            ? this.media.getAttribute("poster") ||
                                this.media.getAttribute("data-poster")
                            : null;
                        },
                        set: function (e) {
                          this.isVideo
                            ? rt.setPoster
                                .call(this, e, !1)
                                .catch(function () {})
                            : this.debug.warn(
                                "Poster can only be set for video"
                              );
                        },
                      },
                      {
                        key: "ratio",
                        get: function () {
                          if (!this.isVideo) return null;
                          var e = je(Ne.call(this));
                          return V(e) ? e.join(":") : e;
                        },
                        set: function (e) {
                          this.isVideo
                            ? H(e) && Le(e)
                              ? ((this.config.ratio = je(e)), Ie.call(this))
                              : this.debug.error(
                                  "Invalid aspect ratio specified (".concat(
                                    e,
                                    ")"
                                  )
                                )
                            : this.debug.warn(
                                "Aspect ratio can only be set for video"
                              );
                        },
                      },
                      {
                        key: "autoplay",
                        get: function () {
                          return Boolean(this.config.autoplay);
                        },
                        set: function (e) {
                          this.config.autoplay = F(e)
                            ? e
                            : this.config.autoplay;
                        },
                      },
                      {
                        key: "toggleCaptions",
                        value: function (e) {
                          Xe.toggle.call(this, e, !1);
                        },
                      },
                      {
                        key: "currentTrack",
                        get: function () {
                          var e = this.captions,
                            t = e.toggled,
                            n = e.currentTrack;
                          return t ? n : -1;
                        },
                        set: function (e) {
                          Xe.set.call(this, e, !1), Xe.setup.call(this);
                        },
                      },
                      {
                        key: "language",
                        get: function () {
                          return (Xe.getCurrentTrack.call(this) || {}).language;
                        },
                        set: function (e) {
                          Xe.setLanguage.call(this, e, !1);
                        },
                      },
                      {
                        key: "pip",
                        get: function () {
                          return ge.pip
                            ? $(this.media.webkitPresentationMode)
                              ? this.media === document.pictureInPictureElement
                              : this.media.webkitPresentationMode === Ge
                            : null;
                        },
                        set: function (e) {
                          if (ge.pip) {
                            var t = F(e) ? e : !this.pip;
                            R(this.media.webkitSetPresentationMode) &&
                              this.media.webkitSetPresentationMode(
                                t ? Ge : "inline"
                              ),
                              R(this.media.requestPictureInPicture) &&
                                (!this.pip && t
                                  ? this.media.requestPictureInPicture()
                                  : this.pip &&
                                    !t &&
                                    document.exitPictureInPicture());
                          }
                        },
                      },
                      {
                        key: "setPreviewThumbnails",
                        value: function (e) {
                          this.previewThumbnails &&
                            this.previewThumbnails.loaded &&
                            (this.previewThumbnails.destroy(),
                            (this.previewThumbnails = null)),
                            Object.assign(this.config.previewThumbnails, e),
                            this.config.previewThumbnails.enabled &&
                              (this.previewThumbnails = new wt(this));
                        },
                      },
                    ],
                    [
                      {
                        key: "supported",
                        value: function (e, t, n) {
                          return ge.check(e, t, n);
                        },
                      },
                      {
                        key: "loadSprite",
                        value: function (e, t) {
                          return We(e, t);
                        },
                      },
                      {
                        key: "setup",
                        value: function (e) {
                          var n =
                              arguments.length > 1 && void 0 !== arguments[1]
                                ? arguments[1]
                                : {},
                            i = null;
                          return (
                            H(e)
                              ? (i = Array.from(document.querySelectorAll(e)))
                              : B(e)
                              ? (i = Array.from(e))
                              : V(e) && (i = e.filter(U)),
                            $(i)
                              ? null
                              : i.map(function (e) {
                                  return new t(e, n);
                                })
                          );
                        },
                      },
                    ]
                  ),
                  t
                );
              })();
            return (
              (Tt.defaults = ((yt = Je), JSON.parse(JSON.stringify(yt)))), Tt
            );
          })());
      },
      "./src/assets/js/MySwiper.js": function (e, t, n) {
        "use strict";
        n.r(t),
          n.d(t, {
            Swipers: function () {
              return i;
            },
          });
        var i = function () {
          document.addEventListener("DOMContentLoaded", function () {
            var e = new Swiper(".slider-js-2", {
              slidesPerView: 4,
              direction: "vertical",
              freeMode: !0,
              watchSlidesProgress: !0,
            });
            new Swiper(".slider-js-1", {
              spaceBetween: 10,
              navigation: {
                nextEl: ".swiper-button-next",
                prevEl: ".swiper-button-prev",
              },
              thumbs: { swiper: e },
              effect: "fade",
              fadeEffect: { crossFade: !0 },
            }),
              new Swiper(".slider-full-js", {
                slidesPerView: 4,
                loop: "true",
                speed: 300,
                spaceBetween: 14,
                grabCursor: !0,
                pagination: { el: ".swiper-pagination-rew", clickable: !0 },
                navigation: { prevEl: ".js-rew-prev", nextEl: ".js-rew-next" },
                breakpoints: { 900: { spaceBetween: 22 } },
              });
          });
        };
      },
      "./src/assets/js/animation.js": function (e, t, n) {
        "use strict";
        n.r(t),
          n.d(t, {
            Anim: function () {
              return i;
            },
          });
        var i = function () {
          document.addEventListener("DOMContentLoaded", function () {
            var e = document.querySelectorAll("._anim-top"),
              t = document.querySelectorAll("._anim-left"),
              n = document.querySelectorAll("._anim-right"),
              i = Array.prototype.slice.call(e),
              a = Array.prototype.slice.call(t),
              r = Array.prototype.slice.call(n);
            i.length > 0 &&
              i.forEach(function (e) {
                var t = e.getBoundingClientRect();
                window.addEventListener("scroll", function () {
                  t.top < document.body.offsetHeight - 200 &&
                    e.classList.add("_is-active");
                });
              }),
              a.length > 0 &&
                a.forEach(function (e) {
                  var t = e.getBoundingClientRect();
                  window.addEventListener("scroll", function () {
                    t.top < document.body.offsetHeight - 200 &&
                      e.classList.add("_is-active");
                  });
                }),
              r.length > 0 &&
                r.forEach(function (e) {
                  var t = e.getBoundingClientRect();
                  window.addEventListener("scroll", function () {
                    t.top < document.body.offsetHeight - 200 &&
                      e.classList.add("_is-active");
                  });
                });
          });
        };
      },
      "./src/assets/js/button.js": function (e, t, n) {
        "use strict";
        n.r(t),
          n.d(t, {
            Button: function () {
              return i;
            },
          });
        var i = function (e) {
          var t = e.target.closest(".but-wave");
          e.preventDefault();
          var n = Math.max(t.clientWidth, t.clientHeight),
            i = document.createElement("div"),
            a = t.getBoundingClientRect();
          i.classList.add("addDiv"),
            (i.style.width = i.style.height = n + "px"),
            (i.style.left = e.clientX - a.left - n / 2 + "px"),
            (i.style.top = e.clientY - a.top - n / 2 + "px"),
            t.closest(".but-wave").append(i),
            setTimeout(function () {
              i.remove();
            }, 300);
        };
      },
      "./src/assets/js/constants.js": function (e, t, n) {
        "use strict";
        n.r(t),
          n.d(t, {
            body: function () {
              return i;
            },
            header: function () {
              return s;
            },
            popupsInit: function () {
              return r;
            },
            toysPlyr: function () {
              return o;
            },
            waves: function () {
              return a;
            },
          }),
          n("./node_modules/plyr/dist/plyr.min.js");
        var i = document.querySelector("body"),
          a = document.querySelectorAll(".but-wave"),
          r = document.querySelectorAll(".popups-init-js"),
          s = document.querySelector("header"),
          o = document.querySelector(".toys__plyr");
      },
      "./src/assets/js/galSwiper.js": function (e, t, n) {
        "use strict";
        function i(e) {
          return (
            (function (e) {
              if (Array.isArray(e)) return a(e);
            })(e) ||
            (function (e) {
              if (
                ("undefined" != typeof Symbol && null != e[Symbol.iterator]) ||
                null != e["@@iterator"]
              )
                return Array.from(e);
            })(e) ||
            (function (e, t) {
              if (e) {
                if ("string" == typeof e) return a(e, t);
                var n = Object.prototype.toString.call(e).slice(8, -1);
                return (
                  "Object" === n && e.constructor && (n = e.constructor.name),
                  "Map" === n || "Set" === n
                    ? Array.from(e)
                    : "Arguments" === n ||
                      /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)
                    ? a(e, t)
                    : void 0
                );
              }
            })(e) ||
            (function () {
              throw new TypeError(
                "Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."
              );
            })()
          );
        }
        function a(e, t) {
          (null == t || t > e.length) && (t = e.length);
          for (var n = 0, i = new Array(t); n < t; n++) i[n] = e[n];
          return i;
        }
        n.r(t),
          n.d(t, {
            Gal: function () {
              return r;
            },
          });
        var r = function (e) {
          var t,
            n = new Swiper(".s2swiper", {
              speed: 300,
              centeredSlides: !0,
              spaceBetween: 11,
              effect: "coverflow",
              coverflowEffect: { rotate: 0, stretch: 0, depth: 0 },
              navigation: { prevEl: ".s2-prev", nextEl: ".s2-next" },
              loop: !0,
              slidesPerView: "auto",
              slideToClickedSlide: "true",
              grabCursor: !0,
            });
          n &&
            n.on("beforeTransitionStart", function () {
              for (
                var e = i(document.querySelectorAll(".s2  .swiper-slide")),
                  n = i(document.querySelectorAll(".s1  .slide")),
                  a = 0;
                a < n.length;
                ++a
              )
                n[a].classList.contains("_is-start") &&
                  n[a].classList.remove("_is-start"),
                  n[a].classList.contains("_is-active") &&
                    (n[a].classList.remove("_is-active"),
                    n[a].classList.add("_not-active"));
              setTimeout(function () {
                for (var i = 0; i < e.length; ++i)
                  e[i].classList.contains("swiper-slide-active") &&
                    ((t = e[i].getAttribute("data-id")),
                    n[t].classList.remove("_not-active"),
                    n[t].classList.add("_is-active"));
              }, 10);
            });
        };
      },
      "./src/assets/js/header.js": function (e, t, n) {
        "use strict";
        n.r(t),
          n.d(t, {
            Headers: function () {
              return i;
            },
          });
        var i = function () {
          window.addEventListener("scroll", function (e) {
            window.pageYOffset > 100
              ? document
                  .querySelector(".dop_header")
                  .classList.add("responciveHeader")
              : document
                  .querySelector(".dop_header")
                  .classList.remove("responciveHeader");
          }),
            (window.onresize = function () {
              window.innerWidth >= 999 &&
                (menu.querySelector(".header__info") &&
                  menu.querySelector(".header__info").remove(),
                menu.classList.remove("menu-active"),
                document.querySelector(".info").classList.remove("info-active"),
                document.querySelector("body").classList.remove("lock"));
            });
        };
      },
      "./src/assets/js/popup.js": function (e, t, n) {
        "use strict";
        n.r(t),
          n.d(t, {
            Popups: function () {
              return o;
            },
          });
        var i = n("./node_modules/plyr/dist/plyr.min.js"),
          a = n.n(i),
          r = n("./src/assets/js/constants.js");
        function s(e, t) {
          (null == t || t > e.length) && (t = e.length);
          for (var n = 0, i = new Array(t); n < t; n++) i[n] = e[n];
          return i;
        }
        var o = function () {
          var e,
            t = document.querySelector(".popup-js"),
            n = t.querySelectorAll(".popup__content"),
            i = [],
            o =
              (function (e) {
                if (Array.isArray(e)) return s(e);
              })((e = document.querySelectorAll(".slider-video"))) ||
              (function (e) {
                if (
                  ("undefined" != typeof Symbol &&
                    null != e[Symbol.iterator]) ||
                  null != e["@@iterator"]
                )
                  return Array.from(e);
              })(e) ||
              (function (e, t) {
                if (e) {
                  if ("string" == typeof e) return s(e, t);
                  var n = Object.prototype.toString.call(e).slice(8, -1);
                  return (
                    "Object" === n && e.constructor && (n = e.constructor.name),
                    "Map" === n || "Set" === n
                      ? Array.from(e)
                      : "Arguments" === n ||
                        /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)
                      ? s(e, t)
                      : void 0
                  );
                }
              })(e) ||
              (function () {
                throw new TypeError(
                  "Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."
                );
              })();
          o.forEach(function (e) {
            var t = e.getAttribute("id");
            if (t) {
              var n = "#".concat(t),
                r = new (a())(n);
              i.push({ id: t, e: r });
            }
          }),
            document.addEventListener("click", function (e) {
              var a = e.target;
              a.closest(".popups-init-js")
                ? (function () {
                    var e = t.querySelector(
                      a.closest(".popups-init-js").getAttribute("rel")
                    );
                    setTimeout(function () {
                      (t.style.display = "block"),
                        t.classList.remove("_not-active"),
                        t.classList.add("_is-active"),
                        n.forEach(function (t) {
                          t == e
                            ? (e.style.display = "grid")
                            : (t.style.display = "none");
                        });
                    }, 200);
                    for (
                      var s = e.querySelector("video").getAttribute("id"),
                        l = 0;
                      l < o.length;
                      ++l
                    )
                      i[l].id === s && i[l].e.play();
                    r.body.style.cssText = "overflow: hidden";
                  })()
                : (a.matches(".popup-overlay-js") ||
                    a.closest(".popup-close-js")) &&
                  (function () {
                    t.classList.remove("_is-active"),
                      t.classList.add("_not-active"),
                      setTimeout(function () {
                        (t.style.display = "none"),
                          n.forEach(function (e) {
                            e.style.display = "none";
                          });
                      }, 300),
                      (r.body.style.cssText = "overflow: visible");
                    for (var e = 0; e < i.length; ++e) i[e].e.stop();
                  })();
            });
        };
      },
      "./src/assets/js/sdouble.js": function (e, t, n) {
        "use strict";
        n.r(t),
          n.d(t, {
            Double: function () {
              return i;
            },
          });
        var i = function () {
          document.addEventListener("DOMContentLoaded", function () {
            var e = new Swiper(".slider-double1-js", {
                loop: "true",
                speed: 500,
                slidesPerView: "auto",
                grabCursor: !0,
                spaceBetween: 20,
                thumbs: { swiper: t },
                  breakpoints: {
                        768: {
                          
                            spaceBetween: 0,
                  }
                              },
              }),
              t = new Swiper(".slider-double2-js", {
                slidesPerView: "auto",
                slideToClickedSlide: "true",
                spaceBetween: 10,
                loop: "true",
                speed: 500,
                navigation: {
                  nextEl: ".js-double2-next",
                  prevEl: ".js-double2-prev",
                },
                grabCursor: !0,
                watchSlidesProgress: !0,
                centeredSlides: !0,
              });
            (e.controller.control = t), (t.controller.control = e);
          });
        };
      },
      "./src/assets/scss/app.scss": function (e, t, n) {
        "use strict";
        n.r(t);
      },
    },
    t = {};
  function n(i) {
    var a = t[i];
    if (void 0 !== a) return a.exports;
    var r = (t[i] = { exports: {} });
    return e[i].call(r.exports, r, r.exports, n), r.exports;
  }
  (n.n = function (e) {
    var t =
      e && e.__esModule
        ? function () {
            return e.default;
          }
        : function () {
            return e;
          };
    return n.d(t, { a: t }), t;
  }),
    (n.d = function (e, t) {
      for (var i in t)
        n.o(t, i) &&
          !n.o(e, i) &&
          Object.defineProperty(e, i, { enumerable: !0, get: t[i] });
    }),
    (n.g = (function () {
      if ("object" == typeof globalThis) return globalThis;
      try {
        return this || new Function("return this")();
      } catch (e) {
        if ("object" == typeof window) return window;
      }
    })()),
    (n.o = function (e, t) {
      return Object.prototype.hasOwnProperty.call(e, t);
    }),
    (n.r = function (e) {
      "undefined" != typeof Symbol &&
        Symbol.toStringTag &&
        Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }),
        Object.defineProperty(e, "__esModule", { value: !0 });
    });
  var i = {};
  !(function () {
    "use strict";
    n.r(i);
    var e = n("./src/assets/js/animation.js"),
      t = n("./src/assets/js/button.js"),
      a = n("./src/assets/js/header.js"),
      r = n("./src/assets/js/MySwiper.js"),
      s = n("./src/assets/js/popup.js"),
      o = n("./src/assets/js/galSwiper.js"),
      l = n("./src/assets/js/sdouble.js"),
      c = n("./src/assets/js/constants.js");
    n("./src/assets/scss/app.scss"),
      (0, e.Anim)(),
      (0, r.Swipers)(),
      (0, o.Gal)(),
      (0, l.Double)(),
      document.addEventListener("DOMContentLoaded", function () {
        c.popupsInit.length > 0 && (0, s.Popups)(),
          c.header && (0, a.Headers)(),
          c.waves.forEach(function (e) {
            e.addEventListener("click", t.Button);
          }),
          (function () {
            if (playerFullToys) {
              var e = document.querySelector(".playerFullToys"),
                t = document.querySelector(".toys__video .toys__sheap");
              (t.innerHTML = "0:00"),
                e.addEventListener("click", function (e) {
                  var n = playerFullToys.currentTime.toFixed(2);
                  (n = n.replace(".", ":")), (t.innerHTML = n);
                });
            }
          })();
      });
  })();
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0ZZLEVBQUFBLEVBQUFBLFdBR0ZkLEVBQUFBLE1BQUFBLFNBQWMsU0FBQ1QsR0FDYkEsRUFBS3I2QixpQkFBaUIsUUFBU3k2QixFQUFBQSxPQUNoQyxJQUVnQixXQUVmLEdBQUlnRCxlQUFnQixDQUNsQixJQUFJQyxFQUFPanJDLFNBQVNxQixjQUFjLG1CQUNoQzZwQyxFQUFRbHJDLFNBQVNxQixjQUFjLDZCQUVqQzZwQyxFQUFNdDNCLFVBQVksT0FDbEJxM0IsRUFBSzE5QixpQkFBaUIsU0FBUyxTQUFDaFAsR0FFOUIsSUFBSTRzQyxFQUFLSCxlQUFlejRCLFlBQVlsUCxRQUFRLEdBQzVDOG5DLEVBQUtBLEVBQUduaEMsUUFBUSxJQUFLLEtBQ3JCa2hDLEVBQU10M0IsVUFBWXUzQixDQUNuQixHQUNGLENBQ0YsQ0FFREMsRUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovL3Jlcy9wbHlyLmpzIiwid2VicGFjazovL3Jlcy9ub2RlX21vZHVsZXMvcmFuZ2V0b3VjaC9kaXN0L3JhbmdldG91Y2gubWpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvdXRpbHMvaXMuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy91dGlscy9hbmltYXRpb24uanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy91dGlscy9icm93c2VyLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvdXRpbHMvb2JqZWN0cy5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3V0aWxzL2VsZW1lbnRzLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvc3VwcG9ydC5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3V0aWxzL2V2ZW50cy5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3V0aWxzL3Byb21pc2UuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy91dGlscy9hcnJheXMuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy91dGlscy9zdHlsZS5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL2h0bWw1LmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvdXRpbHMvc3RyaW5ncy5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3V0aWxzL2kxOG4uanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy9zdG9yYWdlLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvdXRpbHMvZmV0Y2guanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy91dGlscy9sb2FkLXNwcml0ZS5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3V0aWxzL3RpbWUuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy9jb250cm9scy5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3V0aWxzL3VybHMuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy9jYXB0aW9ucy5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL2NvbmZpZy9kZWZhdWx0cy5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL2NvbmZpZy9zdGF0ZXMuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy9jb25maWcvdHlwZXMuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy9jb25zb2xlLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvZnVsbHNjcmVlbi5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3V0aWxzL2xvYWQtaW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy91aS5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL2xpc3RlbmVycy5qcyIsIndlYnBhY2s6Ly9yZXMvbm9kZV9tb2R1bGVzL2xvYWRqcy9kaXN0L2xvYWRqcy51bWQuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy91dGlscy9sb2FkLXNjcmlwdC5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3BsdWdpbnMvdmltZW8uanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy9wbHVnaW5zL3lvdXR1YmUuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy9tZWRpYS5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3BsdWdpbnMvYWRzLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvdXRpbHMvbnVtYmVycy5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3BsdWdpbnMvcHJldmlldy10aHVtYm5haWxzLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvc291cmNlLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvcGx5ci5qcyIsIndlYnBhY2s6Ly9yZXMvLi9zcmMvYXNzZXRzL2pzL015U3dpcGVyLmpzIiwid2VicGFjazovL3Jlcy8uL3NyYy9hc3NldHMvanMvYW5pbWF0aW9uLmpzIiwid2VicGFjazovL3Jlcy8uL3NyYy9hc3NldHMvanMvYnV0dG9uLmpzIiwid2VicGFjazovL3Jlcy8uL3NyYy9hc3NldHMvanMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3Jlcy8uL3NyYy9hc3NldHMvanMvZ2FsU3dpcGVyLmpzIiwid2VicGFjazovL3Jlcy8uL3NyYy9hc3NldHMvanMvaGVhZGVyLmpzIiwid2VicGFjazovL3Jlcy8uL3NyYy9hc3NldHMvanMvcG9wdXAuanMiLCJ3ZWJwYWNrOi8vcmVzLy4vc3JjL2Fzc2V0cy9qcy9zZG91YmxlLmpzIiwid2VicGFjazovL3Jlcy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9yZXMvd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vcmVzL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9yZXMvd2VicGFjay9ydW50aW1lL2dsb2JhbCIsIndlYnBhY2s6Ly9yZXMvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9yZXMvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly9yZXMvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsidHlwZW9mIG5hdmlnYXRvciA9PT0gXCJvYmplY3RcIiAmJiAoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuICB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6XG4gIHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZSgnUGx5cicsIGZhY3RvcnkpIDpcbiAgKGdsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiBnbG9iYWwgfHwgc2VsZiwgZ2xvYmFsLlBseXIgPSBmYWN0b3J5KCkpO1xufSkodGhpcywgKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gIGZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eSQxKG9iaiwga2V5LCB2YWx1ZSkge1xuICAgIGlmIChrZXkgaW4gb2JqKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHtcbiAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgb2JqW2tleV0gPSB2YWx1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gb2JqO1xuICB9XG5cbiAgZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGUsIHQpIHtcbiAgICBpZiAoIShlIGluc3RhbmNlb2YgdCkpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7XG4gIH1cblxuICBmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyhlLCB0KSB7XG4gICAgZm9yICh2YXIgbiA9IDA7IG4gPCB0Lmxlbmd0aDsgbisrKSB7XG4gICAgICB2YXIgciA9IHRbbl07XG4gICAgICByLmVudW1lcmFibGUgPSByLmVudW1lcmFibGUgfHwgITEsIHIuY29uZmlndXJhYmxlID0gITAsIFwidmFsdWVcIiBpbiByICYmIChyLndyaXRhYmxlID0gITApLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgci5rZXksIHIpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhlLCB0LCBuKSB7XG4gICAgcmV0dXJuIHQgJiYgX2RlZmluZVByb3BlcnRpZXMoZS5wcm90b3R5cGUsIHQpLCBuICYmIF9kZWZpbmVQcm9wZXJ0aWVzKGUsIG4pLCBlO1xuICB9XG5cbiAgZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KGUsIHQsIG4pIHtcbiAgICByZXR1cm4gdCBpbiBlID8gT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIHQsIHtcbiAgICAgIHZhbHVlOiBuLFxuICAgICAgZW51bWVyYWJsZTogITAsXG4gICAgICBjb25maWd1cmFibGU6ICEwLFxuICAgICAgd3JpdGFibGU6ICEwXG4gICAgfSkgOiBlW3RdID0gbiwgZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG93bktleXMoZSwgdCkge1xuICAgIHZhciBuID0gT2JqZWN0LmtleXMoZSk7XG5cbiAgICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykge1xuICAgICAgdmFyIHIgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO1xuICAgICAgdCAmJiAociA9IHIuZmlsdGVyKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsIHQpLmVudW1lcmFibGU7XG4gICAgICB9KSksIG4ucHVzaC5hcHBseShuLCByKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbjtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9vYmplY3RTcHJlYWQyKGUpIHtcbiAgICBmb3IgKHZhciB0ID0gMTsgdCA8IGFyZ3VtZW50cy5sZW5ndGg7IHQrKykge1xuICAgICAgdmFyIG4gPSBudWxsICE9IGFyZ3VtZW50c1t0XSA/IGFyZ3VtZW50c1t0XSA6IHt9O1xuICAgICAgdCAlIDIgPyBvd25LZXlzKE9iamVjdChuKSwgITApLmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgX2RlZmluZVByb3BlcnR5KGUsIHQsIG5bdF0pO1xuICAgICAgfSkgOiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKG4pKSA6IG93bktleXMoT2JqZWN0KG4pKS5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCB0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG4sIHQpKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBlO1xuICB9XG5cbiAgdmFyIGRlZmF1bHRzJDEgPSB7XG4gICAgYWRkQ1NTOiAhMCxcbiAgICB0aHVtYldpZHRoOiAxNSxcbiAgICB3YXRjaDogITBcbiAgfTtcblxuICBmdW5jdGlvbiBtYXRjaGVzJDEoZSwgdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHQpKS5pbmNsdWRlcyh0aGlzKTtcbiAgICB9LmNhbGwoZSwgdCk7XG4gIH1cblxuICBmdW5jdGlvbiB0cmlnZ2VyKGUsIHQpIHtcbiAgICBpZiAoZSAmJiB0KSB7XG4gICAgICB2YXIgbiA9IG5ldyBFdmVudCh0LCB7XG4gICAgICAgIGJ1YmJsZXM6ICEwXG4gICAgICB9KTtcbiAgICAgIGUuZGlzcGF0Y2hFdmVudChuKTtcbiAgICB9XG4gIH1cblxuICB2YXIgZ2V0Q29uc3RydWN0b3IkMSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIG51bGwgIT0gZSA/IGUuY29uc3RydWN0b3IgOiBudWxsO1xuICB9LFxuICAgICAgaW5zdGFuY2VPZiQxID0gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICByZXR1cm4gISEoZSAmJiB0ICYmIGUgaW5zdGFuY2VvZiB0KTtcbiAgfSxcbiAgICAgIGlzTnVsbE9yVW5kZWZpbmVkJDEgPSBmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBudWxsID09IGU7XG4gIH0sXG4gICAgICBpc09iamVjdCQxID0gZnVuY3Rpb24gKGUpIHtcbiAgICByZXR1cm4gZ2V0Q29uc3RydWN0b3IkMShlKSA9PT0gT2JqZWN0O1xuICB9LFxuICAgICAgaXNOdW1iZXIkMSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIGdldENvbnN0cnVjdG9yJDEoZSkgPT09IE51bWJlciAmJiAhTnVtYmVyLmlzTmFOKGUpO1xuICB9LFxuICAgICAgaXNTdHJpbmckMSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIGdldENvbnN0cnVjdG9yJDEoZSkgPT09IFN0cmluZztcbiAgfSxcbiAgICAgIGlzQm9vbGVhbiQxID0gZnVuY3Rpb24gKGUpIHtcbiAgICByZXR1cm4gZ2V0Q29uc3RydWN0b3IkMShlKSA9PT0gQm9vbGVhbjtcbiAgfSxcbiAgICAgIGlzRnVuY3Rpb24kMSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIGdldENvbnN0cnVjdG9yJDEoZSkgPT09IEZ1bmN0aW9uO1xuICB9LFxuICAgICAgaXNBcnJheSQxID0gZnVuY3Rpb24gKGUpIHtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheShlKTtcbiAgfSxcbiAgICAgIGlzTm9kZUxpc3QkMSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIGluc3RhbmNlT2YkMShlLCBOb2RlTGlzdCk7XG4gIH0sXG4gICAgICBpc0VsZW1lbnQkMSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIGluc3RhbmNlT2YkMShlLCBFbGVtZW50KTtcbiAgfSxcbiAgICAgIGlzRXZlbnQkMSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIGluc3RhbmNlT2YkMShlLCBFdmVudCk7XG4gIH0sXG4gICAgICBpc0VtcHR5JDEgPSBmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBpc051bGxPclVuZGVmaW5lZCQxKGUpIHx8IChpc1N0cmluZyQxKGUpIHx8IGlzQXJyYXkkMShlKSB8fCBpc05vZGVMaXN0JDEoZSkpICYmICFlLmxlbmd0aCB8fCBpc09iamVjdCQxKGUpICYmICFPYmplY3Qua2V5cyhlKS5sZW5ndGg7XG4gIH0sXG4gICAgICBpcyQxID0ge1xuICAgIG51bGxPclVuZGVmaW5lZDogaXNOdWxsT3JVbmRlZmluZWQkMSxcbiAgICBvYmplY3Q6IGlzT2JqZWN0JDEsXG4gICAgbnVtYmVyOiBpc051bWJlciQxLFxuICAgIHN0cmluZzogaXNTdHJpbmckMSxcbiAgICBib29sZWFuOiBpc0Jvb2xlYW4kMSxcbiAgICBmdW5jdGlvbjogaXNGdW5jdGlvbiQxLFxuICAgIGFycmF5OiBpc0FycmF5JDEsXG4gICAgbm9kZUxpc3Q6IGlzTm9kZUxpc3QkMSxcbiAgICBlbGVtZW50OiBpc0VsZW1lbnQkMSxcbiAgICBldmVudDogaXNFdmVudCQxLFxuICAgIGVtcHR5OiBpc0VtcHR5JDFcbiAgfTtcblxuICBmdW5jdGlvbiBnZXREZWNpbWFsUGxhY2VzKGUpIHtcbiAgICB2YXIgdCA9IFwiXCIuY29uY2F0KGUpLm1hdGNoKC8oPzpcXC4oXFxkKykpPyg/OltlRV0oWystXT9cXGQrKSk/JC8pO1xuICAgIHJldHVybiB0ID8gTWF0aC5tYXgoMCwgKHRbMV0gPyB0WzFdLmxlbmd0aCA6IDApIC0gKHRbMl0gPyArdFsyXSA6IDApKSA6IDA7XG4gIH1cblxuICBmdW5jdGlvbiByb3VuZChlLCB0KSB7XG4gICAgaWYgKDEgPiB0KSB7XG4gICAgICB2YXIgbiA9IGdldERlY2ltYWxQbGFjZXModCk7XG4gICAgICByZXR1cm4gcGFyc2VGbG9hdChlLnRvRml4ZWQobikpO1xuICAgIH1cblxuICAgIHJldHVybiBNYXRoLnJvdW5kKGUgLyB0KSAqIHQ7XG4gIH1cblxuICB2YXIgUmFuZ2VUb3VjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBlKHQsIG4pIHtcbiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBlKSwgaXMkMS5lbGVtZW50KHQpID8gdGhpcy5lbGVtZW50ID0gdCA6IGlzJDEuc3RyaW5nKHQpICYmICh0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHQpKSwgaXMkMS5lbGVtZW50KHRoaXMuZWxlbWVudCkgJiYgaXMkMS5lbXB0eSh0aGlzLmVsZW1lbnQucmFuZ2VUb3VjaCkgJiYgKHRoaXMuY29uZmlnID0gX29iamVjdFNwcmVhZDIoe30sIGRlZmF1bHRzJDEsIHt9LCBuKSwgdGhpcy5pbml0KCkpO1xuICAgIH1cblxuICAgIHJldHVybiBfY3JlYXRlQ2xhc3MoZSwgW3tcbiAgICAgIGtleTogXCJpbml0XCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICBlLmVuYWJsZWQgJiYgKHRoaXMuY29uZmlnLmFkZENTUyAmJiAodGhpcy5lbGVtZW50LnN0eWxlLnVzZXJTZWxlY3QgPSBcIm5vbmVcIiwgdGhpcy5lbGVtZW50LnN0eWxlLndlYktpdFVzZXJTZWxlY3QgPSBcIm5vbmVcIiwgdGhpcy5lbGVtZW50LnN0eWxlLnRvdWNoQWN0aW9uID0gXCJtYW5pcHVsYXRpb25cIiksIHRoaXMubGlzdGVuZXJzKCEwKSwgdGhpcy5lbGVtZW50LnJhbmdlVG91Y2ggPSB0aGlzKTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6IFwiZGVzdHJveVwiLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZS5lbmFibGVkICYmICh0aGlzLmNvbmZpZy5hZGRDU1MgJiYgKHRoaXMuZWxlbWVudC5zdHlsZS51c2VyU2VsZWN0ID0gXCJcIiwgdGhpcy5lbGVtZW50LnN0eWxlLndlYktpdFVzZXJTZWxlY3QgPSBcIlwiLCB0aGlzLmVsZW1lbnQuc3R5bGUudG91Y2hBY3Rpb24gPSBcIlwiKSwgdGhpcy5saXN0ZW5lcnMoITEpLCB0aGlzLmVsZW1lbnQucmFuZ2VUb3VjaCA9IG51bGwpO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogXCJsaXN0ZW5lcnNcIixcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgdCA9IHRoaXMsXG4gICAgICAgICAgICBuID0gZSA/IFwiYWRkRXZlbnRMaXN0ZW5lclwiIDogXCJyZW1vdmVFdmVudExpc3RlbmVyXCI7XG4gICAgICAgIFtcInRvdWNoc3RhcnRcIiwgXCJ0b3VjaG1vdmVcIiwgXCJ0b3VjaGVuZFwiXS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdC5lbGVtZW50W25dKGUsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gdC5zZXQoZSk7XG4gICAgICAgICAgfSwgITEpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6IFwiZ2V0XCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgaWYgKCFlLmVuYWJsZWQgfHwgIWlzJDEuZXZlbnQodCkpIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgbixcbiAgICAgICAgICAgIHIgPSB0LnRhcmdldCxcbiAgICAgICAgICAgIGkgPSB0LmNoYW5nZWRUb3VjaGVzWzBdLFxuICAgICAgICAgICAgbyA9IHBhcnNlRmxvYXQoci5nZXRBdHRyaWJ1dGUoXCJtaW5cIikpIHx8IDAsXG4gICAgICAgICAgICBzID0gcGFyc2VGbG9hdChyLmdldEF0dHJpYnV0ZShcIm1heFwiKSkgfHwgMTAwLFxuICAgICAgICAgICAgdSA9IHBhcnNlRmxvYXQoci5nZXRBdHRyaWJ1dGUoXCJzdGVwXCIpKSB8fCAxLFxuICAgICAgICAgICAgYyA9IHIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgICAgICBhID0gMTAwIC8gYy53aWR0aCAqICh0aGlzLmNvbmZpZy50aHVtYldpZHRoIC8gMikgLyAxMDA7XG4gICAgICAgIHJldHVybiAwID4gKG4gPSAxMDAgLyBjLndpZHRoICogKGkuY2xpZW50WCAtIGMubGVmdCkpID8gbiA9IDAgOiAxMDAgPCBuICYmIChuID0gMTAwKSwgNTAgPiBuID8gbiAtPSAoMTAwIC0gMiAqIG4pICogYSA6IDUwIDwgbiAmJiAobiArPSAyICogKG4gLSA1MCkgKiBhKSwgbyArIHJvdW5kKG4gLyAxMDAgKiAocyAtIG8pLCB1KTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6IFwic2V0XCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgZS5lbmFibGVkICYmIGlzJDEuZXZlbnQodCkgJiYgIXQudGFyZ2V0LmRpc2FibGVkICYmICh0LnByZXZlbnREZWZhdWx0KCksIHQudGFyZ2V0LnZhbHVlID0gdGhpcy5nZXQodCksIHRyaWdnZXIodC50YXJnZXQsIFwidG91Y2hlbmRcIiA9PT0gdC50eXBlID8gXCJjaGFuZ2VcIiA6IFwiaW5wdXRcIikpO1xuICAgICAgfVxuICAgIH1dLCBbe1xuICAgICAga2V5OiBcInNldHVwXCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdmFyIG4gPSAxIDwgYXJndW1lbnRzLmxlbmd0aCAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1sxXSA/IGFyZ3VtZW50c1sxXSA6IHt9LFxuICAgICAgICAgICAgciA9IG51bGw7XG4gICAgICAgIGlmIChpcyQxLmVtcHR5KHQpIHx8IGlzJDEuc3RyaW5nKHQpID8gciA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChpcyQxLnN0cmluZyh0KSA/IHQgOiAnaW5wdXRbdHlwZT1cInJhbmdlXCJdJykpIDogaXMkMS5lbGVtZW50KHQpID8gciA9IFt0XSA6IGlzJDEubm9kZUxpc3QodCkgPyByID0gQXJyYXkuZnJvbSh0KSA6IGlzJDEuYXJyYXkodCkgJiYgKHIgPSB0LmZpbHRlcihpcyQxLmVsZW1lbnQpKSwgaXMkMS5lbXB0eShyKSkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgdmFyIGkgPSBfb2JqZWN0U3ByZWFkMih7fSwgZGVmYXVsdHMkMSwge30sIG4pO1xuXG4gICAgICAgIGlmIChpcyQxLnN0cmluZyh0KSAmJiBpLndhdGNoKSB7XG4gICAgICAgICAgdmFyIG8gPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgQXJyYXkuZnJvbShuKS5mb3JFYWNoKGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgIEFycmF5LmZyb20obi5hZGRlZE5vZGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgaXMkMS5lbGVtZW50KG4pICYmIG1hdGNoZXMkMShuLCB0KSAmJiBuZXcgZShuLCBpKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBvLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge1xuICAgICAgICAgICAgY2hpbGRMaXN0OiAhMCxcbiAgICAgICAgICAgIHN1YnRyZWU6ICEwXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gci5tYXAoZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IGUodCwgbik7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogXCJlbmFibGVkXCIsXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwib250b3VjaHN0YXJ0XCIgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuICAgICAgfVxuICAgIH1dKSwgZTtcbiAgfSgpO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFR5cGUgY2hlY2tpbmcgdXRpbHNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgY29uc3QgZ2V0Q29uc3RydWN0b3IgPSBpbnB1dCA9PiBpbnB1dCAhPT0gbnVsbCAmJiB0eXBlb2YgaW5wdXQgIT09ICd1bmRlZmluZWQnID8gaW5wdXQuY29uc3RydWN0b3IgOiBudWxsO1xuXG4gIGNvbnN0IGluc3RhbmNlT2YgPSAoaW5wdXQsIGNvbnN0cnVjdG9yKSA9PiBCb29sZWFuKGlucHV0ICYmIGNvbnN0cnVjdG9yICYmIGlucHV0IGluc3RhbmNlb2YgY29uc3RydWN0b3IpO1xuXG4gIGNvbnN0IGlzTnVsbE9yVW5kZWZpbmVkID0gaW5wdXQgPT4gaW5wdXQgPT09IG51bGwgfHwgdHlwZW9mIGlucHV0ID09PSAndW5kZWZpbmVkJztcblxuICBjb25zdCBpc09iamVjdCA9IGlucHV0ID0+IGdldENvbnN0cnVjdG9yKGlucHV0KSA9PT0gT2JqZWN0O1xuXG4gIGNvbnN0IGlzTnVtYmVyID0gaW5wdXQgPT4gZ2V0Q29uc3RydWN0b3IoaW5wdXQpID09PSBOdW1iZXIgJiYgIU51bWJlci5pc05hTihpbnB1dCk7XG5cbiAgY29uc3QgaXNTdHJpbmcgPSBpbnB1dCA9PiBnZXRDb25zdHJ1Y3RvcihpbnB1dCkgPT09IFN0cmluZztcblxuICBjb25zdCBpc0Jvb2xlYW4gPSBpbnB1dCA9PiBnZXRDb25zdHJ1Y3RvcihpbnB1dCkgPT09IEJvb2xlYW47XG5cbiAgY29uc3QgaXNGdW5jdGlvbiA9IGlucHV0ID0+IGdldENvbnN0cnVjdG9yKGlucHV0KSA9PT0gRnVuY3Rpb247XG5cbiAgY29uc3QgaXNBcnJheSA9IGlucHV0ID0+IEFycmF5LmlzQXJyYXkoaW5wdXQpO1xuXG4gIGNvbnN0IGlzV2Vha01hcCA9IGlucHV0ID0+IGluc3RhbmNlT2YoaW5wdXQsIFdlYWtNYXApO1xuXG4gIGNvbnN0IGlzTm9kZUxpc3QgPSBpbnB1dCA9PiBpbnN0YW5jZU9mKGlucHV0LCBOb2RlTGlzdCk7XG5cbiAgY29uc3QgaXNUZXh0Tm9kZSA9IGlucHV0ID0+IGdldENvbnN0cnVjdG9yKGlucHV0KSA9PT0gVGV4dDtcblxuICBjb25zdCBpc0V2ZW50ID0gaW5wdXQgPT4gaW5zdGFuY2VPZihpbnB1dCwgRXZlbnQpO1xuXG4gIGNvbnN0IGlzS2V5Ym9hcmRFdmVudCA9IGlucHV0ID0+IGluc3RhbmNlT2YoaW5wdXQsIEtleWJvYXJkRXZlbnQpO1xuXG4gIGNvbnN0IGlzQ3VlID0gaW5wdXQgPT4gaW5zdGFuY2VPZihpbnB1dCwgd2luZG93LlRleHRUcmFja0N1ZSkgfHwgaW5zdGFuY2VPZihpbnB1dCwgd2luZG93LlZUVEN1ZSk7XG5cbiAgY29uc3QgaXNUcmFjayA9IGlucHV0ID0+IGluc3RhbmNlT2YoaW5wdXQsIFRleHRUcmFjaykgfHwgIWlzTnVsbE9yVW5kZWZpbmVkKGlucHV0KSAmJiBpc1N0cmluZyhpbnB1dC5raW5kKTtcblxuICBjb25zdCBpc1Byb21pc2UgPSBpbnB1dCA9PiBpbnN0YW5jZU9mKGlucHV0LCBQcm9taXNlKSAmJiBpc0Z1bmN0aW9uKGlucHV0LnRoZW4pO1xuXG4gIGNvbnN0IGlzRWxlbWVudCA9IGlucHV0ID0+IGlucHV0ICE9PSBudWxsICYmIHR5cGVvZiBpbnB1dCA9PT0gJ29iamVjdCcgJiYgaW5wdXQubm9kZVR5cGUgPT09IDEgJiYgdHlwZW9mIGlucHV0LnN0eWxlID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgaW5wdXQub3duZXJEb2N1bWVudCA9PT0gJ29iamVjdCc7XG5cbiAgY29uc3QgaXNFbXB0eSA9IGlucHV0ID0+IGlzTnVsbE9yVW5kZWZpbmVkKGlucHV0KSB8fCAoaXNTdHJpbmcoaW5wdXQpIHx8IGlzQXJyYXkoaW5wdXQpIHx8IGlzTm9kZUxpc3QoaW5wdXQpKSAmJiAhaW5wdXQubGVuZ3RoIHx8IGlzT2JqZWN0KGlucHV0KSAmJiAhT2JqZWN0LmtleXMoaW5wdXQpLmxlbmd0aDtcblxuICBjb25zdCBpc1VybCA9IGlucHV0ID0+IHtcbiAgICAvLyBBY2NlcHQgYSBVUkwgb2JqZWN0XG4gICAgaWYgKGluc3RhbmNlT2YoaW5wdXQsIHdpbmRvdy5VUkwpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IC8vIE11c3QgYmUgc3RyaW5nIGZyb20gaGVyZVxuXG5cbiAgICBpZiAoIWlzU3RyaW5nKGlucHV0KSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gLy8gQWRkIHRoZSBwcm90b2NvbCBpZiByZXF1aXJlZFxuXG5cbiAgICBsZXQgc3RyaW5nID0gaW5wdXQ7XG5cbiAgICBpZiAoIWlucHV0LnN0YXJ0c1dpdGgoJ2h0dHA6Ly8nKSB8fCAhaW5wdXQuc3RhcnRzV2l0aCgnaHR0cHM6Ly8nKSkge1xuICAgICAgc3RyaW5nID0gYGh0dHA6Ly8ke2lucHV0fWA7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiAhaXNFbXB0eShuZXcgVVJMKHN0cmluZykuaG9zdG5hbWUpO1xuICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGlzID0ge1xuICAgIG51bGxPclVuZGVmaW5lZDogaXNOdWxsT3JVbmRlZmluZWQsXG4gICAgb2JqZWN0OiBpc09iamVjdCxcbiAgICBudW1iZXI6IGlzTnVtYmVyLFxuICAgIHN0cmluZzogaXNTdHJpbmcsXG4gICAgYm9vbGVhbjogaXNCb29sZWFuLFxuICAgIGZ1bmN0aW9uOiBpc0Z1bmN0aW9uLFxuICAgIGFycmF5OiBpc0FycmF5LFxuICAgIHdlYWtNYXA6IGlzV2Vha01hcCxcbiAgICBub2RlTGlzdDogaXNOb2RlTGlzdCxcbiAgICBlbGVtZW50OiBpc0VsZW1lbnQsXG4gICAgdGV4dE5vZGU6IGlzVGV4dE5vZGUsXG4gICAgZXZlbnQ6IGlzRXZlbnQsXG4gICAga2V5Ym9hcmRFdmVudDogaXNLZXlib2FyZEV2ZW50LFxuICAgIGN1ZTogaXNDdWUsXG4gICAgdHJhY2s6IGlzVHJhY2ssXG4gICAgcHJvbWlzZTogaXNQcm9taXNlLFxuICAgIHVybDogaXNVcmwsXG4gICAgZW1wdHk6IGlzRW1wdHlcbiAgfTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBjb25zdCB0cmFuc2l0aW9uRW5kRXZlbnQgPSAoKCkgPT4ge1xuICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgY29uc3QgZXZlbnRzID0ge1xuICAgICAgV2Via2l0VHJhbnNpdGlvbjogJ3dlYmtpdFRyYW5zaXRpb25FbmQnLFxuICAgICAgTW96VHJhbnNpdGlvbjogJ3RyYW5zaXRpb25lbmQnLFxuICAgICAgT1RyYW5zaXRpb246ICdvVHJhbnNpdGlvbkVuZCBvdHJhbnNpdGlvbmVuZCcsXG4gICAgICB0cmFuc2l0aW9uOiAndHJhbnNpdGlvbmVuZCdcbiAgICB9O1xuICAgIGNvbnN0IHR5cGUgPSBPYmplY3Qua2V5cyhldmVudHMpLmZpbmQoZXZlbnQgPT4gZWxlbWVudC5zdHlsZVtldmVudF0gIT09IHVuZGVmaW5lZCk7XG4gICAgcmV0dXJuIGlzLnN0cmluZyh0eXBlKSA/IGV2ZW50c1t0eXBlXSA6IGZhbHNlO1xuICB9KSgpOyAvLyBGb3JjZSByZXBhaW50IG9mIGVsZW1lbnRcblxuICBmdW5jdGlvbiByZXBhaW50KGVsZW1lbnQsIGRlbGF5KSB7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgICAgZWxlbWVudC5oaWRkZW4gPSB0cnVlOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLWV4cHJlc3Npb25zXG5cbiAgICAgICAgZWxlbWVudC5vZmZzZXRIZWlnaHQ7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuXG4gICAgICAgIGVsZW1lbnQuaGlkZGVuID0gZmFsc2U7XG4gICAgICB9IGNhdGNoIChfKSB7Ly8gRG8gbm90aGluZ1xuICAgICAgfVxuICAgIH0sIGRlbGF5KTtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIEJyb3dzZXIgc25pZmZpbmdcbiAgLy8gVW5mb3J0dW5hdGVseSwgZHVlIHRvIG1peGVkIHN1cHBvcnQsIFVBIHNuaWZmaW5nIGlzIHJlcXVpcmVkXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IGJyb3dzZXIgPSB7XG4gICAgaXNJRTogQm9vbGVhbih3aW5kb3cuZG9jdW1lbnQuZG9jdW1lbnRNb2RlKSxcbiAgICBpc0VkZ2U6IHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdFZGdlJyksXG4gICAgaXNXZWJraXQ6ICdXZWJraXRBcHBlYXJhbmNlJyBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUgJiYgIS9FZGdlLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLFxuICAgIGlzSVBob25lOiAvKGlQaG9uZXxpUG9kKS9naS50ZXN0KG5hdmlnYXRvci5wbGF0Zm9ybSksXG4gICAgaXNJb3M6IG5hdmlnYXRvci5wbGF0Zm9ybSA9PT0gJ01hY0ludGVsJyAmJiBuYXZpZ2F0b3IubWF4VG91Y2hQb2ludHMgPiAxIHx8IC8oaVBhZHxpUGhvbmV8aVBvZCkvZ2kudGVzdChuYXZpZ2F0b3IucGxhdGZvcm0pXG4gIH07XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBmdW5jdGlvbiBjbG9uZURlZXAob2JqZWN0KSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqZWN0KSk7XG4gIH0gLy8gR2V0IGEgbmVzdGVkIHZhbHVlIGluIGFuIG9iamVjdFxuXG4gIGZ1bmN0aW9uIGdldERlZXAob2JqZWN0LCBwYXRoKSB7XG4gICAgcmV0dXJuIHBhdGguc3BsaXQoJy4nKS5yZWR1Y2UoKG9iaiwga2V5KSA9PiBvYmogJiYgb2JqW2tleV0sIG9iamVjdCk7XG4gIH0gLy8gRGVlcCBleHRlbmQgZGVzdGluYXRpb24gb2JqZWN0IHdpdGggTiBtb3JlIG9iamVjdHNcblxuICBmdW5jdGlvbiBleHRlbmQodGFyZ2V0ID0ge30sIC4uLnNvdXJjZXMpIHtcbiAgICBpZiAoIXNvdXJjZXMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH1cblxuICAgIGNvbnN0IHNvdXJjZSA9IHNvdXJjZXMuc2hpZnQoKTtcblxuICAgIGlmICghaXMub2JqZWN0KHNvdXJjZSkpIHtcbiAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfVxuXG4gICAgT2JqZWN0LmtleXMoc291cmNlKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICBpZiAoaXMub2JqZWN0KHNvdXJjZVtrZXldKSkge1xuICAgICAgICBpZiAoIU9iamVjdC5rZXlzKHRhcmdldCkuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgICAgIE9iamVjdC5hc3NpZ24odGFyZ2V0LCB7XG4gICAgICAgICAgICBba2V5XToge31cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGV4dGVuZCh0YXJnZXRba2V5XSwgc291cmNlW2tleV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHtcbiAgICAgICAgICBba2V5XTogc291cmNlW2tleV1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGV4dGVuZCh0YXJnZXQsIC4uLnNvdXJjZXMpO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBmdW5jdGlvbiB3cmFwKGVsZW1lbnRzLCB3cmFwcGVyKSB7XG4gICAgLy8gQ29udmVydCBgZWxlbWVudHNgIHRvIGFuIGFycmF5LCBpZiBuZWNlc3NhcnkuXG4gICAgY29uc3QgdGFyZ2V0cyA9IGVsZW1lbnRzLmxlbmd0aCA/IGVsZW1lbnRzIDogW2VsZW1lbnRzXTsgLy8gTG9vcHMgYmFja3dhcmRzIHRvIHByZXZlbnQgaGF2aW5nIHRvIGNsb25lIHRoZSB3cmFwcGVyIG9uIHRoZVxuICAgIC8vIGZpcnN0IGVsZW1lbnQgKHNlZSBgY2hpbGRgIGJlbG93KS5cblxuICAgIEFycmF5LmZyb20odGFyZ2V0cykucmV2ZXJzZSgpLmZvckVhY2goKGVsZW1lbnQsIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBjaGlsZCA9IGluZGV4ID4gMCA/IHdyYXBwZXIuY2xvbmVOb2RlKHRydWUpIDogd3JhcHBlcjsgLy8gQ2FjaGUgdGhlIGN1cnJlbnQgcGFyZW50IGFuZCBzaWJsaW5nLlxuXG4gICAgICBjb25zdCBwYXJlbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XG4gICAgICBjb25zdCBzaWJsaW5nID0gZWxlbWVudC5uZXh0U2libGluZzsgLy8gV3JhcCB0aGUgZWxlbWVudCAoaXMgYXV0b21hdGljYWxseSByZW1vdmVkIGZyb20gaXRzIGN1cnJlbnRcbiAgICAgIC8vIHBhcmVudCkuXG5cbiAgICAgIGNoaWxkLmFwcGVuZENoaWxkKGVsZW1lbnQpOyAvLyBJZiB0aGUgZWxlbWVudCBoYWQgYSBzaWJsaW5nLCBpbnNlcnQgdGhlIHdyYXBwZXIgYmVmb3JlXG4gICAgICAvLyB0aGUgc2libGluZyB0byBtYWludGFpbiB0aGUgSFRNTCBzdHJ1Y3R1cmU7IG90aGVyd2lzZSwganVzdFxuICAgICAgLy8gYXBwZW5kIGl0IHRvIHRoZSBwYXJlbnQuXG5cbiAgICAgIGlmIChzaWJsaW5nKSB7XG4gICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUoY2hpbGQsIHNpYmxpbmcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKGNoaWxkKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSAvLyBTZXQgYXR0cmlidXRlc1xuXG4gIGZ1bmN0aW9uIHNldEF0dHJpYnV0ZXMoZWxlbWVudCwgYXR0cmlidXRlcykge1xuICAgIGlmICghaXMuZWxlbWVudChlbGVtZW50KSB8fCBpcy5lbXB0eShhdHRyaWJ1dGVzKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH0gLy8gQXNzdW1lIG51bGwgYW5kIHVuZGVmaW5lZCBhdHRyaWJ1dGVzIHNob3VsZCBiZSBsZWZ0IG91dCxcbiAgICAvLyBTZXR0aW5nIHRoZW0gd291bGQgb3RoZXJ3aXNlIGNvbnZlcnQgdGhlbSB0byBcIm51bGxcIiBhbmQgXCJ1bmRlZmluZWRcIlxuXG5cbiAgICBPYmplY3QuZW50cmllcyhhdHRyaWJ1dGVzKS5maWx0ZXIoKFssIHZhbHVlXSkgPT4gIWlzLm51bGxPclVuZGVmaW5lZCh2YWx1ZSkpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4gZWxlbWVudC5zZXRBdHRyaWJ1dGUoa2V5LCB2YWx1ZSkpO1xuICB9IC8vIENyZWF0ZSBhIERvY3VtZW50RnJhZ21lbnRcblxuICBmdW5jdGlvbiBjcmVhdGVFbGVtZW50KHR5cGUsIGF0dHJpYnV0ZXMsIHRleHQpIHtcbiAgICAvLyBDcmVhdGUgYSBuZXcgPGVsZW1lbnQ+XG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodHlwZSk7IC8vIFNldCBhbGwgcGFzc2VkIGF0dHJpYnV0ZXNcblxuICAgIGlmIChpcy5vYmplY3QoYXR0cmlidXRlcykpIHtcbiAgICAgIHNldEF0dHJpYnV0ZXMoZWxlbWVudCwgYXR0cmlidXRlcyk7XG4gICAgfSAvLyBBZGQgdGV4dCBub2RlXG5cblxuICAgIGlmIChpcy5zdHJpbmcodGV4dCkpIHtcbiAgICAgIGVsZW1lbnQuaW5uZXJUZXh0ID0gdGV4dDtcbiAgICB9IC8vIFJldHVybiBidWlsdCBlbGVtZW50XG5cblxuICAgIHJldHVybiBlbGVtZW50O1xuICB9IC8vIEluYWVydCBhbiBlbGVtZW50IGFmdGVyIGFub3RoZXJcblxuICBmdW5jdGlvbiBpbnNlcnRBZnRlcihlbGVtZW50LCB0YXJnZXQpIHtcbiAgICBpZiAoIWlzLmVsZW1lbnQoZWxlbWVudCkgfHwgIWlzLmVsZW1lbnQodGFyZ2V0KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRhcmdldC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlbGVtZW50LCB0YXJnZXQubmV4dFNpYmxpbmcpO1xuICB9IC8vIEluc2VydCBhIERvY3VtZW50RnJhZ21lbnRcblxuICBmdW5jdGlvbiBpbnNlcnRFbGVtZW50KHR5cGUsIHBhcmVudCwgYXR0cmlidXRlcywgdGV4dCkge1xuICAgIGlmICghaXMuZWxlbWVudChwYXJlbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgcGFyZW50LmFwcGVuZENoaWxkKGNyZWF0ZUVsZW1lbnQodHlwZSwgYXR0cmlidXRlcywgdGV4dCkpO1xuICB9IC8vIFJlbW92ZSBlbGVtZW50KHMpXG5cbiAgZnVuY3Rpb24gcmVtb3ZlRWxlbWVudChlbGVtZW50KSB7XG4gICAgaWYgKGlzLm5vZGVMaXN0KGVsZW1lbnQpIHx8IGlzLmFycmF5KGVsZW1lbnQpKSB7XG4gICAgICBBcnJheS5mcm9tKGVsZW1lbnQpLmZvckVhY2gocmVtb3ZlRWxlbWVudCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCFpcy5lbGVtZW50KGVsZW1lbnQpIHx8ICFpcy5lbGVtZW50KGVsZW1lbnQucGFyZW50Tm9kZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBlbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG4gIH0gLy8gUmVtb3ZlIGFsbCBjaGlsZCBlbGVtZW50c1xuXG4gIGZ1bmN0aW9uIGVtcHR5RWxlbWVudChlbGVtZW50KSB7XG4gICAgaWYgKCFpcy5lbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IHtcbiAgICAgIGxlbmd0aFxuICAgIH0gPSBlbGVtZW50LmNoaWxkTm9kZXM7XG5cbiAgICB3aGlsZSAobGVuZ3RoID4gMCkge1xuICAgICAgZWxlbWVudC5yZW1vdmVDaGlsZChlbGVtZW50Lmxhc3RDaGlsZCk7XG4gICAgICBsZW5ndGggLT0gMTtcbiAgICB9XG4gIH0gLy8gUmVwbGFjZSBlbGVtZW50XG5cbiAgZnVuY3Rpb24gcmVwbGFjZUVsZW1lbnQobmV3Q2hpbGQsIG9sZENoaWxkKSB7XG4gICAgaWYgKCFpcy5lbGVtZW50KG9sZENoaWxkKSB8fCAhaXMuZWxlbWVudChvbGRDaGlsZC5wYXJlbnROb2RlKSB8fCAhaXMuZWxlbWVudChuZXdDaGlsZCkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIG9sZENoaWxkLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKG5ld0NoaWxkLCBvbGRDaGlsZCk7XG4gICAgcmV0dXJuIG5ld0NoaWxkO1xuICB9IC8vIEdldCBhbiBhdHRyaWJ1dGUgb2JqZWN0IGZyb20gYSBzdHJpbmcgc2VsZWN0b3JcblxuICBmdW5jdGlvbiBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHNlbCwgZXhpc3RpbmdBdHRyaWJ1dGVzKSB7XG4gICAgLy8gRm9yIGV4YW1wbGU6XG4gICAgLy8gJy50ZXN0JyB0byB7IGNsYXNzOiAndGVzdCcgfVxuICAgIC8vICcjdGVzdCcgdG8geyBpZDogJ3Rlc3QnIH1cbiAgICAvLyAnW2RhdGEtdGVzdD1cInRlc3RcIl0nIHRvIHsgJ2RhdGEtdGVzdCc6ICd0ZXN0JyB9XG4gICAgaWYgKCFpcy5zdHJpbmcoc2VsKSB8fCBpcy5lbXB0eShzZWwpKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuXG4gICAgY29uc3QgYXR0cmlidXRlcyA9IHt9O1xuICAgIGNvbnN0IGV4aXN0aW5nID0gZXh0ZW5kKHt9LCBleGlzdGluZ0F0dHJpYnV0ZXMpO1xuICAgIHNlbC5zcGxpdCgnLCcpLmZvckVhY2gocyA9PiB7XG4gICAgICAvLyBSZW1vdmUgd2hpdGVzcGFjZVxuICAgICAgY29uc3Qgc2VsZWN0b3IgPSBzLnRyaW0oKTtcbiAgICAgIGNvbnN0IGNsYXNzTmFtZSA9IHNlbGVjdG9yLnJlcGxhY2UoJy4nLCAnJyk7XG4gICAgICBjb25zdCBzdHJpcHBlZCA9IHNlbGVjdG9yLnJlcGxhY2UoL1tbXFxdXS9nLCAnJyk7IC8vIEdldCB0aGUgcGFydHMgYW5kIHZhbHVlXG5cbiAgICAgIGNvbnN0IHBhcnRzID0gc3RyaXBwZWQuc3BsaXQoJz0nKTtcbiAgICAgIGNvbnN0IFtrZXldID0gcGFydHM7XG4gICAgICBjb25zdCB2YWx1ZSA9IHBhcnRzLmxlbmd0aCA+IDEgPyBwYXJ0c1sxXS5yZXBsYWNlKC9bXCInXS9nLCAnJykgOiAnJzsgLy8gR2V0IHRoZSBmaXJzdCBjaGFyYWN0ZXJcblxuICAgICAgY29uc3Qgc3RhcnQgPSBzZWxlY3Rvci5jaGFyQXQoMCk7XG5cbiAgICAgIHN3aXRjaCAoc3RhcnQpIHtcbiAgICAgICAgY2FzZSAnLic6XG4gICAgICAgICAgLy8gQWRkIHRvIGV4aXN0aW5nIGNsYXNzbmFtZVxuICAgICAgICAgIGlmIChpcy5zdHJpbmcoZXhpc3RpbmcuY2xhc3MpKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzID0gYCR7ZXhpc3RpbmcuY2xhc3N9ICR7Y2xhc3NOYW1lfWA7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMuY2xhc3MgPSBjbGFzc05hbWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnIyc6XG4gICAgICAgICAgLy8gSUQgc2VsZWN0b3JcbiAgICAgICAgICBhdHRyaWJ1dGVzLmlkID0gc2VsZWN0b3IucmVwbGFjZSgnIycsICcnKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdbJzpcbiAgICAgICAgICAvLyBBdHRyaWJ1dGUgc2VsZWN0b3JcbiAgICAgICAgICBhdHRyaWJ1dGVzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gZXh0ZW5kKGV4aXN0aW5nLCBhdHRyaWJ1dGVzKTtcbiAgfSAvLyBUb2dnbGUgaGlkZGVuXG5cbiAgZnVuY3Rpb24gdG9nZ2xlSGlkZGVuKGVsZW1lbnQsIGhpZGRlbikge1xuICAgIGlmICghaXMuZWxlbWVudChlbGVtZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBoaWRlID0gaGlkZGVuO1xuXG4gICAgaWYgKCFpcy5ib29sZWFuKGhpZGUpKSB7XG4gICAgICBoaWRlID0gIWVsZW1lbnQuaGlkZGVuO1xuICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG5cblxuICAgIGVsZW1lbnQuaGlkZGVuID0gaGlkZTtcbiAgfSAvLyBNaXJyb3IgRWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlLCB3aXRoIElFIGNvbXBhdGliaWxpdHkgZm9yIFwiZm9yY2VcIiBhcmd1bWVudFxuXG4gIGZ1bmN0aW9uIHRvZ2dsZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSwgZm9yY2UpIHtcbiAgICBpZiAoaXMubm9kZUxpc3QoZWxlbWVudCkpIHtcbiAgICAgIHJldHVybiBBcnJheS5mcm9tKGVsZW1lbnQpLm1hcChlID0+IHRvZ2dsZUNsYXNzKGUsIGNsYXNzTmFtZSwgZm9yY2UpKTtcbiAgICB9XG5cbiAgICBpZiAoaXMuZWxlbWVudChlbGVtZW50KSkge1xuICAgICAgbGV0IG1ldGhvZCA9ICd0b2dnbGUnO1xuXG4gICAgICBpZiAodHlwZW9mIGZvcmNlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBtZXRob2QgPSBmb3JjZSA/ICdhZGQnIDogJ3JlbW92ZSc7XG4gICAgICB9XG5cbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0W21ldGhvZF0oY2xhc3NOYW1lKTtcbiAgICAgIHJldHVybiBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfSAvLyBIYXMgY2xhc3MgbmFtZVxuXG4gIGZ1bmN0aW9uIGhhc0NsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgIHJldHVybiBpcy5lbGVtZW50KGVsZW1lbnQpICYmIGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSk7XG4gIH0gLy8gRWxlbWVudCBtYXRjaGVzIHNlbGVjdG9yXG5cbiAgZnVuY3Rpb24gbWF0Y2hlcyhlbGVtZW50LCBzZWxlY3Rvcikge1xuICAgIGNvbnN0IHtcbiAgICAgIHByb3RvdHlwZVxuICAgIH0gPSBFbGVtZW50O1xuXG4gICAgZnVuY3Rpb24gbWF0Y2goKSB7XG4gICAgICByZXR1cm4gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSkuaW5jbHVkZXModGhpcyk7XG4gICAgfVxuXG4gICAgY29uc3QgbWV0aG9kID0gcHJvdG90eXBlLm1hdGNoZXMgfHwgcHJvdG90eXBlLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fCBwcm90b3R5cGUubW96TWF0Y2hlc1NlbGVjdG9yIHx8IHByb3RvdHlwZS5tc01hdGNoZXNTZWxlY3RvciB8fCBtYXRjaDtcbiAgICByZXR1cm4gbWV0aG9kLmNhbGwoZWxlbWVudCwgc2VsZWN0b3IpO1xuICB9IC8vIENsb3Nlc3QgYW5jZXN0b3IgZWxlbWVudCBtYXRjaGluZyBzZWxlY3RvciAoYWxzbyB0ZXN0cyBlbGVtZW50IGl0c2VsZilcblxuICBmdW5jdGlvbiBjbG9zZXN0JDEoZWxlbWVudCwgc2VsZWN0b3IpIHtcbiAgICBjb25zdCB7XG4gICAgICBwcm90b3R5cGVcbiAgICB9ID0gRWxlbWVudDsgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0VsZW1lbnQvY2xvc2VzdCNQb2x5ZmlsbFxuXG4gICAgZnVuY3Rpb24gY2xvc2VzdEVsZW1lbnQoKSB7XG4gICAgICBsZXQgZWwgPSB0aGlzO1xuXG4gICAgICBkbyB7XG4gICAgICAgIGlmIChtYXRjaGVzLm1hdGNoZXMoZWwsIHNlbGVjdG9yKSkgcmV0dXJuIGVsO1xuICAgICAgICBlbCA9IGVsLnBhcmVudEVsZW1lbnQgfHwgZWwucGFyZW50Tm9kZTtcbiAgICAgIH0gd2hpbGUgKGVsICE9PSBudWxsICYmIGVsLm5vZGVUeXBlID09PSAxKTtcblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgbWV0aG9kID0gcHJvdG90eXBlLmNsb3Nlc3QgfHwgY2xvc2VzdEVsZW1lbnQ7XG4gICAgcmV0dXJuIG1ldGhvZC5jYWxsKGVsZW1lbnQsIHNlbGVjdG9yKTtcbiAgfSAvLyBGaW5kIGFsbCBlbGVtZW50c1xuXG4gIGZ1bmN0aW9uIGdldEVsZW1lbnRzKHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpO1xuICB9IC8vIEZpbmQgYSBzaW5nbGUgZWxlbWVudFxuXG4gIGZ1bmN0aW9uIGdldEVsZW1lbnQoc2VsZWN0b3IpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50cy5jb250YWluZXIucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH0gLy8gU2V0IGZvY3VzIGFuZCB0YWIgZm9jdXMgY2xhc3NcblxuICBmdW5jdGlvbiBzZXRGb2N1cyhlbGVtZW50ID0gbnVsbCwgdGFiRm9jdXMgPSBmYWxzZSkge1xuICAgIGlmICghaXMuZWxlbWVudChlbGVtZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH0gLy8gU2V0IHJlZ3VsYXIgZm9jdXNcblxuXG4gICAgZWxlbWVudC5mb2N1cyh7XG4gICAgICBwcmV2ZW50U2Nyb2xsOiB0cnVlXG4gICAgfSk7IC8vIElmIHdlIHdhbnQgdG8gbWltaWMga2V5Ym9hcmQgZm9jdXMgdmlhIHRhYlxuXG4gICAgaWYgKHRhYkZvY3VzKSB7XG4gICAgICB0b2dnbGVDbGFzcyhlbGVtZW50LCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnRhYkZvY3VzKTtcbiAgICB9XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGNvbnN0IGRlZmF1bHRDb2RlY3MgPSB7XG4gICAgJ2F1ZGlvL29nZyc6ICd2b3JiaXMnLFxuICAgICdhdWRpby93YXYnOiAnMScsXG4gICAgJ3ZpZGVvL3dlYm0nOiAndnA4LCB2b3JiaXMnLFxuICAgICd2aWRlby9tcDQnOiAnYXZjMS40MkUwMUUsIG1wNGEuNDAuMicsXG4gICAgJ3ZpZGVvL29nZyc6ICd0aGVvcmEnXG4gIH07IC8vIENoZWNrIGZvciBmZWF0dXJlIHN1cHBvcnRcblxuICBjb25zdCBzdXBwb3J0ID0ge1xuICAgIC8vIEJhc2ljIHN1cHBvcnRcbiAgICBhdWRpbzogJ2NhblBsYXlUeXBlJyBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhdWRpbycpLFxuICAgIHZpZGVvOiAnY2FuUGxheVR5cGUnIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJyksXG5cbiAgICAvLyBDaGVjayBmb3Igc3VwcG9ydFxuICAgIC8vIEJhc2ljIGZ1bmN0aW9uYWxpdHkgdnMgZnVsbCBVSVxuICAgIGNoZWNrKHR5cGUsIHByb3ZpZGVyLCBwbGF5c2lubGluZSkge1xuICAgICAgY29uc3QgY2FuUGxheUlubGluZSA9IGJyb3dzZXIuaXNJUGhvbmUgJiYgcGxheXNpbmxpbmUgJiYgc3VwcG9ydC5wbGF5c2lubGluZTtcbiAgICAgIGNvbnN0IGFwaSA9IHN1cHBvcnRbdHlwZV0gfHwgcHJvdmlkZXIgIT09ICdodG1sNSc7XG4gICAgICBjb25zdCB1aSA9IGFwaSAmJiBzdXBwb3J0LnJhbmdlSW5wdXQgJiYgKHR5cGUgIT09ICd2aWRlbycgfHwgIWJyb3dzZXIuaXNJUGhvbmUgfHwgY2FuUGxheUlubGluZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhcGksXG4gICAgICAgIHVpXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICAvLyBQaWN0dXJlLWluLXBpY3R1cmUgc3VwcG9ydFxuICAgIC8vIFNhZmFyaSAmIENocm9tZSBvbmx5IGN1cnJlbnRseVxuICAgIHBpcDogKCgpID0+IHtcbiAgICAgIGlmIChicm93c2VyLmlzSVBob25lKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0gLy8gU2FmYXJpXG4gICAgICAvLyBodHRwczovL2RldmVsb3Blci5hcHBsZS5jb20vZG9jdW1lbnRhdGlvbi93ZWJraXRqcy9hZGRpbmdfcGljdHVyZV9pbl9waWN0dXJlX3RvX3lvdXJfc2FmYXJpX21lZGlhX2NvbnRyb2xzXG5cblxuICAgICAgaWYgKGlzLmZ1bmN0aW9uKGNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJykud2Via2l0U2V0UHJlc2VudGF0aW9uTW9kZSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IC8vIENocm9tZVxuICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vd2ViL3VwZGF0ZXMvMjAxOC8xMC93YXRjaC12aWRlby11c2luZy1waWN0dXJlLWluLXBpY3R1cmVcblxuXG4gICAgICBpZiAoZG9jdW1lbnQucGljdHVyZUluUGljdHVyZUVuYWJsZWQgJiYgIWNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJykuZGlzYWJsZVBpY3R1cmVJblBpY3R1cmUpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KSgpLFxuICAgIC8vIEFpcnBsYXkgc3VwcG9ydFxuICAgIC8vIFNhZmFyaSBvbmx5IGN1cnJlbnRseVxuICAgIGFpcnBsYXk6IGlzLmZ1bmN0aW9uKHdpbmRvdy5XZWJLaXRQbGF5YmFja1RhcmdldEF2YWlsYWJpbGl0eUV2ZW50KSxcbiAgICAvLyBJbmxpbmUgcGxheWJhY2sgc3VwcG9ydFxuICAgIC8vIGh0dHBzOi8vd2Via2l0Lm9yZy9ibG9nLzY3ODQvbmV3LXZpZGVvLXBvbGljaWVzLWZvci1pb3MvXG4gICAgcGxheXNpbmxpbmU6ICdwbGF5c0lubGluZScgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndmlkZW8nKSxcblxuICAgIC8vIENoZWNrIGZvciBtaW1lIHR5cGUgc3VwcG9ydCBhZ2FpbnN0IGEgcGxheWVyIGluc3RhbmNlXG4gICAgLy8gQ3JlZGl0czogaHR0cDovL2RpdmVpbnRvaHRtbDUuaW5mby9ldmVyeXRoaW5nLmh0bWxcbiAgICAvLyBSZWxhdGVkOiBodHRwOi8vd3d3LmxlYW5iYWNrcGxheWVyLmNvbS90ZXN0L2g1bXQuaHRtbFxuICAgIG1pbWUoaW5wdXQpIHtcbiAgICAgIGlmIChpcy5lbXB0eShpbnB1dCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBbbWVkaWFUeXBlXSA9IGlucHV0LnNwbGl0KCcvJyk7XG4gICAgICBsZXQgdHlwZSA9IGlucHV0OyAvLyBWZXJpZnkgd2UncmUgdXNpbmcgSFRNTDUgYW5kIHRoZXJlJ3Mgbm8gbWVkaWEgdHlwZSBtaXNtYXRjaFxuXG4gICAgICBpZiAoIXRoaXMuaXNIVE1MNSB8fCBtZWRpYVR5cGUgIT09IHRoaXMudHlwZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9IC8vIEFkZCBjb2RlYyBpZiByZXF1aXJlZFxuXG5cbiAgICAgIGlmIChPYmplY3Qua2V5cyhkZWZhdWx0Q29kZWNzKS5pbmNsdWRlcyh0eXBlKSkge1xuICAgICAgICB0eXBlICs9IGA7IGNvZGVjcz1cIiR7ZGVmYXVsdENvZGVjc1tpbnB1dF19XCJgO1xuICAgICAgfVxuXG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gQm9vbGVhbih0eXBlICYmIHRoaXMubWVkaWEuY2FuUGxheVR5cGUodHlwZSkucmVwbGFjZSgvbm8vLCAnJykpO1xuICAgICAgfSBjYXRjaCAoXykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIENoZWNrIGZvciB0ZXh0VHJhY2tzIHN1cHBvcnRcbiAgICB0ZXh0VHJhY2tzOiAndGV4dFRyYWNrcycgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndmlkZW8nKSxcbiAgICAvLyA8aW5wdXQgdHlwZT1cInJhbmdlXCI+IFNsaWRlcnNcbiAgICByYW5nZUlucHV0OiAoKCkgPT4ge1xuICAgICAgY29uc3QgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgcmFuZ2UudHlwZSA9ICdyYW5nZSc7XG4gICAgICByZXR1cm4gcmFuZ2UudHlwZSA9PT0gJ3JhbmdlJztcbiAgICB9KSgpLFxuICAgIC8vIFRvdWNoXG4gICAgLy8gTk9URTogUmVtZW1iZXIgYSBkZXZpY2UgY2FuIGJlIG1vdXNlICsgdG91Y2ggZW5hYmxlZCBzbyB3ZSBjaGVjayBvbiBmaXJzdCB0b3VjaCBldmVudFxuICAgIHRvdWNoOiAnb250b3VjaHN0YXJ0JyBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsXG4gICAgLy8gRGV0ZWN0IHRyYW5zaXRpb25zIHN1cHBvcnRcbiAgICB0cmFuc2l0aW9uczogdHJhbnNpdGlvbkVuZEV2ZW50ICE9PSBmYWxzZSxcbiAgICAvLyBSZWR1Y2VkIG1vdGlvbiBpT1MgJiBNYWNPUyBzZXR0aW5nXG4gICAgLy8gaHR0cHM6Ly93ZWJraXQub3JnL2Jsb2cvNzU1MS9yZXNwb25zaXZlLWRlc2lnbi1mb3ItbW90aW9uL1xuICAgIHJlZHVjZWRNb3Rpb246ICdtYXRjaE1lZGlhJyBpbiB3aW5kb3cgJiYgd2luZG93Lm1hdGNoTWVkaWEoJyhwcmVmZXJzLXJlZHVjZWQtbW90aW9uKScpLm1hdGNoZXNcbiAgfTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBodHRwczovL2dpdGh1Yi5jb20vV0lDRy9FdmVudExpc3RlbmVyT3B0aW9ucy9ibG9iL2doLXBhZ2VzL2V4cGxhaW5lci5tZFxuICAvLyBodHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PU5QTTYxNzJKMjJnXG5cbiAgY29uc3Qgc3VwcG9ydHNQYXNzaXZlTGlzdGVuZXJzID0gKCgpID0+IHtcbiAgICAvLyBUZXN0IHZpYSBhIGdldHRlciBpbiB0aGUgb3B0aW9ucyBvYmplY3QgdG8gc2VlIGlmIHRoZSBwYXNzaXZlIHByb3BlcnR5IGlzIGFjY2Vzc2VkXG4gICAgbGV0IHN1cHBvcnRlZCA9IGZhbHNlO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdwYXNzaXZlJywge1xuICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgc3VwcG9ydGVkID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICB9KTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0ZXN0JywgbnVsbCwgb3B0aW9ucyk7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndGVzdCcsIG51bGwsIG9wdGlvbnMpO1xuICAgIH0gY2F0Y2ggKF8pIHsvLyBEbyBub3RoaW5nXG4gICAgfVxuXG4gICAgcmV0dXJuIHN1cHBvcnRlZDtcbiAgfSkoKTsgLy8gVG9nZ2xlIGV2ZW50IGxpc3RlbmVyXG5cblxuICBmdW5jdGlvbiB0b2dnbGVMaXN0ZW5lcihlbGVtZW50LCBldmVudCwgY2FsbGJhY2ssIHRvZ2dsZSA9IGZhbHNlLCBwYXNzaXZlID0gdHJ1ZSwgY2FwdHVyZSA9IGZhbHNlKSB7XG4gICAgLy8gQmFpbCBpZiBubyBlbGVtZW50LCBldmVudCwgb3IgY2FsbGJhY2tcbiAgICBpZiAoIWVsZW1lbnQgfHwgISgnYWRkRXZlbnRMaXN0ZW5lcicgaW4gZWxlbWVudCkgfHwgaXMuZW1wdHkoZXZlbnQpIHx8ICFpcy5mdW5jdGlvbihjYWxsYmFjaykpIHtcbiAgICAgIHJldHVybjtcbiAgICB9IC8vIEFsbG93IG11bHRpcGxlIGV2ZW50c1xuXG5cbiAgICBjb25zdCBldmVudHMgPSBldmVudC5zcGxpdCgnICcpOyAvLyBCdWlsZCBvcHRpb25zXG4gICAgLy8gRGVmYXVsdCB0byBqdXN0IHRoZSBjYXB0dXJlIGJvb2xlYW4gZm9yIGJyb3dzZXJzIHdpdGggbm8gcGFzc2l2ZSBsaXN0ZW5lciBzdXBwb3J0XG5cbiAgICBsZXQgb3B0aW9ucyA9IGNhcHR1cmU7IC8vIElmIHBhc3NpdmUgZXZlbnRzIGxpc3RlbmVycyBhcmUgc3VwcG9ydGVkXG5cbiAgICBpZiAoc3VwcG9ydHNQYXNzaXZlTGlzdGVuZXJzKSB7XG4gICAgICBvcHRpb25zID0ge1xuICAgICAgICAvLyBXaGV0aGVyIHRoZSBsaXN0ZW5lciBjYW4gYmUgcGFzc2l2ZSAoaS5lLiBkZWZhdWx0IG5ldmVyIHByZXZlbnRlZClcbiAgICAgICAgcGFzc2l2ZSxcbiAgICAgICAgLy8gV2hldGhlciB0aGUgbGlzdGVuZXIgaXMgYSBjYXB0dXJpbmcgbGlzdGVuZXIgb3Igbm90XG4gICAgICAgIGNhcHR1cmVcbiAgICAgIH07XG4gICAgfSAvLyBJZiBhIHNpbmdsZSBub2RlIGlzIHBhc3NlZCwgYmluZCB0aGUgZXZlbnQgbGlzdGVuZXJcblxuXG4gICAgZXZlbnRzLmZvckVhY2godHlwZSA9PiB7XG4gICAgICBpZiAodGhpcyAmJiB0aGlzLmV2ZW50TGlzdGVuZXJzICYmIHRvZ2dsZSkge1xuICAgICAgICAvLyBDYWNoZSBldmVudCBsaXN0ZW5lclxuICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzLnB1c2goe1xuICAgICAgICAgIGVsZW1lbnQsXG4gICAgICAgICAgdHlwZSxcbiAgICAgICAgICBjYWxsYmFjayxcbiAgICAgICAgICBvcHRpb25zXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBlbGVtZW50W3RvZ2dsZSA/ICdhZGRFdmVudExpc3RlbmVyJyA6ICdyZW1vdmVFdmVudExpc3RlbmVyJ10odHlwZSwgY2FsbGJhY2ssIG9wdGlvbnMpO1xuICAgIH0pO1xuICB9IC8vIEJpbmQgZXZlbnQgaGFuZGxlclxuXG4gIGZ1bmN0aW9uIG9uKGVsZW1lbnQsIGV2ZW50cyA9ICcnLCBjYWxsYmFjaywgcGFzc2l2ZSA9IHRydWUsIGNhcHR1cmUgPSBmYWxzZSkge1xuICAgIHRvZ2dsZUxpc3RlbmVyLmNhbGwodGhpcywgZWxlbWVudCwgZXZlbnRzLCBjYWxsYmFjaywgdHJ1ZSwgcGFzc2l2ZSwgY2FwdHVyZSk7XG4gIH0gLy8gVW5iaW5kIGV2ZW50IGhhbmRsZXJcblxuICBmdW5jdGlvbiBvZmYoZWxlbWVudCwgZXZlbnRzID0gJycsIGNhbGxiYWNrLCBwYXNzaXZlID0gdHJ1ZSwgY2FwdHVyZSA9IGZhbHNlKSB7XG4gICAgdG9nZ2xlTGlzdGVuZXIuY2FsbCh0aGlzLCBlbGVtZW50LCBldmVudHMsIGNhbGxiYWNrLCBmYWxzZSwgcGFzc2l2ZSwgY2FwdHVyZSk7XG4gIH0gLy8gQmluZCBvbmNlLW9ubHkgZXZlbnQgaGFuZGxlclxuXG4gIGZ1bmN0aW9uIG9uY2UoZWxlbWVudCwgZXZlbnRzID0gJycsIGNhbGxiYWNrLCBwYXNzaXZlID0gdHJ1ZSwgY2FwdHVyZSA9IGZhbHNlKSB7XG4gICAgY29uc3Qgb25jZUNhbGxiYWNrID0gKC4uLmFyZ3MpID0+IHtcbiAgICAgIG9mZihlbGVtZW50LCBldmVudHMsIG9uY2VDYWxsYmFjaywgcGFzc2l2ZSwgY2FwdHVyZSk7XG4gICAgICBjYWxsYmFjay5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9O1xuXG4gICAgdG9nZ2xlTGlzdGVuZXIuY2FsbCh0aGlzLCBlbGVtZW50LCBldmVudHMsIG9uY2VDYWxsYmFjaywgdHJ1ZSwgcGFzc2l2ZSwgY2FwdHVyZSk7XG4gIH0gLy8gVHJpZ2dlciBldmVudFxuXG4gIGZ1bmN0aW9uIHRyaWdnZXJFdmVudChlbGVtZW50LCB0eXBlID0gJycsIGJ1YmJsZXMgPSBmYWxzZSwgZGV0YWlsID0ge30pIHtcbiAgICAvLyBCYWlsIGlmIG5vIGVsZW1lbnRcbiAgICBpZiAoIWlzLmVsZW1lbnQoZWxlbWVudCkgfHwgaXMuZW1wdHkodHlwZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9IC8vIENyZWF0ZSBhbmQgZGlzcGF0Y2ggdGhlIGV2ZW50XG5cblxuICAgIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KHR5cGUsIHtcbiAgICAgIGJ1YmJsZXMsXG4gICAgICBkZXRhaWw6IHsgLi4uZGV0YWlsLFxuICAgICAgICBwbHlyOiB0aGlzXG4gICAgICB9XG4gICAgfSk7IC8vIERpc3BhdGNoIHRoZSBldmVudFxuXG4gICAgZWxlbWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgfSAvLyBVbmJpbmQgYWxsIGNhY2hlZCBldmVudCBsaXN0ZW5lcnNcblxuICBmdW5jdGlvbiB1bmJpbmRMaXN0ZW5lcnMoKSB7XG4gICAgaWYgKHRoaXMgJiYgdGhpcy5ldmVudExpc3RlbmVycykge1xuICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgZWxlbWVudCxcbiAgICAgICAgICB0eXBlLFxuICAgICAgICAgIGNhbGxiYWNrLFxuICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgfSA9IGl0ZW07XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBjYWxsYmFjaywgb3B0aW9ucyk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMgPSBbXTtcbiAgICB9XG4gIH0gLy8gUnVuIG1ldGhvZCB3aGVuIC8gaWYgcGxheWVyIGlzIHJlYWR5XG5cbiAgZnVuY3Rpb24gcmVhZHkoKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gdGhpcy5yZWFkeSA/IHNldFRpbWVvdXQocmVzb2x2ZSwgMCkgOiBvbi5jYWxsKHRoaXMsIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCAncmVhZHknLCByZXNvbHZlKSkudGhlbigoKSA9PiB7fSk7XG4gIH1cblxuICAvKipcbiAgICogU2lsZW5jZSBhIFByb21pc2UtbGlrZSBvYmplY3QuXG4gICAqIFRoaXMgaXMgdXNlZnVsIGZvciBhdm9pZGluZyBub24taGFybWZ1bCwgYnV0IHBvdGVudGlhbGx5IGNvbmZ1c2luZyBcInVuY2F1Z2h0XG4gICAqIHBsYXkgcHJvbWlzZVwiIHJlamVjdGlvbiBlcnJvciBtZXNzYWdlcy5cbiAgICogQHBhcmFtICB7T2JqZWN0fSB2YWx1ZSBBbiBvYmplY3QgdGhhdCBtYXkgb3IgbWF5IG5vdCBiZSBgUHJvbWlzZWAtbGlrZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gc2lsZW5jZVByb21pc2UodmFsdWUpIHtcbiAgICBpZiAoaXMucHJvbWlzZSh2YWx1ZSkpIHtcbiAgICAgIHZhbHVlLnRoZW4obnVsbCwgKCkgPT4ge30pO1xuICAgIH1cbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgZnVuY3Rpb24gZGVkdXBlKGFycmF5KSB7XG4gICAgaWYgKCFpcy5hcnJheShhcnJheSkpIHtcbiAgICAgIHJldHVybiBhcnJheTtcbiAgICB9XG5cbiAgICByZXR1cm4gYXJyYXkuZmlsdGVyKChpdGVtLCBpbmRleCkgPT4gYXJyYXkuaW5kZXhPZihpdGVtKSA9PT0gaW5kZXgpO1xuICB9IC8vIEdldCB0aGUgY2xvc2VzdCB2YWx1ZSBpbiBhbiBhcnJheVxuXG4gIGZ1bmN0aW9uIGNsb3Nlc3QoYXJyYXksIHZhbHVlKSB7XG4gICAgaWYgKCFpcy5hcnJheShhcnJheSkgfHwgIWFycmF5Lmxlbmd0aCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFycmF5LnJlZHVjZSgocHJldiwgY3VycikgPT4gTWF0aC5hYnMoY3VyciAtIHZhbHVlKSA8IE1hdGguYWJzKHByZXYgLSB2YWx1ZSkgPyBjdXJyIDogcHJldik7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGZ1bmN0aW9uIHN1cHBvcnRzQ1NTKGRlY2xhcmF0aW9uKSB7XG4gICAgaWYgKCF3aW5kb3cgfHwgIXdpbmRvdy5DU1MpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gd2luZG93LkNTUy5zdXBwb3J0cyhkZWNsYXJhdGlvbik7XG4gIH0gLy8gU3RhbmRhcmQvY29tbW9uIGFzcGVjdCByYXRpb3NcblxuICBjb25zdCBzdGFuZGFyZFJhdGlvcyA9IFtbMSwgMV0sIFs0LCAzXSwgWzMsIDRdLCBbNSwgNF0sIFs0LCA1XSwgWzMsIDJdLCBbMiwgM10sIFsxNiwgMTBdLCBbMTAsIDE2XSwgWzE2LCA5XSwgWzksIDE2XSwgWzIxLCA5XSwgWzksIDIxXSwgWzMyLCA5XSwgWzksIDMyXV0ucmVkdWNlKChvdXQsIFt4LCB5XSkgPT4gKHsgLi4ub3V0LFxuICAgIFt4IC8geV06IFt4LCB5XVxuICB9KSwge30pOyAvLyBWYWxpZGF0ZSBhbiBhc3BlY3QgcmF0aW9cblxuICBmdW5jdGlvbiB2YWxpZGF0ZUFzcGVjdFJhdGlvKGlucHV0KSB7XG4gICAgaWYgKCFpcy5hcnJheShpbnB1dCkgJiYgKCFpcy5zdHJpbmcoaW5wdXQpIHx8ICFpbnB1dC5pbmNsdWRlcygnOicpKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNvbnN0IHJhdGlvID0gaXMuYXJyYXkoaW5wdXQpID8gaW5wdXQgOiBpbnB1dC5zcGxpdCgnOicpO1xuICAgIHJldHVybiByYXRpby5tYXAoTnVtYmVyKS5ldmVyeShpcy5udW1iZXIpO1xuICB9IC8vIFJlZHVjZSBhbiBhc3BlY3QgcmF0aW8gdG8gaXQncyBsb3dlc3QgZm9ybVxuXG4gIGZ1bmN0aW9uIHJlZHVjZUFzcGVjdFJhdGlvKHJhdGlvKSB7XG4gICAgaWYgKCFpcy5hcnJheShyYXRpbykgfHwgIXJhdGlvLmV2ZXJ5KGlzLm51bWJlcikpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IFt3aWR0aCwgaGVpZ2h0XSA9IHJhdGlvO1xuXG4gICAgY29uc3QgZ2V0RGl2aWRlciA9ICh3LCBoKSA9PiBoID09PSAwID8gdyA6IGdldERpdmlkZXIoaCwgdyAlIGgpO1xuXG4gICAgY29uc3QgZGl2aWRlciA9IGdldERpdmlkZXIod2lkdGgsIGhlaWdodCk7XG4gICAgcmV0dXJuIFt3aWR0aCAvIGRpdmlkZXIsIGhlaWdodCAvIGRpdmlkZXJdO1xuICB9IC8vIENhbGN1bGF0ZSBhbiBhc3BlY3QgcmF0aW9cblxuICBmdW5jdGlvbiBnZXRBc3BlY3RSYXRpbyhpbnB1dCkge1xuICAgIGNvbnN0IHBhcnNlID0gcmF0aW8gPT4gdmFsaWRhdGVBc3BlY3RSYXRpbyhyYXRpbykgPyByYXRpby5zcGxpdCgnOicpLm1hcChOdW1iZXIpIDogbnVsbDsgLy8gVHJ5IHByb3ZpZGVkIHJhdGlvXG5cblxuICAgIGxldCByYXRpbyA9IHBhcnNlKGlucHV0KTsgLy8gR2V0IGZyb20gY29uZmlnXG5cbiAgICBpZiAocmF0aW8gPT09IG51bGwpIHtcbiAgICAgIHJhdGlvID0gcGFyc2UodGhpcy5jb25maWcucmF0aW8pO1xuICAgIH0gLy8gR2V0IGZyb20gZW1iZWRcblxuXG4gICAgaWYgKHJhdGlvID09PSBudWxsICYmICFpcy5lbXB0eSh0aGlzLmVtYmVkKSAmJiBpcy5hcnJheSh0aGlzLmVtYmVkLnJhdGlvKSkge1xuICAgICAgKHtcbiAgICAgICAgcmF0aW9cbiAgICAgIH0gPSB0aGlzLmVtYmVkKTtcbiAgICB9IC8vIEdldCBmcm9tIEhUTUw1IHZpZGVvXG5cblxuICAgIGlmIChyYXRpbyA9PT0gbnVsbCAmJiB0aGlzLmlzSFRNTDUpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdmlkZW9XaWR0aCxcbiAgICAgICAgdmlkZW9IZWlnaHRcbiAgICAgIH0gPSB0aGlzLm1lZGlhO1xuICAgICAgcmF0aW8gPSBbdmlkZW9XaWR0aCwgdmlkZW9IZWlnaHRdO1xuICAgIH1cblxuICAgIHJldHVybiByZWR1Y2VBc3BlY3RSYXRpbyhyYXRpbyk7XG4gIH0gLy8gU2V0IGFzcGVjdCByYXRpbyBmb3IgcmVzcG9uc2l2ZSBjb250YWluZXJcblxuICBmdW5jdGlvbiBzZXRBc3BlY3RSYXRpbyhpbnB1dCkge1xuICAgIGlmICghdGhpcy5pc1ZpZGVvKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuXG4gICAgY29uc3Qge1xuICAgICAgd3JhcHBlclxuICAgIH0gPSB0aGlzLmVsZW1lbnRzO1xuICAgIGNvbnN0IHJhdGlvID0gZ2V0QXNwZWN0UmF0aW8uY2FsbCh0aGlzLCBpbnB1dCk7XG5cbiAgICBpZiAoIWlzLmFycmF5KHJhdGlvKSkge1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cblxuICAgIGNvbnN0IFt4LCB5XSA9IHJlZHVjZUFzcGVjdFJhdGlvKHJhdGlvKTtcbiAgICBjb25zdCB1c2VOYXRpdmUgPSBzdXBwb3J0c0NTUyhgYXNwZWN0LXJhdGlvOiAke3h9LyR7eX1gKTtcbiAgICBjb25zdCBwYWRkaW5nID0gMTAwIC8geCAqIHk7XG5cbiAgICBpZiAodXNlTmF0aXZlKSB7XG4gICAgICB3cmFwcGVyLnN0eWxlLmFzcGVjdFJhdGlvID0gYCR7eH0vJHt5fWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdyYXBwZXIuc3R5bGUucGFkZGluZ0JvdHRvbSA9IGAke3BhZGRpbmd9JWA7XG4gICAgfSAvLyBGb3IgVmltZW8gd2UgaGF2ZSBhbiBleHRyYSA8ZGl2PiB0byBoaWRlIHRoZSBzdGFuZGFyZCBjb250cm9scyBhbmQgVUlcblxuXG4gICAgaWYgKHRoaXMuaXNWaW1lbyAmJiAhdGhpcy5jb25maWcudmltZW8ucHJlbWl1bSAmJiB0aGlzLnN1cHBvcnRlZC51aSkge1xuICAgICAgY29uc3QgaGVpZ2h0ID0gMTAwIC8gdGhpcy5tZWRpYS5vZmZzZXRXaWR0aCAqIHBhcnNlSW50KHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMubWVkaWEpLnBhZGRpbmdCb3R0b20sIDEwKTtcbiAgICAgIGNvbnN0IG9mZnNldCA9IChoZWlnaHQgLSBwYWRkaW5nKSAvIChoZWlnaHQgLyA1MCk7XG5cbiAgICAgIGlmICh0aGlzLmZ1bGxzY3JlZW4uYWN0aXZlKSB7XG4gICAgICAgIHdyYXBwZXIuc3R5bGUucGFkZGluZ0JvdHRvbSA9IG51bGw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm1lZGlhLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVZKC0ke29mZnNldH0lKWA7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZCh0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnZpZGVvRml4ZWRSYXRpbyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHBhZGRpbmcsXG4gICAgICByYXRpb1xuICAgIH07XG4gIH0gLy8gUm91bmQgYW4gYXNwZWN0IHJhdGlvIHRvIGNsb3Nlc3Qgc3RhbmRhcmQgcmF0aW9cblxuICBmdW5jdGlvbiByb3VuZEFzcGVjdFJhdGlvKHgsIHksIHRvbGVyYW5jZSA9IDAuMDUpIHtcbiAgICBjb25zdCByYXRpbyA9IHggLyB5O1xuICAgIGNvbnN0IGNsb3Nlc3RSYXRpbyA9IGNsb3Nlc3QoT2JqZWN0LmtleXMoc3RhbmRhcmRSYXRpb3MpLCByYXRpbyk7IC8vIENoZWNrIG1hdGNoIGlzIHdpdGhpbiB0b2xlcmFuY2VcblxuICAgIGlmIChNYXRoLmFicyhjbG9zZXN0UmF0aW8gLSByYXRpbykgPD0gdG9sZXJhbmNlKSB7XG4gICAgICByZXR1cm4gc3RhbmRhcmRSYXRpb3NbY2xvc2VzdFJhdGlvXTtcbiAgICB9IC8vIE5vIG1hdGNoXG5cblxuICAgIHJldHVybiBbeCwgeV07XG4gIH0gLy8gR2V0IHRoZSBzaXplIG9mIHRoZSB2aWV3cG9ydFxuICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMjQ4MDgxL2hvdy10by1nZXQtdGhlLWJyb3dzZXItdmlld3BvcnQtZGltZW5zaW9uc1xuXG4gIGZ1bmN0aW9uIGdldFZpZXdwb3J0U2l6ZSgpIHtcbiAgICBjb25zdCB3aWR0aCA9IE1hdGgubWF4KGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCB8fCAwLCB3aW5kb3cuaW5uZXJXaWR0aCB8fCAwKTtcbiAgICBjb25zdCBoZWlnaHQgPSBNYXRoLm1heChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IDAsIHdpbmRvdy5pbm5lckhlaWdodCB8fCAwKTtcbiAgICByZXR1cm4gW3dpZHRoLCBoZWlnaHRdO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgY29uc3QgaHRtbDUgPSB7XG4gICAgZ2V0U291cmNlcygpIHtcbiAgICAgIGlmICghdGhpcy5pc0hUTUw1KSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc291cmNlcyA9IEFycmF5LmZyb20odGhpcy5tZWRpYS5xdWVyeVNlbGVjdG9yQWxsKCdzb3VyY2UnKSk7IC8vIEZpbHRlciBvdXQgdW5zdXBwb3J0ZWQgc291cmNlcyAoaWYgdHlwZSBpcyBzcGVjaWZpZWQpXG5cbiAgICAgIHJldHVybiBzb3VyY2VzLmZpbHRlcihzb3VyY2UgPT4ge1xuICAgICAgICBjb25zdCB0eXBlID0gc291cmNlLmdldEF0dHJpYnV0ZSgndHlwZScpO1xuXG4gICAgICAgIGlmIChpcy5lbXB0eSh0eXBlKSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1cHBvcnQubWltZS5jYWxsKHRoaXMsIHR5cGUpO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vIEdldCBxdWFsaXR5IGxldmVsc1xuICAgIGdldFF1YWxpdHlPcHRpb25zKCkge1xuICAgICAgLy8gV2hldGhlciB3ZSdyZSBmb3JjaW5nIGFsbCBvcHRpb25zIChlLmcuIGZvciBzdHJlYW1pbmcpXG4gICAgICBpZiAodGhpcy5jb25maWcucXVhbGl0eS5mb3JjZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlnLnF1YWxpdHkub3B0aW9ucztcbiAgICAgIH0gLy8gR2V0IHNpemVzIGZyb20gPHNvdXJjZT4gZWxlbWVudHNcblxuXG4gICAgICByZXR1cm4gaHRtbDUuZ2V0U291cmNlcy5jYWxsKHRoaXMpLm1hcChzb3VyY2UgPT4gTnVtYmVyKHNvdXJjZS5nZXRBdHRyaWJ1dGUoJ3NpemUnKSkpLmZpbHRlcihCb29sZWFuKTtcbiAgICB9LFxuXG4gICAgc2V0dXAoKSB7XG4gICAgICBpZiAoIXRoaXMuaXNIVE1MNSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBsYXllciA9IHRoaXM7IC8vIFNldCBzcGVlZCBvcHRpb25zIGZyb20gY29uZmlnXG5cbiAgICAgIHBsYXllci5vcHRpb25zLnNwZWVkID0gcGxheWVyLmNvbmZpZy5zcGVlZC5vcHRpb25zOyAvLyBTZXQgYXNwZWN0IHJhdGlvIGlmIGZpeGVkXG5cbiAgICAgIGlmICghaXMuZW1wdHkodGhpcy5jb25maWcucmF0aW8pKSB7XG4gICAgICAgIHNldEFzcGVjdFJhdGlvLmNhbGwocGxheWVyKTtcbiAgICAgIH0gLy8gUXVhbGl0eVxuXG5cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwbGF5ZXIubWVkaWEsICdxdWFsaXR5Jywge1xuICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgLy8gR2V0IHNvdXJjZXNcbiAgICAgICAgICBjb25zdCBzb3VyY2VzID0gaHRtbDUuZ2V0U291cmNlcy5jYWxsKHBsYXllcik7XG4gICAgICAgICAgY29uc3Qgc291cmNlID0gc291cmNlcy5maW5kKHMgPT4gcy5nZXRBdHRyaWJ1dGUoJ3NyYycpID09PSBwbGF5ZXIuc291cmNlKTsgLy8gUmV0dXJuIHNpemUsIGlmIG1hdGNoIGlzIGZvdW5kXG5cbiAgICAgICAgICByZXR1cm4gc291cmNlICYmIE51bWJlcihzb3VyY2UuZ2V0QXR0cmlidXRlKCdzaXplJykpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldChpbnB1dCkge1xuICAgICAgICAgIGlmIChwbGF5ZXIucXVhbGl0eSA9PT0gaW5wdXQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IC8vIElmIHdlJ3JlIHVzaW5nIGFuIGV4dGVybmFsIGhhbmRsZXIuLi5cblxuXG4gICAgICAgICAgaWYgKHBsYXllci5jb25maWcucXVhbGl0eS5mb3JjZWQgJiYgaXMuZnVuY3Rpb24ocGxheWVyLmNvbmZpZy5xdWFsaXR5Lm9uQ2hhbmdlKSkge1xuICAgICAgICAgICAgcGxheWVyLmNvbmZpZy5xdWFsaXR5Lm9uQ2hhbmdlKGlucHV0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gR2V0IHNvdXJjZXNcbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZXMgPSBodG1sNS5nZXRTb3VyY2VzLmNhbGwocGxheWVyKTsgLy8gR2V0IGZpcnN0IG1hdGNoIGZvciByZXF1ZXN0ZWQgc2l6ZVxuXG4gICAgICAgICAgICBjb25zdCBzb3VyY2UgPSBzb3VyY2VzLmZpbmQocyA9PiBOdW1iZXIocy5nZXRBdHRyaWJ1dGUoJ3NpemUnKSkgPT09IGlucHV0KTsgLy8gTm8gbWF0Y2hpbmcgc291cmNlIGZvdW5kXG5cbiAgICAgICAgICAgIGlmICghc291cmNlKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gLy8gR2V0IGN1cnJlbnQgc3RhdGVcblxuXG4gICAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICAgIGN1cnJlbnRUaW1lLFxuICAgICAgICAgICAgICBwYXVzZWQsXG4gICAgICAgICAgICAgIHByZWxvYWQsXG4gICAgICAgICAgICAgIHJlYWR5U3RhdGUsXG4gICAgICAgICAgICAgIHBsYXliYWNrUmF0ZVxuICAgICAgICAgICAgfSA9IHBsYXllci5tZWRpYTsgLy8gU2V0IG5ldyBzb3VyY2VcblxuICAgICAgICAgICAgcGxheWVyLm1lZGlhLnNyYyA9IHNvdXJjZS5nZXRBdHRyaWJ1dGUoJ3NyYycpOyAvLyBQcmV2ZW50IGxvYWRpbmcgaWYgcHJlbG9hZD1cIm5vbmVcIiBhbmQgdGhlIGN1cnJlbnQgc291cmNlIGlzbid0IGxvYWRlZCAoIzEwNDQpXG5cbiAgICAgICAgICAgIGlmIChwcmVsb2FkICE9PSAnbm9uZScgfHwgcmVhZHlTdGF0ZSkge1xuICAgICAgICAgICAgICAvLyBSZXN0b3JlIHRpbWVcbiAgICAgICAgICAgICAgcGxheWVyLm9uY2UoJ2xvYWRlZG1ldGFkYXRhJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHBsYXllci5zcGVlZCA9IHBsYXliYWNrUmF0ZTtcbiAgICAgICAgICAgICAgICBwbGF5ZXIuY3VycmVudFRpbWUgPSBjdXJyZW50VGltZTsgLy8gUmVzdW1lIHBsYXlpbmdcblxuICAgICAgICAgICAgICAgIGlmICghcGF1c2VkKSB7XG4gICAgICAgICAgICAgICAgICBzaWxlbmNlUHJvbWlzZShwbGF5ZXIucGxheSgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pOyAvLyBMb2FkIG5ldyBzb3VyY2VcblxuICAgICAgICAgICAgICBwbGF5ZXIubWVkaWEubG9hZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gLy8gVHJpZ2dlciBjaGFuZ2UgZXZlbnRcblxuXG4gICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdxdWFsaXR5Y2hhbmdlJywgZmFsc2UsIHtcbiAgICAgICAgICAgIHF1YWxpdHk6IGlucHV0XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vIENhbmNlbCBjdXJyZW50IG5ldHdvcmsgcmVxdWVzdHNcbiAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzE3NFxuICAgIGNhbmNlbFJlcXVlc3RzKCkge1xuICAgICAgaWYgKCF0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBSZW1vdmUgY2hpbGQgc291cmNlc1xuXG5cbiAgICAgIHJlbW92ZUVsZW1lbnQoaHRtbDUuZ2V0U291cmNlcy5jYWxsKHRoaXMpKTsgLy8gU2V0IGJsYW5rIHZpZGVvIHNyYyBhdHRyaWJ1dGVcbiAgICAgIC8vIFRoaXMgaXMgdG8gcHJldmVudCBhIE1FRElBX0VSUl9TUkNfTk9UX1NVUFBPUlRFRCBlcnJvclxuICAgICAgLy8gSW5mbzogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8zMjIzMTU3OS9ob3ctdG8tcHJvcGVybHktZGlzcG9zZS1vZi1hbi1odG1sNS12aWRlby1hbmQtY2xvc2Utc29ja2V0LW9yLWNvbm5lY3Rpb25cblxuICAgICAgdGhpcy5tZWRpYS5zZXRBdHRyaWJ1dGUoJ3NyYycsIHRoaXMuY29uZmlnLmJsYW5rVmlkZW8pOyAvLyBMb2FkIHRoZSBuZXcgZW1wdHkgc291cmNlXG4gICAgICAvLyBUaGlzIHdpbGwgY2FuY2VsIGV4aXN0aW5nIHJlcXVlc3RzXG4gICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzE3NFxuXG4gICAgICB0aGlzLm1lZGlhLmxvYWQoKTsgLy8gRGVidWdnaW5nXG5cbiAgICAgIHRoaXMuZGVidWcubG9nKCdDYW5jZWxsZWQgbmV0d29yayByZXF1ZXN0cycpO1xuICAgIH1cblxuICB9O1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgZnVuY3Rpb24gZ2VuZXJhdGVJZChwcmVmaXgpIHtcbiAgICByZXR1cm4gYCR7cHJlZml4fS0ke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKX1gO1xuICB9IC8vIEZvcm1hdCBzdHJpbmdcblxuICBmdW5jdGlvbiBmb3JtYXQoaW5wdXQsIC4uLmFyZ3MpIHtcbiAgICBpZiAoaXMuZW1wdHkoaW5wdXQpKSByZXR1cm4gaW5wdXQ7XG4gICAgcmV0dXJuIGlucHV0LnRvU3RyaW5nKCkucmVwbGFjZSgveyhcXGQrKX0vZywgKG1hdGNoLCBpKSA9PiBhcmdzW2ldLnRvU3RyaW5nKCkpO1xuICB9IC8vIEdldCBwZXJjZW50YWdlXG5cbiAgZnVuY3Rpb24gZ2V0UGVyY2VudGFnZShjdXJyZW50LCBtYXgpIHtcbiAgICBpZiAoY3VycmVudCA9PT0gMCB8fCBtYXggPT09IDAgfHwgTnVtYmVyLmlzTmFOKGN1cnJlbnQpIHx8IE51bWJlci5pc05hTihtYXgpKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICByZXR1cm4gKGN1cnJlbnQgLyBtYXggKiAxMDApLnRvRml4ZWQoMik7XG4gIH0gLy8gUmVwbGFjZSBhbGwgb2NjdXJyZW5jZXMgb2YgYSBzdHJpbmcgaW4gYSBzdHJpbmdcblxuICBjb25zdCByZXBsYWNlQWxsID0gKGlucHV0ID0gJycsIGZpbmQgPSAnJywgcmVwbGFjZSA9ICcnKSA9PiBpbnB1dC5yZXBsYWNlKG5ldyBSZWdFeHAoZmluZC50b1N0cmluZygpLnJlcGxhY2UoLyhbLiorP149IToke30oKXxbXFxdL1xcXFxdKS9nLCAnXFxcXCQxJyksICdnJyksIHJlcGxhY2UudG9TdHJpbmcoKSk7IC8vIENvbnZlcnQgdG8gdGl0bGUgY2FzZVxuXG4gIGNvbnN0IHRvVGl0bGVDYXNlID0gKGlucHV0ID0gJycpID0+IGlucHV0LnRvU3RyaW5nKCkucmVwbGFjZSgvXFx3XFxTKi9nLCB0ZXh0ID0+IHRleHQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0ZXh0LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCkpOyAvLyBDb252ZXJ0IHN0cmluZyB0byBwYXNjYWxDYXNlXG5cbiAgZnVuY3Rpb24gdG9QYXNjYWxDYXNlKGlucHV0ID0gJycpIHtcbiAgICBsZXQgc3RyaW5nID0gaW5wdXQudG9TdHJpbmcoKTsgLy8gQ29udmVydCBrZWJhYiBjYXNlXG5cbiAgICBzdHJpbmcgPSByZXBsYWNlQWxsKHN0cmluZywgJy0nLCAnICcpOyAvLyBDb252ZXJ0IHNuYWtlIGNhc2VcblxuICAgIHN0cmluZyA9IHJlcGxhY2VBbGwoc3RyaW5nLCAnXycsICcgJyk7IC8vIENvbnZlcnQgdG8gdGl0bGUgY2FzZVxuXG4gICAgc3RyaW5nID0gdG9UaXRsZUNhc2Uoc3RyaW5nKTsgLy8gQ29udmVydCB0byBwYXNjYWwgY2FzZVxuXG4gICAgcmV0dXJuIHJlcGxhY2VBbGwoc3RyaW5nLCAnICcsICcnKTtcbiAgfSAvLyBDb252ZXJ0IHN0cmluZyB0byBwYXNjYWxDYXNlXG5cbiAgZnVuY3Rpb24gdG9DYW1lbENhc2UoaW5wdXQgPSAnJykge1xuICAgIGxldCBzdHJpbmcgPSBpbnB1dC50b1N0cmluZygpOyAvLyBDb252ZXJ0IHRvIHBhc2NhbCBjYXNlXG5cbiAgICBzdHJpbmcgPSB0b1Bhc2NhbENhc2Uoc3RyaW5nKTsgLy8gQ29udmVydCBmaXJzdCBjaGFyYWN0ZXIgdG8gbG93ZXJjYXNlXG5cbiAgICByZXR1cm4gc3RyaW5nLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpICsgc3RyaW5nLnNsaWNlKDEpO1xuICB9IC8vIFJlbW92ZSBIVE1MIGZyb20gYSBzdHJpbmdcblxuICBmdW5jdGlvbiBzdHJpcEhUTUwoc291cmNlKSB7XG4gICAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gc291cmNlO1xuICAgIHJldHVybiBmcmFnbWVudC5maXJzdENoaWxkLmlubmVyVGV4dDtcbiAgfSAvLyBMaWtlIG91dGVySFRNTCwgYnV0IGFsc28gd29ya3MgZm9yIERvY3VtZW50RnJhZ21lbnRcblxuICBmdW5jdGlvbiBnZXRIVE1MKGVsZW1lbnQpIHtcbiAgICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgd3JhcHBlci5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICByZXR1cm4gd3JhcHBlci5pbm5lckhUTUw7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGNvbnN0IHJlc291cmNlcyA9IHtcbiAgICBwaXA6ICdQSVAnLFxuICAgIGFpcnBsYXk6ICdBaXJQbGF5JyxcbiAgICBodG1sNTogJ0hUTUw1JyxcbiAgICB2aW1lbzogJ1ZpbWVvJyxcbiAgICB5b3V0dWJlOiAnWW91VHViZSdcbiAgfTtcbiAgY29uc3QgaTE4biA9IHtcbiAgICBnZXQoa2V5ID0gJycsIGNvbmZpZyA9IHt9KSB7XG4gICAgICBpZiAoaXMuZW1wdHkoa2V5KSB8fCBpcy5lbXB0eShjb25maWcpKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cblxuICAgICAgbGV0IHN0cmluZyA9IGdldERlZXAoY29uZmlnLmkxOG4sIGtleSk7XG5cbiAgICAgIGlmIChpcy5lbXB0eShzdHJpbmcpKSB7XG4gICAgICAgIGlmIChPYmplY3Qua2V5cyhyZXNvdXJjZXMpLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgICByZXR1cm4gcmVzb3VyY2VzW2tleV07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlcGxhY2UgPSB7XG4gICAgICAgICd7c2Vla3RpbWV9JzogY29uZmlnLnNlZWtUaW1lLFxuICAgICAgICAne3RpdGxlfSc6IGNvbmZpZy50aXRsZVxuICAgICAgfTtcbiAgICAgIE9iamVjdC5lbnRyaWVzKHJlcGxhY2UpLmZvckVhY2goKFtrLCB2XSkgPT4ge1xuICAgICAgICBzdHJpbmcgPSByZXBsYWNlQWxsKHN0cmluZywgaywgdik7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfVxuXG4gIH07XG5cbiAgY2xhc3MgU3RvcmFnZSB7XG4gICAgY29uc3RydWN0b3IocGxheWVyKSB7XG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImdldFwiLCBrZXkgPT4ge1xuICAgICAgICBpZiAoIVN0b3JhZ2Uuc3VwcG9ydGVkIHx8ICF0aGlzLmVuYWJsZWQpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHN0b3JlID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMua2V5KTtcblxuICAgICAgICBpZiAoaXMuZW1wdHkoc3RvcmUpKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZShzdG9yZSk7XG4gICAgICAgIHJldHVybiBpcy5zdHJpbmcoa2V5KSAmJiBrZXkubGVuZ3RoID8ganNvbltrZXldIDoganNvbjtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInNldFwiLCBvYmplY3QgPT4ge1xuICAgICAgICAvLyBCYWlsIGlmIHdlIGRvbid0IGhhdmUgbG9jYWxTdG9yYWdlIHN1cHBvcnQgb3IgaXQncyBkaXNhYmxlZFxuICAgICAgICBpZiAoIVN0b3JhZ2Uuc3VwcG9ydGVkIHx8ICF0aGlzLmVuYWJsZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gLy8gQ2FuIG9ubHkgc3RvcmUgb2JqZWN0c3RcblxuXG4gICAgICAgIGlmICghaXMub2JqZWN0KG9iamVjdCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gLy8gR2V0IGN1cnJlbnQgc3RvcmFnZVxuXG5cbiAgICAgICAgbGV0IHN0b3JhZ2UgPSB0aGlzLmdldCgpOyAvLyBEZWZhdWx0IHRvIGVtcHR5IG9iamVjdFxuXG4gICAgICAgIGlmIChpcy5lbXB0eShzdG9yYWdlKSkge1xuICAgICAgICAgIHN0b3JhZ2UgPSB7fTtcbiAgICAgICAgfSAvLyBVcGRhdGUgdGhlIHdvcmtpbmcgY29weSBvZiB0aGUgdmFsdWVzXG5cblxuICAgICAgICBleHRlbmQoc3RvcmFnZSwgb2JqZWN0KTsgLy8gVXBkYXRlIHN0b3JhZ2VcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLmtleSwgSlNPTi5zdHJpbmdpZnkoc3RvcmFnZSkpO1xuICAgICAgICB9IGNhdGNoIChfKSB7Ly8gRG8gbm90aGluZ1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5lbmFibGVkID0gcGxheWVyLmNvbmZpZy5zdG9yYWdlLmVuYWJsZWQ7XG4gICAgICB0aGlzLmtleSA9IHBsYXllci5jb25maWcuc3RvcmFnZS5rZXk7XG4gICAgfSAvLyBDaGVjayBmb3IgYWN0dWFsIHN1cHBvcnQgKHNlZSBpZiB3ZSBjYW4gdXNlIGl0KVxuXG5cbiAgICBzdGF0aWMgZ2V0IHN1cHBvcnRlZCgpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmICghKCdsb2NhbFN0b3JhZ2UnIGluIHdpbmRvdykpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB0ZXN0ID0gJ19fX3Rlc3QnOyAvLyBUcnkgdG8gdXNlIGl0IChpdCBtaWdodCBiZSBkaXNhYmxlZCwgZS5nLiB1c2VyIGlzIGluIHByaXZhdGUgbW9kZSlcbiAgICAgICAgLy8gc2VlOiBodHRwczovL2dpdGh1Yi5jb20vc2FtcG90dHMvcGx5ci9pc3N1ZXMvMTMxXG5cbiAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKHRlc3QsIHRlc3QpO1xuICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0odGVzdCk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBjYXRjaCAoXykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBGZXRjaCB3cmFwcGVyXG4gIC8vIFVzaW5nIFhIUiB0byBhdm9pZCBpc3N1ZXMgd2l0aCBvbGRlciBicm93c2Vyc1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBmdW5jdGlvbiBmZXRjaCh1cmwsIHJlc3BvbnNlVHlwZSA9ICd0ZXh0Jykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7IC8vIENoZWNrIGZvciBDT1JTIHN1cHBvcnRcblxuICAgICAgICBpZiAoISgnd2l0aENyZWRlbnRpYWxzJyBpbiByZXF1ZXN0KSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbiAgICAgICAgICBpZiAocmVzcG9uc2VUeXBlID09PSAndGV4dCcpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHJlc29sdmUoSlNPTi5wYXJzZShyZXF1ZXN0LnJlc3BvbnNlVGV4dCkpO1xuICAgICAgICAgICAgfSBjYXRjaCAoXykge1xuICAgICAgICAgICAgICByZXNvbHZlKHJlcXVlc3QucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZShyZXF1ZXN0LnJlc3BvbnNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKCkgPT4ge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihyZXF1ZXN0LnN0YXR1cyk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXF1ZXN0Lm9wZW4oJ0dFVCcsIHVybCwgdHJ1ZSk7IC8vIFNldCB0aGUgcmVxdWlyZWQgcmVzcG9uc2UgdHlwZVxuXG4gICAgICAgIHJlcXVlc3QucmVzcG9uc2VUeXBlID0gcmVzcG9uc2VUeXBlO1xuICAgICAgICByZXF1ZXN0LnNlbmQoKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGZ1bmN0aW9uIGxvYWRTcHJpdGUodXJsLCBpZCkge1xuICAgIGlmICghaXMuc3RyaW5nKHVybCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBwcmVmaXggPSAnY2FjaGUnO1xuICAgIGNvbnN0IGhhc0lkID0gaXMuc3RyaW5nKGlkKTtcbiAgICBsZXQgaXNDYWNoZWQgPSBmYWxzZTtcblxuICAgIGNvbnN0IGV4aXN0cyA9ICgpID0+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKSAhPT0gbnVsbDtcblxuICAgIGNvbnN0IHVwZGF0ZSA9IChjb250YWluZXIsIGRhdGEpID0+IHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IGRhdGE7IC8vIENoZWNrIGFnYWluIGluY2FzZSBvZiByYWNlIGNvbmRpdGlvblxuXG4gICAgICBpZiAoaGFzSWQgJiYgZXhpc3RzKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBJbmplY3QgdGhlIFNWRyB0byB0aGUgYm9keVxuXG5cbiAgICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgY29udGFpbmVyKTtcbiAgICB9OyAvLyBPbmx5IGxvYWQgb25jZSBpZiBJRCBzZXRcblxuXG4gICAgaWYgKCFoYXNJZCB8fCAhZXhpc3RzKCkpIHtcbiAgICAgIGNvbnN0IHVzZVN0b3JhZ2UgPSBTdG9yYWdlLnN1cHBvcnRlZDsgLy8gQ3JlYXRlIGNvbnRhaW5lclxuXG4gICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTtcblxuICAgICAgaWYgKGhhc0lkKSB7XG4gICAgICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2lkJywgaWQpO1xuICAgICAgfSAvLyBDaGVjayBpbiBjYWNoZVxuXG5cbiAgICAgIGlmICh1c2VTdG9yYWdlKSB7XG4gICAgICAgIGNvbnN0IGNhY2hlZCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShgJHtwcmVmaXh9LSR7aWR9YCk7XG4gICAgICAgIGlzQ2FjaGVkID0gY2FjaGVkICE9PSBudWxsO1xuXG4gICAgICAgIGlmIChpc0NhY2hlZCkge1xuICAgICAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGNhY2hlZCk7XG4gICAgICAgICAgdXBkYXRlKGNvbnRhaW5lciwgZGF0YS5jb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgfSAvLyBHZXQgdGhlIHNwcml0ZVxuXG5cbiAgICAgIGZldGNoKHVybCkudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICBpZiAoaXMuZW1wdHkocmVzdWx0KSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh1c2VTdG9yYWdlKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShgJHtwcmVmaXh9LSR7aWR9YCwgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICBjb250ZW50OiByZXN1bHRcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICB9IGNhdGNoIChfKSB7Ly8gRG8gbm90aGluZ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHVwZGF0ZShjb250YWluZXIsIHJlc3VsdCk7XG4gICAgICB9KS5jYXRjaCgoKSA9PiB7fSk7XG4gICAgfVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBjb25zdCBnZXRIb3VycyA9IHZhbHVlID0+IE1hdGgudHJ1bmModmFsdWUgLyA2MCAvIDYwICUgNjAsIDEwKTtcbiAgY29uc3QgZ2V0TWludXRlcyA9IHZhbHVlID0+IE1hdGgudHJ1bmModmFsdWUgLyA2MCAlIDYwLCAxMCk7XG4gIGNvbnN0IGdldFNlY29uZHMgPSB2YWx1ZSA9PiBNYXRoLnRydW5jKHZhbHVlICUgNjAsIDEwKTsgLy8gRm9ybWF0IHRpbWUgdG8gVUkgZnJpZW5kbHkgc3RyaW5nXG5cbiAgZnVuY3Rpb24gZm9ybWF0VGltZSh0aW1lID0gMCwgZGlzcGxheUhvdXJzID0gZmFsc2UsIGludmVydGVkID0gZmFsc2UpIHtcbiAgICAvLyBCYWlsIGlmIHRoZSB2YWx1ZSBpc24ndCBhIG51bWJlclxuICAgIGlmICghaXMubnVtYmVyKHRpbWUpKSB7XG4gICAgICByZXR1cm4gZm9ybWF0VGltZSh1bmRlZmluZWQsIGRpc3BsYXlIb3VycywgaW52ZXJ0ZWQpO1xuICAgIH0gLy8gRm9ybWF0IHRpbWUgY29tcG9uZW50IHRvIGFkZCBsZWFkaW5nIHplcm9cblxuXG4gICAgY29uc3QgZm9ybWF0ID0gdmFsdWUgPT4gYDAke3ZhbHVlfWAuc2xpY2UoLTIpOyAvLyBCcmVha2Rvd24gdG8gaG91cnMsIG1pbnMsIHNlY3NcblxuXG4gICAgbGV0IGhvdXJzID0gZ2V0SG91cnModGltZSk7XG4gICAgY29uc3QgbWlucyA9IGdldE1pbnV0ZXModGltZSk7XG4gICAgY29uc3Qgc2VjcyA9IGdldFNlY29uZHModGltZSk7IC8vIERvIHdlIG5lZWQgdG8gZGlzcGxheSBob3Vycz9cblxuICAgIGlmIChkaXNwbGF5SG91cnMgfHwgaG91cnMgPiAwKSB7XG4gICAgICBob3VycyA9IGAke2hvdXJzfTpgO1xuICAgIH0gZWxzZSB7XG4gICAgICBob3VycyA9ICcnO1xuICAgIH0gLy8gUmVuZGVyXG5cblxuICAgIHJldHVybiBgJHtpbnZlcnRlZCAmJiB0aW1lID4gMCA/ICctJyA6ICcnfSR7aG91cnN9JHtmb3JtYXQobWlucyl9OiR7Zm9ybWF0KHNlY3MpfWA7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGNvbnN0IGNvbnRyb2xzID0ge1xuICAgIC8vIEdldCBpY29uIFVSTFxuICAgIGdldEljb25VcmwoKSB7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHRoaXMuY29uZmlnLmljb25VcmwsIHdpbmRvdy5sb2NhdGlvbik7XG4gICAgICBjb25zdCBob3N0ID0gd2luZG93LmxvY2F0aW9uLmhvc3QgPyB3aW5kb3cubG9jYXRpb24uaG9zdCA6IHdpbmRvdy50b3AubG9jYXRpb24uaG9zdDtcbiAgICAgIGNvbnN0IGNvcnMgPSB1cmwuaG9zdCAhPT0gaG9zdCB8fCBicm93c2VyLmlzSUUgJiYgIXdpbmRvdy5zdmc0ZXZlcnlib2R5O1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXJsOiB0aGlzLmNvbmZpZy5pY29uVXJsLFxuICAgICAgICBjb3JzXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICAvLyBGaW5kIHRoZSBVSSBjb250cm9sc1xuICAgIGZpbmRFbGVtZW50cygpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMuZWxlbWVudHMuY29udHJvbHMgPSBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmNvbnRyb2xzLndyYXBwZXIpOyAvLyBCdXR0b25zXG5cbiAgICAgICAgdGhpcy5lbGVtZW50cy5idXR0b25zID0ge1xuICAgICAgICAgIHBsYXk6IGdldEVsZW1lbnRzLmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMucGxheSksXG4gICAgICAgICAgcGF1c2U6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5wYXVzZSksXG4gICAgICAgICAgcmVzdGFydDogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnJlc3RhcnQpLFxuICAgICAgICAgIHJld2luZDogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnJld2luZCksXG4gICAgICAgICAgZmFzdEZvcndhcmQ6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5mYXN0Rm9yd2FyZCksXG4gICAgICAgICAgbXV0ZTogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLm11dGUpLFxuICAgICAgICAgIHBpcDogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnBpcCksXG4gICAgICAgICAgYWlycGxheTogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLmFpcnBsYXkpLFxuICAgICAgICAgIHNldHRpbmdzOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMuc2V0dGluZ3MpLFxuICAgICAgICAgIGNhcHRpb25zOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMuY2FwdGlvbnMpLFxuICAgICAgICAgIGZ1bGxzY3JlZW46IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5mdWxsc2NyZWVuKVxuICAgICAgICB9OyAvLyBQcm9ncmVzc1xuXG4gICAgICAgIHRoaXMuZWxlbWVudHMucHJvZ3Jlc3MgPSBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLnByb2dyZXNzKTsgLy8gSW5wdXRzXG5cbiAgICAgICAgdGhpcy5lbGVtZW50cy5pbnB1dHMgPSB7XG4gICAgICAgICAgc2VlazogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5pbnB1dHMuc2VlayksXG4gICAgICAgICAgdm9sdW1lOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmlucHV0cy52b2x1bWUpXG4gICAgICAgIH07IC8vIERpc3BsYXlcblxuICAgICAgICB0aGlzLmVsZW1lbnRzLmRpc3BsYXkgPSB7XG4gICAgICAgICAgYnVmZmVyOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmRpc3BsYXkuYnVmZmVyKSxcbiAgICAgICAgICBjdXJyZW50VGltZTogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5kaXNwbGF5LmN1cnJlbnRUaW1lKSxcbiAgICAgICAgICBkdXJhdGlvbjogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5kaXNwbGF5LmR1cmF0aW9uKVxuICAgICAgICB9OyAvLyBTZWVrIHRvb2x0aXBcblxuICAgICAgICBpZiAoaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLnByb2dyZXNzKSkge1xuICAgICAgICAgIHRoaXMuZWxlbWVudHMuZGlzcGxheS5zZWVrVG9vbHRpcCA9IHRoaXMuZWxlbWVudHMucHJvZ3Jlc3MucXVlcnlTZWxlY3RvcihgLiR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy50b29sdGlwfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAvLyBMb2cgaXRcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdJdCBsb29rcyBsaWtlIHRoZXJlIGlzIGEgcHJvYmxlbSB3aXRoIHlvdXIgY3VzdG9tIGNvbnRyb2xzIEhUTUwnLCBlcnJvcik7IC8vIFJlc3RvcmUgbmF0aXZlIHZpZGVvIGNvbnRyb2xzXG5cbiAgICAgICAgdGhpcy50b2dnbGVOYXRpdmVDb250cm9scyh0cnVlKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBDcmVhdGUgPHN2Zz4gaWNvblxuICAgIGNyZWF0ZUljb24odHlwZSwgYXR0cmlidXRlcykge1xuICAgICAgY29uc3QgbmFtZXNwYWNlID0gJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJztcbiAgICAgIGNvbnN0IGljb25VcmwgPSBjb250cm9scy5nZXRJY29uVXJsLmNhbGwodGhpcyk7XG4gICAgICBjb25zdCBpY29uUGF0aCA9IGAkeyFpY29uVXJsLmNvcnMgPyBpY29uVXJsLnVybCA6ICcnfSMke3RoaXMuY29uZmlnLmljb25QcmVmaXh9YDsgLy8gQ3JlYXRlIDxzdmc+XG5cbiAgICAgIGNvbnN0IGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMobmFtZXNwYWNlLCAnc3ZnJyk7XG4gICAgICBzZXRBdHRyaWJ1dGVzKGljb24sIGV4dGVuZChhdHRyaWJ1dGVzLCB7XG4gICAgICAgICdhcmlhLWhpZGRlbic6ICd0cnVlJyxcbiAgICAgICAgZm9jdXNhYmxlOiAnZmFsc2UnXG4gICAgICB9KSk7IC8vIENyZWF0ZSB0aGUgPHVzZT4gdG8gcmVmZXJlbmNlIHNwcml0ZVxuXG4gICAgICBjb25zdCB1c2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMobmFtZXNwYWNlLCAndXNlJyk7XG4gICAgICBjb25zdCBwYXRoID0gYCR7aWNvblBhdGh9LSR7dHlwZX1gOyAvLyBTZXQgYGhyZWZgIGF0dHJpYnV0ZXNcbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1wb3R0cy9wbHlyL2lzc3Vlcy80NjBcbiAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL1NWRy9BdHRyaWJ1dGUveGxpbms6aHJlZlxuXG4gICAgICBpZiAoJ2hyZWYnIGluIHVzZSkge1xuICAgICAgICB1c2Uuc2V0QXR0cmlidXRlTlMoJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnLCAnaHJlZicsIHBhdGgpO1xuICAgICAgfSAvLyBBbHdheXMgc2V0IHRoZSBvbGRlciBhdHRyaWJ1dGUgZXZlbiB0aG91Z2ggaXQncyBcImRlcHJlY2F0ZWRcIiAoaXQnbGwgYmUgYXJvdW5kIGZvciBhZ2VzKVxuXG5cbiAgICAgIHVzZS5zZXRBdHRyaWJ1dGVOUygnaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycsICd4bGluazpocmVmJywgcGF0aCk7IC8vIEFkZCA8dXNlPiB0byA8c3ZnPlxuXG4gICAgICBpY29uLmFwcGVuZENoaWxkKHVzZSk7XG4gICAgICByZXR1cm4gaWNvbjtcbiAgICB9LFxuXG4gICAgLy8gQ3JlYXRlIGhpZGRlbiB0ZXh0IGxhYmVsXG4gICAgY3JlYXRlTGFiZWwoa2V5LCBhdHRyID0ge30pIHtcbiAgICAgIGNvbnN0IHRleHQgPSBpMThuLmdldChrZXksIHRoaXMuY29uZmlnKTtcbiAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB7IC4uLmF0dHIsXG4gICAgICAgIGNsYXNzOiBbYXR0ci5jbGFzcywgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5oaWRkZW5dLmZpbHRlcihCb29sZWFuKS5qb2luKCcgJylcbiAgICAgIH07XG4gICAgICByZXR1cm4gY3JlYXRlRWxlbWVudCgnc3BhbicsIGF0dHJpYnV0ZXMsIHRleHQpO1xuICAgIH0sXG5cbiAgICAvLyBDcmVhdGUgYSBiYWRnZVxuICAgIGNyZWF0ZUJhZGdlKHRleHQpIHtcbiAgICAgIGlmIChpcy5lbXB0eSh0ZXh0KSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgYmFkZ2UgPSBjcmVhdGVFbGVtZW50KCdzcGFuJywge1xuICAgICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy5tZW51LnZhbHVlXG4gICAgICB9KTtcbiAgICAgIGJhZGdlLmFwcGVuZENoaWxkKGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7XG4gICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLm1lbnUuYmFkZ2VcbiAgICAgIH0sIHRleHQpKTtcbiAgICAgIHJldHVybiBiYWRnZTtcbiAgICB9LFxuXG4gICAgLy8gQ3JlYXRlIGEgPGJ1dHRvbj5cbiAgICBjcmVhdGVCdXR0b24oYnV0dG9uVHlwZSwgYXR0cikge1xuICAgICAgY29uc3QgYXR0cmlidXRlcyA9IGV4dGVuZCh7fSwgYXR0cik7XG4gICAgICBsZXQgdHlwZSA9IHRvQ2FtZWxDYXNlKGJ1dHRvblR5cGUpO1xuICAgICAgY29uc3QgcHJvcHMgPSB7XG4gICAgICAgIGVsZW1lbnQ6ICdidXR0b24nLFxuICAgICAgICB0b2dnbGU6IGZhbHNlLFxuICAgICAgICBsYWJlbDogbnVsbCxcbiAgICAgICAgaWNvbjogbnVsbCxcbiAgICAgICAgbGFiZWxQcmVzc2VkOiBudWxsLFxuICAgICAgICBpY29uUHJlc3NlZDogbnVsbFxuICAgICAgfTtcbiAgICAgIFsnZWxlbWVudCcsICdpY29uJywgJ2xhYmVsJ10uZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBpZiAoT2JqZWN0LmtleXMoYXR0cmlidXRlcykuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgICAgIHByb3BzW2tleV0gPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgICAgZGVsZXRlIGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgfSk7IC8vIERlZmF1bHQgdG8gJ2J1dHRvbicgdHlwZSB0byBwcmV2ZW50IGZvcm0gc3VibWlzc2lvblxuXG4gICAgICBpZiAocHJvcHMuZWxlbWVudCA9PT0gJ2J1dHRvbicgJiYgIU9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmluY2x1ZGVzKCd0eXBlJykpIHtcbiAgICAgICAgYXR0cmlidXRlcy50eXBlID0gJ2J1dHRvbic7XG4gICAgICB9IC8vIFNldCBjbGFzcyBuYW1lXG5cblxuICAgICAgaWYgKE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmluY2x1ZGVzKCdjbGFzcycpKSB7XG4gICAgICAgIGlmICghYXR0cmlidXRlcy5jbGFzcy5zcGxpdCgnICcpLnNvbWUoYyA9PiBjID09PSB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2wpKSB7XG4gICAgICAgICAgZXh0ZW5kKGF0dHJpYnV0ZXMsIHtcbiAgICAgICAgICAgIGNsYXNzOiBgJHthdHRyaWJ1dGVzLmNsYXNzfSAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMuY29udHJvbH1gXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF0dHJpYnV0ZXMuY2xhc3MgPSB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2w7XG4gICAgICB9IC8vIExhcmdlIHBsYXkgYnV0dG9uXG5cblxuICAgICAgc3dpdGNoIChidXR0b25UeXBlKSB7XG4gICAgICAgIGNhc2UgJ3BsYXknOlxuICAgICAgICAgIHByb3BzLnRvZ2dsZSA9IHRydWU7XG4gICAgICAgICAgcHJvcHMubGFiZWwgPSAncGxheSc7XG4gICAgICAgICAgcHJvcHMubGFiZWxQcmVzc2VkID0gJ3BhdXNlJztcbiAgICAgICAgICBwcm9wcy5pY29uID0gJ3BsYXknO1xuICAgICAgICAgIHByb3BzLmljb25QcmVzc2VkID0gJ3BhdXNlJztcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdtdXRlJzpcbiAgICAgICAgICBwcm9wcy50b2dnbGUgPSB0cnVlO1xuICAgICAgICAgIHByb3BzLmxhYmVsID0gJ211dGUnO1xuICAgICAgICAgIHByb3BzLmxhYmVsUHJlc3NlZCA9ICd1bm11dGUnO1xuICAgICAgICAgIHByb3BzLmljb24gPSAndm9sdW1lJztcbiAgICAgICAgICBwcm9wcy5pY29uUHJlc3NlZCA9ICdtdXRlZCc7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnY2FwdGlvbnMnOlxuICAgICAgICAgIHByb3BzLnRvZ2dsZSA9IHRydWU7XG4gICAgICAgICAgcHJvcHMubGFiZWwgPSAnZW5hYmxlQ2FwdGlvbnMnO1xuICAgICAgICAgIHByb3BzLmxhYmVsUHJlc3NlZCA9ICdkaXNhYmxlQ2FwdGlvbnMnO1xuICAgICAgICAgIHByb3BzLmljb24gPSAnY2FwdGlvbnMtb2ZmJztcbiAgICAgICAgICBwcm9wcy5pY29uUHJlc3NlZCA9ICdjYXB0aW9ucy1vbic7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnZnVsbHNjcmVlbic6XG4gICAgICAgICAgcHJvcHMudG9nZ2xlID0gdHJ1ZTtcbiAgICAgICAgICBwcm9wcy5sYWJlbCA9ICdlbnRlckZ1bGxzY3JlZW4nO1xuICAgICAgICAgIHByb3BzLmxhYmVsUHJlc3NlZCA9ICdleGl0RnVsbHNjcmVlbic7XG4gICAgICAgICAgcHJvcHMuaWNvbiA9ICdlbnRlci1mdWxsc2NyZWVuJztcbiAgICAgICAgICBwcm9wcy5pY29uUHJlc3NlZCA9ICdleGl0LWZ1bGxzY3JlZW4nO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3BsYXktbGFyZ2UnOlxuICAgICAgICAgIGF0dHJpYnV0ZXMuY2xhc3MgKz0gYCAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMuY29udHJvbH0tLW92ZXJsYWlkYDtcbiAgICAgICAgICB0eXBlID0gJ3BsYXknO1xuICAgICAgICAgIHByb3BzLmxhYmVsID0gJ3BsYXknO1xuICAgICAgICAgIHByb3BzLmljb24gPSAncGxheSc7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBpZiAoaXMuZW1wdHkocHJvcHMubGFiZWwpKSB7XG4gICAgICAgICAgICBwcm9wcy5sYWJlbCA9IHR5cGU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGlzLmVtcHR5KHByb3BzLmljb24pKSB7XG4gICAgICAgICAgICBwcm9wcy5pY29uID0gYnV0dG9uVHlwZTtcbiAgICAgICAgICB9XG5cbiAgICAgIH1cblxuICAgICAgY29uc3QgYnV0dG9uID0gY3JlYXRlRWxlbWVudChwcm9wcy5lbGVtZW50KTsgLy8gU2V0dXAgdG9nZ2xlIGljb24gYW5kIGxhYmVsc1xuXG4gICAgICBpZiAocHJvcHMudG9nZ2xlKSB7XG4gICAgICAgIC8vIEljb25cbiAgICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKGNvbnRyb2xzLmNyZWF0ZUljb24uY2FsbCh0aGlzLCBwcm9wcy5pY29uUHJlc3NlZCwge1xuICAgICAgICAgIGNsYXNzOiAnaWNvbi0tcHJlc3NlZCdcbiAgICAgICAgfSkpO1xuICAgICAgICBidXR0b24uYXBwZW5kQ2hpbGQoY29udHJvbHMuY3JlYXRlSWNvbi5jYWxsKHRoaXMsIHByb3BzLmljb24sIHtcbiAgICAgICAgICBjbGFzczogJ2ljb24tLW5vdC1wcmVzc2VkJ1xuICAgICAgICB9KSk7IC8vIExhYmVsL1Rvb2x0aXBcblxuICAgICAgICBidXR0b24uYXBwZW5kQ2hpbGQoY29udHJvbHMuY3JlYXRlTGFiZWwuY2FsbCh0aGlzLCBwcm9wcy5sYWJlbFByZXNzZWQsIHtcbiAgICAgICAgICBjbGFzczogJ2xhYmVsLS1wcmVzc2VkJ1xuICAgICAgICB9KSk7XG4gICAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChjb250cm9scy5jcmVhdGVMYWJlbC5jYWxsKHRoaXMsIHByb3BzLmxhYmVsLCB7XG4gICAgICAgICAgY2xhc3M6ICdsYWJlbC0tbm90LXByZXNzZWQnXG4gICAgICAgIH0pKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChjb250cm9scy5jcmVhdGVJY29uLmNhbGwodGhpcywgcHJvcHMuaWNvbikpO1xuICAgICAgICBidXR0b24uYXBwZW5kQ2hpbGQoY29udHJvbHMuY3JlYXRlTGFiZWwuY2FsbCh0aGlzLCBwcm9wcy5sYWJlbCkpO1xuICAgICAgfSAvLyBNZXJnZSBhbmQgc2V0IGF0dHJpYnV0ZXNcblxuXG4gICAgICBleHRlbmQoYXR0cmlidXRlcywgZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9uc1t0eXBlXSwgYXR0cmlidXRlcykpO1xuICAgICAgc2V0QXR0cmlidXRlcyhidXR0b24sIGF0dHJpYnV0ZXMpOyAvLyBXZSBoYXZlIG11bHRpcGxlIHBsYXkgYnV0dG9uc1xuXG4gICAgICBpZiAodHlwZSA9PT0gJ3BsYXknKSB7XG4gICAgICAgIGlmICghaXMuYXJyYXkodGhpcy5lbGVtZW50cy5idXR0b25zW3R5cGVdKSkge1xuICAgICAgICAgIHRoaXMuZWxlbWVudHMuYnV0dG9uc1t0eXBlXSA9IFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lbGVtZW50cy5idXR0b25zW3R5cGVdLnB1c2goYnV0dG9uKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZWxlbWVudHMuYnV0dG9uc1t0eXBlXSA9IGJ1dHRvbjtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGJ1dHRvbjtcbiAgICB9LFxuXG4gICAgLy8gQ3JlYXRlIGFuIDxpbnB1dCB0eXBlPSdyYW5nZSc+XG4gICAgY3JlYXRlUmFuZ2UodHlwZSwgYXR0cmlidXRlcykge1xuICAgICAgLy8gU2VlayBpbnB1dFxuICAgICAgY29uc3QgaW5wdXQgPSBjcmVhdGVFbGVtZW50KCdpbnB1dCcsIGV4dGVuZChnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5pbnB1dHNbdHlwZV0pLCB7XG4gICAgICAgIHR5cGU6ICdyYW5nZScsXG4gICAgICAgIG1pbjogMCxcbiAgICAgICAgbWF4OiAxMDAsXG4gICAgICAgIHN0ZXA6IDAuMDEsXG4gICAgICAgIHZhbHVlOiAwLFxuICAgICAgICBhdXRvY29tcGxldGU6ICdvZmYnLFxuICAgICAgICAvLyBBMTF5IGZpeGVzIGZvciBodHRwczovL2dpdGh1Yi5jb20vc2FtcG90dHMvcGx5ci9pc3N1ZXMvOTA1XG4gICAgICAgIHJvbGU6ICdzbGlkZXInLFxuICAgICAgICAnYXJpYS1sYWJlbCc6IGkxOG4uZ2V0KHR5cGUsIHRoaXMuY29uZmlnKSxcbiAgICAgICAgJ2FyaWEtdmFsdWVtaW4nOiAwLFxuICAgICAgICAnYXJpYS12YWx1ZW1heCc6IDEwMCxcbiAgICAgICAgJ2FyaWEtdmFsdWVub3cnOiAwXG4gICAgICB9LCBhdHRyaWJ1dGVzKSk7XG4gICAgICB0aGlzLmVsZW1lbnRzLmlucHV0c1t0eXBlXSA9IGlucHV0OyAvLyBTZXQgdGhlIGZpbGwgZm9yIHdlYmtpdCBub3dcblxuICAgICAgY29udHJvbHMudXBkYXRlUmFuZ2VGaWxsLmNhbGwodGhpcywgaW5wdXQpOyAvLyBJbXByb3ZlIHN1cHBvcnQgb24gdG91Y2ggZGV2aWNlc1xuXG4gICAgICBSYW5nZVRvdWNoLnNldHVwKGlucHV0KTtcbiAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9LFxuXG4gICAgLy8gQ3JlYXRlIGEgPHByb2dyZXNzPlxuICAgIGNyZWF0ZVByb2dyZXNzKHR5cGUsIGF0dHJpYnV0ZXMpIHtcbiAgICAgIGNvbnN0IHByb2dyZXNzID0gY3JlYXRlRWxlbWVudCgncHJvZ3Jlc3MnLCBleHRlbmQoZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuZGlzcGxheVt0eXBlXSksIHtcbiAgICAgICAgbWluOiAwLFxuICAgICAgICBtYXg6IDEwMCxcbiAgICAgICAgdmFsdWU6IDAsXG4gICAgICAgIHJvbGU6ICdwcm9ncmVzc2JhcicsXG4gICAgICAgICdhcmlhLWhpZGRlbic6IHRydWVcbiAgICAgIH0sIGF0dHJpYnV0ZXMpKTsgLy8gQ3JlYXRlIHRoZSBsYWJlbCBpbnNpZGVcblxuICAgICAgaWYgKHR5cGUgIT09ICd2b2x1bWUnKSB7XG4gICAgICAgIHByb2dyZXNzLmFwcGVuZENoaWxkKGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCBudWxsLCAnMCcpKTtcbiAgICAgICAgY29uc3Qgc3VmZml4S2V5ID0ge1xuICAgICAgICAgIHBsYXllZDogJ3BsYXllZCcsXG4gICAgICAgICAgYnVmZmVyOiAnYnVmZmVyZWQnXG4gICAgICAgIH1bdHlwZV07XG4gICAgICAgIGNvbnN0IHN1ZmZpeCA9IHN1ZmZpeEtleSA/IGkxOG4uZ2V0KHN1ZmZpeEtleSwgdGhpcy5jb25maWcpIDogJyc7XG4gICAgICAgIHByb2dyZXNzLmlubmVyVGV4dCA9IGAlICR7c3VmZml4LnRvTG93ZXJDYXNlKCl9YDtcbiAgICAgIH1cblxuICAgICAgdGhpcy5lbGVtZW50cy5kaXNwbGF5W3R5cGVdID0gcHJvZ3Jlc3M7XG4gICAgICByZXR1cm4gcHJvZ3Jlc3M7XG4gICAgfSxcblxuICAgIC8vIENyZWF0ZSB0aW1lIGRpc3BsYXlcbiAgICBjcmVhdGVUaW1lKHR5cGUsIGF0dHJzKSB7XG4gICAgICBjb25zdCBhdHRyaWJ1dGVzID0gZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuZGlzcGxheVt0eXBlXSwgYXR0cnMpO1xuICAgICAgY29uc3QgY29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2JywgZXh0ZW5kKGF0dHJpYnV0ZXMsIHtcbiAgICAgICAgY2xhc3M6IGAke2F0dHJpYnV0ZXMuY2xhc3MgPyBhdHRyaWJ1dGVzLmNsYXNzIDogJyd9ICR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy5kaXNwbGF5LnRpbWV9IGAudHJpbSgpLFxuICAgICAgICAnYXJpYS1sYWJlbCc6IGkxOG4uZ2V0KHR5cGUsIHRoaXMuY29uZmlnKVxuICAgICAgfSksICcwMDowMCcpOyAvLyBSZWZlcmVuY2UgZm9yIHVwZGF0ZXNcblxuICAgICAgdGhpcy5lbGVtZW50cy5kaXNwbGF5W3R5cGVdID0gY29udGFpbmVyO1xuICAgICAgcmV0dXJuIGNvbnRhaW5lcjtcbiAgICB9LFxuXG4gICAgLy8gQmluZCBrZXlib2FyZCBzaG9ydGN1dHMgZm9yIGEgbWVudSBpdGVtXG4gICAgLy8gV2UgaGF2ZSB0byBiaW5kIHRvIGtleXVwIG90aGVyd2lzZSBGaXJlZm94IHRyaWdnZXJzIGEgY2xpY2sgd2hlbiBhIGtleWRvd24gZXZlbnQgaGFuZGxlciBzaGlmdHMgZm9jdXNcbiAgICAvLyBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD0xMjIwMTQzXG4gICAgYmluZE1lbnVJdGVtU2hvcnRjdXRzKG1lbnVJdGVtLCB0eXBlKSB7XG4gICAgICAvLyBOYXZpZ2F0ZSB0aHJvdWdoIG1lbnVzIHZpYSBhcnJvdyBrZXlzIGFuZCBzcGFjZVxuICAgICAgb24uY2FsbCh0aGlzLCBtZW51SXRlbSwgJ2tleWRvd24ga2V5dXAnLCBldmVudCA9PiB7XG4gICAgICAgIC8vIFdlIG9ubHkgY2FyZSBhYm91dCBzcGFjZSBhbmQg4qyG77iPIOKsh++4j++4jyDinqHvuI9cbiAgICAgICAgaWYgKCFbJ1NwYWNlJywgJ0Fycm93VXAnLCAnQXJyb3dEb3duJywgJ0Fycm93UmlnaHQnXS5pbmNsdWRlcyhldmVudC5rZXkpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIFByZXZlbnQgcGxheSAvIHNlZWtcblxuXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOyAvLyBXZSdyZSBqdXN0IGhlcmUgdG8gcHJldmVudCB0aGUga2V5ZG93biBidWJibGluZ1xuXG4gICAgICAgIGlmIChldmVudC50eXBlID09PSAna2V5ZG93bicpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBpc1JhZGlvQnV0dG9uID0gbWF0Y2hlcyhtZW51SXRlbSwgJ1tyb2xlPVwibWVudWl0ZW1yYWRpb1wiXScpOyAvLyBTaG93IHRoZSByZXNwZWN0aXZlIG1lbnVcblxuICAgICAgICBpZiAoIWlzUmFkaW9CdXR0b24gJiYgWydTcGFjZScsICdBcnJvd1JpZ2h0J10uaW5jbHVkZXMoZXZlbnQua2V5KSkge1xuICAgICAgICAgIGNvbnRyb2xzLnNob3dNZW51UGFuZWwuY2FsbCh0aGlzLCB0eXBlLCB0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsZXQgdGFyZ2V0O1xuXG4gICAgICAgICAgaWYgKGV2ZW50LmtleSAhPT0gJ1NwYWNlJykge1xuICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ0Fycm93RG93bicgfHwgaXNSYWRpb0J1dHRvbiAmJiBldmVudC5rZXkgPT09ICdBcnJvd1JpZ2h0Jykge1xuICAgICAgICAgICAgICB0YXJnZXQgPSBtZW51SXRlbS5uZXh0RWxlbWVudFNpYmxpbmc7XG5cbiAgICAgICAgICAgICAgaWYgKCFpcy5lbGVtZW50KHRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSBtZW51SXRlbS5wYXJlbnROb2RlLmZpcnN0RWxlbWVudENoaWxkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0YXJnZXQgPSBtZW51SXRlbS5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgIGlmICghaXMuZWxlbWVudCh0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gbWVudUl0ZW0ucGFyZW50Tm9kZS5sYXN0RWxlbWVudENoaWxkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNldEZvY3VzLmNhbGwodGhpcywgdGFyZ2V0LCB0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIGZhbHNlKTsgLy8gRW50ZXIgd2lsbCBmaXJlIGEgYGNsaWNrYCBldmVudCBidXQgd2Ugc3RpbGwgbmVlZCB0byBtYW5hZ2UgZm9jdXNcbiAgICAgIC8vIFNvIHdlIGJpbmQgdG8ga2V5dXAgd2hpY2ggZmlyZXMgYWZ0ZXIgYW5kIHNldCBmb2N1cyBoZXJlXG5cbiAgICAgIG9uLmNhbGwodGhpcywgbWVudUl0ZW0sICdrZXl1cCcsIGV2ZW50ID0+IHtcbiAgICAgICAgaWYgKGV2ZW50LmtleSAhPT0gJ1JldHVybicpIHJldHVybjtcbiAgICAgICAgY29udHJvbHMuZm9jdXNGaXJzdE1lbnVJdGVtLmNhbGwodGhpcywgbnVsbCwgdHJ1ZSk7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgLy8gQ3JlYXRlIGEgc2V0dGluZ3MgbWVudSBpdGVtXG4gICAgY3JlYXRlTWVudUl0ZW0oe1xuICAgICAgdmFsdWUsXG4gICAgICBsaXN0LFxuICAgICAgdHlwZSxcbiAgICAgIHRpdGxlLFxuICAgICAgYmFkZ2UgPSBudWxsLFxuICAgICAgY2hlY2tlZCA9IGZhbHNlXG4gICAgfSkge1xuICAgICAgY29uc3QgYXR0cmlidXRlcyA9IGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLmlucHV0c1t0eXBlXSk7XG4gICAgICBjb25zdCBtZW51SXRlbSA9IGNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicsIGV4dGVuZChhdHRyaWJ1dGVzLCB7XG4gICAgICAgIHR5cGU6ICdidXR0b24nLFxuICAgICAgICByb2xlOiAnbWVudWl0ZW1yYWRpbycsXG4gICAgICAgIGNsYXNzOiBgJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2x9ICR7YXR0cmlidXRlcy5jbGFzcyA/IGF0dHJpYnV0ZXMuY2xhc3MgOiAnJ31gLnRyaW0oKSxcbiAgICAgICAgJ2FyaWEtY2hlY2tlZCc6IGNoZWNrZWQsXG4gICAgICAgIHZhbHVlXG4gICAgICB9KSk7XG4gICAgICBjb25zdCBmbGV4ID0gY3JlYXRlRWxlbWVudCgnc3BhbicpOyAvLyBXZSBoYXZlIHRvIHNldCBhcyBIVE1MIGluY2FzZSBvZiBzcGVjaWFsIGNoYXJhY3RlcnNcblxuICAgICAgZmxleC5pbm5lckhUTUwgPSB0aXRsZTtcblxuICAgICAgaWYgKGlzLmVsZW1lbnQoYmFkZ2UpKSB7XG4gICAgICAgIGZsZXguYXBwZW5kQ2hpbGQoYmFkZ2UpO1xuICAgICAgfVxuXG4gICAgICBtZW51SXRlbS5hcHBlbmRDaGlsZChmbGV4KTsgLy8gUmVwbGljYXRlIHJhZGlvIGJ1dHRvbiBiZWhhdmlvclxuXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobWVudUl0ZW0sICdjaGVja2VkJywge1xuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuXG4gICAgICAgIGdldCgpIHtcbiAgICAgICAgICByZXR1cm4gbWVudUl0ZW0uZ2V0QXR0cmlidXRlKCdhcmlhLWNoZWNrZWQnKSA9PT0gJ3RydWUnO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldChjaGVjaykge1xuICAgICAgICAgIC8vIEVuc3VyZSBleGNsdXNpdml0eVxuICAgICAgICAgIGlmIChjaGVjaykge1xuICAgICAgICAgICAgQXJyYXkuZnJvbShtZW51SXRlbS5wYXJlbnROb2RlLmNoaWxkcmVuKS5maWx0ZXIobm9kZSA9PiBtYXRjaGVzKG5vZGUsICdbcm9sZT1cIm1lbnVpdGVtcmFkaW9cIl0nKSkuZm9yRWFjaChub2RlID0+IG5vZGUuc2V0QXR0cmlidXRlKCdhcmlhLWNoZWNrZWQnLCAnZmFsc2UnKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbWVudUl0ZW0uc2V0QXR0cmlidXRlKCdhcmlhLWNoZWNrZWQnLCBjaGVjayA/ICd0cnVlJyA6ICdmYWxzZScpO1xuICAgICAgICB9XG5cbiAgICAgIH0pO1xuICAgICAgdGhpcy5saXN0ZW5lcnMuYmluZChtZW51SXRlbSwgJ2NsaWNrIGtleXVwJywgZXZlbnQgPT4ge1xuICAgICAgICBpZiAoaXMua2V5Ym9hcmRFdmVudChldmVudCkgJiYgZXZlbnQua2V5ICE9PSAnU3BhY2UnKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIG1lbnVJdGVtLmNoZWNrZWQgPSB0cnVlO1xuXG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgIGNhc2UgJ2xhbmd1YWdlJzpcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFRyYWNrID0gTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAncXVhbGl0eSc6XG4gICAgICAgICAgICB0aGlzLnF1YWxpdHkgPSB2YWx1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnc3BlZWQnOlxuICAgICAgICAgICAgdGhpcy5zcGVlZCA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBjb250cm9scy5zaG93TWVudVBhbmVsLmNhbGwodGhpcywgJ2hvbWUnLCBpcy5rZXlib2FyZEV2ZW50KGV2ZW50KSk7XG4gICAgICB9LCB0eXBlLCBmYWxzZSk7XG4gICAgICBjb250cm9scy5iaW5kTWVudUl0ZW1TaG9ydGN1dHMuY2FsbCh0aGlzLCBtZW51SXRlbSwgdHlwZSk7XG4gICAgICBsaXN0LmFwcGVuZENoaWxkKG1lbnVJdGVtKTtcbiAgICB9LFxuXG4gICAgLy8gRm9ybWF0IGEgdGltZSBmb3IgZGlzcGxheVxuICAgIGZvcm1hdFRpbWUodGltZSA9IDAsIGludmVydGVkID0gZmFsc2UpIHtcbiAgICAgIC8vIEJhaWwgaWYgdGhlIHZhbHVlIGlzbid0IGEgbnVtYmVyXG4gICAgICBpZiAoIWlzLm51bWJlcih0aW1lKSkge1xuICAgICAgICByZXR1cm4gdGltZTtcbiAgICAgIH0gLy8gQWx3YXlzIGRpc3BsYXkgaG91cnMgaWYgZHVyYXRpb24gaXMgb3ZlciBhbiBob3VyXG5cblxuICAgICAgY29uc3QgZm9yY2VIb3VycyA9IGdldEhvdXJzKHRoaXMuZHVyYXRpb24pID4gMDtcbiAgICAgIHJldHVybiBmb3JtYXRUaW1lKHRpbWUsIGZvcmNlSG91cnMsIGludmVydGVkKTtcbiAgICB9LFxuXG4gICAgLy8gVXBkYXRlIHRoZSBkaXNwbGF5ZWQgdGltZVxuICAgIHVwZGF0ZVRpbWVEaXNwbGF5KHRhcmdldCA9IG51bGwsIHRpbWUgPSAwLCBpbnZlcnRlZCA9IGZhbHNlKSB7XG4gICAgICAvLyBCYWlsIGlmIHRoZXJlJ3Mgbm8gZWxlbWVudCB0byBkaXNwbGF5IG9yIHRoZSB2YWx1ZSBpc24ndCBhIG51bWJlclxuICAgICAgaWYgKCFpcy5lbGVtZW50KHRhcmdldCkgfHwgIWlzLm51bWJlcih0aW1lKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuXG5cbiAgICAgIHRhcmdldC5pbm5lclRleHQgPSBjb250cm9scy5mb3JtYXRUaW1lKHRpbWUsIGludmVydGVkKTtcbiAgICB9LFxuXG4gICAgLy8gVXBkYXRlIHZvbHVtZSBVSSBhbmQgc3RvcmFnZVxuICAgIHVwZGF0ZVZvbHVtZSgpIHtcbiAgICAgIGlmICghdGhpcy5zdXBwb3J0ZWQudWkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBVcGRhdGUgcmFuZ2VcblxuXG4gICAgICBpZiAoaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmlucHV0cy52b2x1bWUpKSB7XG4gICAgICAgIGNvbnRyb2xzLnNldFJhbmdlLmNhbGwodGhpcywgdGhpcy5lbGVtZW50cy5pbnB1dHMudm9sdW1lLCB0aGlzLm11dGVkID8gMCA6IHRoaXMudm9sdW1lKTtcbiAgICAgIH0gLy8gVXBkYXRlIG11dGUgc3RhdGVcblxuXG4gICAgICBpZiAoaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmJ1dHRvbnMubXV0ZSkpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50cy5idXR0b25zLm11dGUucHJlc3NlZCA9IHRoaXMubXV0ZWQgfHwgdGhpcy52b2x1bWUgPT09IDA7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIFVwZGF0ZSBzZWVrIHZhbHVlIGFuZCBsb3dlciBmaWxsXG4gICAgc2V0UmFuZ2UodGFyZ2V0LCB2YWx1ZSA9IDApIHtcbiAgICAgIGlmICghaXMuZWxlbWVudCh0YXJnZXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG5cblxuICAgICAgdGFyZ2V0LnZhbHVlID0gdmFsdWU7IC8vIFdlYmtpdCByYW5nZSBmaWxsXG5cbiAgICAgIGNvbnRyb2xzLnVwZGF0ZVJhbmdlRmlsbC5jYWxsKHRoaXMsIHRhcmdldCk7XG4gICAgfSxcblxuICAgIC8vIFVwZGF0ZSA8cHJvZ3Jlc3M+IGVsZW1lbnRzXG4gICAgdXBkYXRlUHJvZ3Jlc3MoZXZlbnQpIHtcbiAgICAgIGlmICghdGhpcy5zdXBwb3J0ZWQudWkgfHwgIWlzLmV2ZW50KGV2ZW50KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCB2YWx1ZSA9IDA7XG5cbiAgICAgIGNvbnN0IHNldFByb2dyZXNzID0gKHRhcmdldCwgaW5wdXQpID0+IHtcbiAgICAgICAgY29uc3QgdmFsID0gaXMubnVtYmVyKGlucHV0KSA/IGlucHV0IDogMDtcbiAgICAgICAgY29uc3QgcHJvZ3Jlc3MgPSBpcy5lbGVtZW50KHRhcmdldCkgPyB0YXJnZXQgOiB0aGlzLmVsZW1lbnRzLmRpc3BsYXkuYnVmZmVyOyAvLyBVcGRhdGUgdmFsdWUgYW5kIGxhYmVsXG5cbiAgICAgICAgaWYgKGlzLmVsZW1lbnQocHJvZ3Jlc3MpKSB7XG4gICAgICAgICAgcHJvZ3Jlc3MudmFsdWUgPSB2YWw7IC8vIFVwZGF0ZSB0ZXh0IGxhYmVsIGluc2lkZVxuXG4gICAgICAgICAgY29uc3QgbGFiZWwgPSBwcm9ncmVzcy5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc3BhbicpWzBdO1xuXG4gICAgICAgICAgaWYgKGlzLmVsZW1lbnQobGFiZWwpKSB7XG4gICAgICAgICAgICBsYWJlbC5jaGlsZE5vZGVzWzBdLm5vZGVWYWx1ZSA9IHZhbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGlmIChldmVudCkge1xuICAgICAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcbiAgICAgICAgICAvLyBWaWRlbyBwbGF5aW5nXG4gICAgICAgICAgY2FzZSAndGltZXVwZGF0ZSc6XG4gICAgICAgICAgY2FzZSAnc2Vla2luZyc6XG4gICAgICAgICAgY2FzZSAnc2Vla2VkJzpcbiAgICAgICAgICAgIHZhbHVlID0gZ2V0UGVyY2VudGFnZSh0aGlzLmN1cnJlbnRUaW1lLCB0aGlzLmR1cmF0aW9uKTsgLy8gU2V0IHNlZWsgcmFuZ2UgdmFsdWUgb25seSBpZiBpdCdzIGEgJ25hdHVyYWwnIHRpbWUgZXZlbnRcblxuICAgICAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09ICd0aW1ldXBkYXRlJykge1xuICAgICAgICAgICAgICBjb250cm9scy5zZXRSYW5nZS5jYWxsKHRoaXMsIHRoaXMuZWxlbWVudHMuaW5wdXRzLnNlZWssIHZhbHVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgLy8gQ2hlY2sgYnVmZmVyIHN0YXR1c1xuXG4gICAgICAgICAgY2FzZSAncGxheWluZyc6XG4gICAgICAgICAgY2FzZSAncHJvZ3Jlc3MnOlxuICAgICAgICAgICAgc2V0UHJvZ3Jlc3ModGhpcy5lbGVtZW50cy5kaXNwbGF5LmJ1ZmZlciwgdGhpcy5idWZmZXJlZCAqIDEwMCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBXZWJraXQgcG9seWZpbGwgZm9yIGxvd2VyIGZpbGwgcmFuZ2VcbiAgICB1cGRhdGVSYW5nZUZpbGwodGFyZ2V0KSB7XG4gICAgICAvLyBHZXQgcmFuZ2UgZnJvbSBldmVudCBpZiBldmVudCBwYXNzZWRcbiAgICAgIGNvbnN0IHJhbmdlID0gaXMuZXZlbnQodGFyZ2V0KSA/IHRhcmdldC50YXJnZXQgOiB0YXJnZXQ7IC8vIE5lZWRzIHRvIGJlIGEgdmFsaWQgPGlucHV0IHR5cGU9J3JhbmdlJz5cblxuICAgICAgaWYgKCFpcy5lbGVtZW50KHJhbmdlKSB8fCByYW5nZS5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSAhPT0gJ3JhbmdlJykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIFNldCBhcmlhIHZhbHVlcyBmb3IgaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzkwNVxuXG5cbiAgICAgIGlmIChtYXRjaGVzKHJhbmdlLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuaW5wdXRzLnNlZWspKSB7XG4gICAgICAgIHJhbmdlLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycsIHRoaXMuY3VycmVudFRpbWUpO1xuICAgICAgICBjb25zdCBjdXJyZW50VGltZSA9IGNvbnRyb2xzLmZvcm1hdFRpbWUodGhpcy5jdXJyZW50VGltZSk7XG4gICAgICAgIGNvbnN0IGR1cmF0aW9uID0gY29udHJvbHMuZm9ybWF0VGltZSh0aGlzLmR1cmF0aW9uKTtcbiAgICAgICAgY29uc3QgZm9ybWF0ID0gaTE4bi5nZXQoJ3NlZWtMYWJlbCcsIHRoaXMuY29uZmlnKTtcbiAgICAgICAgcmFuZ2Uuc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVldGV4dCcsIGZvcm1hdC5yZXBsYWNlKCd7Y3VycmVudFRpbWV9JywgY3VycmVudFRpbWUpLnJlcGxhY2UoJ3tkdXJhdGlvbn0nLCBkdXJhdGlvbikpO1xuICAgICAgfSBlbHNlIGlmIChtYXRjaGVzKHJhbmdlLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuaW5wdXRzLnZvbHVtZSkpIHtcbiAgICAgICAgY29uc3QgcGVyY2VudCA9IHJhbmdlLnZhbHVlICogMTAwO1xuICAgICAgICByYW5nZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnLCBwZXJjZW50KTtcbiAgICAgICAgcmFuZ2Uuc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVldGV4dCcsIGAke3BlcmNlbnQudG9GaXhlZCgxKX0lYCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByYW5nZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnLCByYW5nZS52YWx1ZSk7XG4gICAgICB9IC8vIFdlYktpdCBvbmx5XG5cblxuICAgICAgaWYgKCFicm93c2VyLmlzV2Via2l0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gU2V0IENTUyBjdXN0b20gcHJvcGVydHlcblxuXG4gICAgICByYW5nZS5zdHlsZS5zZXRQcm9wZXJ0eSgnLS12YWx1ZScsIGAke3JhbmdlLnZhbHVlIC8gcmFuZ2UubWF4ICogMTAwfSVgKTtcbiAgICB9LFxuXG4gICAgLy8gVXBkYXRlIGhvdmVyIHRvb2x0aXAgZm9yIHNlZWtpbmdcbiAgICB1cGRhdGVTZWVrVG9vbHRpcChldmVudCkge1xuICAgICAgdmFyIF90aGlzJGNvbmZpZyRtYXJrZXJzLCBfdGhpcyRjb25maWckbWFya2VycyQ7XG5cbiAgICAgIC8vIEJhaWwgaWYgc2V0dGluZyBub3QgdHJ1ZVxuICAgICAgaWYgKCF0aGlzLmNvbmZpZy50b29sdGlwcy5zZWVrIHx8ICFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuaW5wdXRzLnNlZWspIHx8ICFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuZGlzcGxheS5zZWVrVG9vbHRpcCkgfHwgdGhpcy5kdXJhdGlvbiA9PT0gMCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRpcEVsZW1lbnQgPSB0aGlzLmVsZW1lbnRzLmRpc3BsYXkuc2Vla1Rvb2x0aXA7XG4gICAgICBjb25zdCB2aXNpYmxlID0gYCR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy50b29sdGlwfS0tdmlzaWJsZWA7XG5cbiAgICAgIGNvbnN0IHRvZ2dsZSA9IHNob3cgPT4gdG9nZ2xlQ2xhc3ModGlwRWxlbWVudCwgdmlzaWJsZSwgc2hvdyk7IC8vIEhpZGUgb24gdG91Y2hcblxuXG4gICAgICBpZiAodGhpcy50b3VjaCkge1xuICAgICAgICB0b2dnbGUoZmFsc2UpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIERldGVybWluZSBwZXJjZW50YWdlLCBpZiBhbHJlYWR5IHZpc2libGVcblxuXG4gICAgICBsZXQgcGVyY2VudCA9IDA7XG4gICAgICBjb25zdCBjbGllbnRSZWN0ID0gdGhpcy5lbGVtZW50cy5wcm9ncmVzcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgaWYgKGlzLmV2ZW50KGV2ZW50KSkge1xuICAgICAgICBwZXJjZW50ID0gMTAwIC8gY2xpZW50UmVjdC53aWR0aCAqIChldmVudC5wYWdlWCAtIGNsaWVudFJlY3QubGVmdCk7XG4gICAgICB9IGVsc2UgaWYgKGhhc0NsYXNzKHRpcEVsZW1lbnQsIHZpc2libGUpKSB7XG4gICAgICAgIHBlcmNlbnQgPSBwYXJzZUZsb2F0KHRpcEVsZW1lbnQuc3R5bGUubGVmdCwgMTApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBTZXQgYm91bmRzXG5cblxuICAgICAgaWYgKHBlcmNlbnQgPCAwKSB7XG4gICAgICAgIHBlcmNlbnQgPSAwO1xuICAgICAgfSBlbHNlIGlmIChwZXJjZW50ID4gMTAwKSB7XG4gICAgICAgIHBlcmNlbnQgPSAxMDA7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRpbWUgPSB0aGlzLmR1cmF0aW9uIC8gMTAwICogcGVyY2VudDsgLy8gRGlzcGxheSB0aGUgdGltZSBhIGNsaWNrIHdvdWxkIHNlZWsgdG9cblxuICAgICAgdGlwRWxlbWVudC5pbm5lclRleHQgPSBjb250cm9scy5mb3JtYXRUaW1lKHRpbWUpOyAvLyBHZXQgbWFya2VyIHBvaW50IGZvciB0aW1lXG5cbiAgICAgIGNvbnN0IHBvaW50ID0gKF90aGlzJGNvbmZpZyRtYXJrZXJzID0gdGhpcy5jb25maWcubWFya2VycykgPT09IG51bGwgfHwgX3RoaXMkY29uZmlnJG1hcmtlcnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfdGhpcyRjb25maWckbWFya2VycyQgPSBfdGhpcyRjb25maWckbWFya2Vycy5wb2ludHMpID09PSBudWxsIHx8IF90aGlzJGNvbmZpZyRtYXJrZXJzJCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkY29uZmlnJG1hcmtlcnMkLmZpbmQoKHtcbiAgICAgICAgdGltZTogdFxuICAgICAgfSkgPT4gdCA9PT0gTWF0aC5yb3VuZCh0aW1lKSk7IC8vIEFwcGVuZCB0aGUgcG9pbnQgbGFiZWwgdG8gdGhlIHRvb2x0aXBcblxuICAgICAgaWYgKHBvaW50KSB7XG4gICAgICAgIHRpcEVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlcmJlZ2luJywgYCR7cG9pbnQubGFiZWx9PGJyPmApO1xuICAgICAgfSAvLyBTZXQgcG9zaXRpb25cblxuXG4gICAgICB0aXBFbGVtZW50LnN0eWxlLmxlZnQgPSBgJHtwZXJjZW50fSVgOyAvLyBTaG93L2hpZGUgdGhlIHRvb2x0aXBcbiAgICAgIC8vIElmIHRoZSBldmVudCBpcyBhIG1vdWVzIGluL291dCBhbmQgcGVyY2VudGFnZSBpcyBpbnNpZGUgYm91bmRzXG5cbiAgICAgIGlmIChpcy5ldmVudChldmVudCkgJiYgWydtb3VzZWVudGVyJywgJ21vdXNlbGVhdmUnXS5pbmNsdWRlcyhldmVudC50eXBlKSkge1xuICAgICAgICB0b2dnbGUoZXZlbnQudHlwZSA9PT0gJ21vdXNlZW50ZXInKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gSGFuZGxlIHRpbWUgY2hhbmdlIGV2ZW50XG4gICAgdGltZVVwZGF0ZShldmVudCkge1xuICAgICAgLy8gT25seSBpbnZlcnQgaWYgb25seSBvbmUgdGltZSBlbGVtZW50IGlzIGRpc3BsYXllZCBhbmQgdXNlZCBmb3IgYm90aCBkdXJhdGlvbiBhbmQgY3VycmVudFRpbWVcbiAgICAgIGNvbnN0IGludmVydCA9ICFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuZGlzcGxheS5kdXJhdGlvbikgJiYgdGhpcy5jb25maWcuaW52ZXJ0VGltZTsgLy8gRHVyYXRpb25cblxuICAgICAgY29udHJvbHMudXBkYXRlVGltZURpc3BsYXkuY2FsbCh0aGlzLCB0aGlzLmVsZW1lbnRzLmRpc3BsYXkuY3VycmVudFRpbWUsIGludmVydCA/IHRoaXMuZHVyYXRpb24gLSB0aGlzLmN1cnJlbnRUaW1lIDogdGhpcy5jdXJyZW50VGltZSwgaW52ZXJ0KTsgLy8gSWdub3JlIHVwZGF0ZXMgd2hpbGUgc2Vla2luZ1xuXG4gICAgICBpZiAoZXZlbnQgJiYgZXZlbnQudHlwZSA9PT0gJ3RpbWV1cGRhdGUnICYmIHRoaXMubWVkaWEuc2Vla2luZykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIFBsYXlpbmcgcHJvZ3Jlc3NcblxuXG4gICAgICBjb250cm9scy51cGRhdGVQcm9ncmVzcy5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9LFxuXG4gICAgLy8gU2hvdyB0aGUgZHVyYXRpb24gb24gbWV0YWRhdGFsb2FkZWQgb3IgZHVyYXRpb25jaGFuZ2UgZXZlbnRzXG4gICAgZHVyYXRpb25VcGRhdGUoKSB7XG4gICAgICAvLyBCYWlsIGlmIG5vIFVJIG9yIGR1cmF0aW9uY2hhbmdlIGV2ZW50IHRyaWdnZXJlZCBhZnRlciBwbGF5aW5nL3NlZWsgd2hlbiBpbnZlcnRUaW1lIGlzIGZhbHNlXG4gICAgICBpZiAoIXRoaXMuc3VwcG9ydGVkLnVpIHx8ICF0aGlzLmNvbmZpZy5pbnZlcnRUaW1lICYmIHRoaXMuY3VycmVudFRpbWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBJZiBkdXJhdGlvbiBpcyB0aGUgMioqMzIgKHNoYWthKSwgSW5maW5pdHkgKEhMUyksIERBU0gtSUYgKE51bWJlci5NQVhfU0FGRV9JTlRFR0VSIHx8IE51bWJlci5NQVhfVkFMVUUpIGluZGljYXRpbmcgbGl2ZSB3ZSBoaWRlIHRoZSBjdXJyZW50VGltZSBhbmQgcHJvZ3Jlc3NiYXIuXG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vdmlkZW8tZGV2L2hscy5qcy9ibG9iLzU4MjBkMjlkM2M0YzhhNDZlOGI3NWYxZTNhZmEzZTY4YzFhOWEyZGIvc3JjL2NvbnRyb2xsZXIvYnVmZmVyLWNvbnRyb2xsZXIuanMjTDQxNVxuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9zaGFrYS1wbGF5ZXIvYmxvYi80ZDg4OTA1NDYzMWY0ZTFjZjBmYmQ4MGRkZDJiNzE4ODdjMDJlMjMyL2xpYi9tZWRpYS9zdHJlYW1pbmdfZW5naW5lLmpzI0wxMDYyXG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vRGFzaC1JbmR1c3RyeS1Gb3J1bS9kYXNoLmpzL2Jsb2IvNjk4NTlmNTFiOTY5NjQ1YjIzNDY2NjgwMGQ0Y2I1OTZkODljNjAyZC9zcmMvZGFzaC9tb2RlbHMvRGFzaE1hbmlmZXN0TW9kZWwuanMjTDMzOFxuXG5cbiAgICAgIGlmICh0aGlzLmR1cmF0aW9uID49IDIgKiogMzIpIHtcbiAgICAgICAgdG9nZ2xlSGlkZGVuKHRoaXMuZWxlbWVudHMuZGlzcGxheS5jdXJyZW50VGltZSwgdHJ1ZSk7XG4gICAgICAgIHRvZ2dsZUhpZGRlbih0aGlzLmVsZW1lbnRzLnByb2dyZXNzLCB0cnVlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBVcGRhdGUgQVJJQSB2YWx1ZXNcblxuXG4gICAgICBpZiAoaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmlucHV0cy5zZWVrKSkge1xuICAgICAgICB0aGlzLmVsZW1lbnRzLmlucHV0cy5zZWVrLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1heCcsIHRoaXMuZHVyYXRpb24pO1xuICAgICAgfSAvLyBJZiB0aGVyZSdzIGEgc3BvdCB0byBkaXNwbGF5IGR1cmF0aW9uXG5cblxuICAgICAgY29uc3QgaGFzRHVyYXRpb24gPSBpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuZGlzcGxheS5kdXJhdGlvbik7IC8vIElmIHRoZXJlJ3Mgb25seSBvbmUgdGltZSBkaXNwbGF5LCBkaXNwbGF5IGR1cmF0aW9uIHRoZXJlXG5cbiAgICAgIGlmICghaGFzRHVyYXRpb24gJiYgdGhpcy5jb25maWcuZGlzcGxheUR1cmF0aW9uICYmIHRoaXMucGF1c2VkKSB7XG4gICAgICAgIGNvbnRyb2xzLnVwZGF0ZVRpbWVEaXNwbGF5LmNhbGwodGhpcywgdGhpcy5lbGVtZW50cy5kaXNwbGF5LmN1cnJlbnRUaW1lLCB0aGlzLmR1cmF0aW9uKTtcbiAgICAgIH0gLy8gSWYgdGhlcmUncyBhIGR1cmF0aW9uIGVsZW1lbnQsIHVwZGF0ZSBjb250ZW50XG5cblxuICAgICAgaWYgKGhhc0R1cmF0aW9uKSB7XG4gICAgICAgIGNvbnRyb2xzLnVwZGF0ZVRpbWVEaXNwbGF5LmNhbGwodGhpcywgdGhpcy5lbGVtZW50cy5kaXNwbGF5LmR1cmF0aW9uLCB0aGlzLmR1cmF0aW9uKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuY29uZmlnLm1hcmtlcnMuZW5hYmxlZCkge1xuICAgICAgICBjb250cm9scy5zZXRNYXJrZXJzLmNhbGwodGhpcyk7XG4gICAgICB9IC8vIFVwZGF0ZSB0aGUgdG9vbHRpcCAoaWYgdmlzaWJsZSlcblxuXG4gICAgICBjb250cm9scy51cGRhdGVTZWVrVG9vbHRpcC5jYWxsKHRoaXMpO1xuICAgIH0sXG5cbiAgICAvLyBIaWRlL3Nob3cgYSB0YWJcbiAgICB0b2dnbGVNZW51QnV0dG9uKHNldHRpbmcsIHRvZ2dsZSkge1xuICAgICAgdG9nZ2xlSGlkZGVuKHRoaXMuZWxlbWVudHMuc2V0dGluZ3MuYnV0dG9uc1tzZXR0aW5nXSwgIXRvZ2dsZSk7XG4gICAgfSxcblxuICAgIC8vIFVwZGF0ZSB0aGUgc2VsZWN0ZWQgc2V0dGluZ1xuICAgIHVwZGF0ZVNldHRpbmcoc2V0dGluZywgY29udGFpbmVyLCBpbnB1dCkge1xuICAgICAgY29uc3QgcGFuZSA9IHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzW3NldHRpbmddO1xuICAgICAgbGV0IHZhbHVlID0gbnVsbDtcbiAgICAgIGxldCBsaXN0ID0gY29udGFpbmVyO1xuXG4gICAgICBpZiAoc2V0dGluZyA9PT0gJ2NhcHRpb25zJykge1xuICAgICAgICB2YWx1ZSA9IHRoaXMuY3VycmVudFRyYWNrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsdWUgPSAhaXMuZW1wdHkoaW5wdXQpID8gaW5wdXQgOiB0aGlzW3NldHRpbmddOyAvLyBHZXQgZGVmYXVsdFxuXG4gICAgICAgIGlmIChpcy5lbXB0eSh2YWx1ZSkpIHtcbiAgICAgICAgICB2YWx1ZSA9IHRoaXMuY29uZmlnW3NldHRpbmddLmRlZmF1bHQ7XG4gICAgICAgIH0gLy8gVW5zdXBwb3J0ZWQgdmFsdWVcblxuXG4gICAgICAgIGlmICghaXMuZW1wdHkodGhpcy5vcHRpb25zW3NldHRpbmddKSAmJiAhdGhpcy5vcHRpb25zW3NldHRpbmddLmluY2x1ZGVzKHZhbHVlKSkge1xuICAgICAgICAgIHRoaXMuZGVidWcud2FybihgVW5zdXBwb3J0ZWQgdmFsdWUgb2YgJyR7dmFsdWV9JyBmb3IgJHtzZXR0aW5nfWApO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSAvLyBEaXNhYmxlZCB2YWx1ZVxuXG5cbiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZ1tzZXR0aW5nXS5vcHRpb25zLmluY2x1ZGVzKHZhbHVlKSkge1xuICAgICAgICAgIHRoaXMuZGVidWcud2FybihgRGlzYWJsZWQgdmFsdWUgb2YgJyR7dmFsdWV9JyBmb3IgJHtzZXR0aW5nfWApO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfSAvLyBHZXQgdGhlIGxpc3QgaWYgd2UgbmVlZCB0b1xuXG5cbiAgICAgIGlmICghaXMuZWxlbWVudChsaXN0KSkge1xuICAgICAgICBsaXN0ID0gcGFuZSAmJiBwYW5lLnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwibWVudVwiXScpO1xuICAgICAgfSAvLyBJZiB0aGVyZSdzIG5vIGxpc3QgaXQgbWVhbnMgaXQncyBub3QgYmVlbiByZW5kZXJlZC4uLlxuXG5cbiAgICAgIGlmICghaXMuZWxlbWVudChsaXN0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIFVwZGF0ZSB0aGUgbGFiZWxcblxuXG4gICAgICBjb25zdCBsYWJlbCA9IHRoaXMuZWxlbWVudHMuc2V0dGluZ3MuYnV0dG9uc1tzZXR0aW5nXS5xdWVyeVNlbGVjdG9yKGAuJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLm1lbnUudmFsdWV9YCk7XG4gICAgICBsYWJlbC5pbm5lckhUTUwgPSBjb250cm9scy5nZXRMYWJlbC5jYWxsKHRoaXMsIHNldHRpbmcsIHZhbHVlKTsgLy8gRmluZCB0aGUgcmFkaW8gb3B0aW9uIGFuZCBjaGVjayBpdFxuXG4gICAgICBjb25zdCB0YXJnZXQgPSBsaXN0ICYmIGxpc3QucXVlcnlTZWxlY3RvcihgW3ZhbHVlPVwiJHt2YWx1ZX1cIl1gKTtcblxuICAgICAgaWYgKGlzLmVsZW1lbnQodGFyZ2V0KSkge1xuICAgICAgICB0YXJnZXQuY2hlY2tlZCA9IHRydWU7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIFRyYW5zbGF0ZSBhIHZhbHVlIGludG8gYSBuaWNlIGxhYmVsXG4gICAgZ2V0TGFiZWwoc2V0dGluZywgdmFsdWUpIHtcbiAgICAgIHN3aXRjaCAoc2V0dGluZykge1xuICAgICAgICBjYXNlICdzcGVlZCc6XG4gICAgICAgICAgcmV0dXJuIHZhbHVlID09PSAxID8gaTE4bi5nZXQoJ25vcm1hbCcsIHRoaXMuY29uZmlnKSA6IGAke3ZhbHVlfSZ0aW1lcztgO1xuXG4gICAgICAgIGNhc2UgJ3F1YWxpdHknOlxuICAgICAgICAgIGlmIChpcy5udW1iZXIodmFsdWUpKSB7XG4gICAgICAgICAgICBjb25zdCBsYWJlbCA9IGkxOG4uZ2V0KGBxdWFsaXR5TGFiZWwuJHt2YWx1ZX1gLCB0aGlzLmNvbmZpZyk7XG5cbiAgICAgICAgICAgIGlmICghbGFiZWwubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBgJHt2YWx1ZX1wYDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGxhYmVsO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB0b1RpdGxlQ2FzZSh2YWx1ZSk7XG5cbiAgICAgICAgY2FzZSAnY2FwdGlvbnMnOlxuICAgICAgICAgIHJldHVybiBjYXB0aW9ucy5nZXRMYWJlbC5jYWxsKHRoaXMpO1xuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIFNldCB0aGUgcXVhbGl0eSBtZW51XG4gICAgc2V0UXVhbGl0eU1lbnUob3B0aW9ucykge1xuICAgICAgLy8gTWVudSByZXF1aXJlZFxuICAgICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLnF1YWxpdHkpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdHlwZSA9ICdxdWFsaXR5JztcbiAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVscy5xdWFsaXR5LnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwibWVudVwiXScpOyAvLyBTZXQgb3B0aW9ucyBpZiBwYXNzZWQgYW5kIGZpbHRlciBiYXNlZCBvbiB1bmlxdWVuZXNzIGFuZCBjb25maWdcblxuICAgICAgaWYgKGlzLmFycmF5KG9wdGlvbnMpKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5xdWFsaXR5ID0gZGVkdXBlKG9wdGlvbnMpLmZpbHRlcihxdWFsaXR5ID0+IHRoaXMuY29uZmlnLnF1YWxpdHkub3B0aW9ucy5pbmNsdWRlcyhxdWFsaXR5KSk7XG4gICAgICB9IC8vIFRvZ2dsZSB0aGUgcGFuZSBhbmQgdGFiXG5cblxuICAgICAgY29uc3QgdG9nZ2xlID0gIWlzLmVtcHR5KHRoaXMub3B0aW9ucy5xdWFsaXR5KSAmJiB0aGlzLm9wdGlvbnMucXVhbGl0eS5sZW5ndGggPiAxO1xuICAgICAgY29udHJvbHMudG9nZ2xlTWVudUJ1dHRvbi5jYWxsKHRoaXMsIHR5cGUsIHRvZ2dsZSk7IC8vIEVtcHR5IHRoZSBtZW51XG5cbiAgICAgIGVtcHR5RWxlbWVudChsaXN0KTsgLy8gQ2hlY2sgaWYgd2UgbmVlZCB0byB0b2dnbGUgdGhlIHBhcmVudFxuXG4gICAgICBjb250cm9scy5jaGVja01lbnUuY2FsbCh0aGlzKTsgLy8gSWYgd2UncmUgaGlkaW5nLCBub3RoaW5nIG1vcmUgdG8gZG9cblxuICAgICAgaWYgKCF0b2dnbGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBHZXQgdGhlIGJhZGdlIEhUTUwgZm9yIEhELCA0SyBldGNcblxuXG4gICAgICBjb25zdCBnZXRCYWRnZSA9IHF1YWxpdHkgPT4ge1xuICAgICAgICBjb25zdCBsYWJlbCA9IGkxOG4uZ2V0KGBxdWFsaXR5QmFkZ2UuJHtxdWFsaXR5fWAsIHRoaXMuY29uZmlnKTtcblxuICAgICAgICBpZiAoIWxhYmVsLmxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbnRyb2xzLmNyZWF0ZUJhZGdlLmNhbGwodGhpcywgbGFiZWwpO1xuICAgICAgfTsgLy8gU29ydCBvcHRpb25zIGJ5IHRoZSBjb25maWcgYW5kIHRoZW4gcmVuZGVyIG9wdGlvbnNcblxuXG4gICAgICB0aGlzLm9wdGlvbnMucXVhbGl0eS5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgIGNvbnN0IHNvcnRpbmcgPSB0aGlzLmNvbmZpZy5xdWFsaXR5Lm9wdGlvbnM7XG4gICAgICAgIHJldHVybiBzb3J0aW5nLmluZGV4T2YoYSkgPiBzb3J0aW5nLmluZGV4T2YoYikgPyAxIDogLTE7XG4gICAgICB9KS5mb3JFYWNoKHF1YWxpdHkgPT4ge1xuICAgICAgICBjb250cm9scy5jcmVhdGVNZW51SXRlbS5jYWxsKHRoaXMsIHtcbiAgICAgICAgICB2YWx1ZTogcXVhbGl0eSxcbiAgICAgICAgICBsaXN0LFxuICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgdGl0bGU6IGNvbnRyb2xzLmdldExhYmVsLmNhbGwodGhpcywgJ3F1YWxpdHknLCBxdWFsaXR5KSxcbiAgICAgICAgICBiYWRnZTogZ2V0QmFkZ2UocXVhbGl0eSlcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIGNvbnRyb2xzLnVwZGF0ZVNldHRpbmcuY2FsbCh0aGlzLCB0eXBlLCBsaXN0KTtcbiAgICB9LFxuXG4gICAgLy8gU2V0IHRoZSBsb29waW5nIG9wdGlvbnNcblxuICAgIC8qIHNldExvb3BNZW51KCkge1xuICAgICAgICAgIC8vIE1lbnUgcmVxdWlyZWRcbiAgICAgICAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMubG9vcCkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IFsnc3RhcnQnLCAnZW5kJywgJ2FsbCcsICdyZXNldCddO1xuICAgICAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVscy5sb29wLnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwibWVudVwiXScpO1xuICAgICAgICAgICAvLyBTaG93IHRoZSBwYW5lIGFuZCB0YWJcbiAgICAgICAgICB0b2dnbGVIaWRkZW4odGhpcy5lbGVtZW50cy5zZXR0aW5ncy5idXR0b25zLmxvb3AsIGZhbHNlKTtcbiAgICAgICAgICB0b2dnbGVIaWRkZW4odGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMubG9vcCwgZmFsc2UpO1xuICAgICAgICAgICAvLyBUb2dnbGUgdGhlIHBhbmUgYW5kIHRhYlxuICAgICAgICAgIGNvbnN0IHRvZ2dsZSA9ICFpcy5lbXB0eSh0aGlzLmxvb3Aub3B0aW9ucyk7XG4gICAgICAgICAgY29udHJvbHMudG9nZ2xlTWVudUJ1dHRvbi5jYWxsKHRoaXMsICdsb29wJywgdG9nZ2xlKTtcbiAgICAgICAgICAgLy8gRW1wdHkgdGhlIG1lbnVcbiAgICAgICAgICBlbXB0eUVsZW1lbnQobGlzdCk7XG4gICAgICAgICAgIG9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4ge1xuICAgICAgICAgICAgICBjb25zdCBpdGVtID0gY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAnYnV0dG9uJyxcbiAgICAgICAgICAgICAgICAgIGV4dGVuZChnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLmxvb3ApLCB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1dHRvbicsXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuY29udHJvbCxcbiAgICAgICAgICAgICAgICAgICAgICAnZGF0YS1wbHlyLWxvb3AtYWN0aW9uJzogb3B0aW9uLFxuICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICBpMThuLmdldChvcHRpb24sIHRoaXMuY29uZmlnKVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgaWYgKFsnc3RhcnQnLCAnZW5kJ10uaW5jbHVkZXMob3B0aW9uKSkge1xuICAgICAgICAgICAgICAgICAgY29uc3QgYmFkZ2UgPSBjb250cm9scy5jcmVhdGVCYWRnZS5jYWxsKHRoaXMsICcwMDowMCcpO1xuICAgICAgICAgICAgICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKGJhZGdlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgaXRlbS5hcHBlbmRDaGlsZChidXR0b24pO1xuICAgICAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGl0ZW0pO1xuICAgICAgICAgIH0pO1xuICAgICAgfSwgKi9cbiAgICAvLyBHZXQgY3VycmVudCBzZWxlY3RlZCBjYXB0aW9uIGxhbmd1YWdlXG4gICAgLy8gVE9ETzogcmV3b3JrIHRoaXMgdG8gdXNlciB0aGUgZ2V0dGVyIGluIHRoZSBBUEk/XG4gICAgLy8gU2V0IGEgbGlzdCBvZiBhdmFpbGFibGUgY2FwdGlvbnMgbGFuZ3VhZ2VzXG4gICAgc2V0Q2FwdGlvbnNNZW51KCkge1xuICAgICAgLy8gTWVudSByZXF1aXJlZFxuICAgICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLmNhcHRpb25zKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIFRPRE86IENhcHRpb25zIG9yIGxhbmd1YWdlPyBDdXJyZW50bHkgaXQncyBtaXhlZFxuXG5cbiAgICAgIGNvbnN0IHR5cGUgPSAnY2FwdGlvbnMnO1xuICAgICAgY29uc3QgbGlzdCA9IHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLmNhcHRpb25zLnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwibWVudVwiXScpO1xuICAgICAgY29uc3QgdHJhY2tzID0gY2FwdGlvbnMuZ2V0VHJhY2tzLmNhbGwodGhpcyk7XG4gICAgICBjb25zdCB0b2dnbGUgPSBCb29sZWFuKHRyYWNrcy5sZW5ndGgpOyAvLyBUb2dnbGUgdGhlIHBhbmUgYW5kIHRhYlxuXG4gICAgICBjb250cm9scy50b2dnbGVNZW51QnV0dG9uLmNhbGwodGhpcywgdHlwZSwgdG9nZ2xlKTsgLy8gRW1wdHkgdGhlIG1lbnVcblxuICAgICAgZW1wdHlFbGVtZW50KGxpc3QpOyAvLyBDaGVjayBpZiB3ZSBuZWVkIHRvIHRvZ2dsZSB0aGUgcGFyZW50XG5cbiAgICAgIGNvbnRyb2xzLmNoZWNrTWVudS5jYWxsKHRoaXMpOyAvLyBJZiB0aGVyZSdzIG5vIGNhcHRpb25zLCBiYWlsXG5cbiAgICAgIGlmICghdG9nZ2xlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gR2VuZXJhdGUgb3B0aW9ucyBkYXRhXG5cblxuICAgICAgY29uc3Qgb3B0aW9ucyA9IHRyYWNrcy5tYXAoKHRyYWNrLCB2YWx1ZSkgPT4gKHtcbiAgICAgICAgdmFsdWUsXG4gICAgICAgIGNoZWNrZWQ6IHRoaXMuY2FwdGlvbnMudG9nZ2xlZCAmJiB0aGlzLmN1cnJlbnRUcmFjayA9PT0gdmFsdWUsXG4gICAgICAgIHRpdGxlOiBjYXB0aW9ucy5nZXRMYWJlbC5jYWxsKHRoaXMsIHRyYWNrKSxcbiAgICAgICAgYmFkZ2U6IHRyYWNrLmxhbmd1YWdlICYmIGNvbnRyb2xzLmNyZWF0ZUJhZGdlLmNhbGwodGhpcywgdHJhY2subGFuZ3VhZ2UudG9VcHBlckNhc2UoKSksXG4gICAgICAgIGxpc3QsXG4gICAgICAgIHR5cGU6ICdsYW5ndWFnZSdcbiAgICAgIH0pKTsgLy8gQWRkIHRoZSBcIkRpc2FibGVkXCIgb3B0aW9uIHRvIHR1cm4gb2ZmIGNhcHRpb25zXG5cbiAgICAgIG9wdGlvbnMudW5zaGlmdCh7XG4gICAgICAgIHZhbHVlOiAtMSxcbiAgICAgICAgY2hlY2tlZDogIXRoaXMuY2FwdGlvbnMudG9nZ2xlZCxcbiAgICAgICAgdGl0bGU6IGkxOG4uZ2V0KCdkaXNhYmxlZCcsIHRoaXMuY29uZmlnKSxcbiAgICAgICAgbGlzdCxcbiAgICAgICAgdHlwZTogJ2xhbmd1YWdlJ1xuICAgICAgfSk7IC8vIEdlbmVyYXRlIG9wdGlvbnNcblxuICAgICAgb3B0aW9ucy5mb3JFYWNoKGNvbnRyb2xzLmNyZWF0ZU1lbnVJdGVtLmJpbmQodGhpcykpO1xuICAgICAgY29udHJvbHMudXBkYXRlU2V0dGluZy5jYWxsKHRoaXMsIHR5cGUsIGxpc3QpO1xuICAgIH0sXG5cbiAgICAvLyBTZXQgYSBsaXN0IG9mIGF2YWlsYWJsZSBjYXB0aW9ucyBsYW5ndWFnZXNcbiAgICBzZXRTcGVlZE1lbnUoKSB7XG4gICAgICAvLyBNZW51IHJlcXVpcmVkXG4gICAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMuc3BlZWQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdHlwZSA9ICdzcGVlZCc7XG4gICAgICBjb25zdCBsaXN0ID0gdGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMuc3BlZWQucXVlcnlTZWxlY3RvcignW3JvbGU9XCJtZW51XCJdJyk7IC8vIEZpbHRlciBvdXQgaW52YWxpZCBzcGVlZHNcblxuICAgICAgdGhpcy5vcHRpb25zLnNwZWVkID0gdGhpcy5vcHRpb25zLnNwZWVkLmZpbHRlcihvID0+IG8gPj0gdGhpcy5taW5pbXVtU3BlZWQgJiYgbyA8PSB0aGlzLm1heGltdW1TcGVlZCk7IC8vIFRvZ2dsZSB0aGUgcGFuZSBhbmQgdGFiXG5cbiAgICAgIGNvbnN0IHRvZ2dsZSA9ICFpcy5lbXB0eSh0aGlzLm9wdGlvbnMuc3BlZWQpICYmIHRoaXMub3B0aW9ucy5zcGVlZC5sZW5ndGggPiAxO1xuICAgICAgY29udHJvbHMudG9nZ2xlTWVudUJ1dHRvbi5jYWxsKHRoaXMsIHR5cGUsIHRvZ2dsZSk7IC8vIEVtcHR5IHRoZSBtZW51XG5cbiAgICAgIGVtcHR5RWxlbWVudChsaXN0KTsgLy8gQ2hlY2sgaWYgd2UgbmVlZCB0byB0b2dnbGUgdGhlIHBhcmVudFxuXG4gICAgICBjb250cm9scy5jaGVja01lbnUuY2FsbCh0aGlzKTsgLy8gSWYgd2UncmUgaGlkaW5nLCBub3RoaW5nIG1vcmUgdG8gZG9cblxuICAgICAgaWYgKCF0b2dnbGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBDcmVhdGUgaXRlbXNcblxuXG4gICAgICB0aGlzLm9wdGlvbnMuc3BlZWQuZm9yRWFjaChzcGVlZCA9PiB7XG4gICAgICAgIGNvbnRyb2xzLmNyZWF0ZU1lbnVJdGVtLmNhbGwodGhpcywge1xuICAgICAgICAgIHZhbHVlOiBzcGVlZCxcbiAgICAgICAgICBsaXN0LFxuICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgdGl0bGU6IGNvbnRyb2xzLmdldExhYmVsLmNhbGwodGhpcywgJ3NwZWVkJywgc3BlZWQpXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBjb250cm9scy51cGRhdGVTZXR0aW5nLmNhbGwodGhpcywgdHlwZSwgbGlzdCk7XG4gICAgfSxcblxuICAgIC8vIENoZWNrIGlmIHdlIG5lZWQgdG8gaGlkZS9zaG93IHRoZSBzZXR0aW5ncyBtZW51XG4gICAgY2hlY2tNZW51KCkge1xuICAgICAgY29uc3Qge1xuICAgICAgICBidXR0b25zXG4gICAgICB9ID0gdGhpcy5lbGVtZW50cy5zZXR0aW5ncztcbiAgICAgIGNvbnN0IHZpc2libGUgPSAhaXMuZW1wdHkoYnV0dG9ucykgJiYgT2JqZWN0LnZhbHVlcyhidXR0b25zKS5zb21lKGJ1dHRvbiA9PiAhYnV0dG9uLmhpZGRlbik7XG4gICAgICB0b2dnbGVIaWRkZW4odGhpcy5lbGVtZW50cy5zZXR0aW5ncy5tZW51LCAhdmlzaWJsZSk7XG4gICAgfSxcblxuICAgIC8vIEZvY3VzIHRoZSBmaXJzdCBtZW51IGl0ZW0gaW4gYSBnaXZlbiAob3IgdmlzaWJsZSkgbWVudVxuICAgIGZvY3VzRmlyc3RNZW51SXRlbShwYW5lLCB0YWJGb2N1cyA9IGZhbHNlKSB7XG4gICAgICBpZiAodGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wb3B1cC5oaWRkZW4pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgdGFyZ2V0ID0gcGFuZTtcblxuICAgICAgaWYgKCFpcy5lbGVtZW50KHRhcmdldCkpIHtcbiAgICAgICAgdGFyZ2V0ID0gT2JqZWN0LnZhbHVlcyh0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVscykuZmluZChwID0+ICFwLmhpZGRlbik7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGZpcnN0SXRlbSA9IHRhcmdldC5xdWVyeVNlbGVjdG9yKCdbcm9sZV49XCJtZW51aXRlbVwiXScpO1xuICAgICAgc2V0Rm9jdXMuY2FsbCh0aGlzLCBmaXJzdEl0ZW0sIHRhYkZvY3VzKTtcbiAgICB9LFxuXG4gICAgLy8gU2hvdy9oaWRlIG1lbnVcbiAgICB0b2dnbGVNZW51KGlucHV0KSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHBvcHVwXG4gICAgICB9ID0gdGhpcy5lbGVtZW50cy5zZXR0aW5ncztcbiAgICAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMuZWxlbWVudHMuYnV0dG9ucy5zZXR0aW5nczsgLy8gTWVudSBhbmQgYnV0dG9uIGFyZSByZXF1aXJlZFxuXG4gICAgICBpZiAoIWlzLmVsZW1lbnQocG9wdXApIHx8ICFpcy5lbGVtZW50KGJ1dHRvbikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBUcnVlIHRvZ2dsZSBieSBkZWZhdWx0XG5cblxuICAgICAgY29uc3Qge1xuICAgICAgICBoaWRkZW5cbiAgICAgIH0gPSBwb3B1cDtcbiAgICAgIGxldCBzaG93ID0gaGlkZGVuO1xuXG4gICAgICBpZiAoaXMuYm9vbGVhbihpbnB1dCkpIHtcbiAgICAgICAgc2hvdyA9IGlucHV0O1xuICAgICAgfSBlbHNlIGlmIChpcy5rZXlib2FyZEV2ZW50KGlucHV0KSAmJiBpbnB1dC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgIHNob3cgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSBpZiAoaXMuZXZlbnQoaW5wdXQpKSB7XG4gICAgICAgIC8vIElmIFBseXIgaXMgaW4gYSBzaGFkb3dET00sIHRoZSBldmVudCB0YXJnZXQgaXMgc2V0IHRvIHRoZSBjb21wb25lbnQsIGluc3RlYWQgb2YgdGhlXG4gICAgICAgIC8vIEVsZW1lbnQgaW4gdGhlIHNoYWRvd0RPTS4gVGhlIHBhdGgsIGlmIGF2YWlsYWJsZSwgaXMgY29tcGxldGUuXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGlzLmZ1bmN0aW9uKGlucHV0LmNvbXBvc2VkUGF0aCkgPyBpbnB1dC5jb21wb3NlZFBhdGgoKVswXSA6IGlucHV0LnRhcmdldDtcbiAgICAgICAgY29uc3QgaXNNZW51SXRlbSA9IHBvcHVwLmNvbnRhaW5zKHRhcmdldCk7IC8vIElmIHRoZSBjbGljayB3YXMgaW5zaWRlIHRoZSBtZW51IG9yIGlmIHRoZSBjbGlja1xuICAgICAgICAvLyB3YXNuJ3QgdGhlIGJ1dHRvbiBvciBtZW51IGl0ZW0gYW5kIHdlJ3JlIHRyeWluZyB0b1xuICAgICAgICAvLyBzaG93IHRoZSBtZW51IChhIGRvYyBjbGljayBzaG91bGRuJ3Qgc2hvdyB0aGUgbWVudSlcblxuICAgICAgICBpZiAoaXNNZW51SXRlbSB8fCAhaXNNZW51SXRlbSAmJiBpbnB1dC50YXJnZXQgIT09IGJ1dHRvbiAmJiBzaG93KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9IC8vIFNldCBidXR0b24gYXR0cmlidXRlc1xuXG5cbiAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCBzaG93KTsgLy8gU2hvdyB0aGUgYWN0dWFsIHBvcHVwXG5cbiAgICAgIHRvZ2dsZUhpZGRlbihwb3B1cCwgIXNob3cpOyAvLyBBZGQgY2xhc3MgaG9va1xuXG4gICAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5tZW51Lm9wZW4sIHNob3cpOyAvLyBGb2N1cyB0aGUgZmlyc3QgaXRlbSBpZiBrZXkgaW50ZXJhY3Rpb25cblxuICAgICAgaWYgKHNob3cgJiYgaXMua2V5Ym9hcmRFdmVudChpbnB1dCkpIHtcbiAgICAgICAgY29udHJvbHMuZm9jdXNGaXJzdE1lbnVJdGVtLmNhbGwodGhpcywgbnVsbCwgdHJ1ZSk7XG4gICAgICB9IGVsc2UgaWYgKCFzaG93ICYmICFoaWRkZW4pIHtcbiAgICAgICAgLy8gSWYgY2xvc2luZywgcmUtZm9jdXMgdGhlIGJ1dHRvblxuICAgICAgICBzZXRGb2N1cy5jYWxsKHRoaXMsIGJ1dHRvbiwgaXMua2V5Ym9hcmRFdmVudChpbnB1dCkpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBHZXQgdGhlIG5hdHVyYWwgc2l6ZSBvZiBhIG1lbnUgcGFuZWxcbiAgICBnZXRNZW51U2l6ZSh0YWIpIHtcbiAgICAgIGNvbnN0IGNsb25lID0gdGFiLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgIGNsb25lLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgIGNsb25lLnN0eWxlLm9wYWNpdHkgPSAwO1xuICAgICAgY2xvbmUucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTsgLy8gQXBwZW5kIHRvIHBhcmVudCBzbyB3ZSBnZXQgdGhlIFwicmVhbFwiIHNpemVcblxuICAgICAgdGFiLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoY2xvbmUpOyAvLyBHZXQgdGhlIHNpemVzIGJlZm9yZSB3ZSByZW1vdmVcblxuICAgICAgY29uc3Qgd2lkdGggPSBjbG9uZS5zY3JvbGxXaWR0aDtcbiAgICAgIGNvbnN0IGhlaWdodCA9IGNsb25lLnNjcm9sbEhlaWdodDsgLy8gUmVtb3ZlIGZyb20gdGhlIERPTVxuXG4gICAgICByZW1vdmVFbGVtZW50KGNsb25lKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHdpZHRoLFxuICAgICAgICBoZWlnaHRcbiAgICAgIH07XG4gICAgfSxcblxuICAgIC8vIFNob3cgYSBwYW5lbCBpbiB0aGUgbWVudVxuICAgIHNob3dNZW51UGFuZWwodHlwZSA9ICcnLCB0YWJGb2N1cyA9IGZhbHNlKSB7XG4gICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKGAjcGx5ci1zZXR0aW5ncy0ke3RoaXMuaWR9LSR7dHlwZX1gKTsgLy8gTm90aGluZyB0byBzaG93LCBiYWlsXG5cbiAgICAgIGlmICghaXMuZWxlbWVudCh0YXJnZXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gSGlkZSBhbGwgb3RoZXIgcGFuZWxzXG5cblxuICAgICAgY29uc3QgY29udGFpbmVyID0gdGFyZ2V0LnBhcmVudE5vZGU7XG4gICAgICBjb25zdCBjdXJyZW50ID0gQXJyYXkuZnJvbShjb250YWluZXIuY2hpbGRyZW4pLmZpbmQobm9kZSA9PiAhbm9kZS5oaWRkZW4pOyAvLyBJZiB3ZSBjYW4gZG8gZmFuY3kgYW5pbWF0aW9ucywgd2UnbGwgYW5pbWF0ZSB0aGUgaGVpZ2h0L3dpZHRoXG5cbiAgICAgIGlmIChzdXBwb3J0LnRyYW5zaXRpb25zICYmICFzdXBwb3J0LnJlZHVjZWRNb3Rpb24pIHtcbiAgICAgICAgLy8gU2V0IHRoZSBjdXJyZW50IHdpZHRoIGFzIGEgYmFzZVxuICAgICAgICBjb250YWluZXIuc3R5bGUud2lkdGggPSBgJHtjdXJyZW50LnNjcm9sbFdpZHRofXB4YDtcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLmhlaWdodCA9IGAke2N1cnJlbnQuc2Nyb2xsSGVpZ2h0fXB4YDsgLy8gR2V0IHBvdGVudGlhbCBzaXplc1xuXG4gICAgICAgIGNvbnN0IHNpemUgPSBjb250cm9scy5nZXRNZW51U2l6ZS5jYWxsKHRoaXMsIHRhcmdldCk7IC8vIFJlc3RvcmUgYXV0byBoZWlnaHQvd2lkdGhcblxuICAgICAgICBjb25zdCByZXN0b3JlID0gZXZlbnQgPT4ge1xuICAgICAgICAgIC8vIFdlJ3JlIG9ubHkgYm90aGVyZWQgYWJvdXQgaGVpZ2h0IGFuZCB3aWR0aCBvbiB0aGUgY29udGFpbmVyXG4gICAgICAgICAgaWYgKGV2ZW50LnRhcmdldCAhPT0gY29udGFpbmVyIHx8ICFbJ3dpZHRoJywgJ2hlaWdodCddLmluY2x1ZGVzKGV2ZW50LnByb3BlcnR5TmFtZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IC8vIFJldmVydCBiYWNrIHRvIGF1dG9cblxuXG4gICAgICAgICAgY29udGFpbmVyLnN0eWxlLndpZHRoID0gJyc7XG4gICAgICAgICAgY29udGFpbmVyLnN0eWxlLmhlaWdodCA9ICcnOyAvLyBPbmx5IGxpc3RlbiBvbmNlXG5cbiAgICAgICAgICBvZmYuY2FsbCh0aGlzLCBjb250YWluZXIsIHRyYW5zaXRpb25FbmRFdmVudCwgcmVzdG9yZSk7XG4gICAgICAgIH07IC8vIExpc3RlbiBmb3IgdGhlIHRyYW5zaXRpb24gZmluaXNoaW5nIGFuZCByZXN0b3JlIGF1dG8gaGVpZ2h0L3dpZHRoXG5cblxuICAgICAgICBvbi5jYWxsKHRoaXMsIGNvbnRhaW5lciwgdHJhbnNpdGlvbkVuZEV2ZW50LCByZXN0b3JlKTsgLy8gU2V0IGRpbWVuc2lvbnMgdG8gdGFyZ2V0XG5cbiAgICAgICAgY29udGFpbmVyLnN0eWxlLndpZHRoID0gYCR7c2l6ZS53aWR0aH1weGA7XG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBgJHtzaXplLmhlaWdodH1weGA7XG4gICAgICB9IC8vIFNldCBhdHRyaWJ1dGVzIG9uIGN1cnJlbnQgdGFiXG5cblxuICAgICAgdG9nZ2xlSGlkZGVuKGN1cnJlbnQsIHRydWUpOyAvLyBTZXQgYXR0cmlidXRlcyBvbiB0YXJnZXRcblxuICAgICAgdG9nZ2xlSGlkZGVuKHRhcmdldCwgZmFsc2UpOyAvLyBGb2N1cyB0aGUgZmlyc3QgaXRlbVxuXG4gICAgICBjb250cm9scy5mb2N1c0ZpcnN0TWVudUl0ZW0uY2FsbCh0aGlzLCB0YXJnZXQsIHRhYkZvY3VzKTtcbiAgICB9LFxuXG4gICAgLy8gU2V0IHRoZSBkb3dubG9hZCBVUkxcbiAgICBzZXREb3dubG9hZFVybCgpIHtcbiAgICAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMuZWxlbWVudHMuYnV0dG9ucy5kb3dubG9hZDsgLy8gQmFpbCBpZiBubyBidXR0b25cblxuICAgICAgaWYgKCFpcy5lbGVtZW50KGJ1dHRvbikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBTZXQgYXR0cmlidXRlXG5cblxuICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnaHJlZicsIHRoaXMuZG93bmxvYWQpO1xuICAgIH0sXG5cbiAgICAvLyBCdWlsZCB0aGUgZGVmYXVsdCBIVE1MXG4gICAgY3JlYXRlKGRhdGEpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgYmluZE1lbnVJdGVtU2hvcnRjdXRzLFxuICAgICAgICBjcmVhdGVCdXR0b24sXG4gICAgICAgIGNyZWF0ZVByb2dyZXNzLFxuICAgICAgICBjcmVhdGVSYW5nZSxcbiAgICAgICAgY3JlYXRlVGltZSxcbiAgICAgICAgc2V0UXVhbGl0eU1lbnUsXG4gICAgICAgIHNldFNwZWVkTWVudSxcbiAgICAgICAgc2hvd01lbnVQYW5lbFxuICAgICAgfSA9IGNvbnRyb2xzO1xuICAgICAgdGhpcy5lbGVtZW50cy5jb250cm9scyA9IG51bGw7IC8vIExhcmdlciBvdmVybGFpZCBwbGF5IGJ1dHRvblxuXG4gICAgICBpZiAoaXMuYXJyYXkodGhpcy5jb25maWcuY29udHJvbHMpICYmIHRoaXMuY29uZmlnLmNvbnRyb2xzLmluY2x1ZGVzKCdwbGF5LWxhcmdlJykpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ3BsYXktbGFyZ2UnKSk7XG4gICAgICB9IC8vIENyZWF0ZSB0aGUgY29udGFpbmVyXG5cblxuICAgICAgY29uc3QgY29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2JywgZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuY29udHJvbHMud3JhcHBlcikpO1xuICAgICAgdGhpcy5lbGVtZW50cy5jb250cm9scyA9IGNvbnRhaW5lcjsgLy8gRGVmYXVsdCBpdGVtIGF0dHJpYnV0ZXNcblxuICAgICAgY29uc3QgZGVmYXVsdEF0dHJpYnV0ZXMgPSB7XG4gICAgICAgIGNsYXNzOiAncGx5cl9fY29udHJvbHNfX2l0ZW0nXG4gICAgICB9OyAvLyBMb29wIHRocm91Z2ggY29udHJvbHMgaW4gb3JkZXJcblxuICAgICAgZGVkdXBlKGlzLmFycmF5KHRoaXMuY29uZmlnLmNvbnRyb2xzKSA/IHRoaXMuY29uZmlnLmNvbnRyb2xzIDogW10pLmZvckVhY2goY29udHJvbCA9PiB7XG4gICAgICAgIC8vIFJlc3RhcnQgYnV0dG9uXG4gICAgICAgIGlmIChjb250cm9sID09PSAncmVzdGFydCcpIHtcbiAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ3Jlc3RhcnQnLCBkZWZhdWx0QXR0cmlidXRlcykpO1xuICAgICAgICB9IC8vIFJld2luZCBidXR0b25cblxuXG4gICAgICAgIGlmIChjb250cm9sID09PSAncmV3aW5kJykge1xuICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAncmV3aW5kJywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgICAgfSAvLyBQbGF5L1BhdXNlIGJ1dHRvblxuXG5cbiAgICAgICAgaWYgKGNvbnRyb2wgPT09ICdwbGF5Jykge1xuICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAncGxheScsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICAgIH0gLy8gRmFzdCBmb3J3YXJkIGJ1dHRvblxuXG5cbiAgICAgICAgaWYgKGNvbnRyb2wgPT09ICdmYXN0LWZvcndhcmQnKSB7XG4gICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdmYXN0LWZvcndhcmQnLCBkZWZhdWx0QXR0cmlidXRlcykpO1xuICAgICAgICB9IC8vIFByb2dyZXNzXG5cblxuICAgICAgICBpZiAoY29udHJvbCA9PT0gJ3Byb2dyZXNzJykge1xuICAgICAgICAgIGNvbnN0IHByb2dyZXNzQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgY2xhc3M6IGAke2RlZmF1bHRBdHRyaWJ1dGVzLmNsYXNzfSBwbHlyX19wcm9ncmVzc19fY29udGFpbmVyYFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnN0IHByb2dyZXNzID0gY3JlYXRlRWxlbWVudCgnZGl2JywgZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMucHJvZ3Jlc3MpKTsgLy8gU2VlayByYW5nZSBzbGlkZXJcblxuICAgICAgICAgIHByb2dyZXNzLmFwcGVuZENoaWxkKGNyZWF0ZVJhbmdlLmNhbGwodGhpcywgJ3NlZWsnLCB7XG4gICAgICAgICAgICBpZDogYHBseXItc2Vlay0ke2RhdGEuaWR9YFxuICAgICAgICAgIH0pKTsgLy8gQnVmZmVyIHByb2dyZXNzXG5cbiAgICAgICAgICBwcm9ncmVzcy5hcHBlbmRDaGlsZChjcmVhdGVQcm9ncmVzcy5jYWxsKHRoaXMsICdidWZmZXInKSk7IC8vIFRPRE86IEFkZCBsb29wIGRpc3BsYXkgaW5kaWNhdG9yXG4gICAgICAgICAgLy8gU2VlayB0b29sdGlwXG5cbiAgICAgICAgICBpZiAodGhpcy5jb25maWcudG9vbHRpcHMuc2Vlaykge1xuICAgICAgICAgICAgY29uc3QgdG9vbHRpcCA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7XG4gICAgICAgICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnRvb2x0aXBcbiAgICAgICAgICAgIH0sICcwMDowMCcpO1xuICAgICAgICAgICAgcHJvZ3Jlc3MuYXBwZW5kQ2hpbGQodG9vbHRpcCk7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzLmRpc3BsYXkuc2Vla1Rvb2x0aXAgPSB0b29sdGlwO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMuZWxlbWVudHMucHJvZ3Jlc3MgPSBwcm9ncmVzcztcbiAgICAgICAgICBwcm9ncmVzc0NvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnRzLnByb2dyZXNzKTtcbiAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NDb250YWluZXIpO1xuICAgICAgICB9IC8vIE1lZGlhIGN1cnJlbnQgdGltZSBkaXNwbGF5XG5cblxuICAgICAgICBpZiAoY29udHJvbCA9PT0gJ2N1cnJlbnQtdGltZScpIHtcbiAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlVGltZS5jYWxsKHRoaXMsICdjdXJyZW50VGltZScsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICAgIH0gLy8gTWVkaWEgZHVyYXRpb24gZGlzcGxheVxuXG5cbiAgICAgICAgaWYgKGNvbnRyb2wgPT09ICdkdXJhdGlvbicpIHtcbiAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlVGltZS5jYWxsKHRoaXMsICdkdXJhdGlvbicsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICAgIH0gLy8gVm9sdW1lIGNvbnRyb2xzXG5cblxuICAgICAgICBpZiAoY29udHJvbCA9PT0gJ211dGUnIHx8IGNvbnRyb2wgPT09ICd2b2x1bWUnKSB7XG4gICAgICAgICAgbGV0IHtcbiAgICAgICAgICAgIHZvbHVtZVxuICAgICAgICAgIH0gPSB0aGlzLmVsZW1lbnRzOyAvLyBDcmVhdGUgdGhlIHZvbHVtZSBjb250YWluZXIgaWYgbmVlZGVkXG5cbiAgICAgICAgICBpZiAoIWlzLmVsZW1lbnQodm9sdW1lKSB8fCAhY29udGFpbmVyLmNvbnRhaW5zKHZvbHVtZSkpIHtcbiAgICAgICAgICAgIHZvbHVtZSA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIGV4dGVuZCh7fSwgZGVmYXVsdEF0dHJpYnV0ZXMsIHtcbiAgICAgICAgICAgICAgY2xhc3M6IGAke2RlZmF1bHRBdHRyaWJ1dGVzLmNsYXNzfSBwbHlyX192b2x1bWVgLnRyaW0oKVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50cy52b2x1bWUgPSB2b2x1bWU7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodm9sdW1lKTtcbiAgICAgICAgICB9IC8vIFRvZ2dsZSBtdXRlIGJ1dHRvblxuXG5cbiAgICAgICAgICBpZiAoY29udHJvbCA9PT0gJ211dGUnKSB7XG4gICAgICAgICAgICB2b2x1bWUuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ211dGUnKSk7XG4gICAgICAgICAgfSAvLyBWb2x1bWUgcmFuZ2UgY29udHJvbFxuICAgICAgICAgIC8vIElnbm9yZWQgb24gaU9TIGFzIGl0J3MgaGFuZGxlZCBnbG9iYWxseVxuICAgICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9saWJyYXJ5L3NhZmFyaS9kb2N1bWVudGF0aW9uL0F1ZGlvVmlkZW8vQ29uY2VwdHVhbC9Vc2luZ19IVE1MNV9BdWRpb19WaWRlby9EZXZpY2UtU3BlY2lmaWNDb25zaWRlcmF0aW9ucy9EZXZpY2UtU3BlY2lmaWNDb25zaWRlcmF0aW9ucy5odG1sXG5cblxuICAgICAgICAgIGlmIChjb250cm9sID09PSAndm9sdW1lJyAmJiAhYnJvd3Nlci5pc0lvcykge1xuICAgICAgICAgICAgLy8gU2V0IHRoZSBhdHRyaWJ1dGVzXG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0ge1xuICAgICAgICAgICAgICBtYXg6IDEsXG4gICAgICAgICAgICAgIHN0ZXA6IDAuMDUsXG4gICAgICAgICAgICAgIHZhbHVlOiB0aGlzLmNvbmZpZy52b2x1bWVcbiAgICAgICAgICAgIH07IC8vIENyZWF0ZSB0aGUgdm9sdW1lIHJhbmdlIHNsaWRlclxuXG4gICAgICAgICAgICB2b2x1bWUuYXBwZW5kQ2hpbGQoY3JlYXRlUmFuZ2UuY2FsbCh0aGlzLCAndm9sdW1lJywgZXh0ZW5kKGF0dHJpYnV0ZXMsIHtcbiAgICAgICAgICAgICAgaWQ6IGBwbHlyLXZvbHVtZS0ke2RhdGEuaWR9YFxuICAgICAgICAgICAgfSkpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gLy8gVG9nZ2xlIGNhcHRpb25zIGJ1dHRvblxuXG5cbiAgICAgICAgaWYgKGNvbnRyb2wgPT09ICdjYXB0aW9ucycpIHtcbiAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ2NhcHRpb25zJywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgICAgfSAvLyBTZXR0aW5ncyBidXR0b24gLyBtZW51XG5cblxuICAgICAgICBpZiAoY29udHJvbCA9PT0gJ3NldHRpbmdzJyAmJiAhaXMuZW1wdHkodGhpcy5jb25maWcuc2V0dGluZ3MpKSB7XG4gICAgICAgICAgY29uc3Qgd3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIGV4dGVuZCh7fSwgZGVmYXVsdEF0dHJpYnV0ZXMsIHtcbiAgICAgICAgICAgIGNsYXNzOiBgJHtkZWZhdWx0QXR0cmlidXRlcy5jbGFzc30gcGx5cl9fbWVudWAudHJpbSgpLFxuICAgICAgICAgICAgaGlkZGVuOiAnJ1xuICAgICAgICAgIH0pKTtcbiAgICAgICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdzZXR0aW5ncycsIHtcbiAgICAgICAgICAgICdhcmlhLWhhc3BvcHVwJzogdHJ1ZSxcbiAgICAgICAgICAgICdhcmlhLWNvbnRyb2xzJzogYHBseXItc2V0dGluZ3MtJHtkYXRhLmlkfWAsXG4gICAgICAgICAgICAnYXJpYS1leHBhbmRlZCc6IGZhbHNlXG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIGNvbnN0IHBvcHVwID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgY2xhc3M6ICdwbHlyX19tZW51X19jb250YWluZXInLFxuICAgICAgICAgICAgaWQ6IGBwbHlyLXNldHRpbmdzLSR7ZGF0YS5pZH1gLFxuICAgICAgICAgICAgaGlkZGVuOiAnJ1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnN0IGlubmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgY29uc3QgaG9tZSA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgIGlkOiBgcGx5ci1zZXR0aW5ncy0ke2RhdGEuaWR9LWhvbWVgXG4gICAgICAgICAgfSk7IC8vIENyZWF0ZSB0aGUgbWVudVxuXG4gICAgICAgICAgY29uc3QgbWVudSA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgIHJvbGU6ICdtZW51J1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGhvbWUuYXBwZW5kQ2hpbGQobWVudSk7XG4gICAgICAgICAgaW5uZXIuYXBwZW5kQ2hpbGQoaG9tZSk7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMuaG9tZSA9IGhvbWU7IC8vIEJ1aWxkIHRoZSBtZW51IGl0ZW1zXG5cbiAgICAgICAgICB0aGlzLmNvbmZpZy5zZXR0aW5ncy5mb3JFYWNoKHR5cGUgPT4ge1xuICAgICAgICAgICAgLy8gVE9ETzogYnVuZGxlIHRoaXMgd2l0aCB0aGUgY3JlYXRlTWVudUl0ZW0gaGVscGVyIGFuZCBiaW5kaW5nc1xuICAgICAgICAgICAgY29uc3QgbWVudUl0ZW0gPSBjcmVhdGVFbGVtZW50KCdidXR0b24nLCBleHRlbmQoZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5zZXR0aW5ncyksIHtcbiAgICAgICAgICAgICAgdHlwZTogJ2J1dHRvbicsXG4gICAgICAgICAgICAgIGNsYXNzOiBgJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2x9ICR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sfS0tZm9yd2FyZGAsXG4gICAgICAgICAgICAgIHJvbGU6ICdtZW51aXRlbScsXG4gICAgICAgICAgICAgICdhcmlhLWhhc3BvcHVwJzogdHJ1ZSxcbiAgICAgICAgICAgICAgaGlkZGVuOiAnJ1xuICAgICAgICAgICAgfSkpOyAvLyBCaW5kIG1lbnUgc2hvcnRjdXRzIGZvciBrZXlib2FyZCB1c2Vyc1xuXG4gICAgICAgICAgICBiaW5kTWVudUl0ZW1TaG9ydGN1dHMuY2FsbCh0aGlzLCBtZW51SXRlbSwgdHlwZSk7IC8vIFNob3cgbWVudSBvbiBjbGlja1xuXG4gICAgICAgICAgICBvbi5jYWxsKHRoaXMsIG1lbnVJdGVtLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgIHNob3dNZW51UGFuZWwuY2FsbCh0aGlzLCB0eXBlLCBmYWxzZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGZsZXggPSBjcmVhdGVFbGVtZW50KCdzcGFuJywgbnVsbCwgaTE4bi5nZXQodHlwZSwgdGhpcy5jb25maWcpKTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gY3JlYXRlRWxlbWVudCgnc3BhbicsIHtcbiAgICAgICAgICAgICAgY2xhc3M6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMubWVudS52YWx1ZVxuICAgICAgICAgICAgfSk7IC8vIFNwZWVkIGNvbnRhaW5zIEhUTUwgZW50aXRpZXNcblxuICAgICAgICAgICAgdmFsdWUuaW5uZXJIVE1MID0gZGF0YVt0eXBlXTtcbiAgICAgICAgICAgIGZsZXguYXBwZW5kQ2hpbGQodmFsdWUpO1xuICAgICAgICAgICAgbWVudUl0ZW0uYXBwZW5kQ2hpbGQoZmxleCk7XG4gICAgICAgICAgICBtZW51LmFwcGVuZENoaWxkKG1lbnVJdGVtKTsgLy8gQnVpbGQgdGhlIHBhbmVzXG5cbiAgICAgICAgICAgIGNvbnN0IHBhbmUgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgICAgIGlkOiBgcGx5ci1zZXR0aW5ncy0ke2RhdGEuaWR9LSR7dHlwZX1gLFxuICAgICAgICAgICAgICBoaWRkZW46ICcnXG4gICAgICAgICAgICB9KTsgLy8gQmFjayBidXR0b25cblxuICAgICAgICAgICAgY29uc3QgYmFja0J1dHRvbiA9IGNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicsIHtcbiAgICAgICAgICAgICAgdHlwZTogJ2J1dHRvbicsXG4gICAgICAgICAgICAgIGNsYXNzOiBgJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2x9ICR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sfS0tYmFja2BcbiAgICAgICAgICAgIH0pOyAvLyBWaXNpYmxlIGxhYmVsXG5cbiAgICAgICAgICAgIGJhY2tCdXR0b24uYXBwZW5kQ2hpbGQoY3JlYXRlRWxlbWVudCgnc3BhbicsIHtcbiAgICAgICAgICAgICAgJ2FyaWEtaGlkZGVuJzogdHJ1ZVxuICAgICAgICAgICAgfSwgaTE4bi5nZXQodHlwZSwgdGhpcy5jb25maWcpKSk7IC8vIFNjcmVlbiByZWFkZXIgbGFiZWxcblxuICAgICAgICAgICAgYmFja0J1dHRvbi5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KCdzcGFuJywge1xuICAgICAgICAgICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy5oaWRkZW5cbiAgICAgICAgICAgIH0sIGkxOG4uZ2V0KCdtZW51QmFjaycsIHRoaXMuY29uZmlnKSkpOyAvLyBHbyBiYWNrIHZpYSBrZXlib2FyZFxuXG4gICAgICAgICAgICBvbi5jYWxsKHRoaXMsIHBhbmUsICdrZXlkb3duJywgZXZlbnQgPT4ge1xuICAgICAgICAgICAgICBpZiAoZXZlbnQua2V5ICE9PSAnQXJyb3dMZWZ0JykgcmV0dXJuOyAvLyBQcmV2ZW50IHNlZWtcblxuICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsgLy8gU2hvdyB0aGUgcmVzcGVjdGl2ZSBtZW51XG5cbiAgICAgICAgICAgICAgc2hvd01lbnVQYW5lbC5jYWxsKHRoaXMsICdob21lJywgdHJ1ZSk7XG4gICAgICAgICAgICB9LCBmYWxzZSk7IC8vIEdvIGJhY2sgdmlhIGJ1dHRvbiBjbGlja1xuXG4gICAgICAgICAgICBvbi5jYWxsKHRoaXMsIGJhY2tCdXR0b24sICdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgc2hvd01lbnVQYW5lbC5jYWxsKHRoaXMsICdob21lJywgZmFsc2UpO1xuICAgICAgICAgICAgfSk7IC8vIEFkZCB0byBwYW5lXG5cbiAgICAgICAgICAgIHBhbmUuYXBwZW5kQ2hpbGQoYmFja0J1dHRvbik7IC8vIE1lbnVcblxuICAgICAgICAgICAgcGFuZS5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgICAgIHJvbGU6ICdtZW51J1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgaW5uZXIuYXBwZW5kQ2hpbGQocGFuZSk7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLmJ1dHRvbnNbdHlwZV0gPSBtZW51SXRlbTtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzW3R5cGVdID0gcGFuZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBwb3B1cC5hcHBlbmRDaGlsZChpbm5lcik7XG4gICAgICAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChwb3B1cCk7XG4gICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHdyYXBwZXIpO1xuICAgICAgICAgIHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucG9wdXAgPSBwb3B1cDtcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLm1lbnUgPSB3cmFwcGVyO1xuICAgICAgICB9IC8vIFBpY3R1cmUgaW4gcGljdHVyZSBidXR0b25cblxuXG4gICAgICAgIGlmIChjb250cm9sID09PSAncGlwJyAmJiBzdXBwb3J0LnBpcCkge1xuICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAncGlwJywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgICAgfSAvLyBBaXJwbGF5IGJ1dHRvblxuXG5cbiAgICAgICAgaWYgKGNvbnRyb2wgPT09ICdhaXJwbGF5JyAmJiBzdXBwb3J0LmFpcnBsYXkpIHtcbiAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ2FpcnBsYXknLCBkZWZhdWx0QXR0cmlidXRlcykpO1xuICAgICAgICB9IC8vIERvd25sb2FkIGJ1dHRvblxuXG5cbiAgICAgICAgaWYgKGNvbnRyb2wgPT09ICdkb3dubG9hZCcpIHtcbiAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gZXh0ZW5kKHt9LCBkZWZhdWx0QXR0cmlidXRlcywge1xuICAgICAgICAgICAgZWxlbWVudDogJ2EnLFxuICAgICAgICAgICAgaHJlZjogdGhpcy5kb3dubG9hZCxcbiAgICAgICAgICAgIHRhcmdldDogJ19ibGFuaydcbiAgICAgICAgICB9KTsgLy8gU2V0IGRvd25sb2FkIGF0dHJpYnV0ZSBmb3IgSFRNTDUgb25seVxuXG4gICAgICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICAgICAgYXR0cmlidXRlcy5kb3dubG9hZCA9ICcnO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGRvd25sb2FkXG4gICAgICAgICAgfSA9IHRoaXMuY29uZmlnLnVybHM7XG5cbiAgICAgICAgICBpZiAoIWlzLnVybChkb3dubG9hZCkgJiYgdGhpcy5pc0VtYmVkKSB7XG4gICAgICAgICAgICBleHRlbmQoYXR0cmlidXRlcywge1xuICAgICAgICAgICAgICBpY29uOiBgbG9nby0ke3RoaXMucHJvdmlkZXJ9YCxcbiAgICAgICAgICAgICAgbGFiZWw6IHRoaXMucHJvdmlkZXJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAnZG93bmxvYWQnLCBhdHRyaWJ1dGVzKSk7XG4gICAgICAgIH0gLy8gVG9nZ2xlIGZ1bGxzY3JlZW4gYnV0dG9uXG5cblxuICAgICAgICBpZiAoY29udHJvbCA9PT0gJ2Z1bGxzY3JlZW4nKSB7XG4gICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdmdWxsc2NyZWVuJywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgICAgfVxuICAgICAgfSk7IC8vIFNldCBhdmFpbGFibGUgcXVhbGl0eSBsZXZlbHNcblxuICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICBzZXRRdWFsaXR5TWVudS5jYWxsKHRoaXMsIGh0bWw1LmdldFF1YWxpdHlPcHRpb25zLmNhbGwodGhpcykpO1xuICAgICAgfVxuXG4gICAgICBzZXRTcGVlZE1lbnUuY2FsbCh0aGlzKTtcbiAgICAgIHJldHVybiBjb250YWluZXI7XG4gICAgfSxcblxuICAgIC8vIEluc2VydCBjb250cm9sc1xuICAgIGluamVjdCgpIHtcbiAgICAgIC8vIFNwcml0ZVxuICAgICAgaWYgKHRoaXMuY29uZmlnLmxvYWRTcHJpdGUpIHtcbiAgICAgICAgY29uc3QgaWNvbiA9IGNvbnRyb2xzLmdldEljb25VcmwuY2FsbCh0aGlzKTsgLy8gT25seSBsb2FkIGV4dGVybmFsIHNwcml0ZSB1c2luZyBBSkFYXG5cbiAgICAgICAgaWYgKGljb24uY29ycykge1xuICAgICAgICAgIGxvYWRTcHJpdGUoaWNvbi51cmwsICdzcHJpdGUtcGx5cicpO1xuICAgICAgICB9XG4gICAgICB9IC8vIENyZWF0ZSBhIHVuaXF1ZSBJRFxuXG5cbiAgICAgIHRoaXMuaWQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCk7IC8vIE51bGwgYnkgZGVmYXVsdFxuXG4gICAgICBsZXQgY29udGFpbmVyID0gbnVsbDtcbiAgICAgIHRoaXMuZWxlbWVudHMuY29udHJvbHMgPSBudWxsOyAvLyBTZXQgdGVtcGxhdGUgcHJvcGVydGllc1xuXG4gICAgICBjb25zdCBwcm9wcyA9IHtcbiAgICAgICAgaWQ6IHRoaXMuaWQsXG4gICAgICAgIHNlZWt0aW1lOiB0aGlzLmNvbmZpZy5zZWVrVGltZSxcbiAgICAgICAgdGl0bGU6IHRoaXMuY29uZmlnLnRpdGxlXG4gICAgICB9O1xuICAgICAgbGV0IHVwZGF0ZSA9IHRydWU7IC8vIElmIGZ1bmN0aW9uLCBydW4gaXQgYW5kIHVzZSBvdXRwdXRcblxuICAgICAgaWYgKGlzLmZ1bmN0aW9uKHRoaXMuY29uZmlnLmNvbnRyb2xzKSkge1xuICAgICAgICB0aGlzLmNvbmZpZy5jb250cm9scyA9IHRoaXMuY29uZmlnLmNvbnRyb2xzLmNhbGwodGhpcywgcHJvcHMpO1xuICAgICAgfSAvLyBDb252ZXJ0IGZhbHN5IGNvbnRyb2xzIHRvIGVtcHR5IGFycmF5IChwcmltYXJpbHkgZm9yIGVtcHR5IHN0cmluZ3MpXG5cblxuICAgICAgaWYgKCF0aGlzLmNvbmZpZy5jb250cm9scykge1xuICAgICAgICB0aGlzLmNvbmZpZy5jb250cm9scyA9IFtdO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXMuZWxlbWVudCh0aGlzLmNvbmZpZy5jb250cm9scykgfHwgaXMuc3RyaW5nKHRoaXMuY29uZmlnLmNvbnRyb2xzKSkge1xuICAgICAgICAvLyBIVE1MRWxlbWVudCBvciBOb24tZW1wdHkgc3RyaW5nIHBhc3NlZCBhcyB0aGUgb3B0aW9uXG4gICAgICAgIGNvbnRhaW5lciA9IHRoaXMuY29uZmlnLmNvbnRyb2xzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gQ3JlYXRlIGNvbnRyb2xzXG4gICAgICAgIGNvbnRhaW5lciA9IGNvbnRyb2xzLmNyZWF0ZS5jYWxsKHRoaXMsIHtcbiAgICAgICAgICBpZDogdGhpcy5pZCxcbiAgICAgICAgICBzZWVrdGltZTogdGhpcy5jb25maWcuc2Vla1RpbWUsXG4gICAgICAgICAgc3BlZWQ6IHRoaXMuc3BlZWQsXG4gICAgICAgICAgcXVhbGl0eTogdGhpcy5xdWFsaXR5LFxuICAgICAgICAgIGNhcHRpb25zOiBjYXB0aW9ucy5nZXRMYWJlbC5jYWxsKHRoaXMpIC8vIFRPRE86IExvb3BpbmdcbiAgICAgICAgICAvLyBsb29wOiAnTm9uZScsXG5cbiAgICAgICAgfSk7XG4gICAgICAgIHVwZGF0ZSA9IGZhbHNlO1xuICAgICAgfSAvLyBSZXBsYWNlIHByb3BzIHdpdGggdGhlaXIgdmFsdWVcblxuXG4gICAgICBjb25zdCByZXBsYWNlID0gaW5wdXQgPT4ge1xuICAgICAgICBsZXQgcmVzdWx0ID0gaW5wdXQ7XG4gICAgICAgIE9iamVjdC5lbnRyaWVzKHByb3BzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgICByZXN1bHQgPSByZXBsYWNlQWxsKHJlc3VsdCwgYHske2tleX19YCwgdmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH07IC8vIFVwZGF0ZSBtYXJrdXBcblxuXG4gICAgICBpZiAodXBkYXRlKSB7XG4gICAgICAgIGlmIChpcy5zdHJpbmcodGhpcy5jb25maWcuY29udHJvbHMpKSB7XG4gICAgICAgICAgY29udGFpbmVyID0gcmVwbGFjZShjb250YWluZXIpO1xuICAgICAgICB9XG4gICAgICB9IC8vIENvbnRyb2xzIGNvbnRhaW5lclxuXG5cbiAgICAgIGxldCB0YXJnZXQ7IC8vIEluamVjdCB0byBjdXN0b20gbG9jYXRpb25cblxuICAgICAgaWYgKGlzLnN0cmluZyh0aGlzLmNvbmZpZy5zZWxlY3RvcnMuY29udHJvbHMuY29udGFpbmVyKSkge1xuICAgICAgICB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5jb250cm9scy5jb250YWluZXIpO1xuICAgICAgfSAvLyBJbmplY3QgaW50byB0aGUgY29udGFpbmVyIGJ5IGRlZmF1bHRcblxuXG4gICAgICBpZiAoIWlzLmVsZW1lbnQodGFyZ2V0KSkge1xuICAgICAgICB0YXJnZXQgPSB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lcjtcbiAgICAgIH0gLy8gSW5qZWN0IGNvbnRyb2xzIEhUTUwgKG5lZWRzIHRvIGJlIGJlZm9yZSBjYXB0aW9ucywgaGVuY2UgXCJhZnRlcmJlZ2luXCIpXG5cblxuICAgICAgY29uc3QgaW5zZXJ0TWV0aG9kID0gaXMuZWxlbWVudChjb250YWluZXIpID8gJ2luc2VydEFkamFjZW50RWxlbWVudCcgOiAnaW5zZXJ0QWRqYWNlbnRIVE1MJztcbiAgICAgIHRhcmdldFtpbnNlcnRNZXRob2RdKCdhZnRlcmJlZ2luJywgY29udGFpbmVyKTsgLy8gRmluZCB0aGUgZWxlbWVudHMgaWYgbmVlZCBiZVxuXG4gICAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5jb250cm9scykpIHtcbiAgICAgICAgY29udHJvbHMuZmluZEVsZW1lbnRzLmNhbGwodGhpcyk7XG4gICAgICB9IC8vIEFkZCBwcmVzc2VkIHByb3BlcnR5IHRvIGJ1dHRvbnNcblxuXG4gICAgICBpZiAoIWlzLmVtcHR5KHRoaXMuZWxlbWVudHMuYnV0dG9ucykpIHtcbiAgICAgICAgY29uc3QgYWRkUHJvcGVydHkgPSBidXR0b24gPT4ge1xuICAgICAgICAgIGNvbnN0IGNsYXNzTmFtZSA9IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuY29udHJvbFByZXNzZWQ7XG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGJ1dHRvbiwgJ3ByZXNzZWQnLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuXG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYXNDbGFzcyhidXR0b24sIGNsYXNzTmFtZSk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBzZXQocHJlc3NlZCA9IGZhbHNlKSB7XG4gICAgICAgICAgICAgIHRvZ2dsZUNsYXNzKGJ1dHRvbiwgY2xhc3NOYW1lLCBwcmVzc2VkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0pO1xuICAgICAgICB9OyAvLyBUb2dnbGUgY2xhc3NuYW1lIHdoZW4gcHJlc3NlZCBwcm9wZXJ0eSBpcyBzZXRcblxuXG4gICAgICAgIE9iamVjdC52YWx1ZXModGhpcy5lbGVtZW50cy5idXR0b25zKS5maWx0ZXIoQm9vbGVhbikuZm9yRWFjaChidXR0b24gPT4ge1xuICAgICAgICAgIGlmIChpcy5hcnJheShidXR0b24pIHx8IGlzLm5vZGVMaXN0KGJ1dHRvbikpIHtcbiAgICAgICAgICAgIEFycmF5LmZyb20oYnV0dG9uKS5maWx0ZXIoQm9vbGVhbikuZm9yRWFjaChhZGRQcm9wZXJ0eSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFkZFByb3BlcnR5KGJ1dHRvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gLy8gRWRnZSBzb21ldGltZXMgZG9lc24ndCBmaW5pc2ggdGhlIHBhaW50IHNvIGZvcmNlIGEgcmVwYWludFxuXG5cbiAgICAgIGlmIChicm93c2VyLmlzRWRnZSkge1xuICAgICAgICByZXBhaW50KHRhcmdldCk7XG4gICAgICB9IC8vIFNldHVwIHRvb2x0aXBzXG5cblxuICAgICAgaWYgKHRoaXMuY29uZmlnLnRvb2x0aXBzLmNvbnRyb2xzKSB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBjbGFzc05hbWVzLFxuICAgICAgICAgIHNlbGVjdG9yc1xuICAgICAgICB9ID0gdGhpcy5jb25maWc7XG4gICAgICAgIGNvbnN0IHNlbGVjdG9yID0gYCR7c2VsZWN0b3JzLmNvbnRyb2xzLndyYXBwZXJ9ICR7c2VsZWN0b3JzLmxhYmVsc30gLiR7Y2xhc3NOYW1lcy5oaWRkZW59YDtcbiAgICAgICAgY29uc3QgbGFiZWxzID0gZ2V0RWxlbWVudHMuY2FsbCh0aGlzLCBzZWxlY3Rvcik7XG4gICAgICAgIEFycmF5LmZyb20obGFiZWxzKS5mb3JFYWNoKGxhYmVsID0+IHtcbiAgICAgICAgICB0b2dnbGVDbGFzcyhsYWJlbCwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5oaWRkZW4sIGZhbHNlKTtcbiAgICAgICAgICB0b2dnbGVDbGFzcyhsYWJlbCwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy50b29sdGlwLCB0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIFNldCBtZWRpYSBtZXRhZGF0YVxuICAgIHNldE1lZGlhTWV0YWRhdGEoKSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoJ21lZGlhU2Vzc2lvbicgaW4gbmF2aWdhdG9yKSB7XG4gICAgICAgICAgbmF2aWdhdG9yLm1lZGlhU2Vzc2lvbi5tZXRhZGF0YSA9IG5ldyB3aW5kb3cuTWVkaWFNZXRhZGF0YSh7XG4gICAgICAgICAgICB0aXRsZTogdGhpcy5jb25maWcubWVkaWFNZXRhZGF0YS50aXRsZSxcbiAgICAgICAgICAgIGFydGlzdDogdGhpcy5jb25maWcubWVkaWFNZXRhZGF0YS5hcnRpc3QsXG4gICAgICAgICAgICBhbGJ1bTogdGhpcy5jb25maWcubWVkaWFNZXRhZGF0YS5hbGJ1bSxcbiAgICAgICAgICAgIGFydHdvcms6IHRoaXMuY29uZmlnLm1lZGlhTWV0YWRhdGEuYXJ0d29ya1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChfKSB7Ly8gRG8gbm90aGluZ1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBBZGQgbWFya2Vyc1xuICAgIHNldE1hcmtlcnMoKSB7XG4gICAgICB2YXIgX3RoaXMkY29uZmlnJG1hcmtlcnMyLCBfdGhpcyRjb25maWckbWFya2VyczM7XG5cbiAgICAgIGlmICghdGhpcy5kdXJhdGlvbiB8fCB0aGlzLmVsZW1lbnRzLm1hcmtlcnMpIHJldHVybjsgLy8gR2V0IHZhbGlkIHBvaW50c1xuXG4gICAgICBjb25zdCBwb2ludHMgPSAoX3RoaXMkY29uZmlnJG1hcmtlcnMyID0gdGhpcy5jb25maWcubWFya2VycykgPT09IG51bGwgfHwgX3RoaXMkY29uZmlnJG1hcmtlcnMyID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3RoaXMkY29uZmlnJG1hcmtlcnMzID0gX3RoaXMkY29uZmlnJG1hcmtlcnMyLnBvaW50cykgPT09IG51bGwgfHwgX3RoaXMkY29uZmlnJG1hcmtlcnMzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRjb25maWckbWFya2VyczMuZmlsdGVyKCh7XG4gICAgICAgIHRpbWVcbiAgICAgIH0pID0+IHRpbWUgPiAwICYmIHRpbWUgPCB0aGlzLmR1cmF0aW9uKTtcbiAgICAgIGlmICghKHBvaW50cyAhPT0gbnVsbCAmJiBwb2ludHMgIT09IHZvaWQgMCAmJiBwb2ludHMubGVuZ3RoKSkgcmV0dXJuO1xuICAgICAgY29uc3QgY29udGFpbmVyRnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICBjb25zdCBwb2ludHNGcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgIGxldCB0aXBFbGVtZW50ID0gbnVsbDtcbiAgICAgIGNvbnN0IHRpcFZpc2libGUgPSBgJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnRvb2x0aXB9LS12aXNpYmxlYDtcblxuICAgICAgY29uc3QgdG9nZ2xlVGlwID0gc2hvdyA9PiB0b2dnbGVDbGFzcyh0aXBFbGVtZW50LCB0aXBWaXNpYmxlLCBzaG93KTsgLy8gSW5qZWN0IG1hcmtlcnMgdG8gcHJvZ3Jlc3MgY29udGFpbmVyXG5cblxuICAgICAgcG9pbnRzLmZvckVhY2gocG9pbnQgPT4ge1xuICAgICAgICBjb25zdCBtYXJrZXJFbGVtZW50ID0gY3JlYXRlRWxlbWVudCgnc3BhbicsIHtcbiAgICAgICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy5tYXJrZXJcbiAgICAgICAgfSwgJycpO1xuICAgICAgICBjb25zdCBsZWZ0ID0gYCR7cG9pbnQudGltZSAvIHRoaXMuZHVyYXRpb24gKiAxMDB9JWA7XG5cbiAgICAgICAgaWYgKHRpcEVsZW1lbnQpIHtcbiAgICAgICAgICAvLyBTaG93IG9uIGhvdmVyXG4gICAgICAgICAgbWFya2VyRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHBvaW50LmxhYmVsKSByZXR1cm47XG4gICAgICAgICAgICB0aXBFbGVtZW50LnN0eWxlLmxlZnQgPSBsZWZ0O1xuICAgICAgICAgICAgdGlwRWxlbWVudC5pbm5lckhUTUwgPSBwb2ludC5sYWJlbDtcbiAgICAgICAgICAgIHRvZ2dsZVRpcCh0cnVlKTtcbiAgICAgICAgICB9KTsgLy8gSGlkZSBvbiBsZWF2ZVxuXG4gICAgICAgICAgbWFya2VyRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuICAgICAgICAgICAgdG9nZ2xlVGlwKGZhbHNlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1hcmtlckVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5jdXJyZW50VGltZSA9IHBvaW50LnRpbWU7XG4gICAgICAgIH0pO1xuICAgICAgICBtYXJrZXJFbGVtZW50LnN0eWxlLmxlZnQgPSBsZWZ0O1xuICAgICAgICBwb2ludHNGcmFnbWVudC5hcHBlbmRDaGlsZChtYXJrZXJFbGVtZW50KTtcbiAgICAgIH0pO1xuICAgICAgY29udGFpbmVyRnJhZ21lbnQuYXBwZW5kQ2hpbGQocG9pbnRzRnJhZ21lbnQpOyAvLyBJbmplY3QgYSB0b29sdGlwIGlmIG5lZWRlZFxuXG4gICAgICBpZiAoIXRoaXMuY29uZmlnLnRvb2x0aXBzLnNlZWspIHtcbiAgICAgICAgdGlwRWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7XG4gICAgICAgICAgY2xhc3M6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMudG9vbHRpcFxuICAgICAgICB9LCAnJyk7XG4gICAgICAgIGNvbnRhaW5lckZyYWdtZW50LmFwcGVuZENoaWxkKHRpcEVsZW1lbnQpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmVsZW1lbnRzLm1hcmtlcnMgPSB7XG4gICAgICAgIHBvaW50czogcG9pbnRzRnJhZ21lbnQsXG4gICAgICAgIHRpcDogdGlwRWxlbWVudFxuICAgICAgfTtcbiAgICAgIHRoaXMuZWxlbWVudHMucHJvZ3Jlc3MuYXBwZW5kQ2hpbGQoY29udGFpbmVyRnJhZ21lbnQpO1xuICAgIH1cblxuICB9O1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8qKlxuICAgKiBQYXJzZSBhIHN0cmluZyB0byBhIFVSTCBvYmplY3RcbiAgICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IC0gdGhlIFVSTCB0byBiZSBwYXJzZWRcbiAgICogQHBhcmFtIHtCb29sZWFufSBzYWZlIC0gZmFpbHNhZmUgcGFyc2luZ1xuICAgKi9cblxuICBmdW5jdGlvbiBwYXJzZVVybChpbnB1dCwgc2FmZSA9IHRydWUpIHtcbiAgICBsZXQgdXJsID0gaW5wdXQ7XG5cbiAgICBpZiAoc2FmZSkge1xuICAgICAgY29uc3QgcGFyc2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgcGFyc2VyLmhyZWYgPSB1cmw7XG4gICAgICB1cmwgPSBwYXJzZXIuaHJlZjtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIG5ldyBVUkwodXJsKTtcbiAgICB9IGNhdGNoIChfKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH0gLy8gQ29udmVydCBvYmplY3QgdG8gVVJMU2VhcmNoUGFyYW1zXG5cbiAgZnVuY3Rpb24gYnVpbGRVcmxQYXJhbXMoaW5wdXQpIHtcbiAgICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG5cbiAgICBpZiAoaXMub2JqZWN0KGlucHV0KSkge1xuICAgICAgT2JqZWN0LmVudHJpZXMoaW5wdXQpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICBwYXJhbXMuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcmFtcztcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IGNhcHRpb25zID0ge1xuICAgIC8vIFNldHVwIGNhcHRpb25zXG4gICAgc2V0dXAoKSB7XG4gICAgICAvLyBSZXF1aXJlcyBVSSBzdXBwb3J0XG4gICAgICBpZiAoIXRoaXMuc3VwcG9ydGVkLnVpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gT25seSBWaW1lbyBhbmQgSFRNTDUgdmlkZW8gc3VwcG9ydGVkIGF0IHRoaXMgcG9pbnRcblxuXG4gICAgICBpZiAoIXRoaXMuaXNWaWRlbyB8fCB0aGlzLmlzWW91VHViZSB8fCB0aGlzLmlzSFRNTDUgJiYgIXN1cHBvcnQudGV4dFRyYWNrcykge1xuICAgICAgICAvLyBDbGVhciBtZW51IGFuZCBoaWRlXG4gICAgICAgIGlmIChpcy5hcnJheSh0aGlzLmNvbmZpZy5jb250cm9scykgJiYgdGhpcy5jb25maWcuY29udHJvbHMuaW5jbHVkZXMoJ3NldHRpbmdzJykgJiYgdGhpcy5jb25maWcuc2V0dGluZ3MuaW5jbHVkZXMoJ2NhcHRpb25zJykpIHtcbiAgICAgICAgICBjb250cm9scy5zZXRDYXB0aW9uc01lbnUuY2FsbCh0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gSW5qZWN0IHRoZSBjb250YWluZXJcblxuXG4gICAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5jYXB0aW9ucykpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50cy5jYXB0aW9ucyA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLmNhcHRpb25zKSk7XG4gICAgICAgIGluc2VydEFmdGVyKHRoaXMuZWxlbWVudHMuY2FwdGlvbnMsIHRoaXMuZWxlbWVudHMud3JhcHBlcik7XG4gICAgICB9IC8vIEZpeCBJRSBjYXB0aW9ucyBpZiBDT1JTIGlzIHVzZWRcbiAgICAgIC8vIEZldGNoIGNhcHRpb25zIGFuZCBpbmplY3QgYXMgYmxvYnMgaW5zdGVhZCAoZGF0YSBVUklzIG5vdCBzdXBwb3J0ZWQhKVxuXG5cbiAgICAgIGlmIChicm93c2VyLmlzSUUgJiYgd2luZG93LlVSTCkge1xuICAgICAgICBjb25zdCBlbGVtZW50cyA9IHRoaXMubWVkaWEucXVlcnlTZWxlY3RvckFsbCgndHJhY2snKTtcbiAgICAgICAgQXJyYXkuZnJvbShlbGVtZW50cykuZm9yRWFjaCh0cmFjayA9PiB7XG4gICAgICAgICAgY29uc3Qgc3JjID0gdHJhY2suZ2V0QXR0cmlidXRlKCdzcmMnKTtcbiAgICAgICAgICBjb25zdCB1cmwgPSBwYXJzZVVybChzcmMpO1xuXG4gICAgICAgICAgaWYgKHVybCAhPT0gbnVsbCAmJiB1cmwuaG9zdG5hbWUgIT09IHdpbmRvdy5sb2NhdGlvbi5ocmVmLmhvc3RuYW1lICYmIFsnaHR0cDonLCAnaHR0cHM6J10uaW5jbHVkZXModXJsLnByb3RvY29sKSkge1xuICAgICAgICAgICAgZmV0Y2goc3JjLCAnYmxvYicpLnRoZW4oYmxvYiA9PiB7XG4gICAgICAgICAgICAgIHRyYWNrLnNldEF0dHJpYnV0ZSgnc3JjJywgd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYikpO1xuICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgICByZW1vdmVFbGVtZW50KHRyYWNrKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IC8vIEdldCBhbmQgc2V0IGluaXRpYWwgZGF0YVxuICAgICAgLy8gVGhlIFwicHJlZmVycmVkXCIgb3B0aW9ucyBhcmUgbm90IHJlYWxpemVkIHVubGVzcyAvIHVudGlsIHRoZSB3YW50ZWQgbGFuZ3VhZ2UgaGFzIGEgbWF0Y2hcbiAgICAgIC8vICogbGFuZ3VhZ2VzOiBBcnJheSBvZiB1c2VyJ3MgYnJvd3NlciBsYW5ndWFnZXMuXG4gICAgICAvLyAqIGxhbmd1YWdlOiAgVGhlIGxhbmd1YWdlIHByZWZlcnJlZCBieSB1c2VyIHNldHRpbmdzIG9yIGNvbmZpZ1xuICAgICAgLy8gKiBhY3RpdmU6ICAgIFRoZSBzdGF0ZSBwcmVmZXJyZWQgYnkgdXNlciBzZXR0aW5ncyBvciBjb25maWdcbiAgICAgIC8vICogdG9nZ2xlZDogICBUaGUgcmVhbCBjYXB0aW9ucyBzdGF0ZVxuXG5cbiAgICAgIGNvbnN0IGJyb3dzZXJMYW5ndWFnZXMgPSBuYXZpZ2F0b3IubGFuZ3VhZ2VzIHx8IFtuYXZpZ2F0b3IubGFuZ3VhZ2UgfHwgbmF2aWdhdG9yLnVzZXJMYW5ndWFnZSB8fCAnZW4nXTtcbiAgICAgIGNvbnN0IGxhbmd1YWdlcyA9IGRlZHVwZShicm93c2VyTGFuZ3VhZ2VzLm1hcChsYW5ndWFnZSA9PiBsYW5ndWFnZS5zcGxpdCgnLScpWzBdKSk7XG4gICAgICBsZXQgbGFuZ3VhZ2UgPSAodGhpcy5zdG9yYWdlLmdldCgnbGFuZ3VhZ2UnKSB8fCB0aGlzLmNvbmZpZy5jYXB0aW9ucy5sYW5ndWFnZSB8fCAnYXV0bycpLnRvTG93ZXJDYXNlKCk7IC8vIFVzZSBmaXJzdCBicm93c2VyIGxhbmd1YWdlIHdoZW4gbGFuZ3VhZ2UgaXMgJ2F1dG8nXG5cbiAgICAgIGlmIChsYW5ndWFnZSA9PT0gJ2F1dG8nKSB7XG4gICAgICAgIFtsYW5ndWFnZV0gPSBsYW5ndWFnZXM7XG4gICAgICB9XG5cbiAgICAgIGxldCBhY3RpdmUgPSB0aGlzLnN0b3JhZ2UuZ2V0KCdjYXB0aW9ucycpO1xuXG4gICAgICBpZiAoIWlzLmJvb2xlYW4oYWN0aXZlKSkge1xuICAgICAgICAoe1xuICAgICAgICAgIGFjdGl2ZVxuICAgICAgICB9ID0gdGhpcy5jb25maWcuY2FwdGlvbnMpO1xuICAgICAgfVxuXG4gICAgICBPYmplY3QuYXNzaWduKHRoaXMuY2FwdGlvbnMsIHtcbiAgICAgICAgdG9nZ2xlZDogZmFsc2UsXG4gICAgICAgIGFjdGl2ZSxcbiAgICAgICAgbGFuZ3VhZ2UsXG4gICAgICAgIGxhbmd1YWdlc1xuICAgICAgfSk7IC8vIFdhdGNoIGNoYW5nZXMgdG8gdGV4dFRyYWNrcyBhbmQgdXBkYXRlIGNhcHRpb25zIG1lbnVcblxuICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICBjb25zdCB0cmFja0V2ZW50cyA9IHRoaXMuY29uZmlnLmNhcHRpb25zLnVwZGF0ZSA/ICdhZGR0cmFjayByZW1vdmV0cmFjaycgOiAncmVtb3ZldHJhY2snO1xuICAgICAgICBvbi5jYWxsKHRoaXMsIHRoaXMubWVkaWEudGV4dFRyYWNrcywgdHJhY2tFdmVudHMsIGNhcHRpb25zLnVwZGF0ZS5iaW5kKHRoaXMpKTtcbiAgICAgIH0gLy8gVXBkYXRlIGF2YWlsYWJsZSBsYW5ndWFnZXMgaW4gbGlzdCBuZXh0IHRpY2sgKHRoZSBldmVudCBtdXN0IG5vdCBiZSB0cmlnZ2VyZWQgYmVmb3JlIHRoZSBsaXN0ZW5lcnMpXG5cblxuICAgICAgc2V0VGltZW91dChjYXB0aW9ucy51cGRhdGUuYmluZCh0aGlzKSwgMCk7XG4gICAgfSxcblxuICAgIC8vIFVwZGF0ZSBhdmFpbGFibGUgbGFuZ3VhZ2Ugb3B0aW9ucyBpbiBzZXR0aW5ncyBiYXNlZCBvbiB0cmFja3NcbiAgICB1cGRhdGUoKSB7XG4gICAgICBjb25zdCB0cmFja3MgPSBjYXB0aW9ucy5nZXRUcmFja3MuY2FsbCh0aGlzLCB0cnVlKTsgLy8gR2V0IHRoZSB3YW50ZWQgbGFuZ3VhZ2VcblxuICAgICAgY29uc3Qge1xuICAgICAgICBhY3RpdmUsXG4gICAgICAgIGxhbmd1YWdlLFxuICAgICAgICBtZXRhLFxuICAgICAgICBjdXJyZW50VHJhY2tOb2RlXG4gICAgICB9ID0gdGhpcy5jYXB0aW9ucztcbiAgICAgIGNvbnN0IGxhbmd1YWdlRXhpc3RzID0gQm9vbGVhbih0cmFja3MuZmluZCh0cmFjayA9PiB0cmFjay5sYW5ndWFnZSA9PT0gbGFuZ3VhZ2UpKTsgLy8gSGFuZGxlIHRyYWNrcyAoYWRkIGV2ZW50IGxpc3RlbmVyIGFuZCBcInBzZXVkb1wiLWRlZmF1bHQpXG5cbiAgICAgIGlmICh0aGlzLmlzSFRNTDUgJiYgdGhpcy5pc1ZpZGVvKSB7XG4gICAgICAgIHRyYWNrcy5maWx0ZXIodHJhY2sgPT4gIW1ldGEuZ2V0KHRyYWNrKSkuZm9yRWFjaCh0cmFjayA9PiB7XG4gICAgICAgICAgdGhpcy5kZWJ1Zy5sb2coJ1RyYWNrIGFkZGVkJywgdHJhY2spOyAvLyBBdHRlbXB0IHRvIHN0b3JlIGlmIHRoZSBvcmlnaW5hbCBkb20gZWxlbWVudCB3YXMgXCJkZWZhdWx0XCJcblxuICAgICAgICAgIG1ldGEuc2V0KHRyYWNrLCB7XG4gICAgICAgICAgICBkZWZhdWx0OiB0cmFjay5tb2RlID09PSAnc2hvd2luZydcbiAgICAgICAgICB9KTsgLy8gVHVybiBvZmYgbmF0aXZlIGNhcHRpb24gcmVuZGVyaW5nIHRvIGF2b2lkIGRvdWJsZSBjYXB0aW9uc1xuICAgICAgICAgIC8vIE5vdGU6IG1vZGU9J2hpZGRlbicgZm9yY2VzIGEgdHJhY2sgdG8gZG93bmxvYWQuIFRvIGVuc3VyZSBldmVyeSB0cmFja1xuICAgICAgICAgIC8vIGlzbid0IGRvd25sb2FkZWQgYXQgb25jZSwgb25seSAnc2hvd2luZycgdHJhY2tzIHNob3VsZCBiZSByZWFzc2lnbmVkXG4gICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG5cbiAgICAgICAgICBpZiAodHJhY2subW9kZSA9PT0gJ3Nob3dpbmcnKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgICAgICAgIHRyYWNrLm1vZGUgPSAnaGlkZGVuJztcbiAgICAgICAgICB9IC8vIEFkZCBldmVudCBsaXN0ZW5lciBmb3IgY3VlIGNoYW5nZXNcblxuXG4gICAgICAgICAgb24uY2FsbCh0aGlzLCB0cmFjaywgJ2N1ZWNoYW5nZScsICgpID0+IGNhcHRpb25zLnVwZGF0ZUN1ZXMuY2FsbCh0aGlzKSk7XG4gICAgICAgIH0pO1xuICAgICAgfSAvLyBVcGRhdGUgbGFuZ3VhZ2UgZmlyc3QgdGltZSBpdCBtYXRjaGVzLCBvciBpZiB0aGUgcHJldmlvdXMgbWF0Y2hpbmcgdHJhY2sgd2FzIHJlbW92ZWRcblxuXG4gICAgICBpZiAobGFuZ3VhZ2VFeGlzdHMgJiYgdGhpcy5sYW5ndWFnZSAhPT0gbGFuZ3VhZ2UgfHwgIXRyYWNrcy5pbmNsdWRlcyhjdXJyZW50VHJhY2tOb2RlKSkge1xuICAgICAgICBjYXB0aW9ucy5zZXRMYW5ndWFnZS5jYWxsKHRoaXMsIGxhbmd1YWdlKTtcbiAgICAgICAgY2FwdGlvbnMudG9nZ2xlLmNhbGwodGhpcywgYWN0aXZlICYmIGxhbmd1YWdlRXhpc3RzKTtcbiAgICAgIH0gLy8gRW5hYmxlIG9yIGRpc2FibGUgY2FwdGlvbnMgYmFzZWQgb24gdHJhY2sgbGVuZ3RoXG5cblxuICAgICAgaWYgKHRoaXMuZWxlbWVudHMpIHtcbiAgICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuY2FwdGlvbnMuZW5hYmxlZCwgIWlzLmVtcHR5KHRyYWNrcykpO1xuICAgICAgfSAvLyBVcGRhdGUgYXZhaWxhYmxlIGxhbmd1YWdlcyBpbiBsaXN0XG5cblxuICAgICAgaWYgKGlzLmFycmF5KHRoaXMuY29uZmlnLmNvbnRyb2xzKSAmJiB0aGlzLmNvbmZpZy5jb250cm9scy5pbmNsdWRlcygnc2V0dGluZ3MnKSAmJiB0aGlzLmNvbmZpZy5zZXR0aW5ncy5pbmNsdWRlcygnY2FwdGlvbnMnKSkge1xuICAgICAgICBjb250cm9scy5zZXRDYXB0aW9uc01lbnUuY2FsbCh0aGlzKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gVG9nZ2xlIGNhcHRpb25zIGRpc3BsYXlcbiAgICAvLyBVc2VkIGludGVybmFsbHkgZm9yIHRoZSB0b2dnbGVDYXB0aW9ucyBtZXRob2QsIHdpdGggdGhlIHBhc3NpdmUgb3B0aW9uIGZvcmNlZCB0byBmYWxzZVxuICAgIHRvZ2dsZShpbnB1dCwgcGFzc2l2ZSA9IHRydWUpIHtcbiAgICAgIC8vIElmIHRoZXJlJ3Mgbm8gZnVsbCBzdXBwb3J0XG4gICAgICBpZiAoIXRoaXMuc3VwcG9ydGVkLnVpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3Qge1xuICAgICAgICB0b2dnbGVkXG4gICAgICB9ID0gdGhpcy5jYXB0aW9uczsgLy8gQ3VycmVudCBzdGF0ZVxuXG4gICAgICBjb25zdCBhY3RpdmVDbGFzcyA9IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuY2FwdGlvbnMuYWN0aXZlOyAvLyBHZXQgdGhlIG5leHQgc3RhdGVcbiAgICAgIC8vIElmIHRoZSBtZXRob2QgaXMgY2FsbGVkIHdpdGhvdXQgcGFyYW1ldGVyLCB0b2dnbGUgYmFzZWQgb24gY3VycmVudCB2YWx1ZVxuXG4gICAgICBjb25zdCBhY3RpdmUgPSBpcy5udWxsT3JVbmRlZmluZWQoaW5wdXQpID8gIXRvZ2dsZWQgOiBpbnB1dDsgLy8gVXBkYXRlIHN0YXRlIGFuZCB0cmlnZ2VyIGV2ZW50XG5cbiAgICAgIGlmIChhY3RpdmUgIT09IHRvZ2dsZWQpIHtcbiAgICAgICAgLy8gV2hlbiBwYXNzaXZlLCBkb24ndCBvdmVycmlkZSB1c2VyIHByZWZlcmVuY2VzXG4gICAgICAgIGlmICghcGFzc2l2ZSkge1xuICAgICAgICAgIHRoaXMuY2FwdGlvbnMuYWN0aXZlID0gYWN0aXZlO1xuICAgICAgICAgIHRoaXMuc3RvcmFnZS5zZXQoe1xuICAgICAgICAgICAgY2FwdGlvbnM6IGFjdGl2ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IC8vIEZvcmNlIGxhbmd1YWdlIGlmIHRoZSBjYWxsIGlzbid0IHBhc3NpdmUgYW5kIHRoZXJlIGlzIG5vIG1hdGNoaW5nIGxhbmd1YWdlIHRvIHRvZ2dsZSB0b1xuXG5cbiAgICAgICAgaWYgKCF0aGlzLmxhbmd1YWdlICYmIGFjdGl2ZSAmJiAhcGFzc2l2ZSkge1xuICAgICAgICAgIGNvbnN0IHRyYWNrcyA9IGNhcHRpb25zLmdldFRyYWNrcy5jYWxsKHRoaXMpO1xuICAgICAgICAgIGNvbnN0IHRyYWNrID0gY2FwdGlvbnMuZmluZFRyYWNrLmNhbGwodGhpcywgW3RoaXMuY2FwdGlvbnMubGFuZ3VhZ2UsIC4uLnRoaXMuY2FwdGlvbnMubGFuZ3VhZ2VzXSwgdHJ1ZSk7IC8vIE92ZXJyaWRlIHVzZXIgcHJlZmVyZW5jZXMgdG8gYXZvaWQgc3dpdGNoaW5nIGxhbmd1YWdlcyBpZiBhIG1hdGNoaW5nIHRyYWNrIGlzIGFkZGVkXG5cbiAgICAgICAgICB0aGlzLmNhcHRpb25zLmxhbmd1YWdlID0gdHJhY2subGFuZ3VhZ2U7IC8vIFNldCBjYXB0aW9uLCBidXQgZG9uJ3Qgc3RvcmUgaW4gbG9jYWxTdG9yYWdlIGFzIHVzZXIgcHJlZmVyZW5jZVxuXG4gICAgICAgICAgY2FwdGlvbnMuc2V0LmNhbGwodGhpcywgdHJhY2tzLmluZGV4T2YodHJhY2spKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gLy8gVG9nZ2xlIGJ1dHRvbiBpZiBpdCdzIGVuYWJsZWRcblxuXG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnRzLmJ1dHRvbnMuY2FwdGlvbnMpIHtcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLmJ1dHRvbnMuY2FwdGlvbnMucHJlc3NlZCA9IGFjdGl2ZTtcbiAgICAgICAgfSAvLyBBZGQgY2xhc3MgaG9va1xuXG5cbiAgICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIGFjdGl2ZUNsYXNzLCBhY3RpdmUpO1xuICAgICAgICB0aGlzLmNhcHRpb25zLnRvZ2dsZWQgPSBhY3RpdmU7IC8vIFVwZGF0ZSBzZXR0aW5ncyBtZW51XG5cbiAgICAgICAgY29udHJvbHMudXBkYXRlU2V0dGluZy5jYWxsKHRoaXMsICdjYXB0aW9ucycpOyAvLyBUcmlnZ2VyIGV2ZW50IChub3QgdXNlZCBpbnRlcm5hbGx5KVxuXG4gICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMsIHRoaXMubWVkaWEsIGFjdGl2ZSA/ICdjYXB0aW9uc2VuYWJsZWQnIDogJ2NhcHRpb25zZGlzYWJsZWQnKTtcbiAgICAgIH0gLy8gV2FpdCBmb3IgdGhlIGNhbGwgc3RhY2sgdG8gY2xlYXIgYmVmb3JlIHNldHRpbmcgbW9kZT0naGlkZGVuJ1xuICAgICAgLy8gb24gdGhlIGFjdGl2ZSB0cmFjayAtIGZvcmNpbmcgdGhlIGJyb3dzZXIgdG8gZG93bmxvYWQgaXRcblxuXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKGFjdGl2ZSAmJiB0aGlzLmNhcHRpb25zLnRvZ2dsZWQpIHtcbiAgICAgICAgICB0aGlzLmNhcHRpb25zLmN1cnJlbnRUcmFja05vZGUubW9kZSA9ICdoaWRkZW4nO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgLy8gU2V0IGNhcHRpb25zIGJ5IHRyYWNrIGluZGV4XG4gICAgLy8gVXNlZCBpbnRlcm5hbGx5IGZvciB0aGUgY3VycmVudFRyYWNrIHNldHRlciB3aXRoIHRoZSBwYXNzaXZlIG9wdGlvbiBmb3JjZWQgdG8gZmFsc2VcbiAgICBzZXQoaW5kZXgsIHBhc3NpdmUgPSB0cnVlKSB7XG4gICAgICBjb25zdCB0cmFja3MgPSBjYXB0aW9ucy5nZXRUcmFja3MuY2FsbCh0aGlzKTsgLy8gRGlzYWJsZSBjYXB0aW9ucyBpZiBzZXR0aW5nIHRvIC0xXG5cbiAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgY2FwdGlvbnMudG9nZ2xlLmNhbGwodGhpcywgZmFsc2UsIHBhc3NpdmUpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICghaXMubnVtYmVyKGluZGV4KSkge1xuICAgICAgICB0aGlzLmRlYnVnLndhcm4oJ0ludmFsaWQgY2FwdGlvbiBhcmd1bWVudCcsIGluZGV4KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoIShpbmRleCBpbiB0cmFja3MpKSB7XG4gICAgICAgIHRoaXMuZGVidWcud2FybignVHJhY2sgbm90IGZvdW5kJywgaW5kZXgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmNhcHRpb25zLmN1cnJlbnRUcmFjayAhPT0gaW5kZXgpIHtcbiAgICAgICAgdGhpcy5jYXB0aW9ucy5jdXJyZW50VHJhY2sgPSBpbmRleDtcbiAgICAgICAgY29uc3QgdHJhY2sgPSB0cmFja3NbaW5kZXhdO1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgbGFuZ3VhZ2VcbiAgICAgICAgfSA9IHRyYWNrIHx8IHt9OyAvLyBTdG9yZSByZWZlcmVuY2UgdG8gbm9kZSBmb3IgaW52YWxpZGF0aW9uIG9uIHJlbW92ZVxuXG4gICAgICAgIHRoaXMuY2FwdGlvbnMuY3VycmVudFRyYWNrTm9kZSA9IHRyYWNrOyAvLyBVcGRhdGUgc2V0dGluZ3MgbWVudVxuXG4gICAgICAgIGNvbnRyb2xzLnVwZGF0ZVNldHRpbmcuY2FsbCh0aGlzLCAnY2FwdGlvbnMnKTsgLy8gV2hlbiBwYXNzaXZlLCBkb24ndCBvdmVycmlkZSB1c2VyIHByZWZlcmVuY2VzXG5cbiAgICAgICAgaWYgKCFwYXNzaXZlKSB7XG4gICAgICAgICAgdGhpcy5jYXB0aW9ucy5sYW5ndWFnZSA9IGxhbmd1YWdlO1xuICAgICAgICAgIHRoaXMuc3RvcmFnZS5zZXQoe1xuICAgICAgICAgICAgbGFuZ3VhZ2VcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSAvLyBIYW5kbGUgVmltZW8gY2FwdGlvbnNcblxuXG4gICAgICAgIGlmICh0aGlzLmlzVmltZW8pIHtcbiAgICAgICAgICB0aGlzLmVtYmVkLmVuYWJsZVRleHRUcmFjayhsYW5ndWFnZSk7XG4gICAgICAgIH0gLy8gVHJpZ2dlciBldmVudFxuXG5cbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwodGhpcywgdGhpcy5tZWRpYSwgJ2xhbmd1YWdlY2hhbmdlJyk7XG4gICAgICB9IC8vIFNob3cgY2FwdGlvbnNcblxuXG4gICAgICBjYXB0aW9ucy50b2dnbGUuY2FsbCh0aGlzLCB0cnVlLCBwYXNzaXZlKTtcblxuICAgICAgaWYgKHRoaXMuaXNIVE1MNSAmJiB0aGlzLmlzVmlkZW8pIHtcbiAgICAgICAgLy8gSWYgd2UgY2hhbmdlIHRoZSBhY3RpdmUgdHJhY2sgd2hpbGUgYSBjdWUgaXMgYWxyZWFkeSBkaXNwbGF5ZWQgd2UgbmVlZCB0byB1cGRhdGUgaXRcbiAgICAgICAgY2FwdGlvbnMudXBkYXRlQ3Vlcy5jYWxsKHRoaXMpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBTZXQgY2FwdGlvbnMgYnkgbGFuZ3VhZ2VcbiAgICAvLyBVc2VkIGludGVybmFsbHkgZm9yIHRoZSBsYW5ndWFnZSBzZXR0ZXIgd2l0aCB0aGUgcGFzc2l2ZSBvcHRpb24gZm9yY2VkIHRvIGZhbHNlXG4gICAgc2V0TGFuZ3VhZ2UoaW5wdXQsIHBhc3NpdmUgPSB0cnVlKSB7XG4gICAgICBpZiAoIWlzLnN0cmluZyhpbnB1dCkpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdJbnZhbGlkIGxhbmd1YWdlIGFyZ3VtZW50JywgaW5wdXQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIE5vcm1hbGl6ZVxuXG5cbiAgICAgIGNvbnN0IGxhbmd1YWdlID0gaW5wdXQudG9Mb3dlckNhc2UoKTtcbiAgICAgIHRoaXMuY2FwdGlvbnMubGFuZ3VhZ2UgPSBsYW5ndWFnZTsgLy8gU2V0IGN1cnJlbnRUcmFja1xuXG4gICAgICBjb25zdCB0cmFja3MgPSBjYXB0aW9ucy5nZXRUcmFja3MuY2FsbCh0aGlzKTtcbiAgICAgIGNvbnN0IHRyYWNrID0gY2FwdGlvbnMuZmluZFRyYWNrLmNhbGwodGhpcywgW2xhbmd1YWdlXSk7XG4gICAgICBjYXB0aW9ucy5zZXQuY2FsbCh0aGlzLCB0cmFja3MuaW5kZXhPZih0cmFjayksIHBhc3NpdmUpO1xuICAgIH0sXG5cbiAgICAvLyBHZXQgY3VycmVudCB2YWxpZCBjYXB0aW9uIHRyYWNrc1xuICAgIC8vIElmIHVwZGF0ZSBpcyBmYWxzZSBpdCB3aWxsIGFsc28gaWdub3JlIHRyYWNrcyB3aXRob3V0IG1ldGFkYXRhXG4gICAgLy8gVGhpcyBpcyB1c2VkIHRvIFwiZnJlZXplXCIgdGhlIGxhbmd1YWdlIG9wdGlvbnMgd2hlbiBjYXB0aW9ucy51cGRhdGUgaXMgZmFsc2VcbiAgICBnZXRUcmFja3ModXBkYXRlID0gZmFsc2UpIHtcbiAgICAgIC8vIEhhbmRsZSBtZWRpYSBvciB0ZXh0VHJhY2tzIG1pc3Npbmcgb3IgbnVsbFxuICAgICAgY29uc3QgdHJhY2tzID0gQXJyYXkuZnJvbSgodGhpcy5tZWRpYSB8fCB7fSkudGV4dFRyYWNrcyB8fCBbXSk7IC8vIEZvciBIVE1MNSwgdXNlIGNhY2hlIGluc3RlYWQgb2YgY3VycmVudCB0cmFja3Mgd2hlbiBpdCBleGlzdHMgKGlmIGNhcHRpb25zLnVwZGF0ZSBpcyBmYWxzZSlcbiAgICAgIC8vIEZpbHRlciBvdXQgcmVtb3ZlZCB0cmFja3MgYW5kIHRyYWNrcyB0aGF0IGFyZW4ndCBjYXB0aW9ucy9zdWJ0aXRsZXMgKGZvciBleGFtcGxlIG1ldGFkYXRhKVxuXG4gICAgICByZXR1cm4gdHJhY2tzLmZpbHRlcih0cmFjayA9PiAhdGhpcy5pc0hUTUw1IHx8IHVwZGF0ZSB8fCB0aGlzLmNhcHRpb25zLm1ldGEuaGFzKHRyYWNrKSkuZmlsdGVyKHRyYWNrID0+IFsnY2FwdGlvbnMnLCAnc3VidGl0bGVzJ10uaW5jbHVkZXModHJhY2sua2luZCkpO1xuICAgIH0sXG5cbiAgICAvLyBNYXRjaCB0cmFja3MgYmFzZWQgb24gbGFuZ3VhZ2VzIGFuZCBnZXQgdGhlIGZpcnN0XG4gICAgZmluZFRyYWNrKGxhbmd1YWdlcywgZm9yY2UgPSBmYWxzZSkge1xuICAgICAgY29uc3QgdHJhY2tzID0gY2FwdGlvbnMuZ2V0VHJhY2tzLmNhbGwodGhpcyk7XG5cbiAgICAgIGNvbnN0IHNvcnRJc0RlZmF1bHQgPSB0cmFjayA9PiBOdW1iZXIoKHRoaXMuY2FwdGlvbnMubWV0YS5nZXQodHJhY2spIHx8IHt9KS5kZWZhdWx0KTtcblxuICAgICAgY29uc3Qgc29ydGVkID0gQXJyYXkuZnJvbSh0cmFja3MpLnNvcnQoKGEsIGIpID0+IHNvcnRJc0RlZmF1bHQoYikgLSBzb3J0SXNEZWZhdWx0KGEpKTtcbiAgICAgIGxldCB0cmFjaztcbiAgICAgIGxhbmd1YWdlcy5ldmVyeShsYW5ndWFnZSA9PiB7XG4gICAgICAgIHRyYWNrID0gc29ydGVkLmZpbmQodCA9PiB0Lmxhbmd1YWdlID09PSBsYW5ndWFnZSk7XG4gICAgICAgIHJldHVybiAhdHJhY2s7IC8vIEJyZWFrIGl0ZXJhdGlvbiBpZiB0aGVyZSBpcyBhIG1hdGNoXG4gICAgICB9KTsgLy8gSWYgbm8gbWF0Y2ggaXMgZm91bmQgYnV0IGlzIHJlcXVpcmVkLCBnZXQgZmlyc3RcblxuICAgICAgcmV0dXJuIHRyYWNrIHx8IChmb3JjZSA/IHNvcnRlZFswXSA6IHVuZGVmaW5lZCk7XG4gICAgfSxcblxuICAgIC8vIEdldCB0aGUgY3VycmVudCB0cmFja1xuICAgIGdldEN1cnJlbnRUcmFjaygpIHtcbiAgICAgIHJldHVybiBjYXB0aW9ucy5nZXRUcmFja3MuY2FsbCh0aGlzKVt0aGlzLmN1cnJlbnRUcmFja107XG4gICAgfSxcblxuICAgIC8vIEdldCBVSSBsYWJlbCBmb3IgdHJhY2tcbiAgICBnZXRMYWJlbCh0cmFjaykge1xuICAgICAgbGV0IGN1cnJlbnRUcmFjayA9IHRyYWNrO1xuXG4gICAgICBpZiAoIWlzLnRyYWNrKGN1cnJlbnRUcmFjaykgJiYgc3VwcG9ydC50ZXh0VHJhY2tzICYmIHRoaXMuY2FwdGlvbnMudG9nZ2xlZCkge1xuICAgICAgICBjdXJyZW50VHJhY2sgPSBjYXB0aW9ucy5nZXRDdXJyZW50VHJhY2suY2FsbCh0aGlzKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGlzLnRyYWNrKGN1cnJlbnRUcmFjaykpIHtcbiAgICAgICAgaWYgKCFpcy5lbXB0eShjdXJyZW50VHJhY2subGFiZWwpKSB7XG4gICAgICAgICAgcmV0dXJuIGN1cnJlbnRUcmFjay5sYWJlbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaXMuZW1wdHkoY3VycmVudFRyYWNrLmxhbmd1YWdlKSkge1xuICAgICAgICAgIHJldHVybiB0cmFjay5sYW5ndWFnZS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGkxOG4uZ2V0KCdlbmFibGVkJywgdGhpcy5jb25maWcpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gaTE4bi5nZXQoJ2Rpc2FibGVkJywgdGhpcy5jb25maWcpO1xuICAgIH0sXG5cbiAgICAvLyBVcGRhdGUgY2FwdGlvbnMgdXNpbmcgY3VycmVudCB0cmFjaydzIGFjdGl2ZSBjdWVzXG4gICAgLy8gQWxzbyBvcHRpb25hbCBhcnJheSBhcmd1bWVudCBpbiBjYXNlIHRoZXJlIGlzbid0IGFueSB0cmFjayAoZXg6IHZpbWVvKVxuICAgIHVwZGF0ZUN1ZXMoaW5wdXQpIHtcbiAgICAgIC8vIFJlcXVpcmVzIFVJXG4gICAgICBpZiAoIXRoaXMuc3VwcG9ydGVkLnVpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuY2FwdGlvbnMpKSB7XG4gICAgICAgIHRoaXMuZGVidWcud2FybignTm8gY2FwdGlvbnMgZWxlbWVudCB0byByZW5kZXIgdG8nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBPbmx5IGFjY2VwdCBhcnJheSBvciBlbXB0eSBpbnB1dFxuXG5cbiAgICAgIGlmICghaXMubnVsbE9yVW5kZWZpbmVkKGlucHV0KSAmJiAhQXJyYXkuaXNBcnJheShpbnB1dCkpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKCd1cGRhdGVDdWVzOiBJbnZhbGlkIGlucHV0JywgaW5wdXQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCBjdWVzID0gaW5wdXQ7IC8vIEdldCBjdWVzIGZyb20gdHJhY2tcblxuICAgICAgaWYgKCFjdWVzKSB7XG4gICAgICAgIGNvbnN0IHRyYWNrID0gY2FwdGlvbnMuZ2V0Q3VycmVudFRyYWNrLmNhbGwodGhpcyk7XG4gICAgICAgIGN1ZXMgPSBBcnJheS5mcm9tKCh0cmFjayB8fCB7fSkuYWN0aXZlQ3VlcyB8fCBbXSkubWFwKGN1ZSA9PiBjdWUuZ2V0Q3VlQXNIVE1MKCkpLm1hcChnZXRIVE1MKTtcbiAgICAgIH0gLy8gU2V0IG5ldyBjYXB0aW9uIHRleHRcblxuXG4gICAgICBjb25zdCBjb250ZW50ID0gY3Vlcy5tYXAoY3VlVGV4dCA9PiBjdWVUZXh0LnRyaW0oKSkuam9pbignXFxuJyk7XG4gICAgICBjb25zdCBjaGFuZ2VkID0gY29udGVudCAhPT0gdGhpcy5lbGVtZW50cy5jYXB0aW9ucy5pbm5lckhUTUw7XG5cbiAgICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgIC8vIEVtcHR5IHRoZSBjb250YWluZXIgYW5kIGNyZWF0ZSBhIG5ldyBjaGlsZCBlbGVtZW50XG4gICAgICAgIGVtcHR5RWxlbWVudCh0aGlzLmVsZW1lbnRzLmNhcHRpb25zKTtcbiAgICAgICAgY29uc3QgY2FwdGlvbiA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5jYXB0aW9uKSk7XG4gICAgICAgIGNhcHRpb24uaW5uZXJIVE1MID0gY29udGVudDtcbiAgICAgICAgdGhpcy5lbGVtZW50cy5jYXB0aW9ucy5hcHBlbmRDaGlsZChjYXB0aW9uKTsgLy8gVHJpZ2dlciBldmVudFxuXG4gICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMsIHRoaXMubWVkaWEsICdjdWVjaGFuZ2UnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgfTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBQbHlyIGRlZmF1bHQgY29uZmlnXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IGRlZmF1bHRzID0ge1xuICAgIC8vIERpc2FibGVcbiAgICBlbmFibGVkOiB0cnVlLFxuICAgIC8vIEN1c3RvbSBtZWRpYSB0aXRsZVxuICAgIHRpdGxlOiAnJyxcbiAgICAvLyBMb2dnaW5nIHRvIGNvbnNvbGVcbiAgICBkZWJ1ZzogZmFsc2UsXG4gICAgLy8gQXV0byBwbGF5IChpZiBzdXBwb3J0ZWQpXG4gICAgYXV0b3BsYXk6IGZhbHNlLFxuICAgIC8vIE9ubHkgYWxsb3cgb25lIG1lZGlhIHBsYXlpbmcgYXQgb25jZSAodmltZW8gb25seSlcbiAgICBhdXRvcGF1c2U6IHRydWUsXG4gICAgLy8gQWxsb3cgaW5saW5lIHBsYXliYWNrIG9uIGlPUyAodGhpcyBlZmZlY3RzIFlvdVR1YmUvVmltZW8gLSBIVE1MNSByZXF1aXJlcyB0aGUgYXR0cmlidXRlIHByZXNlbnQpXG4gICAgLy8gVE9ETzogUmVtb3ZlIGlvc05hdGl2ZSBmdWxsc2NyZWVuIG9wdGlvbiBpbiBmYXZvdXIgb2YgdGhpcyAobG9naWMgbmVlZHMgd29yaylcbiAgICBwbGF5c2lubGluZTogdHJ1ZSxcbiAgICAvLyBEZWZhdWx0IHRpbWUgdG8gc2tpcCB3aGVuIHJld2luZC9mYXN0IGZvcndhcmRcbiAgICBzZWVrVGltZTogMTAsXG4gICAgLy8gRGVmYXVsdCB2b2x1bWVcbiAgICB2b2x1bWU6IDEsXG4gICAgbXV0ZWQ6IGZhbHNlLFxuICAgIC8vIFBhc3MgYSBjdXN0b20gZHVyYXRpb25cbiAgICBkdXJhdGlvbjogbnVsbCxcbiAgICAvLyBEaXNwbGF5IHRoZSBtZWRpYSBkdXJhdGlvbiBvbiBsb2FkIGluIHRoZSBjdXJyZW50IHRpbWUgcG9zaXRpb25cbiAgICAvLyBJZiB5b3UgaGF2ZSBvcHRlZCB0byBkaXNwbGF5IGJvdGggZHVyYXRpb24gYW5kIGN1cnJlbnRUaW1lLCB0aGlzIGlzIGlnbm9yZWRcbiAgICBkaXNwbGF5RHVyYXRpb246IHRydWUsXG4gICAgLy8gSW52ZXJ0IHRoZSBjdXJyZW50IHRpbWUgdG8gYmUgYSBjb3VudGRvd25cbiAgICBpbnZlcnRUaW1lOiB0cnVlLFxuICAgIC8vIENsaWNraW5nIHRoZSBjdXJyZW50VGltZSBpbnZlcnRzIGl0J3MgdmFsdWUgdG8gc2hvdyB0aW1lIGxlZnQgcmF0aGVyIHRoYW4gZWxhcHNlZFxuICAgIHRvZ2dsZUludmVydDogdHJ1ZSxcbiAgICAvLyBGb3JjZSBhbiBhc3BlY3QgcmF0aW9cbiAgICAvLyBUaGUgZm9ybWF0IG11c3QgYmUgYCd3OmgnYCAoZS5nLiBgJzE2OjknYClcbiAgICByYXRpbzogbnVsbCxcbiAgICAvLyBDbGljayB2aWRlbyBjb250YWluZXIgdG8gcGxheS9wYXVzZVxuICAgIGNsaWNrVG9QbGF5OiB0cnVlLFxuICAgIC8vIEF1dG8gaGlkZSB0aGUgY29udHJvbHNcbiAgICBoaWRlQ29udHJvbHM6IHRydWUsXG4gICAgLy8gUmVzZXQgdG8gc3RhcnQgd2hlbiBwbGF5YmFjayBlbmRlZFxuICAgIHJlc2V0T25FbmQ6IGZhbHNlLFxuICAgIC8vIERpc2FibGUgdGhlIHN0YW5kYXJkIGNvbnRleHQgbWVudVxuICAgIGRpc2FibGVDb250ZXh0TWVudTogdHJ1ZSxcbiAgICAvLyBTcHJpdGUgKGZvciBpY29ucylcbiAgICBsb2FkU3ByaXRlOiB0cnVlLFxuICAgIGljb25QcmVmaXg6ICdwbHlyJyxcbiAgICBpY29uVXJsOiAnaHR0cHM6Ly9jZG4ucGx5ci5pby8zLjcuMi9wbHlyLnN2ZycsXG4gICAgLy8gQmxhbmsgdmlkZW8gKHVzZWQgdG8gcHJldmVudCBlcnJvcnMgb24gc291cmNlIGNoYW5nZSlcbiAgICBibGFua1ZpZGVvOiAnaHR0cHM6Ly9jZG4ucGx5ci5pby9zdGF0aWMvYmxhbmsubXA0JyxcbiAgICAvLyBRdWFsaXR5IGRlZmF1bHRcbiAgICBxdWFsaXR5OiB7XG4gICAgICBkZWZhdWx0OiA1NzYsXG4gICAgICAvLyBUaGUgb3B0aW9ucyB0byBkaXNwbGF5IGluIHRoZSBVSSwgaWYgYXZhaWxhYmxlIGZvciB0aGUgc291cmNlIG1lZGlhXG4gICAgICBvcHRpb25zOiBbNDMyMCwgMjg4MCwgMjE2MCwgMTQ0MCwgMTA4MCwgNzIwLCA1NzYsIDQ4MCwgMzYwLCAyNDBdLFxuICAgICAgZm9yY2VkOiBmYWxzZSxcbiAgICAgIG9uQ2hhbmdlOiBudWxsXG4gICAgfSxcbiAgICAvLyBTZXQgbG9vcHNcbiAgICBsb29wOiB7XG4gICAgICBhY3RpdmU6IGZhbHNlIC8vIHN0YXJ0OiBudWxsLFxuICAgICAgLy8gZW5kOiBudWxsLFxuXG4gICAgfSxcbiAgICAvLyBTcGVlZCBkZWZhdWx0IGFuZCBvcHRpb25zIHRvIGRpc3BsYXlcbiAgICBzcGVlZDoge1xuICAgICAgc2VsZWN0ZWQ6IDEsXG4gICAgICAvLyBUaGUgb3B0aW9ucyB0byBkaXNwbGF5IGluIHRoZSBVSSwgaWYgYXZhaWxhYmxlIGZvciB0aGUgc291cmNlIG1lZGlhIChlLmcuIFZpbWVvIGFuZCBZb3VUdWJlIG9ubHkgc3VwcG9ydCAwLjV4LTR4KVxuICAgICAgb3B0aW9uczogWzAuNSwgMC43NSwgMSwgMS4yNSwgMS41LCAxLjc1LCAyLCA0XVxuICAgIH0sXG4gICAgLy8gS2V5Ym9hcmQgc2hvcnRjdXQgc2V0dGluZ3NcbiAgICBrZXlib2FyZDoge1xuICAgICAgZm9jdXNlZDogdHJ1ZSxcbiAgICAgIGdsb2JhbDogZmFsc2VcbiAgICB9LFxuICAgIC8vIERpc3BsYXkgdG9vbHRpcHNcbiAgICB0b29sdGlwczoge1xuICAgICAgY29udHJvbHM6IGZhbHNlLFxuICAgICAgc2VlazogdHJ1ZVxuICAgIH0sXG4gICAgLy8gQ2FwdGlvbnMgc2V0dGluZ3NcbiAgICBjYXB0aW9uczoge1xuICAgICAgYWN0aXZlOiBmYWxzZSxcbiAgICAgIGxhbmd1YWdlOiAnYXV0bycsXG4gICAgICAvLyBMaXN0ZW4gdG8gbmV3IHRyYWNrcyBhZGRlZCBhZnRlciBQbHlyIGlzIGluaXRpYWxpemVkLlxuICAgICAgLy8gVGhpcyBpcyBuZWVkZWQgZm9yIHN0cmVhbWluZyBjYXB0aW9ucywgYnV0IG1heSByZXN1bHQgaW4gdW5zZWxlY3RhYmxlIG9wdGlvbnNcbiAgICAgIHVwZGF0ZTogZmFsc2VcbiAgICB9LFxuICAgIC8vIEZ1bGxzY3JlZW4gc2V0dGluZ3NcbiAgICBmdWxsc2NyZWVuOiB7XG4gICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgLy8gQWxsb3cgZnVsbHNjcmVlbj9cbiAgICAgIGZhbGxiYWNrOiB0cnVlLFxuICAgICAgLy8gRmFsbGJhY2sgdXNpbmcgZnVsbCB2aWV3cG9ydC93aW5kb3dcbiAgICAgIGlvc05hdGl2ZTogZmFsc2UgLy8gVXNlIHRoZSBuYXRpdmUgZnVsbHNjcmVlbiBpbiBpT1MgKGRpc2FibGVzIGN1c3RvbSBjb250cm9scylcbiAgICAgIC8vIFNlbGVjdG9yIGZvciB0aGUgZnVsbHNjcmVlbiBjb250YWluZXIgc28gY29udGV4dHVhbCAvIG5vbi1wbGF5ZXIgY29udGVudCBjYW4gcmVtYWluIHZpc2libGUgaW4gZnVsbHNjcmVlbiBtb2RlXG4gICAgICAvLyBOb24tYW5jZXN0b3JzIG9mIHRoZSBwbGF5ZXIgZWxlbWVudCB3aWxsIGJlIGlnbm9yZWRcbiAgICAgIC8vIGNvbnRhaW5lcjogbnVsbCwgLy8gZGVmYXVsdHMgdG8gdGhlIHBsYXllciBlbGVtZW50XG5cbiAgICB9LFxuICAgIC8vIExvY2FsIHN0b3JhZ2VcbiAgICBzdG9yYWdlOiB7XG4gICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAga2V5OiAncGx5cidcbiAgICB9LFxuICAgIC8vIERlZmF1bHQgY29udHJvbHNcbiAgICBjb250cm9sczogWydwbGF5LWxhcmdlJywgLy8gJ3Jlc3RhcnQnLFxuICAgIC8vICdyZXdpbmQnLFxuICAgICdwbGF5JywgLy8gJ2Zhc3QtZm9yd2FyZCcsXG4gICAgJ3Byb2dyZXNzJywgJ2N1cnJlbnQtdGltZScsIC8vICdkdXJhdGlvbicsXG4gICAgJ211dGUnLCAndm9sdW1lJywgJ2NhcHRpb25zJywgJ3NldHRpbmdzJywgJ3BpcCcsICdhaXJwbGF5JywgLy8gJ2Rvd25sb2FkJyxcbiAgICAnZnVsbHNjcmVlbiddLFxuICAgIHNldHRpbmdzOiBbJ2NhcHRpb25zJywgJ3F1YWxpdHknLCAnc3BlZWQnXSxcbiAgICAvLyBMb2NhbGlzYXRpb25cbiAgICBpMThuOiB7XG4gICAgICByZXN0YXJ0OiAnUmVzdGFydCcsXG4gICAgICByZXdpbmQ6ICdSZXdpbmQge3NlZWt0aW1lfXMnLFxuICAgICAgcGxheTogJ1BsYXknLFxuICAgICAgcGF1c2U6ICdQYXVzZScsXG4gICAgICBmYXN0Rm9yd2FyZDogJ0ZvcndhcmQge3NlZWt0aW1lfXMnLFxuICAgICAgc2VlazogJ1NlZWsnLFxuICAgICAgc2Vla0xhYmVsOiAne2N1cnJlbnRUaW1lfSBvZiB7ZHVyYXRpb259JyxcbiAgICAgIHBsYXllZDogJ1BsYXllZCcsXG4gICAgICBidWZmZXJlZDogJ0J1ZmZlcmVkJyxcbiAgICAgIGN1cnJlbnRUaW1lOiAnQ3VycmVudCB0aW1lJyxcbiAgICAgIGR1cmF0aW9uOiAnRHVyYXRpb24nLFxuICAgICAgdm9sdW1lOiAnVm9sdW1lJyxcbiAgICAgIG11dGU6ICdNdXRlJyxcbiAgICAgIHVubXV0ZTogJ1VubXV0ZScsXG4gICAgICBlbmFibGVDYXB0aW9uczogJ0VuYWJsZSBjYXB0aW9ucycsXG4gICAgICBkaXNhYmxlQ2FwdGlvbnM6ICdEaXNhYmxlIGNhcHRpb25zJyxcbiAgICAgIGRvd25sb2FkOiAnRG93bmxvYWQnLFxuICAgICAgZW50ZXJGdWxsc2NyZWVuOiAnRW50ZXIgZnVsbHNjcmVlbicsXG4gICAgICBleGl0RnVsbHNjcmVlbjogJ0V4aXQgZnVsbHNjcmVlbicsXG4gICAgICBmcmFtZVRpdGxlOiAnUGxheWVyIGZvciB7dGl0bGV9JyxcbiAgICAgIGNhcHRpb25zOiAnQ2FwdGlvbnMnLFxuICAgICAgc2V0dGluZ3M6ICdTZXR0aW5ncycsXG4gICAgICBwaXA6ICdQSVAnLFxuICAgICAgbWVudUJhY2s6ICdHbyBiYWNrIHRvIHByZXZpb3VzIG1lbnUnLFxuICAgICAgc3BlZWQ6ICdTcGVlZCcsXG4gICAgICBub3JtYWw6ICdOb3JtYWwnLFxuICAgICAgcXVhbGl0eTogJ1F1YWxpdHknLFxuICAgICAgbG9vcDogJ0xvb3AnLFxuICAgICAgc3RhcnQ6ICdTdGFydCcsXG4gICAgICBlbmQ6ICdFbmQnLFxuICAgICAgYWxsOiAnQWxsJyxcbiAgICAgIHJlc2V0OiAnUmVzZXQnLFxuICAgICAgZGlzYWJsZWQ6ICdEaXNhYmxlZCcsXG4gICAgICBlbmFibGVkOiAnRW5hYmxlZCcsXG4gICAgICBhZHZlcnRpc2VtZW50OiAnQWQnLFxuICAgICAgcXVhbGl0eUJhZGdlOiB7XG4gICAgICAgIDIxNjA6ICc0SycsXG4gICAgICAgIDE0NDA6ICdIRCcsXG4gICAgICAgIDEwODA6ICdIRCcsXG4gICAgICAgIDcyMDogJ0hEJyxcbiAgICAgICAgNTc2OiAnU0QnLFxuICAgICAgICA0ODA6ICdTRCdcbiAgICAgIH1cbiAgICB9LFxuICAgIC8vIFVSTHNcbiAgICB1cmxzOiB7XG4gICAgICBkb3dubG9hZDogbnVsbCxcbiAgICAgIHZpbWVvOiB7XG4gICAgICAgIHNkazogJ2h0dHBzOi8vcGxheWVyLnZpbWVvLmNvbS9hcGkvcGxheWVyLmpzJyxcbiAgICAgICAgaWZyYW1lOiAnaHR0cHM6Ly9wbGF5ZXIudmltZW8uY29tL3ZpZGVvL3swfT97MX0nLFxuICAgICAgICBhcGk6ICdodHRwczovL3ZpbWVvLmNvbS9hcGkvb2VtYmVkLmpzb24/dXJsPXswfSdcbiAgICAgIH0sXG4gICAgICB5b3V0dWJlOiB7XG4gICAgICAgIHNkazogJ2h0dHBzOi8vd3d3LnlvdXR1YmUuY29tL2lmcmFtZV9hcGknLFxuICAgICAgICBhcGk6ICdodHRwczovL25vZW1iZWQuY29tL2VtYmVkP3VybD1odHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PXswfSdcbiAgICAgIH0sXG4gICAgICBnb29nbGVJTUE6IHtcbiAgICAgICAgc2RrOiAnaHR0cHM6Ly9pbWFzZGsuZ29vZ2xlYXBpcy5jb20vanMvc2RrbG9hZGVyL2ltYTMuanMnXG4gICAgICB9XG4gICAgfSxcbiAgICAvLyBDdXN0b20gY29udHJvbCBsaXN0ZW5lcnNcbiAgICBsaXN0ZW5lcnM6IHtcbiAgICAgIHNlZWs6IG51bGwsXG4gICAgICBwbGF5OiBudWxsLFxuICAgICAgcGF1c2U6IG51bGwsXG4gICAgICByZXN0YXJ0OiBudWxsLFxuICAgICAgcmV3aW5kOiBudWxsLFxuICAgICAgZmFzdEZvcndhcmQ6IG51bGwsXG4gICAgICBtdXRlOiBudWxsLFxuICAgICAgdm9sdW1lOiBudWxsLFxuICAgICAgY2FwdGlvbnM6IG51bGwsXG4gICAgICBkb3dubG9hZDogbnVsbCxcbiAgICAgIGZ1bGxzY3JlZW46IG51bGwsXG4gICAgICBwaXA6IG51bGwsXG4gICAgICBhaXJwbGF5OiBudWxsLFxuICAgICAgc3BlZWQ6IG51bGwsXG4gICAgICBxdWFsaXR5OiBudWxsLFxuICAgICAgbG9vcDogbnVsbCxcbiAgICAgIGxhbmd1YWdlOiBudWxsXG4gICAgfSxcbiAgICAvLyBFdmVudHMgdG8gd2F0Y2ggYW5kIGJ1YmJsZVxuICAgIGV2ZW50czogWy8vIEV2ZW50cyB0byB3YXRjaCBvbiBIVE1MNSBtZWRpYSBlbGVtZW50cyBhbmQgYnViYmxlXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vZG9jcy9XZWIvR3VpZGUvRXZlbnRzL01lZGlhX2V2ZW50c1xuICAgICdlbmRlZCcsICdwcm9ncmVzcycsICdzdGFsbGVkJywgJ3BsYXlpbmcnLCAnd2FpdGluZycsICdjYW5wbGF5JywgJ2NhbnBsYXl0aHJvdWdoJywgJ2xvYWRzdGFydCcsICdsb2FkZWRkYXRhJywgJ2xvYWRlZG1ldGFkYXRhJywgJ3RpbWV1cGRhdGUnLCAndm9sdW1lY2hhbmdlJywgJ3BsYXknLCAncGF1c2UnLCAnZXJyb3InLCAnc2Vla2luZycsICdzZWVrZWQnLCAnZW1wdGllZCcsICdyYXRlY2hhbmdlJywgJ2N1ZWNoYW5nZScsIC8vIEN1c3RvbSBldmVudHNcbiAgICAnZG93bmxvYWQnLCAnZW50ZXJmdWxsc2NyZWVuJywgJ2V4aXRmdWxsc2NyZWVuJywgJ2NhcHRpb25zZW5hYmxlZCcsICdjYXB0aW9uc2Rpc2FibGVkJywgJ2xhbmd1YWdlY2hhbmdlJywgJ2NvbnRyb2xzaGlkZGVuJywgJ2NvbnRyb2xzc2hvd24nLCAncmVhZHknLCAvLyBZb3VUdWJlXG4gICAgJ3N0YXRlY2hhbmdlJywgLy8gUXVhbGl0eVxuICAgICdxdWFsaXR5Y2hhbmdlJywgLy8gQWRzXG4gICAgJ2Fkc2xvYWRlZCcsICdhZHNjb250ZW50cGF1c2UnLCAnYWRzY29udGVudHJlc3VtZScsICdhZHN0YXJ0ZWQnLCAnYWRzbWlkcG9pbnQnLCAnYWRzY29tcGxldGUnLCAnYWRzYWxsY29tcGxldGUnLCAnYWRzaW1wcmVzc2lvbicsICdhZHNjbGljayddLFxuICAgIC8vIFNlbGVjdG9yc1xuICAgIC8vIENoYW5nZSB0aGVzZSB0byBtYXRjaCB5b3VyIHRlbXBsYXRlIGlmIHVzaW5nIGN1c3RvbSBIVE1MXG4gICAgc2VsZWN0b3JzOiB7XG4gICAgICBlZGl0YWJsZTogJ2lucHV0LCB0ZXh0YXJlYSwgc2VsZWN0LCBbY29udGVudGVkaXRhYmxlXScsXG4gICAgICBjb250YWluZXI6ICcucGx5cicsXG4gICAgICBjb250cm9sczoge1xuICAgICAgICBjb250YWluZXI6IG51bGwsXG4gICAgICAgIHdyYXBwZXI6ICcucGx5cl9fY29udHJvbHMnXG4gICAgICB9LFxuICAgICAgbGFiZWxzOiAnW2RhdGEtcGx5cl0nLFxuICAgICAgYnV0dG9uczoge1xuICAgICAgICBwbGF5OiAnW2RhdGEtcGx5cj1cInBsYXlcIl0nLFxuICAgICAgICBwYXVzZTogJ1tkYXRhLXBseXI9XCJwYXVzZVwiXScsXG4gICAgICAgIHJlc3RhcnQ6ICdbZGF0YS1wbHlyPVwicmVzdGFydFwiXScsXG4gICAgICAgIHJld2luZDogJ1tkYXRhLXBseXI9XCJyZXdpbmRcIl0nLFxuICAgICAgICBmYXN0Rm9yd2FyZDogJ1tkYXRhLXBseXI9XCJmYXN0LWZvcndhcmRcIl0nLFxuICAgICAgICBtdXRlOiAnW2RhdGEtcGx5cj1cIm11dGVcIl0nLFxuICAgICAgICBjYXB0aW9uczogJ1tkYXRhLXBseXI9XCJjYXB0aW9uc1wiXScsXG4gICAgICAgIGRvd25sb2FkOiAnW2RhdGEtcGx5cj1cImRvd25sb2FkXCJdJyxcbiAgICAgICAgZnVsbHNjcmVlbjogJ1tkYXRhLXBseXI9XCJmdWxsc2NyZWVuXCJdJyxcbiAgICAgICAgcGlwOiAnW2RhdGEtcGx5cj1cInBpcFwiXScsXG4gICAgICAgIGFpcnBsYXk6ICdbZGF0YS1wbHlyPVwiYWlycGxheVwiXScsXG4gICAgICAgIHNldHRpbmdzOiAnW2RhdGEtcGx5cj1cInNldHRpbmdzXCJdJyxcbiAgICAgICAgbG9vcDogJ1tkYXRhLXBseXI9XCJsb29wXCJdJ1xuICAgICAgfSxcbiAgICAgIGlucHV0czoge1xuICAgICAgICBzZWVrOiAnW2RhdGEtcGx5cj1cInNlZWtcIl0nLFxuICAgICAgICB2b2x1bWU6ICdbZGF0YS1wbHlyPVwidm9sdW1lXCJdJyxcbiAgICAgICAgc3BlZWQ6ICdbZGF0YS1wbHlyPVwic3BlZWRcIl0nLFxuICAgICAgICBsYW5ndWFnZTogJ1tkYXRhLXBseXI9XCJsYW5ndWFnZVwiXScsXG4gICAgICAgIHF1YWxpdHk6ICdbZGF0YS1wbHlyPVwicXVhbGl0eVwiXSdcbiAgICAgIH0sXG4gICAgICBkaXNwbGF5OiB7XG4gICAgICAgIGN1cnJlbnRUaW1lOiAnLnBseXJfX3RpbWUtLWN1cnJlbnQnLFxuICAgICAgICBkdXJhdGlvbjogJy5wbHlyX190aW1lLS1kdXJhdGlvbicsXG4gICAgICAgIGJ1ZmZlcjogJy5wbHlyX19wcm9ncmVzc19fYnVmZmVyJyxcbiAgICAgICAgbG9vcDogJy5wbHlyX19wcm9ncmVzc19fbG9vcCcsXG4gICAgICAgIC8vIFVzZWQgbGF0ZXJcbiAgICAgICAgdm9sdW1lOiAnLnBseXJfX3ZvbHVtZS0tZGlzcGxheSdcbiAgICAgIH0sXG4gICAgICBwcm9ncmVzczogJy5wbHlyX19wcm9ncmVzcycsXG4gICAgICBjYXB0aW9uczogJy5wbHlyX19jYXB0aW9ucycsXG4gICAgICBjYXB0aW9uOiAnLnBseXJfX2NhcHRpb24nXG4gICAgfSxcbiAgICAvLyBDbGFzcyBob29rcyBhZGRlZCB0byB0aGUgcGxheWVyIGluIGRpZmZlcmVudCBzdGF0ZXNcbiAgICBjbGFzc05hbWVzOiB7XG4gICAgICB0eXBlOiAncGx5ci0tezB9JyxcbiAgICAgIHByb3ZpZGVyOiAncGx5ci0tezB9JyxcbiAgICAgIHZpZGVvOiAncGx5cl9fdmlkZW8td3JhcHBlcicsXG4gICAgICBlbWJlZDogJ3BseXJfX3ZpZGVvLWVtYmVkJyxcbiAgICAgIHZpZGVvRml4ZWRSYXRpbzogJ3BseXJfX3ZpZGVvLXdyYXBwZXItLWZpeGVkLXJhdGlvJyxcbiAgICAgIGVtYmVkQ29udGFpbmVyOiAncGx5cl9fdmlkZW8tZW1iZWRfX2NvbnRhaW5lcicsXG4gICAgICBwb3N0ZXI6ICdwbHlyX19wb3N0ZXInLFxuICAgICAgcG9zdGVyRW5hYmxlZDogJ3BseXJfX3Bvc3Rlci1lbmFibGVkJyxcbiAgICAgIGFkczogJ3BseXJfX2FkcycsXG4gICAgICBjb250cm9sOiAncGx5cl9fY29udHJvbCcsXG4gICAgICBjb250cm9sUHJlc3NlZDogJ3BseXJfX2NvbnRyb2wtLXByZXNzZWQnLFxuICAgICAgcGxheWluZzogJ3BseXItLXBsYXlpbmcnLFxuICAgICAgcGF1c2VkOiAncGx5ci0tcGF1c2VkJyxcbiAgICAgIHN0b3BwZWQ6ICdwbHlyLS1zdG9wcGVkJyxcbiAgICAgIGxvYWRpbmc6ICdwbHlyLS1sb2FkaW5nJyxcbiAgICAgIGhvdmVyOiAncGx5ci0taG92ZXInLFxuICAgICAgdG9vbHRpcDogJ3BseXJfX3Rvb2x0aXAnLFxuICAgICAgY3VlczogJ3BseXJfX2N1ZXMnLFxuICAgICAgbWFya2VyOiAncGx5cl9fcHJvZ3Jlc3NfX21hcmtlcicsXG4gICAgICBoaWRkZW46ICdwbHlyX19zci1vbmx5JyxcbiAgICAgIGhpZGVDb250cm9sczogJ3BseXItLWhpZGUtY29udHJvbHMnLFxuICAgICAgaXNJb3M6ICdwbHlyLS1pcy1pb3MnLFxuICAgICAgaXNUb3VjaDogJ3BseXItLWlzLXRvdWNoJyxcbiAgICAgIHVpU3VwcG9ydGVkOiAncGx5ci0tZnVsbC11aScsXG4gICAgICBub1RyYW5zaXRpb246ICdwbHlyLS1uby10cmFuc2l0aW9uJyxcbiAgICAgIGRpc3BsYXk6IHtcbiAgICAgICAgdGltZTogJ3BseXJfX3RpbWUnXG4gICAgICB9LFxuICAgICAgbWVudToge1xuICAgICAgICB2YWx1ZTogJ3BseXJfX21lbnVfX3ZhbHVlJyxcbiAgICAgICAgYmFkZ2U6ICdwbHlyX19iYWRnZScsXG4gICAgICAgIG9wZW46ICdwbHlyLS1tZW51LW9wZW4nXG4gICAgICB9LFxuICAgICAgY2FwdGlvbnM6IHtcbiAgICAgICAgZW5hYmxlZDogJ3BseXItLWNhcHRpb25zLWVuYWJsZWQnLFxuICAgICAgICBhY3RpdmU6ICdwbHlyLS1jYXB0aW9ucy1hY3RpdmUnXG4gICAgICB9LFxuICAgICAgZnVsbHNjcmVlbjoge1xuICAgICAgICBlbmFibGVkOiAncGx5ci0tZnVsbHNjcmVlbi1lbmFibGVkJyxcbiAgICAgICAgZmFsbGJhY2s6ICdwbHlyLS1mdWxsc2NyZWVuLWZhbGxiYWNrJ1xuICAgICAgfSxcbiAgICAgIHBpcDoge1xuICAgICAgICBzdXBwb3J0ZWQ6ICdwbHlyLS1waXAtc3VwcG9ydGVkJyxcbiAgICAgICAgYWN0aXZlOiAncGx5ci0tcGlwLWFjdGl2ZSdcbiAgICAgIH0sXG4gICAgICBhaXJwbGF5OiB7XG4gICAgICAgIHN1cHBvcnRlZDogJ3BseXItLWFpcnBsYXktc3VwcG9ydGVkJyxcbiAgICAgICAgYWN0aXZlOiAncGx5ci0tYWlycGxheS1hY3RpdmUnXG4gICAgICB9LFxuICAgICAgdGFiRm9jdXM6ICdwbHlyX190YWItZm9jdXMnLFxuICAgICAgcHJldmlld1RodW1ibmFpbHM6IHtcbiAgICAgICAgLy8gVG9vbHRpcCB0aHVtYnNcbiAgICAgICAgdGh1bWJDb250YWluZXI6ICdwbHlyX19wcmV2aWV3LXRodW1iJyxcbiAgICAgICAgdGh1bWJDb250YWluZXJTaG93bjogJ3BseXJfX3ByZXZpZXctdGh1bWItLWlzLXNob3duJyxcbiAgICAgICAgaW1hZ2VDb250YWluZXI6ICdwbHlyX19wcmV2aWV3LXRodW1iX19pbWFnZS1jb250YWluZXInLFxuICAgICAgICB0aW1lQ29udGFpbmVyOiAncGx5cl9fcHJldmlldy10aHVtYl9fdGltZS1jb250YWluZXInLFxuICAgICAgICAvLyBTY3J1YmJpbmdcbiAgICAgICAgc2NydWJiaW5nQ29udGFpbmVyOiAncGx5cl9fcHJldmlldy1zY3J1YmJpbmcnLFxuICAgICAgICBzY3J1YmJpbmdDb250YWluZXJTaG93bjogJ3BseXJfX3ByZXZpZXctc2NydWJiaW5nLS1pcy1zaG93bidcbiAgICAgIH1cbiAgICB9LFxuICAgIC8vIEVtYmVkIGF0dHJpYnV0ZXNcbiAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICBlbWJlZDoge1xuICAgICAgICBwcm92aWRlcjogJ2RhdGEtcGx5ci1wcm92aWRlcicsXG4gICAgICAgIGlkOiAnZGF0YS1wbHlyLWVtYmVkLWlkJyxcbiAgICAgICAgaGFzaDogJ2RhdGEtcGx5ci1lbWJlZC1oYXNoJ1xuICAgICAgfVxuICAgIH0sXG4gICAgLy8gQWR2ZXJ0aXNlbWVudHMgcGx1Z2luXG4gICAgLy8gUmVnaXN0ZXIgZm9yIGFuIGFjY291bnQgaGVyZTogaHR0cDovL3ZpLmFpL3B1Ymxpc2hlci12aWRlby1tb25ldGl6YXRpb24vP2FpZD1wbHlyaW9cbiAgICBhZHM6IHtcbiAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgcHVibGlzaGVySWQ6ICcnLFxuICAgICAgdGFnVXJsOiAnJ1xuICAgIH0sXG4gICAgLy8gUHJldmlldyBUaHVtYm5haWxzIHBsdWdpblxuICAgIHByZXZpZXdUaHVtYm5haWxzOiB7XG4gICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgIHNyYzogJydcbiAgICB9LFxuICAgIC8vIFZpbWVvIHBsdWdpblxuICAgIHZpbWVvOiB7XG4gICAgICBieWxpbmU6IGZhbHNlLFxuICAgICAgcG9ydHJhaXQ6IGZhbHNlLFxuICAgICAgdGl0bGU6IGZhbHNlLFxuICAgICAgc3BlZWQ6IHRydWUsXG4gICAgICB0cmFuc3BhcmVudDogZmFsc2UsXG4gICAgICAvLyBDdXN0b20gc2V0dGluZ3MgZnJvbSBQbHlyXG4gICAgICBjdXN0b21Db250cm9sczogdHJ1ZSxcbiAgICAgIHJlZmVycmVyUG9saWN5OiBudWxsLFxuICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0hUTUxJRnJhbWVFbGVtZW50L3JlZmVycmVyUG9saWN5XG4gICAgICAvLyBXaGV0aGVyIHRoZSBvd25lciBvZiB0aGUgdmlkZW8gaGFzIGEgUHJvIG9yIEJ1c2luZXNzIGFjY291bnRcbiAgICAgIC8vICh3aGljaCBhbGxvd3MgdXMgdG8gcHJvcGVybHkgaGlkZSBjb250cm9scyB3aXRob3V0IENTUyBoYWNrcywgZXRjKVxuICAgICAgcHJlbWl1bTogZmFsc2VcbiAgICB9LFxuICAgIC8vIFlvdVR1YmUgcGx1Z2luXG4gICAgeW91dHViZToge1xuICAgICAgcmVsOiAwLFxuICAgICAgLy8gTm8gcmVsYXRlZCB2aWRzXG4gICAgICBzaG93aW5mbzogMCxcbiAgICAgIC8vIEhpZGUgaW5mb1xuICAgICAgaXZfbG9hZF9wb2xpY3k6IDMsXG4gICAgICAvLyBIaWRlIGFubm90YXRpb25zXG4gICAgICBtb2Rlc3RicmFuZGluZzogMSxcbiAgICAgIC8vIEhpZGUgbG9nb3MgYXMgbXVjaCBhcyBwb3NzaWJsZSAodGhleSBzdGlsbCBzaG93IG9uZSBpbiB0aGUgY29ybmVyIHdoZW4gcGF1c2VkKVxuICAgICAgLy8gQ3VzdG9tIHNldHRpbmdzIGZyb20gUGx5clxuICAgICAgY3VzdG9tQ29udHJvbHM6IHRydWUsXG4gICAgICBub0Nvb2tpZTogZmFsc2UgLy8gV2hldGhlciB0byB1c2UgYW4gYWx0ZXJuYXRpdmUgdmVyc2lvbiBvZiBZb3VUdWJlIHdpdGhvdXQgY29va2llc1xuXG4gICAgfSxcbiAgICAvLyBNZWRpYSBNZXRhZGF0YVxuICAgIG1lZGlhTWV0YWRhdGE6IHtcbiAgICAgIHRpdGxlOiAnJyxcbiAgICAgIGFydGlzdDogJycsXG4gICAgICBhbGJ1bTogJycsXG4gICAgICBhcnR3b3JrOiBbXVxuICAgIH0sXG4gICAgLy8gTWFya2Vyc1xuICAgIG1hcmtlcnM6IHtcbiAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgcG9pbnRzOiBbXVxuICAgIH1cbiAgfTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBQbHlyIHN0YXRlc1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBwaXAgPSB7XG4gICAgYWN0aXZlOiAncGljdHVyZS1pbi1waWN0dXJlJyxcbiAgICBpbmFjdGl2ZTogJ2lubGluZSdcbiAgfTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBQbHlyIHN1cHBvcnRlZCB0eXBlcyBhbmQgcHJvdmlkZXJzXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IHByb3ZpZGVycyA9IHtcbiAgICBodG1sNTogJ2h0bWw1JyxcbiAgICB5b3V0dWJlOiAneW91dHViZScsXG4gICAgdmltZW86ICd2aW1lbydcbiAgfTtcbiAgY29uc3QgdHlwZXMgPSB7XG4gICAgYXVkaW86ICdhdWRpbycsXG4gICAgdmlkZW86ICd2aWRlbydcbiAgfTtcbiAgLyoqXG4gICAqIEdldCBwcm92aWRlciBieSBVUkxcbiAgICogQHBhcmFtIHtTdHJpbmd9IHVybFxuICAgKi9cblxuICBmdW5jdGlvbiBnZXRQcm92aWRlckJ5VXJsKHVybCkge1xuICAgIC8vIFlvdVR1YmVcbiAgICBpZiAoL14oaHR0cHM/OlxcL1xcLyk/KHd3d1xcLik/KHlvdXR1YmVcXC5jb218eW91dHViZS1ub2Nvb2tpZVxcLmNvbXx5b3V0dVxcLj9iZSlcXC8uKyQvLnRlc3QodXJsKSkge1xuICAgICAgcmV0dXJuIHByb3ZpZGVycy55b3V0dWJlO1xuICAgIH0gLy8gVmltZW9cblxuXG4gICAgaWYgKC9eaHR0cHM/OlxcL1xcL3BsYXllci52aW1lby5jb21cXC92aWRlb1xcL1xcZHswLDl9KD89XFxifFxcLykvLnRlc3QodXJsKSkge1xuICAgICAgcmV0dXJuIHByb3ZpZGVycy52aW1lbztcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIENvbnNvbGUgd3JhcHBlclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBub29wID0gKCkgPT4ge307XG5cbiAgY2xhc3MgQ29uc29sZSB7XG4gICAgY29uc3RydWN0b3IoZW5hYmxlZCA9IGZhbHNlKSB7XG4gICAgICB0aGlzLmVuYWJsZWQgPSB3aW5kb3cuY29uc29sZSAmJiBlbmFibGVkO1xuXG4gICAgICBpZiAodGhpcy5lbmFibGVkKSB7XG4gICAgICAgIHRoaXMubG9nKCdEZWJ1Z2dpbmcgZW5hYmxlZCcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGdldCBsb2coKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgcmV0dXJuIHRoaXMuZW5hYmxlZCA/IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwoY29uc29sZS5sb2csIGNvbnNvbGUpIDogbm9vcDtcbiAgICB9XG5cbiAgICBnZXQgd2FybigpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICByZXR1cm4gdGhpcy5lbmFibGVkID8gRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQuY2FsbChjb25zb2xlLndhcm4sIGNvbnNvbGUpIDogbm9vcDtcbiAgICB9XG5cbiAgICBnZXQgZXJyb3IoKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgcmV0dXJuIHRoaXMuZW5hYmxlZCA/IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwoY29uc29sZS5lcnJvciwgY29uc29sZSkgOiBub29wO1xuICAgIH1cblxuICB9XG5cbiAgY2xhc3MgRnVsbHNjcmVlbiB7XG4gICAgY29uc3RydWN0b3IocGxheWVyKSB7XG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcIm9uQ2hhbmdlXCIsICgpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gLy8gVXBkYXRlIHRvZ2dsZSBidXR0b25cblxuXG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMucGxheWVyLmVsZW1lbnRzLmJ1dHRvbnMuZnVsbHNjcmVlbjtcblxuICAgICAgICBpZiAoaXMuZWxlbWVudChidXR0b24pKSB7XG4gICAgICAgICAgYnV0dG9uLnByZXNzZWQgPSB0aGlzLmFjdGl2ZTtcbiAgICAgICAgfSAvLyBBbHdheXMgdHJpZ2dlciBldmVudHMgb24gdGhlIHBseXIgLyBtZWRpYSBlbGVtZW50IChub3QgYSBmdWxsc2NyZWVuIGNvbnRhaW5lcikgYW5kIGxldCB0aGVtIGJ1YmJsZSB1cFxuXG5cbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy50YXJnZXQgPT09IHRoaXMucGxheWVyLm1lZGlhID8gdGhpcy50YXJnZXQgOiB0aGlzLnBsYXllci5lbGVtZW50cy5jb250YWluZXI7IC8vIFRyaWdnZXIgYW4gZXZlbnRcblxuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbCh0aGlzLnBsYXllciwgdGFyZ2V0LCB0aGlzLmFjdGl2ZSA/ICdlbnRlcmZ1bGxzY3JlZW4nIDogJ2V4aXRmdWxsc2NyZWVuJywgdHJ1ZSk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJ0b2dnbGVGYWxsYmFja1wiLCAodG9nZ2xlID0gZmFsc2UpID0+IHtcbiAgICAgICAgLy8gU3RvcmUgb3IgcmVzdG9yZSBzY3JvbGwgcG9zaXRpb25cbiAgICAgICAgaWYgKHRvZ2dsZSkge1xuICAgICAgICAgIHRoaXMuc2Nyb2xsUG9zaXRpb24gPSB7XG4gICAgICAgICAgICB4OiB3aW5kb3cuc2Nyb2xsWCB8fCAwLFxuICAgICAgICAgICAgeTogd2luZG93LnNjcm9sbFkgfHwgMFxuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgd2luZG93LnNjcm9sbFRvKHRoaXMuc2Nyb2xsUG9zaXRpb24ueCwgdGhpcy5zY3JvbGxQb3NpdGlvbi55KTtcbiAgICAgICAgfSAvLyBUb2dnbGUgc2Nyb2xsXG5cblxuICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gdG9nZ2xlID8gJ2hpZGRlbicgOiAnJzsgLy8gVG9nZ2xlIGNsYXNzIGhvb2tcblxuICAgICAgICB0b2dnbGVDbGFzcyh0aGlzLnRhcmdldCwgdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMuZnVsbHNjcmVlbi5mYWxsYmFjaywgdG9nZ2xlKTsgLy8gRm9yY2UgZnVsbCB2aWV3cG9ydCBvbiBpUGhvbmUgWCtcblxuICAgICAgICBpZiAoYnJvd3Nlci5pc0lvcykge1xuICAgICAgICAgIGxldCB2aWV3cG9ydCA9IGRvY3VtZW50LmhlYWQucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPVwidmlld3BvcnRcIl0nKTtcbiAgICAgICAgICBjb25zdCBwcm9wZXJ0eSA9ICd2aWV3cG9ydC1maXQ9Y292ZXInOyAvLyBJbmplY3QgdGhlIHZpZXdwb3J0IG1ldGEgaWYgcmVxdWlyZWRcblxuICAgICAgICAgIGlmICghdmlld3BvcnQpIHtcbiAgICAgICAgICAgIHZpZXdwb3J0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWV0YScpO1xuICAgICAgICAgICAgdmlld3BvcnQuc2V0QXR0cmlidXRlKCduYW1lJywgJ3ZpZXdwb3J0Jyk7XG4gICAgICAgICAgfSAvLyBDaGVjayBpZiB0aGUgcHJvcGVydHkgYWxyZWFkeSBleGlzdHNcblxuXG4gICAgICAgICAgY29uc3QgaGFzUHJvcGVydHkgPSBpcy5zdHJpbmcodmlld3BvcnQuY29udGVudCkgJiYgdmlld3BvcnQuY29udGVudC5pbmNsdWRlcyhwcm9wZXJ0eSk7XG5cbiAgICAgICAgICBpZiAodG9nZ2xlKSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXBWaWV3cG9ydCA9ICFoYXNQcm9wZXJ0eTtcblxuICAgICAgICAgICAgaWYgKCFoYXNQcm9wZXJ0eSkge1xuICAgICAgICAgICAgICB2aWV3cG9ydC5jb250ZW50ICs9IGAsJHtwcm9wZXJ0eX1gO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5jbGVhbnVwVmlld3BvcnQpIHtcbiAgICAgICAgICAgIHZpZXdwb3J0LmNvbnRlbnQgPSB2aWV3cG9ydC5jb250ZW50LnNwbGl0KCcsJykuZmlsdGVyKHBhcnQgPT4gcGFydC50cmltKCkgIT09IHByb3BlcnR5KS5qb2luKCcsJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IC8vIFRvZ2dsZSBidXR0b24gYW5kIGZpcmUgZXZlbnRzXG5cblxuICAgICAgICB0aGlzLm9uQ2hhbmdlKCk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJ0cmFwRm9jdXNcIiwgZXZlbnQgPT4ge1xuICAgICAgICAvLyBCYWlsIGlmIGlPUywgbm90IGFjdGl2ZSwgbm90IHRoZSB0YWIga2V5XG4gICAgICAgIGlmIChicm93c2VyLmlzSW9zIHx8ICF0aGlzLmFjdGl2ZSB8fCBldmVudC5rZXkgIT09ICdUYWInKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIEdldCB0aGUgY3VycmVudCBmb2N1c2VkIGVsZW1lbnRcblxuXG4gICAgICAgIGNvbnN0IGZvY3VzZWQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgICAgICBjb25zdCBmb2N1c2FibGUgPSBnZXRFbGVtZW50cy5jYWxsKHRoaXMucGxheWVyLCAnYVtocmVmXSwgYnV0dG9uOm5vdCg6ZGlzYWJsZWQpLCBpbnB1dDpub3QoOmRpc2FibGVkKSwgW3RhYmluZGV4XScpO1xuICAgICAgICBjb25zdCBbZmlyc3RdID0gZm9jdXNhYmxlO1xuICAgICAgICBjb25zdCBsYXN0ID0gZm9jdXNhYmxlW2ZvY3VzYWJsZS5sZW5ndGggLSAxXTtcblxuICAgICAgICBpZiAoZm9jdXNlZCA9PT0gbGFzdCAmJiAhZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgICAgICAvLyBNb3ZlIGZvY3VzIHRvIGZpcnN0IGVsZW1lbnQgdGhhdCBjYW4gYmUgdGFiYmVkIGlmIFNoaWZ0IGlzbid0IHVzZWRcbiAgICAgICAgICBmaXJzdC5mb2N1cygpO1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZm9jdXNlZCA9PT0gZmlyc3QgJiYgZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgICAgICAvLyBNb3ZlIGZvY3VzIHRvIGxhc3QgZWxlbWVudCB0aGF0IGNhbiBiZSB0YWJiZWQgaWYgU2hpZnQgaXMgdXNlZFxuICAgICAgICAgIGxhc3QuZm9jdXMoKTtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJ1cGRhdGVcIiwgKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5lbmFibGVkKSB7XG4gICAgICAgICAgbGV0IG1vZGU7XG5cbiAgICAgICAgICBpZiAodGhpcy5mb3JjZUZhbGxiYWNrKSB7XG4gICAgICAgICAgICBtb2RlID0gJ0ZhbGxiYWNrIChmb3JjZWQpJztcbiAgICAgICAgICB9IGVsc2UgaWYgKEZ1bGxzY3JlZW4ubmF0aXZlKSB7XG4gICAgICAgICAgICBtb2RlID0gJ05hdGl2ZSc7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1vZGUgPSAnRmFsbGJhY2snO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZyhgJHttb2RlfSBmdWxsc2NyZWVuIGVuYWJsZWRgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coJ0Z1bGxzY3JlZW4gbm90IHN1cHBvcnRlZCBhbmQgZmFsbGJhY2sgZGlzYWJsZWQnKTtcbiAgICAgICAgfSAvLyBBZGQgc3R5bGluZyBob29rIHRvIHNob3cgYnV0dG9uXG5cblxuICAgICAgICB0b2dnbGVDbGFzcyh0aGlzLnBsYXllci5lbGVtZW50cy5jb250YWluZXIsIHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLmZ1bGxzY3JlZW4uZW5hYmxlZCwgdGhpcy5lbmFibGVkKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImVudGVyXCIsICgpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gLy8gaU9TIG5hdGl2ZSBmdWxsc2NyZWVuIGRvZXNuJ3QgbmVlZCB0aGUgcmVxdWVzdCBzdGVwXG5cblxuICAgICAgICBpZiAoYnJvd3Nlci5pc0lvcyAmJiB0aGlzLnBsYXllci5jb25maWcuZnVsbHNjcmVlbi5pb3NOYXRpdmUpIHtcbiAgICAgICAgICBpZiAodGhpcy5wbGF5ZXIuaXNWaW1lbykge1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZW1iZWQucmVxdWVzdEZ1bGxzY3JlZW4oKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50YXJnZXQud2Via2l0RW50ZXJGdWxsc2NyZWVuKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKCFGdWxsc2NyZWVuLm5hdGl2ZSB8fCB0aGlzLmZvcmNlRmFsbGJhY2spIHtcbiAgICAgICAgICB0aGlzLnRvZ2dsZUZhbGxiYWNrKHRydWUpO1xuICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLnByZWZpeCkge1xuICAgICAgICAgIHRoaXMudGFyZ2V0LnJlcXVlc3RGdWxsc2NyZWVuKHtcbiAgICAgICAgICAgIG5hdmlnYXRpb25VSTogJ2hpZGUnXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoIWlzLmVtcHR5KHRoaXMucHJlZml4KSkge1xuICAgICAgICAgIHRoaXMudGFyZ2V0W2Ake3RoaXMucHJlZml4fVJlcXVlc3Qke3RoaXMucHJvcGVydHl9YF0oKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiZXhpdFwiLCAoKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIGlPUyBuYXRpdmUgZnVsbHNjcmVlblxuXG5cbiAgICAgICAgaWYgKGJyb3dzZXIuaXNJb3MgJiYgdGhpcy5wbGF5ZXIuY29uZmlnLmZ1bGxzY3JlZW4uaW9zTmF0aXZlKSB7XG4gICAgICAgICAgdGhpcy50YXJnZXQud2Via2l0RXhpdEZ1bGxzY3JlZW4oKTtcbiAgICAgICAgICBzaWxlbmNlUHJvbWlzZSh0aGlzLnBsYXllci5wbGF5KCkpO1xuICAgICAgICB9IGVsc2UgaWYgKCFGdWxsc2NyZWVuLm5hdGl2ZSB8fCB0aGlzLmZvcmNlRmFsbGJhY2spIHtcbiAgICAgICAgICB0aGlzLnRvZ2dsZUZhbGxiYWNrKGZhbHNlKTtcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5wcmVmaXgpIHtcbiAgICAgICAgICAoZG9jdW1lbnQuY2FuY2VsRnVsbFNjcmVlbiB8fCBkb2N1bWVudC5leGl0RnVsbHNjcmVlbikuY2FsbChkb2N1bWVudCk7XG4gICAgICAgIH0gZWxzZSBpZiAoIWlzLmVtcHR5KHRoaXMucHJlZml4KSkge1xuICAgICAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMucHJlZml4ID09PSAnbW96JyA/ICdDYW5jZWwnIDogJ0V4aXQnO1xuICAgICAgICAgIGRvY3VtZW50W2Ake3RoaXMucHJlZml4fSR7YWN0aW9ufSR7dGhpcy5wcm9wZXJ0eX1gXSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJ0b2dnbGVcIiwgKCkgPT4ge1xuICAgICAgICBpZiAoIXRoaXMuYWN0aXZlKSB7XG4gICAgICAgICAgdGhpcy5lbnRlcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuZXhpdCgpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gS2VlcCByZWZlcmVuY2UgdG8gcGFyZW50XG4gICAgICB0aGlzLnBsYXllciA9IHBsYXllcjsgLy8gR2V0IHByZWZpeFxuXG4gICAgICB0aGlzLnByZWZpeCA9IEZ1bGxzY3JlZW4ucHJlZml4O1xuICAgICAgdGhpcy5wcm9wZXJ0eSA9IEZ1bGxzY3JlZW4ucHJvcGVydHk7IC8vIFNjcm9sbCBwb3NpdGlvblxuXG4gICAgICB0aGlzLnNjcm9sbFBvc2l0aW9uID0ge1xuICAgICAgICB4OiAwLFxuICAgICAgICB5OiAwXG4gICAgICB9OyAvLyBGb3JjZSB0aGUgdXNlIG9mICdmdWxsIHdpbmRvdy9icm93c2VyJyByYXRoZXIgdGhhbiBmdWxsc2NyZWVuXG5cbiAgICAgIHRoaXMuZm9yY2VGYWxsYmFjayA9IHBsYXllci5jb25maWcuZnVsbHNjcmVlbi5mYWxsYmFjayA9PT0gJ2ZvcmNlJzsgLy8gR2V0IHRoZSBmdWxsc2NyZWVuIGVsZW1lbnRcbiAgICAgIC8vIENoZWNrcyBjb250YWluZXIgaXMgYW4gYW5jZXN0b3IsIGRlZmF1bHRzIHRvIG51bGxcblxuICAgICAgdGhpcy5wbGF5ZXIuZWxlbWVudHMuZnVsbHNjcmVlbiA9IHBsYXllci5jb25maWcuZnVsbHNjcmVlbi5jb250YWluZXIgJiYgY2xvc2VzdCQxKHRoaXMucGxheWVyLmVsZW1lbnRzLmNvbnRhaW5lciwgcGxheWVyLmNvbmZpZy5mdWxsc2NyZWVuLmNvbnRhaW5lcik7IC8vIFJlZ2lzdGVyIGV2ZW50IGxpc3RlbmVyc1xuICAgICAgLy8gSGFuZGxlIGV2ZW50IChpbmNhc2UgdXNlciBwcmVzc2VzIGVzY2FwZSBldGMpXG5cbiAgICAgIG9uLmNhbGwodGhpcy5wbGF5ZXIsIGRvY3VtZW50LCB0aGlzLnByZWZpeCA9PT0gJ21zJyA/ICdNU0Z1bGxzY3JlZW5DaGFuZ2UnIDogYCR7dGhpcy5wcmVmaXh9ZnVsbHNjcmVlbmNoYW5nZWAsICgpID0+IHtcbiAgICAgICAgLy8gVE9ETzogRmlsdGVyIGZvciB0YXJnZXQ/P1xuICAgICAgICB0aGlzLm9uQ2hhbmdlKCk7XG4gICAgICB9KTsgLy8gRnVsbHNjcmVlbiB0b2dnbGUgb24gZG91YmxlIGNsaWNrXG5cbiAgICAgIG9uLmNhbGwodGhpcy5wbGF5ZXIsIHRoaXMucGxheWVyLmVsZW1lbnRzLmNvbnRhaW5lciwgJ2RibGNsaWNrJywgZXZlbnQgPT4ge1xuICAgICAgICAvLyBJZ25vcmUgZG91YmxlIGNsaWNrIGluIGNvbnRyb2xzXG4gICAgICAgIGlmIChpcy5lbGVtZW50KHRoaXMucGxheWVyLmVsZW1lbnRzLmNvbnRyb2xzKSAmJiB0aGlzLnBsYXllci5lbGVtZW50cy5jb250cm9scy5jb250YWlucyhldmVudC50YXJnZXQpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wbGF5ZXIubGlzdGVuZXJzLnByb3h5KGV2ZW50LCB0aGlzLnRvZ2dsZSwgJ2Z1bGxzY3JlZW4nKTtcbiAgICAgIH0pOyAvLyBUYXAgZm9jdXMgd2hlbiBpbiBmdWxsc2NyZWVuXG5cbiAgICAgIG9uLmNhbGwodGhpcywgdGhpcy5wbGF5ZXIuZWxlbWVudHMuY29udGFpbmVyLCAna2V5ZG93bicsIGV2ZW50ID0+IHRoaXMudHJhcEZvY3VzKGV2ZW50KSk7IC8vIFVwZGF0ZSB0aGUgVUlcblxuICAgICAgdGhpcy51cGRhdGUoKTsgLy8gdGhpcy50b2dnbGUgPSB0aGlzLnRvZ2dsZS5iaW5kKHRoaXMpO1xuICAgIH0gLy8gRGV0ZXJtaW5lIGlmIG5hdGl2ZSBzdXBwb3J0ZWRcblxuXG4gICAgc3RhdGljIGdldCBuYXRpdmUoKSB7XG4gICAgICByZXR1cm4gISEoZG9jdW1lbnQuZnVsbHNjcmVlbkVuYWJsZWQgfHwgZG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVuYWJsZWQgfHwgZG9jdW1lbnQubW96RnVsbFNjcmVlbkVuYWJsZWQgfHwgZG9jdW1lbnQubXNGdWxsc2NyZWVuRW5hYmxlZCk7XG4gICAgfSAvLyBJZiB3ZSdyZSBhY3R1YWxseSB1c2luZyBuYXRpdmVcblxuXG4gICAgZ2V0IHVzaW5nTmF0aXZlKCkge1xuICAgICAgcmV0dXJuIEZ1bGxzY3JlZW4ubmF0aXZlICYmICF0aGlzLmZvcmNlRmFsbGJhY2s7XG4gICAgfSAvLyBHZXQgdGhlIHByZWZpeCBmb3IgaGFuZGxlcnNcblxuXG4gICAgc3RhdGljIGdldCBwcmVmaXgoKSB7XG4gICAgICAvLyBObyBwcmVmaXhcbiAgICAgIGlmIChpcy5mdW5jdGlvbihkb2N1bWVudC5leGl0RnVsbHNjcmVlbikpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfSAvLyBDaGVjayBmb3IgZnVsbHNjcmVlbiBzdXBwb3J0IGJ5IHZlbmRvciBwcmVmaXhcblxuXG4gICAgICBsZXQgdmFsdWUgPSAnJztcbiAgICAgIGNvbnN0IHByZWZpeGVzID0gWyd3ZWJraXQnLCAnbW96JywgJ21zJ107XG4gICAgICBwcmVmaXhlcy5zb21lKHByZSA9PiB7XG4gICAgICAgIGlmIChpcy5mdW5jdGlvbihkb2N1bWVudFtgJHtwcmV9RXhpdEZ1bGxzY3JlZW5gXSkgfHwgaXMuZnVuY3Rpb24oZG9jdW1lbnRbYCR7cHJlfUNhbmNlbEZ1bGxTY3JlZW5gXSkpIHtcbiAgICAgICAgICB2YWx1ZSA9IHByZTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXQgcHJvcGVydHkoKSB7XG4gICAgICByZXR1cm4gdGhpcy5wcmVmaXggPT09ICdtb3onID8gJ0Z1bGxTY3JlZW4nIDogJ0Z1bGxzY3JlZW4nO1xuICAgIH0gLy8gRGV0ZXJtaW5lIGlmIGZ1bGxzY3JlZW4gaXMgZW5hYmxlZFxuXG5cbiAgICBnZXQgZW5hYmxlZCgpIHtcbiAgICAgIHJldHVybiAoRnVsbHNjcmVlbi5uYXRpdmUgfHwgdGhpcy5wbGF5ZXIuY29uZmlnLmZ1bGxzY3JlZW4uZmFsbGJhY2spICYmIHRoaXMucGxheWVyLmNvbmZpZy5mdWxsc2NyZWVuLmVuYWJsZWQgJiYgdGhpcy5wbGF5ZXIuc3VwcG9ydGVkLnVpICYmIHRoaXMucGxheWVyLmlzVmlkZW87XG4gICAgfSAvLyBHZXQgYWN0aXZlIHN0YXRlXG5cblxuICAgIGdldCBhY3RpdmUoKSB7XG4gICAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9IC8vIEZhbGxiYWNrIHVzaW5nIGNsYXNzbmFtZVxuXG5cbiAgICAgIGlmICghRnVsbHNjcmVlbi5uYXRpdmUgfHwgdGhpcy5mb3JjZUZhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBoYXNDbGFzcyh0aGlzLnRhcmdldCwgdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMuZnVsbHNjcmVlbi5mYWxsYmFjayk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGVsZW1lbnQgPSAhdGhpcy5wcmVmaXggPyB0aGlzLnRhcmdldC5nZXRSb290Tm9kZSgpLmZ1bGxzY3JlZW5FbGVtZW50IDogdGhpcy50YXJnZXQuZ2V0Um9vdE5vZGUoKVtgJHt0aGlzLnByZWZpeH0ke3RoaXMucHJvcGVydHl9RWxlbWVudGBdO1xuICAgICAgcmV0dXJuIGVsZW1lbnQgJiYgZWxlbWVudC5zaGFkb3dSb290ID8gZWxlbWVudCA9PT0gdGhpcy50YXJnZXQuZ2V0Um9vdE5vZGUoKS5ob3N0IDogZWxlbWVudCA9PT0gdGhpcy50YXJnZXQ7XG4gICAgfSAvLyBHZXQgdGFyZ2V0IGVsZW1lbnRcblxuXG4gICAgZ2V0IHRhcmdldCgpIHtcbiAgICAgIHJldHVybiBicm93c2VyLmlzSW9zICYmIHRoaXMucGxheWVyLmNvbmZpZy5mdWxsc2NyZWVuLmlvc05hdGl2ZSA/IHRoaXMucGxheWVyLm1lZGlhIDogdGhpcy5wbGF5ZXIuZWxlbWVudHMuZnVsbHNjcmVlbiB8fCB0aGlzLnBsYXllci5lbGVtZW50cy5jb250YWluZXI7XG4gICAgfVxuXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBMb2FkIGltYWdlIGF2b2lkaW5nIHhoci9mZXRjaCBDT1JTIGlzc3Vlc1xuICAvLyBTZXJ2ZXIgc3RhdHVzIGNhbid0IGJlIG9idGFpbmVkIHRoaXMgd2F5IHVuZm9ydHVuYXRlbHksIHNvIHRoaXMgdXNlcyBcIm5hdHVyYWxXaWR0aFwiIHRvIGRldGVybWluZSBpZiB0aGUgaW1hZ2UgaGFzIGxvYWRlZFxuICAvLyBCeSBkZWZhdWx0IGl0IGNoZWNrcyBpZiBpdCBpcyBhdCBsZWFzdCAxcHgsIGJ1dCB5b3UgY2FuIGFkZCBhIHNlY29uZCBhcmd1bWVudCB0byBjaGFuZ2UgdGhpc1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBmdW5jdGlvbiBsb2FkSW1hZ2Uoc3JjLCBtaW5XaWR0aCA9IDEpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY29uc3QgaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcblxuICAgICAgY29uc3QgaGFuZGxlciA9ICgpID0+IHtcbiAgICAgICAgZGVsZXRlIGltYWdlLm9ubG9hZDtcbiAgICAgICAgZGVsZXRlIGltYWdlLm9uZXJyb3I7XG4gICAgICAgIChpbWFnZS5uYXR1cmFsV2lkdGggPj0gbWluV2lkdGggPyByZXNvbHZlIDogcmVqZWN0KShpbWFnZSk7XG4gICAgICB9O1xuXG4gICAgICBPYmplY3QuYXNzaWduKGltYWdlLCB7XG4gICAgICAgIG9ubG9hZDogaGFuZGxlcixcbiAgICAgICAgb25lcnJvcjogaGFuZGxlcixcbiAgICAgICAgc3JjXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IHVpID0ge1xuICAgIGFkZFN0eWxlSG9vaygpIHtcbiAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuY29udGFpbmVyLnJlcGxhY2UoJy4nLCAnJyksIHRydWUpO1xuICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMudWlTdXBwb3J0ZWQsIHRoaXMuc3VwcG9ydGVkLnVpKTtcbiAgICB9LFxuXG4gICAgLy8gVG9nZ2xlIG5hdGl2ZSBIVE1MNSBtZWRpYSBjb250cm9sc1xuICAgIHRvZ2dsZU5hdGl2ZUNvbnRyb2xzKHRvZ2dsZSA9IGZhbHNlKSB7XG4gICAgICBpZiAodG9nZ2xlICYmIHRoaXMuaXNIVE1MNSkge1xuICAgICAgICB0aGlzLm1lZGlhLnNldEF0dHJpYnV0ZSgnY29udHJvbHMnLCAnJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm1lZGlhLnJlbW92ZUF0dHJpYnV0ZSgnY29udHJvbHMnKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gU2V0dXAgdGhlIFVJXG4gICAgYnVpbGQoKSB7XG4gICAgICAvLyBSZS1hdHRhY2ggbWVkaWEgZWxlbWVudCBsaXN0ZW5lcnNcbiAgICAgIC8vIFRPRE86IFVzZSBldmVudCBidWJibGluZz9cbiAgICAgIHRoaXMubGlzdGVuZXJzLm1lZGlhKCk7IC8vIERvbid0IHNldHVwIGludGVyZmFjZSBpZiBubyBzdXBwb3J0XG5cbiAgICAgIGlmICghdGhpcy5zdXBwb3J0ZWQudWkpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKGBCYXNpYyBzdXBwb3J0IG9ubHkgZm9yICR7dGhpcy5wcm92aWRlcn0gJHt0aGlzLnR5cGV9YCk7IC8vIFJlc3RvcmUgbmF0aXZlIGNvbnRyb2xzXG5cbiAgICAgICAgdWkudG9nZ2xlTmF0aXZlQ29udHJvbHMuY2FsbCh0aGlzLCB0cnVlKTsgLy8gQmFpbFxuXG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gSW5qZWN0IGN1c3RvbSBjb250cm9scyBpZiBub3QgcHJlc2VudFxuXG5cbiAgICAgIGlmICghaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmNvbnRyb2xzKSkge1xuICAgICAgICAvLyBJbmplY3QgY3VzdG9tIGNvbnRyb2xzXG4gICAgICAgIGNvbnRyb2xzLmluamVjdC5jYWxsKHRoaXMpOyAvLyBSZS1hdHRhY2ggY29udHJvbCBsaXN0ZW5lcnNcblxuICAgICAgICB0aGlzLmxpc3RlbmVycy5jb250cm9scygpO1xuICAgICAgfSAvLyBSZW1vdmUgbmF0aXZlIGNvbnRyb2xzXG5cblxuICAgICAgdWkudG9nZ2xlTmF0aXZlQ29udHJvbHMuY2FsbCh0aGlzKTsgLy8gU2V0dXAgY2FwdGlvbnMgZm9yIEhUTUw1XG5cbiAgICAgIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgY2FwdGlvbnMuc2V0dXAuY2FsbCh0aGlzKTtcbiAgICAgIH0gLy8gUmVzZXQgdm9sdW1lXG5cblxuICAgICAgdGhpcy52b2x1bWUgPSBudWxsOyAvLyBSZXNldCBtdXRlIHN0YXRlXG5cbiAgICAgIHRoaXMubXV0ZWQgPSBudWxsOyAvLyBSZXNldCBsb29wIHN0YXRlXG5cbiAgICAgIHRoaXMubG9vcCA9IG51bGw7IC8vIFJlc2V0IHF1YWxpdHkgc2V0dGluZ1xuXG4gICAgICB0aGlzLnF1YWxpdHkgPSBudWxsOyAvLyBSZXNldCBzcGVlZFxuXG4gICAgICB0aGlzLnNwZWVkID0gbnVsbDsgLy8gUmVzZXQgdm9sdW1lIGRpc3BsYXlcblxuICAgICAgY29udHJvbHMudXBkYXRlVm9sdW1lLmNhbGwodGhpcyk7IC8vIFJlc2V0IHRpbWUgZGlzcGxheVxuXG4gICAgICBjb250cm9scy50aW1lVXBkYXRlLmNhbGwodGhpcyk7IC8vIFJlc2V0IGR1cmF0aW9uIGRpc3BsYXlcblxuICAgICAgY29udHJvbHMuZHVyYXRpb25VcGRhdGUuY2FsbCh0aGlzKTsgLy8gVXBkYXRlIHRoZSBVSVxuXG4gICAgICB1aS5jaGVja1BsYXlpbmcuY2FsbCh0aGlzKTsgLy8gQ2hlY2sgZm9yIHBpY3R1cmUtaW4tcGljdHVyZSBzdXBwb3J0XG5cbiAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnBpcC5zdXBwb3J0ZWQsIHN1cHBvcnQucGlwICYmIHRoaXMuaXNIVE1MNSAmJiB0aGlzLmlzVmlkZW8pOyAvLyBDaGVjayBmb3IgYWlycGxheSBzdXBwb3J0XG5cbiAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmFpcnBsYXkuc3VwcG9ydGVkLCBzdXBwb3J0LmFpcnBsYXkgJiYgdGhpcy5pc0hUTUw1KTsgLy8gQWRkIGlPUyBjbGFzc1xuXG4gICAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5pc0lvcywgYnJvd3Nlci5pc0lvcyk7IC8vIEFkZCB0b3VjaCBjbGFzc1xuXG4gICAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5pc1RvdWNoLCB0aGlzLnRvdWNoKTsgLy8gUmVhZHkgZm9yIEFQSSBjYWxsc1xuXG4gICAgICB0aGlzLnJlYWR5ID0gdHJ1ZTsgLy8gUmVhZHkgZXZlbnQgYXQgZW5kIG9mIGV4ZWN1dGlvbiBzdGFja1xuXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwodGhpcywgdGhpcy5tZWRpYSwgJ3JlYWR5Jyk7XG4gICAgICB9LCAwKTsgLy8gU2V0IHRoZSB0aXRsZVxuXG4gICAgICB1aS5zZXRUaXRsZS5jYWxsKHRoaXMpOyAvLyBBc3N1cmUgdGhlIHBvc3RlciBpbWFnZSBpcyBzZXQsIGlmIHRoZSBwcm9wZXJ0eSB3YXMgYWRkZWQgYmVmb3JlIHRoZSBlbGVtZW50IHdhcyBjcmVhdGVkXG5cbiAgICAgIGlmICh0aGlzLnBvc3Rlcikge1xuICAgICAgICB1aS5zZXRQb3N0ZXIuY2FsbCh0aGlzLCB0aGlzLnBvc3RlciwgZmFsc2UpLmNhdGNoKCgpID0+IHt9KTtcbiAgICAgIH0gLy8gTWFudWFsbHkgc2V0IHRoZSBkdXJhdGlvbiBpZiB1c2VyIGhhcyBvdmVycmlkZGVuIGl0LlxuICAgICAgLy8gVGhlIGV2ZW50IGxpc3RlbmVycyBmb3IgaXQgZG9lc24ndCBnZXQgY2FsbGVkIGlmIHByZWxvYWQgaXMgZGlzYWJsZWQgKCM3MDEpXG5cblxuICAgICAgaWYgKHRoaXMuY29uZmlnLmR1cmF0aW9uKSB7XG4gICAgICAgIGNvbnRyb2xzLmR1cmF0aW9uVXBkYXRlLmNhbGwodGhpcyk7XG4gICAgICB9IC8vIE1lZGlhIG1ldGFkYXRhXG5cblxuICAgICAgaWYgKHRoaXMuY29uZmlnLm1lZGlhTWV0YWRhdGEpIHtcbiAgICAgICAgY29udHJvbHMuc2V0TWVkaWFNZXRhZGF0YS5jYWxsKHRoaXMpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBTZXR1cCBhcmlhIGF0dHJpYnV0ZSBmb3IgcGxheSBhbmQgaWZyYW1lIHRpdGxlXG4gICAgc2V0VGl0bGUoKSB7XG4gICAgICAvLyBGaW5kIHRoZSBjdXJyZW50IHRleHRcbiAgICAgIGxldCBsYWJlbCA9IGkxOG4uZ2V0KCdwbGF5JywgdGhpcy5jb25maWcpOyAvLyBJZiB0aGVyZSdzIGEgbWVkaWEgdGl0bGUgc2V0LCB1c2UgdGhhdCBmb3IgdGhlIGxhYmVsXG5cbiAgICAgIGlmIChpcy5zdHJpbmcodGhpcy5jb25maWcudGl0bGUpICYmICFpcy5lbXB0eSh0aGlzLmNvbmZpZy50aXRsZSkpIHtcbiAgICAgICAgbGFiZWwgKz0gYCwgJHt0aGlzLmNvbmZpZy50aXRsZX1gO1xuICAgICAgfSAvLyBJZiB0aGVyZSdzIGEgcGxheSBidXR0b24sIHNldCBsYWJlbFxuXG5cbiAgICAgIEFycmF5LmZyb20odGhpcy5lbGVtZW50cy5idXR0b25zLnBsYXkgfHwgW10pLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGxhYmVsKTtcbiAgICAgIH0pOyAvLyBTZXQgaWZyYW1lIHRpdGxlXG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vc2FtcG90dHMvcGx5ci9pc3N1ZXMvMTI0XG5cbiAgICAgIGlmICh0aGlzLmlzRW1iZWQpIHtcbiAgICAgICAgY29uc3QgaWZyYW1lID0gZ2V0RWxlbWVudC5jYWxsKHRoaXMsICdpZnJhbWUnKTtcblxuICAgICAgICBpZiAoIWlzLmVsZW1lbnQoaWZyYW1lKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSAvLyBEZWZhdWx0IHRvIG1lZGlhIHR5cGVcblxuXG4gICAgICAgIGNvbnN0IHRpdGxlID0gIWlzLmVtcHR5KHRoaXMuY29uZmlnLnRpdGxlKSA/IHRoaXMuY29uZmlnLnRpdGxlIDogJ3ZpZGVvJztcbiAgICAgICAgY29uc3QgZm9ybWF0ID0gaTE4bi5nZXQoJ2ZyYW1lVGl0bGUnLCB0aGlzLmNvbmZpZyk7XG4gICAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgZm9ybWF0LnJlcGxhY2UoJ3t0aXRsZX0nLCB0aXRsZSkpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBUb2dnbGUgcG9zdGVyXG4gICAgdG9nZ2xlUG9zdGVyKGVuYWJsZSkge1xuICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMucG9zdGVyRW5hYmxlZCwgZW5hYmxlKTtcbiAgICB9LFxuXG4gICAgLy8gU2V0IHRoZSBwb3N0ZXIgaW1hZ2UgKGFzeW5jKVxuICAgIC8vIFVzZWQgaW50ZXJuYWxseSBmb3IgdGhlIHBvc3RlciBzZXR0ZXIsIHdpdGggdGhlIHBhc3NpdmUgb3B0aW9uIGZvcmNlZCB0byBmYWxzZVxuICAgIHNldFBvc3Rlcihwb3N0ZXIsIHBhc3NpdmUgPSB0cnVlKSB7XG4gICAgICAvLyBEb24ndCBvdmVycmlkZSBpZiBjYWxsIGlzIHBhc3NpdmVcbiAgICAgIGlmIChwYXNzaXZlICYmIHRoaXMucG9zdGVyKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1Bvc3RlciBhbHJlYWR5IHNldCcpKTtcbiAgICAgIH0gLy8gU2V0IHByb3BlcnR5IHN5bmNocm9ub3VzbHkgdG8gcmVzcGVjdCB0aGUgY2FsbCBvcmRlclxuXG5cbiAgICAgIHRoaXMubWVkaWEuc2V0QXR0cmlidXRlKCdkYXRhLXBvc3RlcicsIHBvc3Rlcik7IC8vIFNob3cgdGhlIHBvc3RlclxuXG4gICAgICB0aGlzLmVsZW1lbnRzLnBvc3Rlci5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpOyAvLyBXYWl0IHVudGlsIHVpIGlzIHJlYWR5XG5cbiAgICAgIHJldHVybiByZWFkeS5jYWxsKHRoaXMpIC8vIExvYWQgaW1hZ2VcbiAgICAgIC50aGVuKCgpID0+IGxvYWRJbWFnZShwb3N0ZXIpKS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIC8vIEhpZGUgcG9zdGVyIG9uIGVycm9yIHVubGVzcyBpdCdzIGJlZW4gc2V0IGJ5IGFub3RoZXIgY2FsbFxuICAgICAgICBpZiAocG9zdGVyID09PSB0aGlzLnBvc3Rlcikge1xuICAgICAgICAgIHVpLnRvZ2dsZVBvc3Rlci5jYWxsKHRoaXMsIGZhbHNlKTtcbiAgICAgICAgfSAvLyBSZXRocm93XG5cblxuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgICAvLyBQcmV2ZW50IHJhY2UgY29uZGl0aW9uc1xuICAgICAgICBpZiAocG9zdGVyICE9PSB0aGlzLnBvc3Rlcikge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignc2V0UG9zdGVyIGNhbmNlbGxlZCBieSBsYXRlciBjYWxsIHRvIHNldFBvc3RlcicpO1xuICAgICAgICB9XG4gICAgICB9KS50aGVuKCgpID0+IHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmVsZW1lbnRzLnBvc3Rlci5zdHlsZSwge1xuICAgICAgICAgIGJhY2tncm91bmRJbWFnZTogYHVybCgnJHtwb3N0ZXJ9JylgLFxuICAgICAgICAgIC8vIFJlc2V0IGJhY2tncm91bmRTaXplIGFzIHdlbGwgKHNpbmNlIGl0IGNhbiBiZSBzZXQgdG8gXCJjb3ZlclwiIGZvciBwYWRkZWQgdGh1bWJuYWlscyBmb3IgeW91dHViZSlcbiAgICAgICAgICBiYWNrZ3JvdW5kU2l6ZTogJydcbiAgICAgICAgfSk7XG4gICAgICAgIHVpLnRvZ2dsZVBvc3Rlci5jYWxsKHRoaXMsIHRydWUpO1xuICAgICAgICByZXR1cm4gcG9zdGVyO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vIENoZWNrIHBsYXlpbmcgc3RhdGVcbiAgICBjaGVja1BsYXlpbmcoZXZlbnQpIHtcbiAgICAgIC8vIENsYXNzIGhvb2tzXG4gICAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5wbGF5aW5nLCB0aGlzLnBsYXlpbmcpO1xuICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMucGF1c2VkLCB0aGlzLnBhdXNlZCk7XG4gICAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5zdG9wcGVkLCB0aGlzLnN0b3BwZWQpOyAvLyBTZXQgc3RhdGVcblxuICAgICAgQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnRzLmJ1dHRvbnMucGxheSB8fCBbXSkuZm9yRWFjaCh0YXJnZXQgPT4ge1xuICAgICAgICBPYmplY3QuYXNzaWduKHRhcmdldCwge1xuICAgICAgICAgIHByZXNzZWQ6IHRoaXMucGxheWluZ1xuICAgICAgICB9KTtcbiAgICAgICAgdGFyZ2V0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGkxOG4uZ2V0KHRoaXMucGxheWluZyA/ICdwYXVzZScgOiAncGxheScsIHRoaXMuY29uZmlnKSk7XG4gICAgICB9KTsgLy8gT25seSB1cGRhdGUgY29udHJvbHMgb24gbm9uIHRpbWV1cGRhdGUgZXZlbnRzXG5cbiAgICAgIGlmIChpcy5ldmVudChldmVudCkgJiYgZXZlbnQudHlwZSA9PT0gJ3RpbWV1cGRhdGUnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gVG9nZ2xlIGNvbnRyb2xzXG5cblxuICAgICAgdWkudG9nZ2xlQ29udHJvbHMuY2FsbCh0aGlzKTtcbiAgICB9LFxuXG4gICAgLy8gQ2hlY2sgaWYgbWVkaWEgaXMgbG9hZGluZ1xuICAgIGNoZWNrTG9hZGluZyhldmVudCkge1xuICAgICAgdGhpcy5sb2FkaW5nID0gWydzdGFsbGVkJywgJ3dhaXRpbmcnXS5pbmNsdWRlcyhldmVudC50eXBlKTsgLy8gQ2xlYXIgdGltZXJcblxuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmxvYWRpbmcpOyAvLyBUaW1lciB0byBwcmV2ZW50IGZsaWNrZXIgd2hlbiBzZWVraW5nXG5cbiAgICAgIHRoaXMudGltZXJzLmxvYWRpbmcgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgLy8gVXBkYXRlIHByb2dyZXNzIGJhciBsb2FkaW5nIGNsYXNzIHN0YXRlXG4gICAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmxvYWRpbmcsIHRoaXMubG9hZGluZyk7IC8vIFVwZGF0ZSBjb250cm9scyB2aXNpYmlsaXR5XG5cbiAgICAgICAgdWkudG9nZ2xlQ29udHJvbHMuY2FsbCh0aGlzKTtcbiAgICAgIH0sIHRoaXMubG9hZGluZyA/IDI1MCA6IDApO1xuICAgIH0sXG5cbiAgICAvLyBUb2dnbGUgY29udHJvbHMgYmFzZWQgb24gc3RhdGUgYW5kIGBmb3JjZWAgYXJndW1lbnRcbiAgICB0b2dnbGVDb250cm9scyhmb3JjZSkge1xuICAgICAgY29uc3Qge1xuICAgICAgICBjb250cm9sczogY29udHJvbHNFbGVtZW50XG4gICAgICB9ID0gdGhpcy5lbGVtZW50cztcblxuICAgICAgaWYgKGNvbnRyb2xzRWxlbWVudCAmJiB0aGlzLmNvbmZpZy5oaWRlQ29udHJvbHMpIHtcbiAgICAgICAgLy8gRG9uJ3QgaGlkZSBjb250cm9scyBpZiBhIHRvdWNoLWRldmljZSB1c2VyIHJlY2VudGx5IHNlZWtlZC4gKE11c3QgYmUgbGltaXRlZCB0byB0b3VjaCBkZXZpY2VzLCBvciBpdCBvY2Nhc2lvbmFsbHkgcHJldmVudHMgZGVza3RvcCBjb250cm9scyBmcm9tIGhpZGluZy4pXG4gICAgICAgIGNvbnN0IHJlY2VudFRvdWNoU2VlayA9IHRoaXMudG91Y2ggJiYgdGhpcy5sYXN0U2Vla1RpbWUgKyAyMDAwID4gRGF0ZS5ub3coKTsgLy8gU2hvdyBjb250cm9scyBpZiBmb3JjZSwgbG9hZGluZywgcGF1c2VkLCBidXR0b24gaW50ZXJhY3Rpb24sIG9yIHJlY2VudCBzZWVrLCBvdGhlcndpc2UgaGlkZVxuXG4gICAgICAgIHRoaXMudG9nZ2xlQ29udHJvbHMoQm9vbGVhbihmb3JjZSB8fCB0aGlzLmxvYWRpbmcgfHwgdGhpcy5wYXVzZWQgfHwgY29udHJvbHNFbGVtZW50LnByZXNzZWQgfHwgY29udHJvbHNFbGVtZW50LmhvdmVyIHx8IHJlY2VudFRvdWNoU2VlaykpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBNaWdyYXRlIGFueSBjdXN0b20gcHJvcGVydGllcyBmcm9tIHRoZSBtZWRpYSB0byB0aGUgcGFyZW50XG4gICAgbWlncmF0ZVN0eWxlcygpIHtcbiAgICAgIC8vIExvb3AgdGhyb3VnaCB2YWx1ZXMgKGFzIHRoZXkgYXJlIHRoZSBrZXlzIHdoZW4gdGhlIG9iamVjdCBpcyBzcHJlYWQg8J+klClcbiAgICAgIE9iamVjdC52YWx1ZXMoeyAuLi50aGlzLm1lZGlhLnN0eWxlXG4gICAgICB9KSAvLyBXZSdyZSBvbmx5IGZ1c3NlZCBhYm91dCBQbHlyIHNwZWNpZmljIHByb3BlcnRpZXNcbiAgICAgIC5maWx0ZXIoa2V5ID0+ICFpcy5lbXB0eShrZXkpICYmIGlzLnN0cmluZyhrZXkpICYmIGtleS5zdGFydHNXaXRoKCctLXBseXInKSkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAvLyBTZXQgb24gdGhlIGNvbnRhaW5lclxuICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5zdHlsZS5zZXRQcm9wZXJ0eShrZXksIHRoaXMubWVkaWEuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShrZXkpKTsgLy8gQ2xlYW4gdXAgZnJvbSBtZWRpYSBlbGVtZW50XG5cbiAgICAgICAgdGhpcy5tZWRpYS5zdHlsZS5yZW1vdmVQcm9wZXJ0eShrZXkpO1xuICAgICAgfSk7IC8vIFJlbW92ZSBhdHRyaWJ1dGUgaWYgZW1wdHlcblxuICAgICAgaWYgKGlzLmVtcHR5KHRoaXMubWVkaWEuc3R5bGUpKSB7XG4gICAgICAgIHRoaXMubWVkaWEucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpO1xuICAgICAgfVxuICAgIH1cblxuICB9O1xuXG4gIGNsYXNzIExpc3RlbmVycyB7XG4gICAgY29uc3RydWN0b3IoX3BsYXllcikge1xuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJmaXJzdFRvdWNoXCIsICgpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHBsYXllclxuICAgICAgICB9ID0gdGhpcztcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGVsZW1lbnRzXG4gICAgICAgIH0gPSBwbGF5ZXI7XG4gICAgICAgIHBsYXllci50b3VjaCA9IHRydWU7IC8vIEFkZCB0b3VjaCBjbGFzc1xuXG4gICAgICAgIHRvZ2dsZUNsYXNzKGVsZW1lbnRzLmNvbnRhaW5lciwgcGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLmlzVG91Y2gsIHRydWUpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwic2V0VGFiRm9jdXNcIiwgZXZlbnQgPT4ge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgcGxheWVyXG4gICAgICAgIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgZWxlbWVudHNcbiAgICAgICAgfSA9IHBsYXllcjtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGtleSxcbiAgICAgICAgICB0eXBlLFxuICAgICAgICAgIHRpbWVTdGFtcFxuICAgICAgICB9ID0gZXZlbnQ7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmZvY3VzVGltZXIpOyAvLyBJZ25vcmUgYW55IGtleSBvdGhlciB0aGFuIHRhYlxuXG4gICAgICAgIGlmICh0eXBlID09PSAna2V5ZG93bicgJiYga2V5ICE9PSAnVGFiJykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSAvLyBTdG9yZSByZWZlcmVuY2UgdG8gZXZlbnQgdGltZVN0YW1wXG5cblxuICAgICAgICBpZiAodHlwZSA9PT0gJ2tleWRvd24nKSB7XG4gICAgICAgICAgdGhpcy5sYXN0S2V5RG93biA9IHRpbWVTdGFtcDtcbiAgICAgICAgfSAvLyBSZW1vdmUgY3VycmVudCBjbGFzc2VzXG5cblxuICAgICAgICBjb25zdCByZW1vdmVDdXJyZW50ID0gKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNsYXNzTmFtZSA9IHBsYXllci5jb25maWcuY2xhc3NOYW1lcy50YWJGb2N1cztcbiAgICAgICAgICBjb25zdCBjdXJyZW50ID0gZ2V0RWxlbWVudHMuY2FsbChwbGF5ZXIsIGAuJHtjbGFzc05hbWV9YCk7XG4gICAgICAgICAgdG9nZ2xlQ2xhc3MoY3VycmVudCwgY2xhc3NOYW1lLCBmYWxzZSk7XG4gICAgICAgIH07IC8vIERldGVybWluZSBpZiBhIGtleSB3YXMgcHJlc3NlZCB0byB0cmlnZ2VyIHRoaXMgZXZlbnRcblxuXG4gICAgICAgIGNvbnN0IHdhc0tleURvd24gPSB0aW1lU3RhbXAgLSB0aGlzLmxhc3RLZXlEb3duIDw9IDIwOyAvLyBJZ25vcmUgZm9jdXMgZXZlbnRzIGlmIGEga2V5IHdhcyBwcmVzc2VkIHByaW9yXG5cbiAgICAgICAgaWYgKHR5cGUgPT09ICdmb2N1cycgJiYgIXdhc0tleURvd24pIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gLy8gUmVtb3ZlIGFsbCBjdXJyZW50XG5cblxuICAgICAgICByZW1vdmVDdXJyZW50KCk7IC8vIERlbGF5IHRoZSBhZGRpbmcgb2YgY2xhc3NuYW1lIHVudGlsIHRoZSBmb2N1cyBoYXMgY2hhbmdlZFxuICAgICAgICAvLyBUaGlzIGV2ZW50IGZpcmVzIGJlZm9yZSB0aGUgZm9jdXNpbiBldmVudFxuXG4gICAgICAgIGlmICh0eXBlICE9PSAnZm9jdXNvdXQnKSB7XG4gICAgICAgICAgdGhpcy5mb2N1c1RpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBmb2N1c2VkID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDsgLy8gSWdub3JlIGlmIGN1cnJlbnQgZm9jdXMgZWxlbWVudCBpc24ndCBpbnNpZGUgdGhlIHBsYXllclxuXG4gICAgICAgICAgICBpZiAoIWVsZW1lbnRzLmNvbnRhaW5lci5jb250YWlucyhmb2N1c2VkKSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRvZ2dsZUNsYXNzKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQsIHBsYXllci5jb25maWcuY2xhc3NOYW1lcy50YWJGb2N1cywgdHJ1ZSk7XG4gICAgICAgICAgfSwgMTApO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJnbG9iYWxcIiwgKHRvZ2dsZSA9IHRydWUpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHBsYXllclxuICAgICAgICB9ID0gdGhpczsgLy8gS2V5Ym9hcmQgc2hvcnRjdXRzXG5cbiAgICAgICAgaWYgKHBsYXllci5jb25maWcua2V5Ym9hcmQuZ2xvYmFsKSB7XG4gICAgICAgICAgdG9nZ2xlTGlzdGVuZXIuY2FsbChwbGF5ZXIsIHdpbmRvdywgJ2tleWRvd24ga2V5dXAnLCB0aGlzLmhhbmRsZUtleSwgdG9nZ2xlLCBmYWxzZSk7XG4gICAgICAgIH0gLy8gQ2xpY2sgYW55d2hlcmUgY2xvc2VzIG1lbnVcblxuXG4gICAgICAgIHRvZ2dsZUxpc3RlbmVyLmNhbGwocGxheWVyLCBkb2N1bWVudC5ib2R5LCAnY2xpY2snLCB0aGlzLnRvZ2dsZU1lbnUsIHRvZ2dsZSk7IC8vIERldGVjdCB0b3VjaCBieSBldmVudHNcblxuICAgICAgICBvbmNlLmNhbGwocGxheWVyLCBkb2N1bWVudC5ib2R5LCAndG91Y2hzdGFydCcsIHRoaXMuZmlyc3RUb3VjaCk7IC8vIFRhYiBmb2N1cyBkZXRlY3Rpb25cblxuICAgICAgICB0b2dnbGVMaXN0ZW5lci5jYWxsKHBsYXllciwgZG9jdW1lbnQuYm9keSwgJ2tleWRvd24gZm9jdXMgYmx1ciBmb2N1c291dCcsIHRoaXMuc2V0VGFiRm9jdXMsIHRvZ2dsZSwgZmFsc2UsIHRydWUpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiY29udGFpbmVyXCIsICgpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHBsYXllclxuICAgICAgICB9ID0gdGhpcztcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGNvbmZpZyxcbiAgICAgICAgICBlbGVtZW50cyxcbiAgICAgICAgICB0aW1lcnNcbiAgICAgICAgfSA9IHBsYXllcjsgLy8gS2V5Ym9hcmQgc2hvcnRjdXRzXG5cbiAgICAgICAgaWYgKCFjb25maWcua2V5Ym9hcmQuZ2xvYmFsICYmIGNvbmZpZy5rZXlib2FyZC5mb2N1c2VkKSB7XG4gICAgICAgICAgb24uY2FsbChwbGF5ZXIsIGVsZW1lbnRzLmNvbnRhaW5lciwgJ2tleWRvd24ga2V5dXAnLCB0aGlzLmhhbmRsZUtleSwgZmFsc2UpO1xuICAgICAgICB9IC8vIFRvZ2dsZSBjb250cm9scyBvbiBtb3VzZSBldmVudHMgYW5kIGVudGVyaW5nIGZ1bGxzY3JlZW5cblxuXG4gICAgICAgIG9uLmNhbGwocGxheWVyLCBlbGVtZW50cy5jb250YWluZXIsICdtb3VzZW1vdmUgbW91c2VsZWF2ZSB0b3VjaHN0YXJ0IHRvdWNobW92ZSBlbnRlcmZ1bGxzY3JlZW4gZXhpdGZ1bGxzY3JlZW4nLCBldmVudCA9PiB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgY29udHJvbHM6IGNvbnRyb2xzRWxlbWVudFxuICAgICAgICAgIH0gPSBlbGVtZW50czsgLy8gUmVtb3ZlIGJ1dHRvbiBzdGF0ZXMgZm9yIGZ1bGxzY3JlZW5cblxuICAgICAgICAgIGlmIChjb250cm9sc0VsZW1lbnQgJiYgZXZlbnQudHlwZSA9PT0gJ2VudGVyZnVsbHNjcmVlbicpIHtcbiAgICAgICAgICAgIGNvbnRyb2xzRWxlbWVudC5wcmVzc2VkID0gZmFsc2U7XG4gICAgICAgICAgICBjb250cm9sc0VsZW1lbnQuaG92ZXIgPSBmYWxzZTtcbiAgICAgICAgICB9IC8vIFNob3csIHRoZW4gaGlkZSBhZnRlciBhIHRpbWVvdXQgdW5sZXNzIGFub3RoZXIgY29udHJvbCBldmVudCBvY2N1cnNcblxuXG4gICAgICAgICAgY29uc3Qgc2hvdyA9IFsndG91Y2hzdGFydCcsICd0b3VjaG1vdmUnLCAnbW91c2Vtb3ZlJ10uaW5jbHVkZXMoZXZlbnQudHlwZSk7XG4gICAgICAgICAgbGV0IGRlbGF5ID0gMDtcblxuICAgICAgICAgIGlmIChzaG93KSB7XG4gICAgICAgICAgICB1aS50b2dnbGVDb250cm9scy5jYWxsKHBsYXllciwgdHJ1ZSk7IC8vIFVzZSBsb25nZXIgdGltZW91dCBmb3IgdG91Y2ggZGV2aWNlc1xuXG4gICAgICAgICAgICBkZWxheSA9IHBsYXllci50b3VjaCA/IDMwMDAgOiAyMDAwO1xuICAgICAgICAgIH0gLy8gQ2xlYXIgdGltZXJcblxuXG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVycy5jb250cm9scyk7IC8vIFNldCBuZXcgdGltZXIgdG8gcHJldmVudCBmbGlja2VyIHdoZW4gc2Vla2luZ1xuXG4gICAgICAgICAgdGltZXJzLmNvbnRyb2xzID0gc2V0VGltZW91dCgoKSA9PiB1aS50b2dnbGVDb250cm9scy5jYWxsKHBsYXllciwgZmFsc2UpLCBkZWxheSk7XG4gICAgICAgIH0pOyAvLyBTZXQgYSBndXR0ZXIgZm9yIFZpbWVvXG5cbiAgICAgICAgY29uc3Qgc2V0R3V0dGVyID0gKCkgPT4ge1xuICAgICAgICAgIGlmICghcGxheWVyLmlzVmltZW8gfHwgcGxheWVyLmNvbmZpZy52aW1lby5wcmVtaXVtKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgdGFyZ2V0ID0gZWxlbWVudHMud3JhcHBlcjtcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBhY3RpdmVcbiAgICAgICAgICB9ID0gcGxheWVyLmZ1bGxzY3JlZW47XG4gICAgICAgICAgY29uc3QgW3ZpZGVvV2lkdGgsIHZpZGVvSGVpZ2h0XSA9IGdldEFzcGVjdFJhdGlvLmNhbGwocGxheWVyKTtcbiAgICAgICAgICBjb25zdCB1c2VOYXRpdmVBc3BlY3RSYXRpbyA9IHN1cHBvcnRzQ1NTKGBhc3BlY3QtcmF0aW86ICR7dmlkZW9XaWR0aH0gLyAke3ZpZGVvSGVpZ2h0fWApOyAvLyBJZiBub3QgYWN0aXZlLCByZW1vdmUgc3R5bGVzXG5cbiAgICAgICAgICBpZiAoIWFjdGl2ZSkge1xuICAgICAgICAgICAgaWYgKHVzZU5hdGl2ZUFzcGVjdFJhdGlvKSB7XG4gICAgICAgICAgICAgIHRhcmdldC5zdHlsZS53aWR0aCA9IG51bGw7XG4gICAgICAgICAgICAgIHRhcmdldC5zdHlsZS5oZWlnaHQgPSBudWxsO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGFyZ2V0LnN0eWxlLm1heFdpZHRoID0gbnVsbDtcbiAgICAgICAgICAgICAgdGFyZ2V0LnN0eWxlLm1hcmdpbiA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IC8vIERldGVybWluZSB3aGljaCBkaW1lbnNpb24gd2lsbCBvdmVyZmxvdyBhbmQgY29uc3RyYWluIHZpZXdcblxuXG4gICAgICAgICAgY29uc3QgW3ZpZXdwb3J0V2lkdGgsIHZpZXdwb3J0SGVpZ2h0XSA9IGdldFZpZXdwb3J0U2l6ZSgpO1xuICAgICAgICAgIGNvbnN0IG92ZXJmbG93ID0gdmlld3BvcnRXaWR0aCAvIHZpZXdwb3J0SGVpZ2h0ID4gdmlkZW9XaWR0aCAvIHZpZGVvSGVpZ2h0O1xuXG4gICAgICAgICAgaWYgKHVzZU5hdGl2ZUFzcGVjdFJhdGlvKSB7XG4gICAgICAgICAgICB0YXJnZXQuc3R5bGUud2lkdGggPSBvdmVyZmxvdyA/ICdhdXRvJyA6ICcxMDAlJztcbiAgICAgICAgICAgIHRhcmdldC5zdHlsZS5oZWlnaHQgPSBvdmVyZmxvdyA/ICcxMDAlJyA6ICdhdXRvJztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGFyZ2V0LnN0eWxlLm1heFdpZHRoID0gb3ZlcmZsb3cgPyBgJHt2aWV3cG9ydEhlaWdodCAvIHZpZGVvSGVpZ2h0ICogdmlkZW9XaWR0aH1weGAgOiBudWxsO1xuICAgICAgICAgICAgdGFyZ2V0LnN0eWxlLm1hcmdpbiA9IG92ZXJmbG93ID8gJzAgYXV0bycgOiBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfTsgLy8gSGFuZGxlIHJlc2l6aW5nXG5cblxuICAgICAgICBjb25zdCByZXNpemVkID0gKCkgPT4ge1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcnMucmVzaXplZCk7XG4gICAgICAgICAgdGltZXJzLnJlc2l6ZWQgPSBzZXRUaW1lb3V0KHNldEd1dHRlciwgNTApO1xuICAgICAgICB9O1xuXG4gICAgICAgIG9uLmNhbGwocGxheWVyLCBlbGVtZW50cy5jb250YWluZXIsICdlbnRlcmZ1bGxzY3JlZW4gZXhpdGZ1bGxzY3JlZW4nLCBldmVudCA9PiB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgdGFyZ2V0XG4gICAgICAgICAgfSA9IHBsYXllci5mdWxsc2NyZWVuOyAvLyBJZ25vcmUgZXZlbnRzIG5vdCBmcm9tIHRhcmdldFxuXG4gICAgICAgICAgaWYgKHRhcmdldCAhPT0gZWxlbWVudHMuY29udGFpbmVyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSAvLyBJZiBpdCdzIG5vdCBhbiBlbWJlZCBhbmQgbm8gcmF0aW8gc3BlY2lmaWVkXG5cblxuICAgICAgICAgIGlmICghcGxheWVyLmlzRW1iZWQgJiYgaXMuZW1wdHkocGxheWVyLmNvbmZpZy5yYXRpbykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IC8vIFNldCBWaW1lbyBndXR0ZXJcblxuXG4gICAgICAgICAgc2V0R3V0dGVyKCk7IC8vIFdhdGNoIGZvciByZXNpemVzXG5cbiAgICAgICAgICBjb25zdCBtZXRob2QgPSBldmVudC50eXBlID09PSAnZW50ZXJmdWxsc2NyZWVuJyA/IG9uIDogb2ZmO1xuICAgICAgICAgIG1ldGhvZC5jYWxsKHBsYXllciwgd2luZG93LCAncmVzaXplJywgcmVzaXplZCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwibWVkaWFcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgcGxheWVyXG4gICAgICAgIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgZWxlbWVudHNcbiAgICAgICAgfSA9IHBsYXllcjsgLy8gVGltZSBjaGFuZ2Ugb24gbWVkaWFcblxuICAgICAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndGltZXVwZGF0ZSBzZWVraW5nIHNlZWtlZCcsIGV2ZW50ID0+IGNvbnRyb2xzLnRpbWVVcGRhdGUuY2FsbChwbGF5ZXIsIGV2ZW50KSk7IC8vIERpc3BsYXkgZHVyYXRpb25cblxuICAgICAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZHVyYXRpb25jaGFuZ2UgbG9hZGVkZGF0YSBsb2FkZWRtZXRhZGF0YScsIGV2ZW50ID0+IGNvbnRyb2xzLmR1cmF0aW9uVXBkYXRlLmNhbGwocGxheWVyLCBldmVudCkpOyAvLyBIYW5kbGUgdGhlIG1lZGlhIGZpbmlzaGluZ1xuXG4gICAgICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdlbmRlZCcsICgpID0+IHtcbiAgICAgICAgICAvLyBTaG93IHBvc3RlciBvbiBlbmRcbiAgICAgICAgICBpZiAocGxheWVyLmlzSFRNTDUgJiYgcGxheWVyLmlzVmlkZW8gJiYgcGxheWVyLmNvbmZpZy5yZXNldE9uRW5kKSB7XG4gICAgICAgICAgICAvLyBSZXN0YXJ0XG4gICAgICAgICAgICBwbGF5ZXIucmVzdGFydCgpOyAvLyBDYWxsIHBhdXNlIG90aGVyd2lzZSBJRTExIHdpbGwgc3RhcnQgcGxheWluZyB0aGUgdmlkZW8gYWdhaW5cblxuICAgICAgICAgICAgcGxheWVyLnBhdXNlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTsgLy8gQ2hlY2sgZm9yIGJ1ZmZlciBwcm9ncmVzc1xuXG4gICAgICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdwcm9ncmVzcyBwbGF5aW5nIHNlZWtpbmcgc2Vla2VkJywgZXZlbnQgPT4gY29udHJvbHMudXBkYXRlUHJvZ3Jlc3MuY2FsbChwbGF5ZXIsIGV2ZW50KSk7IC8vIEhhbmRsZSB2b2x1bWUgY2hhbmdlc1xuXG4gICAgICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd2b2x1bWVjaGFuZ2UnLCBldmVudCA9PiBjb250cm9scy51cGRhdGVWb2x1bWUuY2FsbChwbGF5ZXIsIGV2ZW50KSk7IC8vIEhhbmRsZSBwbGF5L3BhdXNlXG5cbiAgICAgICAgb24uY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3BsYXlpbmcgcGxheSBwYXVzZSBlbmRlZCBlbXB0aWVkIHRpbWV1cGRhdGUnLCBldmVudCA9PiB1aS5jaGVja1BsYXlpbmcuY2FsbChwbGF5ZXIsIGV2ZW50KSk7IC8vIExvYWRpbmcgc3RhdGVcblxuICAgICAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnd2FpdGluZyBjYW5wbGF5IHNlZWtlZCBwbGF5aW5nJywgZXZlbnQgPT4gdWkuY2hlY2tMb2FkaW5nLmNhbGwocGxheWVyLCBldmVudCkpOyAvLyBDbGljayB2aWRlb1xuXG4gICAgICAgIGlmIChwbGF5ZXIuc3VwcG9ydGVkLnVpICYmIHBsYXllci5jb25maWcuY2xpY2tUb1BsYXkgJiYgIXBsYXllci5pc0F1ZGlvKSB7XG4gICAgICAgICAgLy8gUmUtZmV0Y2ggdGhlIHdyYXBwZXJcbiAgICAgICAgICBjb25zdCB3cmFwcGVyID0gZ2V0RWxlbWVudC5jYWxsKHBsYXllciwgYC4ke3BsYXllci5jb25maWcuY2xhc3NOYW1lcy52aWRlb31gKTsgLy8gQmFpbCBpZiB0aGVyZSdzIG5vIHdyYXBwZXIgKHRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbilcblxuICAgICAgICAgIGlmICghaXMuZWxlbWVudCh3cmFwcGVyKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gLy8gT24gY2xpY2sgcGxheSwgcGF1c2Ugb3IgcmVzdGFydFxuXG5cbiAgICAgICAgICBvbi5jYWxsKHBsYXllciwgZWxlbWVudHMuY29udGFpbmVyLCAnY2xpY2snLCBldmVudCA9PiB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRzID0gW2VsZW1lbnRzLmNvbnRhaW5lciwgd3JhcHBlcl07IC8vIElnbm9yZSBpZiBjbGljayBpZiBub3QgY29udGFpbmVyIG9yIGluIHZpZGVvIHdyYXBwZXJcblxuICAgICAgICAgICAgaWYgKCF0YXJnZXRzLmluY2x1ZGVzKGV2ZW50LnRhcmdldCkgJiYgIXdyYXBwZXIuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IC8vIFRvdWNoIGRldmljZXMgd2lsbCBqdXN0IHNob3cgY29udHJvbHMgKGlmIGhpZGRlbilcblxuXG4gICAgICAgICAgICBpZiAocGxheWVyLnRvdWNoICYmIHBsYXllci5jb25maWcuaGlkZUNvbnRyb2xzKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHBsYXllci5lbmRlZCkge1xuICAgICAgICAgICAgICB0aGlzLnByb3h5KGV2ZW50LCBwbGF5ZXIucmVzdGFydCwgJ3Jlc3RhcnQnKTtcbiAgICAgICAgICAgICAgdGhpcy5wcm94eShldmVudCwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNpbGVuY2VQcm9taXNlKHBsYXllci5wbGF5KCkpO1xuICAgICAgICAgICAgICB9LCAncGxheScpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5wcm94eShldmVudCwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNpbGVuY2VQcm9taXNlKHBsYXllci50b2dnbGVQbGF5KCkpO1xuICAgICAgICAgICAgICB9LCAncGxheScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IC8vIERpc2FibGUgcmlnaHQgY2xpY2tcblxuXG4gICAgICAgIGlmIChwbGF5ZXIuc3VwcG9ydGVkLnVpICYmIHBsYXllci5jb25maWcuZGlzYWJsZUNvbnRleHRNZW51KSB7XG4gICAgICAgICAgb24uY2FsbChwbGF5ZXIsIGVsZW1lbnRzLndyYXBwZXIsICdjb250ZXh0bWVudScsIGV2ZW50ID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgfSwgZmFsc2UpO1xuICAgICAgICB9IC8vIFZvbHVtZSBjaGFuZ2VcblxuXG4gICAgICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd2b2x1bWVjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgLy8gU2F2ZSB0byBzdG9yYWdlXG4gICAgICAgICAgcGxheWVyLnN0b3JhZ2Uuc2V0KHtcbiAgICAgICAgICAgIHZvbHVtZTogcGxheWVyLnZvbHVtZSxcbiAgICAgICAgICAgIG11dGVkOiBwbGF5ZXIubXV0ZWRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7IC8vIFNwZWVkIGNoYW5nZVxuXG4gICAgICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdyYXRlY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgIC8vIFVwZGF0ZSBVSVxuICAgICAgICAgIGNvbnRyb2xzLnVwZGF0ZVNldHRpbmcuY2FsbChwbGF5ZXIsICdzcGVlZCcpOyAvLyBTYXZlIHRvIHN0b3JhZ2VcblxuICAgICAgICAgIHBsYXllci5zdG9yYWdlLnNldCh7XG4gICAgICAgICAgICBzcGVlZDogcGxheWVyLnNwZWVkXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pOyAvLyBRdWFsaXR5IGNoYW5nZVxuXG4gICAgICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdxdWFsaXR5Y2hhbmdlJywgZXZlbnQgPT4ge1xuICAgICAgICAgIC8vIFVwZGF0ZSBVSVxuICAgICAgICAgIGNvbnRyb2xzLnVwZGF0ZVNldHRpbmcuY2FsbChwbGF5ZXIsICdxdWFsaXR5JywgbnVsbCwgZXZlbnQuZGV0YWlsLnF1YWxpdHkpO1xuICAgICAgICB9KTsgLy8gVXBkYXRlIGRvd25sb2FkIGxpbmsgd2hlbiByZWFkeSBhbmQgaWYgcXVhbGl0eSBjaGFuZ2VzXG5cbiAgICAgICAgb24uY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3JlYWR5IHF1YWxpdHljaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgY29udHJvbHMuc2V0RG93bmxvYWRVcmwuY2FsbChwbGF5ZXIpO1xuICAgICAgICB9KTsgLy8gUHJveHkgZXZlbnRzIHRvIGNvbnRhaW5lclxuICAgICAgICAvLyBCdWJibGUgdXAga2V5IGV2ZW50cyBmb3IgRWRnZVxuXG4gICAgICAgIGNvbnN0IHByb3h5RXZlbnRzID0gcGxheWVyLmNvbmZpZy5ldmVudHMuY29uY2F0KFsna2V5dXAnLCAna2V5ZG93biddKS5qb2luKCcgJyk7XG4gICAgICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsIHByb3h5RXZlbnRzLCBldmVudCA9PiB7XG4gICAgICAgICAgbGV0IHtcbiAgICAgICAgICAgIGRldGFpbCA9IHt9XG4gICAgICAgICAgfSA9IGV2ZW50OyAvLyBHZXQgZXJyb3IgZGV0YWlscyBmcm9tIG1lZGlhXG5cbiAgICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgZGV0YWlsID0gcGxheWVyLm1lZGlhLmVycm9yO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgZWxlbWVudHMuY29udGFpbmVyLCBldmVudC50eXBlLCB0cnVlLCBkZXRhaWwpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInByb3h5XCIsIChldmVudCwgZGVmYXVsdEhhbmRsZXIsIGN1c3RvbUhhbmRsZXJLZXkpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHBsYXllclxuICAgICAgICB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgY3VzdG9tSGFuZGxlciA9IHBsYXllci5jb25maWcubGlzdGVuZXJzW2N1c3RvbUhhbmRsZXJLZXldO1xuICAgICAgICBjb25zdCBoYXNDdXN0b21IYW5kbGVyID0gaXMuZnVuY3Rpb24oY3VzdG9tSGFuZGxlcik7XG4gICAgICAgIGxldCByZXR1cm5lZCA9IHRydWU7IC8vIEV4ZWN1dGUgY3VzdG9tIGhhbmRsZXJcblxuICAgICAgICBpZiAoaGFzQ3VzdG9tSGFuZGxlcikge1xuICAgICAgICAgIHJldHVybmVkID0gY3VzdG9tSGFuZGxlci5jYWxsKHBsYXllciwgZXZlbnQpO1xuICAgICAgICB9IC8vIE9ubHkgY2FsbCBkZWZhdWx0IGhhbmRsZXIgaWYgbm90IHByZXZlbnRlZCBpbiBjdXN0b20gaGFuZGxlclxuXG5cbiAgICAgICAgaWYgKHJldHVybmVkICE9PSBmYWxzZSAmJiBpcy5mdW5jdGlvbihkZWZhdWx0SGFuZGxlcikpIHtcbiAgICAgICAgICBkZWZhdWx0SGFuZGxlci5jYWxsKHBsYXllciwgZXZlbnQpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJiaW5kXCIsIChlbGVtZW50LCB0eXBlLCBkZWZhdWx0SGFuZGxlciwgY3VzdG9tSGFuZGxlcktleSwgcGFzc2l2ZSA9IHRydWUpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHBsYXllclxuICAgICAgICB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgY3VzdG9tSGFuZGxlciA9IHBsYXllci5jb25maWcubGlzdGVuZXJzW2N1c3RvbUhhbmRsZXJLZXldO1xuICAgICAgICBjb25zdCBoYXNDdXN0b21IYW5kbGVyID0gaXMuZnVuY3Rpb24oY3VzdG9tSGFuZGxlcik7XG4gICAgICAgIG9uLmNhbGwocGxheWVyLCBlbGVtZW50LCB0eXBlLCBldmVudCA9PiB0aGlzLnByb3h5KGV2ZW50LCBkZWZhdWx0SGFuZGxlciwgY3VzdG9tSGFuZGxlcktleSksIHBhc3NpdmUgJiYgIWhhc0N1c3RvbUhhbmRsZXIpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiY29udHJvbHNcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgcGxheWVyXG4gICAgICAgIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgZWxlbWVudHNcbiAgICAgICAgfSA9IHBsYXllcjsgLy8gSUUgZG9lc24ndCBzdXBwb3J0IGlucHV0IGV2ZW50LCBzbyB3ZSBmYWxsYmFjayB0byBjaGFuZ2VcblxuICAgICAgICBjb25zdCBpbnB1dEV2ZW50ID0gYnJvd3Nlci5pc0lFID8gJ2NoYW5nZScgOiAnaW5wdXQnOyAvLyBQbGF5L3BhdXNlIHRvZ2dsZVxuXG4gICAgICAgIGlmIChlbGVtZW50cy5idXR0b25zLnBsYXkpIHtcbiAgICAgICAgICBBcnJheS5mcm9tKGVsZW1lbnRzLmJ1dHRvbnMucGxheSkuZm9yRWFjaChidXR0b24gPT4ge1xuICAgICAgICAgICAgdGhpcy5iaW5kKGJ1dHRvbiwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICBzaWxlbmNlUHJvbWlzZShwbGF5ZXIudG9nZ2xlUGxheSgpKTtcbiAgICAgICAgICAgIH0sICdwbGF5Jyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gLy8gUGF1c2VcblxuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5idXR0b25zLnJlc3RhcnQsICdjbGljaycsIHBsYXllci5yZXN0YXJ0LCAncmVzdGFydCcpOyAvLyBSZXdpbmRcblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuYnV0dG9ucy5yZXdpbmQsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAvLyBSZWNvcmQgc2VlayB0aW1lIHNvIHdlIGNhbiBwcmV2ZW50IGhpZGluZyBjb250cm9scyBmb3IgYSBmZXcgc2Vjb25kcyBhZnRlciByZXdpbmRcbiAgICAgICAgICBwbGF5ZXIubGFzdFNlZWtUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICBwbGF5ZXIucmV3aW5kKCk7XG4gICAgICAgIH0sICdyZXdpbmQnKTsgLy8gUmV3aW5kXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmJ1dHRvbnMuZmFzdEZvcndhcmQsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAvLyBSZWNvcmQgc2VlayB0aW1lIHNvIHdlIGNhbiBwcmV2ZW50IGhpZGluZyBjb250cm9scyBmb3IgYSBmZXcgc2Vjb25kcyBhZnRlciBmYXN0IGZvcndhcmRcbiAgICAgICAgICBwbGF5ZXIubGFzdFNlZWtUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICBwbGF5ZXIuZm9yd2FyZCgpO1xuICAgICAgICB9LCAnZmFzdEZvcndhcmQnKTsgLy8gTXV0ZSB0b2dnbGVcblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuYnV0dG9ucy5tdXRlLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgcGxheWVyLm11dGVkID0gIXBsYXllci5tdXRlZDtcbiAgICAgICAgfSwgJ211dGUnKTsgLy8gQ2FwdGlvbnMgdG9nZ2xlXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmJ1dHRvbnMuY2FwdGlvbnMsICdjbGljaycsICgpID0+IHBsYXllci50b2dnbGVDYXB0aW9ucygpKTsgLy8gRG93bmxvYWRcblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuYnV0dG9ucy5kb3dubG9hZCwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZG93bmxvYWQnKTtcbiAgICAgICAgfSwgJ2Rvd25sb2FkJyk7IC8vIEZ1bGxzY3JlZW4gdG9nZ2xlXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmJ1dHRvbnMuZnVsbHNjcmVlbiwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgIHBsYXllci5mdWxsc2NyZWVuLnRvZ2dsZSgpO1xuICAgICAgICB9LCAnZnVsbHNjcmVlbicpOyAvLyBQaWN0dXJlLWluLVBpY3R1cmVcblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuYnV0dG9ucy5waXAsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgICBwbGF5ZXIucGlwID0gJ3RvZ2dsZSc7XG4gICAgICAgIH0sICdwaXAnKTsgLy8gQWlycGxheVxuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5idXR0b25zLmFpcnBsYXksICdjbGljaycsIHBsYXllci5haXJwbGF5LCAnYWlycGxheScpOyAvLyBTZXR0aW5ncyBtZW51IC0gY2xpY2sgdG9nZ2xlXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmJ1dHRvbnMuc2V0dGluZ3MsICdjbGljaycsIGV2ZW50ID0+IHtcbiAgICAgICAgICAvLyBQcmV2ZW50IHRoZSBkb2N1bWVudCBjbGljayBsaXN0ZW5lciBjbG9zaW5nIHRoZSBtZW51XG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBjb250cm9scy50b2dnbGVNZW51LmNhbGwocGxheWVyLCBldmVudCk7XG4gICAgICAgIH0sIG51bGwsIGZhbHNlKTsgLy8gQ2FuJ3QgYmUgcGFzc2l2ZSBhcyB3ZSdyZSBwcmV2ZW50aW5nIGRlZmF1bHRcbiAgICAgICAgLy8gU2V0dGluZ3MgbWVudSAtIGtleWJvYXJkIHRvZ2dsZVxuICAgICAgICAvLyBXZSBoYXZlIHRvIGJpbmQgdG8ga2V5dXAgb3RoZXJ3aXNlIEZpcmVmb3ggdHJpZ2dlcnMgYSBjbGljayB3aGVuIGEga2V5ZG93biBldmVudCBoYW5kbGVyIHNoaWZ0cyBmb2N1c1xuICAgICAgICAvLyBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD0xMjIwMTQzXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmJ1dHRvbnMuc2V0dGluZ3MsICdrZXl1cCcsIGV2ZW50ID0+IHtcbiAgICAgICAgICBpZiAoIVsnU3BhY2UnLCAnRW50ZXInXS5pbmNsdWRlcyhldmVudC5rZXkpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSAvLyBCZWNhdXNlIHJldHVybiB0cmlnZ2VycyBhIGNsaWNrIGFueXdheSwgYWxsIHdlIG5lZWQgdG8gZG8gaXMgc2V0IGZvY3VzXG5cblxuICAgICAgICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicpIHtcbiAgICAgICAgICAgIGNvbnRyb2xzLmZvY3VzRmlyc3RNZW51SXRlbS5jYWxsKHBsYXllciwgbnVsbCwgdHJ1ZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSAvLyBQcmV2ZW50IHNjcm9sbFxuXG5cbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAvLyBQcmV2ZW50IHBsYXlpbmcgdmlkZW8gKEZpcmVmb3gpXG5cbiAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsgLy8gVG9nZ2xlIG1lbnVcblxuICAgICAgICAgIGNvbnRyb2xzLnRvZ2dsZU1lbnUuY2FsbChwbGF5ZXIsIGV2ZW50KTtcbiAgICAgICAgfSwgbnVsbCwgZmFsc2UgLy8gQ2FuJ3QgYmUgcGFzc2l2ZSBhcyB3ZSdyZSBwcmV2ZW50aW5nIGRlZmF1bHRcbiAgICAgICAgKTsgLy8gRXNjYXBlIGNsb3NlcyBtZW51XG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLnNldHRpbmdzLm1lbnUsICdrZXlkb3duJywgZXZlbnQgPT4ge1xuICAgICAgICAgIGlmIChldmVudC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICBjb250cm9scy50b2dnbGVNZW51LmNhbGwocGxheWVyLCBldmVudCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTsgLy8gU2V0IHJhbmdlIGlucHV0IGFsdGVybmF0aXZlIFwidmFsdWVcIiwgd2hpY2ggbWF0Y2hlcyB0aGUgdG9vbHRpcCB0aW1lICgjOTU0KVxuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5pbnB1dHMuc2VlaywgJ21vdXNlZG93biBtb3VzZW1vdmUnLCBldmVudCA9PiB7XG4gICAgICAgICAgY29uc3QgcmVjdCA9IGVsZW1lbnRzLnByb2dyZXNzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgIGNvbnN0IHBlcmNlbnQgPSAxMDAgLyByZWN0LndpZHRoICogKGV2ZW50LnBhZ2VYIC0gcmVjdC5sZWZ0KTtcbiAgICAgICAgICBldmVudC5jdXJyZW50VGFyZ2V0LnNldEF0dHJpYnV0ZSgnc2Vlay12YWx1ZScsIHBlcmNlbnQpO1xuICAgICAgICB9KTsgLy8gUGF1c2Ugd2hpbGUgc2Vla2luZ1xuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5pbnB1dHMuc2VlaywgJ21vdXNlZG93biBtb3VzZXVwIGtleWRvd24ga2V5dXAgdG91Y2hzdGFydCB0b3VjaGVuZCcsIGV2ZW50ID0+IHtcbiAgICAgICAgICBjb25zdCBzZWVrID0gZXZlbnQuY3VycmVudFRhcmdldDtcbiAgICAgICAgICBjb25zdCBhdHRyaWJ1dGUgPSAncGxheS1vbi1zZWVrZWQnO1xuXG4gICAgICAgICAgaWYgKGlzLmtleWJvYXJkRXZlbnQoZXZlbnQpICYmICFbJ0Fycm93TGVmdCcsICdBcnJvd1JpZ2h0J10uaW5jbHVkZXMoZXZlbnQua2V5KSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gLy8gUmVjb3JkIHNlZWsgdGltZSBzbyB3ZSBjYW4gcHJldmVudCBoaWRpbmcgY29udHJvbHMgZm9yIGEgZmV3IHNlY29uZHMgYWZ0ZXIgc2Vla1xuXG5cbiAgICAgICAgICBwbGF5ZXIubGFzdFNlZWtUaW1lID0gRGF0ZS5ub3coKTsgLy8gV2FzIHBsYXlpbmcgYmVmb3JlP1xuXG4gICAgICAgICAgY29uc3QgcGxheSA9IHNlZWsuaGFzQXR0cmlidXRlKGF0dHJpYnV0ZSk7IC8vIERvbmUgc2Vla2luZ1xuXG4gICAgICAgICAgY29uc3QgZG9uZSA9IFsnbW91c2V1cCcsICd0b3VjaGVuZCcsICdrZXl1cCddLmluY2x1ZGVzKGV2ZW50LnR5cGUpOyAvLyBJZiB3ZSdyZSBkb25lIHNlZWtpbmcgYW5kIGl0IHdhcyBwbGF5aW5nLCByZXN1bWUgcGxheWJhY2tcblxuICAgICAgICAgIGlmIChwbGF5ICYmIGRvbmUpIHtcbiAgICAgICAgICAgIHNlZWsucmVtb3ZlQXR0cmlidXRlKGF0dHJpYnV0ZSk7XG4gICAgICAgICAgICBzaWxlbmNlUHJvbWlzZShwbGF5ZXIucGxheSgpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKCFkb25lICYmIHBsYXllci5wbGF5aW5nKSB7XG4gICAgICAgICAgICBzZWVrLnNldEF0dHJpYnV0ZShhdHRyaWJ1dGUsICcnKTtcbiAgICAgICAgICAgIHBsYXllci5wYXVzZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7IC8vIEZpeCByYW5nZSBpbnB1dHMgb24gaU9TXG4gICAgICAgIC8vIFN1cGVyIHdlaXJkIGlPUyBidWcgd2hlcmUgYWZ0ZXIgeW91IGludGVyYWN0IHdpdGggYW4gPGlucHV0IHR5cGU9XCJyYW5nZVwiPixcbiAgICAgICAgLy8gaXQgdGFrZXMgb3ZlciBmdXJ0aGVyIGludGVyYWN0aW9ucyBvbiB0aGUgcGFnZS4gVGhpcyBpcyBhIGhhY2tcblxuICAgICAgICBpZiAoYnJvd3Nlci5pc0lvcykge1xuICAgICAgICAgIGNvbnN0IGlucHV0cyA9IGdldEVsZW1lbnRzLmNhbGwocGxheWVyLCAnaW5wdXRbdHlwZT1cInJhbmdlXCJdJyk7XG4gICAgICAgICAgQXJyYXkuZnJvbShpbnB1dHMpLmZvckVhY2goaW5wdXQgPT4gdGhpcy5iaW5kKGlucHV0LCBpbnB1dEV2ZW50LCBldmVudCA9PiByZXBhaW50KGV2ZW50LnRhcmdldCkpKTtcbiAgICAgICAgfSAvLyBTZWVrXG5cblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuaW5wdXRzLnNlZWssIGlucHV0RXZlbnQsIGV2ZW50ID0+IHtcbiAgICAgICAgICBjb25zdCBzZWVrID0gZXZlbnQuY3VycmVudFRhcmdldDsgLy8gSWYgaXQgZXhpc3RzLCB1c2Ugc2Vlay12YWx1ZSBpbnN0ZWFkIG9mIFwidmFsdWVcIiBmb3IgY29uc2lzdGVuY3kgd2l0aCB0b29sdGlwIHRpbWUgKCM5NTQpXG5cbiAgICAgICAgICBsZXQgc2Vla1RvID0gc2Vlay5nZXRBdHRyaWJ1dGUoJ3NlZWstdmFsdWUnKTtcblxuICAgICAgICAgIGlmIChpcy5lbXB0eShzZWVrVG8pKSB7XG4gICAgICAgICAgICBzZWVrVG8gPSBzZWVrLnZhbHVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHNlZWsucmVtb3ZlQXR0cmlidXRlKCdzZWVrLXZhbHVlJyk7XG4gICAgICAgICAgcGxheWVyLmN1cnJlbnRUaW1lID0gc2Vla1RvIC8gc2Vlay5tYXggKiBwbGF5ZXIuZHVyYXRpb247XG4gICAgICAgIH0sICdzZWVrJyk7IC8vIFNlZWsgdG9vbHRpcFxuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5wcm9ncmVzcywgJ21vdXNlZW50ZXIgbW91c2VsZWF2ZSBtb3VzZW1vdmUnLCBldmVudCA9PiBjb250cm9scy51cGRhdGVTZWVrVG9vbHRpcC5jYWxsKHBsYXllciwgZXZlbnQpKTsgLy8gUHJldmlldyB0aHVtYm5haWxzIHBsdWdpblxuICAgICAgICAvLyBUT0RPOiBSZWFsbHkgbmVlZCB0byB3b3JrIG9uIHNvbWUgc29ydCBvZiBwbHVnLWluIHdpZGUgZXZlbnQgYnVzIG9yIHB1Yi1zdWIgZm9yIHRoaXNcblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMucHJvZ3Jlc3MsICdtb3VzZW1vdmUgdG91Y2htb3ZlJywgZXZlbnQgPT4ge1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIHByZXZpZXdUaHVtYm5haWxzXG4gICAgICAgICAgfSA9IHBsYXllcjtcblxuICAgICAgICAgIGlmIChwcmV2aWV3VGh1bWJuYWlscyAmJiBwcmV2aWV3VGh1bWJuYWlscy5sb2FkZWQpIHtcbiAgICAgICAgICAgIHByZXZpZXdUaHVtYm5haWxzLnN0YXJ0TW92ZShldmVudCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTsgLy8gSGlkZSB0aHVtYm5haWwgcHJldmlldyAtIG9uIG1vdXNlIGNsaWNrLCBtb3VzZSBsZWF2ZSwgYW5kIHZpZGVvIHBsYXkvc2Vlay4gQWxsIGZvdXIgYXJlIHJlcXVpcmVkLCBlLmcuLCBmb3IgYnVmZmVyaW5nXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLnByb2dyZXNzLCAnbW91c2VsZWF2ZSB0b3VjaGVuZCBjbGljaycsICgpID0+IHtcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBwcmV2aWV3VGh1bWJuYWlsc1xuICAgICAgICAgIH0gPSBwbGF5ZXI7XG5cbiAgICAgICAgICBpZiAocHJldmlld1RodW1ibmFpbHMgJiYgcHJldmlld1RodW1ibmFpbHMubG9hZGVkKSB7XG4gICAgICAgICAgICBwcmV2aWV3VGh1bWJuYWlscy5lbmRNb3ZlKGZhbHNlLCB0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pOyAvLyBTaG93IHNjcnViYmluZyBwcmV2aWV3XG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLnByb2dyZXNzLCAnbW91c2Vkb3duIHRvdWNoc3RhcnQnLCBldmVudCA9PiB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgcHJldmlld1RodW1ibmFpbHNcbiAgICAgICAgICB9ID0gcGxheWVyO1xuXG4gICAgICAgICAgaWYgKHByZXZpZXdUaHVtYm5haWxzICYmIHByZXZpZXdUaHVtYm5haWxzLmxvYWRlZCkge1xuICAgICAgICAgICAgcHJldmlld1RodW1ibmFpbHMuc3RhcnRTY3J1YmJpbmcoZXZlbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5wcm9ncmVzcywgJ21vdXNldXAgdG91Y2hlbmQnLCBldmVudCA9PiB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgcHJldmlld1RodW1ibmFpbHNcbiAgICAgICAgICB9ID0gcGxheWVyO1xuXG4gICAgICAgICAgaWYgKHByZXZpZXdUaHVtYm5haWxzICYmIHByZXZpZXdUaHVtYm5haWxzLmxvYWRlZCkge1xuICAgICAgICAgICAgcHJldmlld1RodW1ibmFpbHMuZW5kU2NydWJiaW5nKGV2ZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pOyAvLyBQb2x5ZmlsbCBmb3IgbG93ZXIgZmlsbCBpbiA8aW5wdXQgdHlwZT1cInJhbmdlXCI+IGZvciB3ZWJraXRcblxuICAgICAgICBpZiAoYnJvd3Nlci5pc1dlYmtpdCkge1xuICAgICAgICAgIEFycmF5LmZyb20oZ2V0RWxlbWVudHMuY2FsbChwbGF5ZXIsICdpbnB1dFt0eXBlPVwicmFuZ2VcIl0nKSkuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgICAgICAgIHRoaXMuYmluZChlbGVtZW50LCAnaW5wdXQnLCBldmVudCA9PiBjb250cm9scy51cGRhdGVSYW5nZUZpbGwuY2FsbChwbGF5ZXIsIGV2ZW50LnRhcmdldCkpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IC8vIEN1cnJlbnQgdGltZSBpbnZlcnRcbiAgICAgICAgLy8gT25seSBpZiBvbmUgdGltZSBlbGVtZW50IGlzIHVzZWQgZm9yIGJvdGggY3VycmVudFRpbWUgYW5kIGR1cmF0aW9uXG5cblxuICAgICAgICBpZiAocGxheWVyLmNvbmZpZy50b2dnbGVJbnZlcnQgJiYgIWlzLmVsZW1lbnQoZWxlbWVudHMuZGlzcGxheS5kdXJhdGlvbikpIHtcbiAgICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuZGlzcGxheS5jdXJyZW50VGltZSwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgLy8gRG8gbm90aGluZyBpZiB3ZSdyZSBhdCB0aGUgc3RhcnRcbiAgICAgICAgICAgIGlmIChwbGF5ZXIuY3VycmVudFRpbWUgPT09IDApIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwbGF5ZXIuY29uZmlnLmludmVydFRpbWUgPSAhcGxheWVyLmNvbmZpZy5pbnZlcnRUaW1lO1xuICAgICAgICAgICAgY29udHJvbHMudGltZVVwZGF0ZS5jYWxsKHBsYXllcik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gLy8gVm9sdW1lXG5cblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuaW5wdXRzLnZvbHVtZSwgaW5wdXRFdmVudCwgZXZlbnQgPT4ge1xuICAgICAgICAgIHBsYXllci52b2x1bWUgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgICAgIH0sICd2b2x1bWUnKTsgLy8gVXBkYXRlIGNvbnRyb2xzLmhvdmVyIHN0YXRlICh1c2VkIGZvciB1aS50b2dnbGVDb250cm9scyB0byBhdm9pZCBoaWRpbmcgd2hlbiBpbnRlcmFjdGluZylcblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuY29udHJvbHMsICdtb3VzZWVudGVyIG1vdXNlbGVhdmUnLCBldmVudCA9PiB7XG4gICAgICAgICAgZWxlbWVudHMuY29udHJvbHMuaG92ZXIgPSAhcGxheWVyLnRvdWNoICYmIGV2ZW50LnR5cGUgPT09ICdtb3VzZWVudGVyJztcbiAgICAgICAgfSk7IC8vIEFsc28gdXBkYXRlIGNvbnRyb2xzLmhvdmVyIHN0YXRlIGZvciBhbnkgbm9uLXBsYXllciBjaGlsZHJlbiBvZiBmdWxsc2NyZWVuIGVsZW1lbnQgKGFzIGFib3ZlKVxuXG4gICAgICAgIGlmIChlbGVtZW50cy5mdWxsc2NyZWVuKSB7XG4gICAgICAgICAgQXJyYXkuZnJvbShlbGVtZW50cy5mdWxsc2NyZWVuLmNoaWxkcmVuKS5maWx0ZXIoYyA9PiAhYy5jb250YWlucyhlbGVtZW50cy5jb250YWluZXIpKS5mb3JFYWNoKGNoaWxkID0+IHtcbiAgICAgICAgICAgIHRoaXMuYmluZChjaGlsZCwgJ21vdXNlZW50ZXIgbW91c2VsZWF2ZScsIGV2ZW50ID0+IHtcbiAgICAgICAgICAgICAgaWYgKGVsZW1lbnRzLmNvbnRyb2xzKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudHMuY29udHJvbHMuaG92ZXIgPSAhcGxheWVyLnRvdWNoICYmIGV2ZW50LnR5cGUgPT09ICdtb3VzZWVudGVyJztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gLy8gVXBkYXRlIGNvbnRyb2xzLnByZXNzZWQgc3RhdGUgKHVzZWQgZm9yIHVpLnRvZ2dsZUNvbnRyb2xzIHRvIGF2b2lkIGhpZGluZyB3aGVuIGludGVyYWN0aW5nKVxuXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmNvbnRyb2xzLCAnbW91c2Vkb3duIG1vdXNldXAgdG91Y2hzdGFydCB0b3VjaGVuZCB0b3VjaGNhbmNlbCcsIGV2ZW50ID0+IHtcbiAgICAgICAgICBlbGVtZW50cy5jb250cm9scy5wcmVzc2VkID0gWydtb3VzZWRvd24nLCAndG91Y2hzdGFydCddLmluY2x1ZGVzKGV2ZW50LnR5cGUpO1xuICAgICAgICB9KTsgLy8gU2hvdyBjb250cm9scyB3aGVuIHRoZXkgcmVjZWl2ZSBmb2N1cyAoZS5nLiwgd2hlbiB1c2luZyBrZXlib2FyZCB0YWIga2V5KVxuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5jb250cm9scywgJ2ZvY3VzaW4nLCAoKSA9PiB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgY29uZmlnLFxuICAgICAgICAgICAgdGltZXJzXG4gICAgICAgICAgfSA9IHBsYXllcjsgLy8gU2tpcCB0cmFuc2l0aW9uIHRvIHByZXZlbnQgZm9jdXMgZnJvbSBzY3JvbGxpbmcgdGhlIHBhcmVudCBlbGVtZW50XG5cbiAgICAgICAgICB0b2dnbGVDbGFzcyhlbGVtZW50cy5jb250cm9scywgY29uZmlnLmNsYXNzTmFtZXMubm9UcmFuc2l0aW9uLCB0cnVlKTsgLy8gVG9nZ2xlXG5cbiAgICAgICAgICB1aS50b2dnbGVDb250cm9scy5jYWxsKHBsYXllciwgdHJ1ZSk7IC8vIFJlc3RvcmUgdHJhbnNpdGlvblxuXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0b2dnbGVDbGFzcyhlbGVtZW50cy5jb250cm9scywgY29uZmlnLmNsYXNzTmFtZXMubm9UcmFuc2l0aW9uLCBmYWxzZSk7XG4gICAgICAgICAgfSwgMCk7IC8vIERlbGF5IGEgbGl0dGxlIG1vcmUgZm9yIG1vdXNlIHVzZXJzXG5cbiAgICAgICAgICBjb25zdCBkZWxheSA9IHRoaXMudG91Y2ggPyAzMDAwIDogNDAwMDsgLy8gQ2xlYXIgdGltZXJcblxuICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcnMuY29udHJvbHMpOyAvLyBIaWRlIGFnYWluIGFmdGVyIGRlbGF5XG5cbiAgICAgICAgICB0aW1lcnMuY29udHJvbHMgPSBzZXRUaW1lb3V0KCgpID0+IHVpLnRvZ2dsZUNvbnRyb2xzLmNhbGwocGxheWVyLCBmYWxzZSksIGRlbGF5KTtcbiAgICAgICAgfSk7IC8vIE1vdXNlIHdoZWVsIGZvciB2b2x1bWVcblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuaW5wdXRzLnZvbHVtZSwgJ3doZWVsJywgZXZlbnQgPT4ge1xuICAgICAgICAgIC8vIERldGVjdCBcIm5hdHVyYWxcIiBzY3JvbGwgLSBzdXBwb3J0ZWQgb24gT1MgWCBTYWZhcmkgb25seVxuICAgICAgICAgIC8vIE90aGVyIGJyb3dzZXJzIG9uIE9TIFggd2lsbCBiZSBpbnZlcnRlZCB1bnRpbCBzdXBwb3J0IGltcHJvdmVzXG4gICAgICAgICAgY29uc3QgaW52ZXJ0ZWQgPSBldmVudC53ZWJraXREaXJlY3Rpb25JbnZlcnRlZEZyb21EZXZpY2U7IC8vIEdldCBkZWx0YSBmcm9tIGV2ZW50LiBJbnZlcnQgaWYgYGludmVydGVkYCBpcyB0cnVlXG5cbiAgICAgICAgICBjb25zdCBbeCwgeV0gPSBbZXZlbnQuZGVsdGFYLCAtZXZlbnQuZGVsdGFZXS5tYXAodmFsdWUgPT4gaW52ZXJ0ZWQgPyAtdmFsdWUgOiB2YWx1ZSk7IC8vIFVzaW5nIHRoZSBiaWdnZXN0IGRlbHRhLCBub3JtYWxpemUgdG8gMSBvciAtMSAob3IgMCBpZiBubyBkZWx0YSlcblxuICAgICAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IE1hdGguc2lnbihNYXRoLmFicyh4KSA+IE1hdGguYWJzKHkpID8geCA6IHkpOyAvLyBDaGFuZ2UgdGhlIHZvbHVtZSBieSAyJVxuXG4gICAgICAgICAgcGxheWVyLmluY3JlYXNlVm9sdW1lKGRpcmVjdGlvbiAvIDUwKTsgLy8gRG9uJ3QgYnJlYWsgcGFnZSBzY3JvbGxpbmcgYXQgbWF4IGFuZCBtaW5cblxuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIHZvbHVtZVxuICAgICAgICAgIH0gPSBwbGF5ZXIubWVkaWE7XG5cbiAgICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAxICYmIHZvbHVtZSA8IDEgfHwgZGlyZWN0aW9uID09PSAtMSAmJiB2b2x1bWUgPiAwKSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgJ3ZvbHVtZScsIGZhbHNlKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLnBsYXllciA9IF9wbGF5ZXI7XG4gICAgICB0aGlzLmxhc3RLZXkgPSBudWxsO1xuICAgICAgdGhpcy5mb2N1c1RpbWVyID0gbnVsbDtcbiAgICAgIHRoaXMubGFzdEtleURvd24gPSBudWxsO1xuICAgICAgdGhpcy5oYW5kbGVLZXkgPSB0aGlzLmhhbmRsZUtleS5iaW5kKHRoaXMpO1xuICAgICAgdGhpcy50b2dnbGVNZW51ID0gdGhpcy50b2dnbGVNZW51LmJpbmQodGhpcyk7XG4gICAgICB0aGlzLnNldFRhYkZvY3VzID0gdGhpcy5zZXRUYWJGb2N1cy5iaW5kKHRoaXMpO1xuICAgICAgdGhpcy5maXJzdFRvdWNoID0gdGhpcy5maXJzdFRvdWNoLmJpbmQodGhpcyk7XG4gICAgfSAvLyBIYW5kbGUga2V5IHByZXNzZXNcblxuXG4gICAgaGFuZGxlS2V5KGV2ZW50KSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHBsYXllclxuICAgICAgfSA9IHRoaXM7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGVsZW1lbnRzXG4gICAgICB9ID0gcGxheWVyO1xuICAgICAgY29uc3Qge1xuICAgICAgICBrZXksXG4gICAgICAgIHR5cGUsXG4gICAgICAgIGFsdEtleSxcbiAgICAgICAgY3RybEtleSxcbiAgICAgICAgbWV0YUtleSxcbiAgICAgICAgc2hpZnRLZXlcbiAgICAgIH0gPSBldmVudDtcbiAgICAgIGNvbnN0IHByZXNzZWQgPSB0eXBlID09PSAna2V5ZG93bic7XG4gICAgICBjb25zdCByZXBlYXQgPSBwcmVzc2VkICYmIGtleSA9PT0gdGhpcy5sYXN0S2V5OyAvLyBCYWlsIGlmIGEgbW9kaWZpZXIga2V5IGlzIHNldFxuXG4gICAgICBpZiAoYWx0S2V5IHx8IGN0cmxLZXkgfHwgbWV0YUtleSB8fCBzaGlmdEtleSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIElmIHRoZSBldmVudCBpcyBidWJibGVkIGZyb20gdGhlIG1lZGlhIGVsZW1lbnRcbiAgICAgIC8vIEZpcmVmb3ggZG9lc24ndCBnZXQgdGhlIGtleSBmb3Igd2hhdGV2ZXIgcmVhc29uXG5cblxuICAgICAgaWYgKCFrZXkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBTZWVrIGJ5IGluY3JlbWVudFxuXG5cbiAgICAgIGNvbnN0IHNlZWtCeUluY3JlbWVudCA9IGluY3JlbWVudCA9PiB7XG4gICAgICAgIC8vIERpdmlkZSB0aGUgbWF4IGR1cmF0aW9uIGludG8gMTB0aCdzIGFuZCB0aW1lcyBieSB0aGUgbnVtYmVyIHZhbHVlXG4gICAgICAgIHBsYXllci5jdXJyZW50VGltZSA9IHBsYXllci5kdXJhdGlvbiAvIDEwICogaW5jcmVtZW50O1xuICAgICAgfTsgLy8gSGFuZGxlIHRoZSBrZXkgb24ga2V5ZG93blxuICAgICAgLy8gUmVzZXQgb24ga2V5dXBcblxuXG4gICAgICBpZiAocHJlc3NlZCkge1xuICAgICAgICAvLyBDaGVjayBmb2N1c2VkIGVsZW1lbnRcbiAgICAgICAgLy8gYW5kIGlmIHRoZSBmb2N1c2VkIGVsZW1lbnQgaXMgbm90IGVkaXRhYmxlIChlLmcuIHRleHQgaW5wdXQpXG4gICAgICAgIC8vIGFuZCBhbnkgdGhhdCBhY2NlcHQga2V5IGlucHV0IGh0dHA6Ly93ZWJhaW0ub3JnL3RlY2huaXF1ZXMva2V5Ym9hcmQvXG4gICAgICAgIGNvbnN0IGZvY3VzZWQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuXG4gICAgICAgIGlmIChpcy5lbGVtZW50KGZvY3VzZWQpKSB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgZWRpdGFibGVcbiAgICAgICAgICB9ID0gcGxheWVyLmNvbmZpZy5zZWxlY3RvcnM7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgc2Vla1xuICAgICAgICAgIH0gPSBlbGVtZW50cy5pbnB1dHM7XG5cbiAgICAgICAgICBpZiAoZm9jdXNlZCAhPT0gc2VlayAmJiBtYXRjaGVzKGZvY3VzZWQsIGVkaXRhYmxlKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChldmVudC5rZXkgPT09ICdTcGFjZScgJiYgbWF0Y2hlcyhmb2N1c2VkLCAnYnV0dG9uLCBbcm9sZV49XCJtZW51aXRlbVwiXScpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9IC8vIFdoaWNoIGtleXMgc2hvdWxkIHdlIHByZXZlbnQgZGVmYXVsdFxuXG5cbiAgICAgICAgY29uc3QgcHJldmVudERlZmF1bHQgPSBbJ1NwYWNlJywgJ0Fycm93TGVmdCcsICdBcnJvd1VwJywgJ0Fycm93UmlnaHQnLCAnQXJyb3dEb3duJywgJzAnLCAnMScsICcyJywgJzMnLCAnNCcsICc1JywgJzYnLCAnNycsICc4JywgJzknLCAnYycsICdmJywgJ2snLCAnbCcsICdtJ107IC8vIElmIHRoZSBrZXkgaXMgZm91bmQgcHJldmVudCBkZWZhdWx0IChlLmcuIHByZXZlbnQgc2Nyb2xsaW5nIGZvciBhcnJvd3MpXG5cbiAgICAgICAgaWYgKHByZXZlbnREZWZhdWx0LmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3dpdGNoIChrZXkpIHtcbiAgICAgICAgICBjYXNlICcwJzpcbiAgICAgICAgICBjYXNlICcxJzpcbiAgICAgICAgICBjYXNlICcyJzpcbiAgICAgICAgICBjYXNlICczJzpcbiAgICAgICAgICBjYXNlICc0JzpcbiAgICAgICAgICBjYXNlICc1JzpcbiAgICAgICAgICBjYXNlICc2JzpcbiAgICAgICAgICBjYXNlICc3JzpcbiAgICAgICAgICBjYXNlICc4JzpcbiAgICAgICAgICBjYXNlICc5JzpcbiAgICAgICAgICAgIGlmICghcmVwZWF0KSB7XG4gICAgICAgICAgICAgIHNlZWtCeUluY3JlbWVudChwYXJzZUludChrZXksIDEwKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnU3BhY2UnOlxuICAgICAgICAgIGNhc2UgJ2snOlxuICAgICAgICAgICAgaWYgKCFyZXBlYXQpIHtcbiAgICAgICAgICAgICAgc2lsZW5jZVByb21pc2UocGxheWVyLnRvZ2dsZVBsYXkoKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnQXJyb3dVcCc6XG4gICAgICAgICAgICBwbGF5ZXIuaW5jcmVhc2VWb2x1bWUoMC4xKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnQXJyb3dEb3duJzpcbiAgICAgICAgICAgIHBsYXllci5kZWNyZWFzZVZvbHVtZSgwLjEpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlICdtJzpcbiAgICAgICAgICAgIGlmICghcmVwZWF0KSB7XG4gICAgICAgICAgICAgIHBsYXllci5tdXRlZCA9ICFwbGF5ZXIubXV0ZWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnQXJyb3dSaWdodCc6XG4gICAgICAgICAgICBwbGF5ZXIuZm9yd2FyZCgpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlICdBcnJvd0xlZnQnOlxuICAgICAgICAgICAgcGxheWVyLnJld2luZCgpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlICdmJzpcbiAgICAgICAgICAgIHBsYXllci5mdWxsc2NyZWVuLnRvZ2dsZSgpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlICdjJzpcbiAgICAgICAgICAgIGlmICghcmVwZWF0KSB7XG4gICAgICAgICAgICAgIHBsYXllci50b2dnbGVDYXB0aW9ucygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgJ2wnOlxuICAgICAgICAgICAgcGxheWVyLmxvb3AgPSAhcGxheWVyLmxvb3A7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfSAvLyBFc2NhcGUgaXMgaGFuZGxlIG5hdGl2ZWx5IHdoZW4gaW4gZnVsbCBzY3JlZW5cbiAgICAgICAgLy8gU28gd2Ugb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IG5vbiBuYXRpdmVcblxuXG4gICAgICAgIGlmIChrZXkgPT09ICdFc2NhcGUnICYmICFwbGF5ZXIuZnVsbHNjcmVlbi51c2luZ05hdGl2ZSAmJiBwbGF5ZXIuZnVsbHNjcmVlbi5hY3RpdmUpIHtcbiAgICAgICAgICBwbGF5ZXIuZnVsbHNjcmVlbi50b2dnbGUoKTtcbiAgICAgICAgfSAvLyBTdG9yZSBsYXN0IGtleSBmb3IgbmV4dCBjeWNsZVxuXG5cbiAgICAgICAgdGhpcy5sYXN0S2V5ID0ga2V5O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5sYXN0S2V5ID0gbnVsbDtcbiAgICAgIH1cbiAgICB9IC8vIFRvZ2dsZSBtZW51XG5cblxuICAgIHRvZ2dsZU1lbnUoZXZlbnQpIHtcbiAgICAgIGNvbnRyb2xzLnRvZ2dsZU1lbnUuY2FsbCh0aGlzLnBsYXllciwgZXZlbnQpO1xuICAgIH0gLy8gRGV2aWNlIGlzIHRvdWNoIGVuYWJsZWRcblxuXG4gIH1cblxuICB2YXIgY29tbW9uanNHbG9iYWwgPSB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWxUaGlzIDogdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB7fTtcblxuICBmdW5jdGlvbiBjcmVhdGVDb21tb25qc01vZHVsZShmbiwgbW9kdWxlKSB7XG4gIFx0cmV0dXJuIG1vZHVsZSA9IHsgZXhwb3J0czoge30gfSwgZm4obW9kdWxlLCBtb2R1bGUuZXhwb3J0cyksIG1vZHVsZS5leHBvcnRzO1xuICB9XG5cbiAgdmFyIGxvYWRqc191bWQgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG4gICAgKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XG4gICAgICB7XG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICAgICAgfVxuICAgIH0pKGNvbW1vbmpzR2xvYmFsLCBmdW5jdGlvbiAoKSB7XG4gICAgICAvKipcbiAgICAgICAqIEdsb2JhbCBkZXBlbmRlbmNpZXMuXG4gICAgICAgKiBAZ2xvYmFsIHtPYmplY3R9IGRvY3VtZW50IC0gRE9NXG4gICAgICAgKi9cbiAgICAgIHZhciBkZXZudWxsID0gZnVuY3Rpb24gKCkge30sXG4gICAgICAgICAgYnVuZGxlSWRDYWNoZSA9IHt9LFxuICAgICAgICAgIGJ1bmRsZVJlc3VsdENhY2hlID0ge30sXG4gICAgICAgICAgYnVuZGxlQ2FsbGJhY2tRdWV1ZSA9IHt9O1xuICAgICAgLyoqXG4gICAgICAgKiBTdWJzY3JpYmUgdG8gYnVuZGxlIGxvYWQgZXZlbnQuXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBidW5kbGVJZHMgLSBCdW5kbGUgaWRzXG4gICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja0ZuIC0gVGhlIGNhbGxiYWNrIGZ1bmN0aW9uXG4gICAgICAgKi9cblxuXG4gICAgICBmdW5jdGlvbiBzdWJzY3JpYmUoYnVuZGxlSWRzLCBjYWxsYmFja0ZuKSB7XG4gICAgICAgIC8vIGxpc3RpZnlcbiAgICAgICAgYnVuZGxlSWRzID0gYnVuZGxlSWRzLnB1c2ggPyBidW5kbGVJZHMgOiBbYnVuZGxlSWRzXTtcbiAgICAgICAgdmFyIGRlcHNOb3RGb3VuZCA9IFtdLFxuICAgICAgICAgICAgaSA9IGJ1bmRsZUlkcy5sZW5ndGgsXG4gICAgICAgICAgICBudW1XYWl0aW5nID0gaSxcbiAgICAgICAgICAgIGZuLFxuICAgICAgICAgICAgYnVuZGxlSWQsXG4gICAgICAgICAgICByLFxuICAgICAgICAgICAgcTsgLy8gZGVmaW5lIGNhbGxiYWNrIGZ1bmN0aW9uXG5cbiAgICAgICAgZm4gPSBmdW5jdGlvbiAoYnVuZGxlSWQsIHBhdGhzTm90Rm91bmQpIHtcbiAgICAgICAgICBpZiAocGF0aHNOb3RGb3VuZC5sZW5ndGgpIGRlcHNOb3RGb3VuZC5wdXNoKGJ1bmRsZUlkKTtcbiAgICAgICAgICBudW1XYWl0aW5nLS07XG4gICAgICAgICAgaWYgKCFudW1XYWl0aW5nKSBjYWxsYmFja0ZuKGRlcHNOb3RGb3VuZCk7XG4gICAgICAgIH07IC8vIHJlZ2lzdGVyIGNhbGxiYWNrXG5cblxuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgYnVuZGxlSWQgPSBidW5kbGVJZHNbaV07IC8vIGV4ZWN1dGUgY2FsbGJhY2sgaWYgaW4gcmVzdWx0IGNhY2hlXG5cbiAgICAgICAgICByID0gYnVuZGxlUmVzdWx0Q2FjaGVbYnVuZGxlSWRdO1xuXG4gICAgICAgICAgaWYgKHIpIHtcbiAgICAgICAgICAgIGZuKGJ1bmRsZUlkLCByKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH0gLy8gYWRkIHRvIGNhbGxiYWNrIHF1ZXVlXG5cblxuICAgICAgICAgIHEgPSBidW5kbGVDYWxsYmFja1F1ZXVlW2J1bmRsZUlkXSA9IGJ1bmRsZUNhbGxiYWNrUXVldWVbYnVuZGxlSWRdIHx8IFtdO1xuICAgICAgICAgIHEucHVzaChmbik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8qKlxuICAgICAgICogUHVibGlzaCBidW5kbGUgbG9hZCBldmVudC5cbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBidW5kbGVJZCAtIEJ1bmRsZSBpZFxuICAgICAgICogQHBhcmFtIHtzdHJpbmdbXX0gcGF0aHNOb3RGb3VuZCAtIExpc3Qgb2YgZmlsZXMgbm90IGZvdW5kXG4gICAgICAgKi9cblxuXG4gICAgICBmdW5jdGlvbiBwdWJsaXNoKGJ1bmRsZUlkLCBwYXRoc05vdEZvdW5kKSB7XG4gICAgICAgIC8vIGV4aXQgaWYgaWQgaXNuJ3QgZGVmaW5lZFxuICAgICAgICBpZiAoIWJ1bmRsZUlkKSByZXR1cm47XG4gICAgICAgIHZhciBxID0gYnVuZGxlQ2FsbGJhY2tRdWV1ZVtidW5kbGVJZF07IC8vIGNhY2hlIHJlc3VsdFxuXG4gICAgICAgIGJ1bmRsZVJlc3VsdENhY2hlW2J1bmRsZUlkXSA9IHBhdGhzTm90Rm91bmQ7IC8vIGV4aXQgaWYgcXVldWUgaXMgZW1wdHlcblxuICAgICAgICBpZiAoIXEpIHJldHVybjsgLy8gZW1wdHkgY2FsbGJhY2sgcXVldWVcblxuICAgICAgICB3aGlsZSAocS5sZW5ndGgpIHtcbiAgICAgICAgICBxWzBdKGJ1bmRsZUlkLCBwYXRoc05vdEZvdW5kKTtcbiAgICAgICAgICBxLnNwbGljZSgwLCAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLyoqXG4gICAgICAgKiBFeGVjdXRlIGNhbGxiYWNrcy5cbiAgICAgICAqIEBwYXJhbSB7T2JqZWN0IG9yIEZ1bmN0aW9ufSBhcmdzIC0gVGhlIGNhbGxiYWNrIGFyZ3NcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IGRlcHNOb3RGb3VuZCAtIExpc3Qgb2YgZGVwZW5kZW5jaWVzIG5vdCBmb3VuZFxuICAgICAgICovXG5cblxuICAgICAgZnVuY3Rpb24gZXhlY3V0ZUNhbGxiYWNrcyhhcmdzLCBkZXBzTm90Rm91bmQpIHtcbiAgICAgICAgLy8gYWNjZXB0IGZ1bmN0aW9uIGFzIGFyZ3VtZW50XG4gICAgICAgIGlmIChhcmdzLmNhbGwpIGFyZ3MgPSB7XG4gICAgICAgICAgc3VjY2VzczogYXJnc1xuICAgICAgICB9OyAvLyBzdWNjZXNzIGFuZCBlcnJvciBjYWxsYmFja3NcblxuICAgICAgICBpZiAoZGVwc05vdEZvdW5kLmxlbmd0aCkgKGFyZ3MuZXJyb3IgfHwgZGV2bnVsbCkoZGVwc05vdEZvdW5kKTtlbHNlIChhcmdzLnN1Y2Nlc3MgfHwgZGV2bnVsbCkoYXJncyk7XG4gICAgICB9XG4gICAgICAvKipcbiAgICAgICAqIExvYWQgaW5kaXZpZHVhbCBmaWxlLlxuICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHBhdGggLSBUaGUgZmlsZSBwYXRoXG4gICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja0ZuIC0gVGhlIGNhbGxiYWNrIGZ1bmN0aW9uXG4gICAgICAgKi9cblxuXG4gICAgICBmdW5jdGlvbiBsb2FkRmlsZShwYXRoLCBjYWxsYmFja0ZuLCBhcmdzLCBudW1Ucmllcykge1xuICAgICAgICB2YXIgZG9jID0gZG9jdW1lbnQsXG4gICAgICAgICAgICBhc3luYyA9IGFyZ3MuYXN5bmMsXG4gICAgICAgICAgICBtYXhUcmllcyA9IChhcmdzLm51bVJldHJpZXMgfHwgMCkgKyAxLFxuICAgICAgICAgICAgYmVmb3JlQ2FsbGJhY2tGbiA9IGFyZ3MuYmVmb3JlIHx8IGRldm51bGwsXG4gICAgICAgICAgICBwYXRobmFtZSA9IHBhdGgucmVwbGFjZSgvW1xcP3wjXS4qJC8sICcnKSxcbiAgICAgICAgICAgIHBhdGhTdHJpcHBlZCA9IHBhdGgucmVwbGFjZSgvXihjc3N8aW1nKSEvLCAnJyksXG4gICAgICAgICAgICBpc0xlZ2FjeUlFQ3NzLFxuICAgICAgICAgICAgZTtcbiAgICAgICAgbnVtVHJpZXMgPSBudW1UcmllcyB8fCAwO1xuXG4gICAgICAgIGlmICgvKF5jc3MhfFxcLmNzcyQpLy50ZXN0KHBhdGhuYW1lKSkge1xuICAgICAgICAgIC8vIGNzc1xuICAgICAgICAgIGUgPSBkb2MuY3JlYXRlRWxlbWVudCgnbGluaycpO1xuICAgICAgICAgIGUucmVsID0gJ3N0eWxlc2hlZXQnO1xuICAgICAgICAgIGUuaHJlZiA9IHBhdGhTdHJpcHBlZDsgLy8gdGFnIElFOStcblxuICAgICAgICAgIGlzTGVnYWN5SUVDc3MgPSAnaGlkZUZvY3VzJyBpbiBlOyAvLyB1c2UgcHJlbG9hZCBpbiBJRSBFZGdlICh0byBkZXRlY3QgbG9hZCBlcnJvcnMpXG5cbiAgICAgICAgICBpZiAoaXNMZWdhY3lJRUNzcyAmJiBlLnJlbExpc3QpIHtcbiAgICAgICAgICAgIGlzTGVnYWN5SUVDc3MgPSAwO1xuICAgICAgICAgICAgZS5yZWwgPSAncHJlbG9hZCc7XG4gICAgICAgICAgICBlLmFzID0gJ3N0eWxlJztcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoLyheaW1nIXxcXC4ocG5nfGdpZnxqcGd8c3ZnfHdlYnApJCkvLnRlc3QocGF0aG5hbWUpKSB7XG4gICAgICAgICAgLy8gaW1hZ2VcbiAgICAgICAgICBlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgICAgICAgIGUuc3JjID0gcGF0aFN0cmlwcGVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGphdmFzY3JpcHRcbiAgICAgICAgICBlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgICAgIGUuc3JjID0gcGF0aDtcbiAgICAgICAgICBlLmFzeW5jID0gYXN5bmMgPT09IHVuZGVmaW5lZCA/IHRydWUgOiBhc3luYztcbiAgICAgICAgfVxuXG4gICAgICAgIGUub25sb2FkID0gZS5vbmVycm9yID0gZS5vbmJlZm9yZWxvYWQgPSBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICB2YXIgcmVzdWx0ID0gZXYudHlwZVswXTsgLy8gdHJlYXQgZW1wdHkgc3R5bGVzaGVldHMgYXMgZmFpbHVyZXMgdG8gZ2V0IGFyb3VuZCBsYWNrIG9mIG9uZXJyb3JcbiAgICAgICAgICAvLyBzdXBwb3J0IGluIElFOS0xMVxuXG4gICAgICAgICAgaWYgKGlzTGVnYWN5SUVDc3MpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGlmICghZS5zaGVldC5jc3NUZXh0Lmxlbmd0aCkgcmVzdWx0ID0gJ2UnO1xuICAgICAgICAgICAgfSBjYXRjaCAoeCkge1xuICAgICAgICAgICAgICAvLyBzaGVldHMgb2JqZWN0cyBjcmVhdGVkIGZyb20gbG9hZCBlcnJvcnMgZG9uJ3QgYWxsb3cgYWNjZXNzIHRvXG4gICAgICAgICAgICAgIC8vIGBjc3NUZXh0YCAodW5sZXNzIGVycm9yIGlzIENvZGU6MTggU2VjdXJpdHlFcnJvcilcbiAgICAgICAgICAgICAgaWYgKHguY29kZSAhPSAxOCkgcmVzdWx0ID0gJ2UnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gLy8gaGFuZGxlIHJldHJpZXMgaW4gY2FzZSBvZiBsb2FkIGZhaWx1cmVcblxuXG4gICAgICAgICAgaWYgKHJlc3VsdCA9PSAnZScpIHtcbiAgICAgICAgICAgIC8vIGluY3JlbWVudCBjb3VudGVyXG4gICAgICAgICAgICBudW1UcmllcyArPSAxOyAvLyBleGl0IGZ1bmN0aW9uIGFuZCB0cnkgYWdhaW5cblxuICAgICAgICAgICAgaWYgKG51bVRyaWVzIDwgbWF4VHJpZXMpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGxvYWRGaWxlKHBhdGgsIGNhbGxiYWNrRm4sIGFyZ3MsIG51bVRyaWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKGUucmVsID09ICdwcmVsb2FkJyAmJiBlLmFzID09ICdzdHlsZScpIHtcbiAgICAgICAgICAgIC8vIGFjdGl2YXRlIHByZWxvYWRlZCBzdHlsZXNoZWV0c1xuICAgICAgICAgICAgcmV0dXJuIGUucmVsID0gJ3N0eWxlc2hlZXQnOyAvLyBqc2hpbnQgaWdub3JlOmxpbmVcbiAgICAgICAgICB9IC8vIGV4ZWN1dGUgY2FsbGJhY2tcblxuXG4gICAgICAgICAgY2FsbGJhY2tGbihwYXRoLCByZXN1bHQsIGV2LmRlZmF1bHRQcmV2ZW50ZWQpO1xuICAgICAgICB9OyAvLyBhZGQgdG8gZG9jdW1lbnQgKHVubGVzcyBjYWxsYmFjayByZXR1cm5zIGBmYWxzZWApXG5cblxuICAgICAgICBpZiAoYmVmb3JlQ2FsbGJhY2tGbihwYXRoLCBlKSAhPT0gZmFsc2UpIGRvYy5oZWFkLmFwcGVuZENoaWxkKGUpO1xuICAgICAgfVxuICAgICAgLyoqXG4gICAgICAgKiBMb2FkIG11bHRpcGxlIGZpbGVzLlxuICAgICAgICogQHBhcmFtIHtzdHJpbmdbXX0gcGF0aHMgLSBUaGUgZmlsZSBwYXRoc1xuICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tGbiAtIFRoZSBjYWxsYmFjayBmdW5jdGlvblxuICAgICAgICovXG5cblxuICAgICAgZnVuY3Rpb24gbG9hZEZpbGVzKHBhdGhzLCBjYWxsYmFja0ZuLCBhcmdzKSB7XG4gICAgICAgIC8vIGxpc3RpZnkgcGF0aHNcbiAgICAgICAgcGF0aHMgPSBwYXRocy5wdXNoID8gcGF0aHMgOiBbcGF0aHNdO1xuICAgICAgICB2YXIgbnVtV2FpdGluZyA9IHBhdGhzLmxlbmd0aCxcbiAgICAgICAgICAgIHggPSBudW1XYWl0aW5nLFxuICAgICAgICAgICAgcGF0aHNOb3RGb3VuZCA9IFtdLFxuICAgICAgICAgICAgZm4sXG4gICAgICAgICAgICBpOyAvLyBkZWZpbmUgY2FsbGJhY2sgZnVuY3Rpb25cblxuICAgICAgICBmbiA9IGZ1bmN0aW9uIChwYXRoLCByZXN1bHQsIGRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgICAgICAvLyBoYW5kbGUgZXJyb3JcbiAgICAgICAgICBpZiAocmVzdWx0ID09ICdlJykgcGF0aHNOb3RGb3VuZC5wdXNoKHBhdGgpOyAvLyBoYW5kbGUgYmVmb3JlbG9hZCBldmVudC4gSWYgZGVmYXVsdFByZXZlbnRlZCB0aGVuIHRoYXQgbWVhbnMgdGhlIGxvYWRcbiAgICAgICAgICAvLyB3aWxsIGJlIGJsb2NrZWQgKGV4LiBHaG9zdGVyeS9BQlAgb24gU2FmYXJpKVxuXG4gICAgICAgICAgaWYgKHJlc3VsdCA9PSAnYicpIHtcbiAgICAgICAgICAgIGlmIChkZWZhdWx0UHJldmVudGVkKSBwYXRoc05vdEZvdW5kLnB1c2gocGF0aCk7ZWxzZSByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbnVtV2FpdGluZy0tO1xuICAgICAgICAgIGlmICghbnVtV2FpdGluZykgY2FsbGJhY2tGbihwYXRoc05vdEZvdW5kKTtcbiAgICAgICAgfTsgLy8gbG9hZCBzY3JpcHRzXG5cblxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgeDsgaSsrKSBsb2FkRmlsZShwYXRoc1tpXSwgZm4sIGFyZ3MpO1xuICAgICAgfVxuICAgICAgLyoqXG4gICAgICAgKiBJbml0aWF0ZSBzY3JpcHQgbG9hZCBhbmQgcmVnaXN0ZXIgYnVuZGxlLlxuICAgICAgICogQHBhcmFtIHsoc3RyaW5nfHN0cmluZ1tdKX0gcGF0aHMgLSBUaGUgZmlsZSBwYXRoc1xuICAgICAgICogQHBhcmFtIHsoc3RyaW5nfEZ1bmN0aW9ufE9iamVjdCl9IFthcmcxXSAtIFRoZSAoMSkgYnVuZGxlSWQgb3IgKDIpIHN1Y2Nlc3NcbiAgICAgICAqICAgY2FsbGJhY2sgb3IgKDMpIG9iamVjdCBsaXRlcmFsIHdpdGggc3VjY2Vzcy9lcnJvciBhcmd1bWVudHMsIG51bVJldHJpZXMsXG4gICAgICAgKiAgIGV0Yy5cbiAgICAgICAqIEBwYXJhbSB7KEZ1bmN0aW9ufE9iamVjdCl9IFthcmcyXSAtIFRoZSAoMSkgc3VjY2VzcyBjYWxsYmFjayBvciAoMikgb2JqZWN0XG4gICAgICAgKiAgIGxpdGVyYWwgd2l0aCBzdWNjZXNzL2Vycm9yIGFyZ3VtZW50cywgbnVtUmV0cmllcywgZXRjLlxuICAgICAgICovXG5cblxuICAgICAgZnVuY3Rpb24gbG9hZGpzKHBhdGhzLCBhcmcxLCBhcmcyKSB7XG4gICAgICAgIHZhciBidW5kbGVJZCwgYXJnczsgLy8gYnVuZGxlSWQgKGlmIHN0cmluZylcblxuICAgICAgICBpZiAoYXJnMSAmJiBhcmcxLnRyaW0pIGJ1bmRsZUlkID0gYXJnMTsgLy8gYXJncyAoZGVmYXVsdCBpcyB7fSlcblxuICAgICAgICBhcmdzID0gKGJ1bmRsZUlkID8gYXJnMiA6IGFyZzEpIHx8IHt9OyAvLyB0aHJvdyBlcnJvciBpZiBidW5kbGUgaXMgYWxyZWFkeSBkZWZpbmVkXG5cbiAgICAgICAgaWYgKGJ1bmRsZUlkKSB7XG4gICAgICAgICAgaWYgKGJ1bmRsZUlkIGluIGJ1bmRsZUlkQ2FjaGUpIHtcbiAgICAgICAgICAgIHRocm93IFwiTG9hZEpTXCI7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ1bmRsZUlkQ2FjaGVbYnVuZGxlSWRdID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBsb2FkRm4ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgbG9hZEZpbGVzKHBhdGhzLCBmdW5jdGlvbiAocGF0aHNOb3RGb3VuZCkge1xuICAgICAgICAgICAgLy8gZXhlY3V0ZSBjYWxsYmFja3NcbiAgICAgICAgICAgIGV4ZWN1dGVDYWxsYmFja3MoYXJncywgcGF0aHNOb3RGb3VuZCk7IC8vIHJlc29sdmUgUHJvbWlzZVxuXG4gICAgICAgICAgICBpZiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgICBleGVjdXRlQ2FsbGJhY2tzKHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiByZXNvbHZlLFxuICAgICAgICAgICAgICAgIGVycm9yOiByZWplY3RcbiAgICAgICAgICAgICAgfSwgcGF0aHNOb3RGb3VuZCk7XG4gICAgICAgICAgICB9IC8vIHB1Ymxpc2ggYnVuZGxlIGxvYWQgZXZlbnRcblxuXG4gICAgICAgICAgICBwdWJsaXNoKGJ1bmRsZUlkLCBwYXRoc05vdEZvdW5kKTtcbiAgICAgICAgICB9LCBhcmdzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhcmdzLnJldHVyblByb21pc2UpIHJldHVybiBuZXcgUHJvbWlzZShsb2FkRm4pO2Vsc2UgbG9hZEZuKCk7XG4gICAgICB9XG4gICAgICAvKipcbiAgICAgICAqIEV4ZWN1dGUgY2FsbGJhY2tzIHdoZW4gZGVwZW5kZW5jaWVzIGhhdmUgYmVlbiBzYXRpc2ZpZWQuXG4gICAgICAgKiBAcGFyYW0geyhzdHJpbmd8c3RyaW5nW10pfSBkZXBzIC0gTGlzdCBvZiBidW5kbGUgaWRzXG4gICAgICAgKiBAcGFyYW0ge09iamVjdH0gYXJncyAtIHN1Y2Nlc3MvZXJyb3IgYXJndW1lbnRzXG4gICAgICAgKi9cblxuXG4gICAgICBsb2FkanMucmVhZHkgPSBmdW5jdGlvbiByZWFkeShkZXBzLCBhcmdzKSB7XG4gICAgICAgIC8vIHN1YnNjcmliZSB0byBidW5kbGUgbG9hZCBldmVudFxuICAgICAgICBzdWJzY3JpYmUoZGVwcywgZnVuY3Rpb24gKGRlcHNOb3RGb3VuZCkge1xuICAgICAgICAgIC8vIGV4ZWN1dGUgY2FsbGJhY2tzXG4gICAgICAgICAgZXhlY3V0ZUNhbGxiYWNrcyhhcmdzLCBkZXBzTm90Rm91bmQpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGxvYWRqcztcbiAgICAgIH07XG4gICAgICAvKipcbiAgICAgICAqIE1hbnVhbGx5IHNhdGlzZnkgYnVuZGxlIGRlcGVuZGVuY2llcy5cbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBidW5kbGVJZCAtIFRoZSBidW5kbGUgaWRcbiAgICAgICAqL1xuXG5cbiAgICAgIGxvYWRqcy5kb25lID0gZnVuY3Rpb24gZG9uZShidW5kbGVJZCkge1xuICAgICAgICBwdWJsaXNoKGJ1bmRsZUlkLCBbXSk7XG4gICAgICB9O1xuICAgICAgLyoqXG4gICAgICAgKiBSZXNldCBsb2FkanMgZGVwZW5kZW5jaWVzIHN0YXR1c2VzXG4gICAgICAgKi9cblxuXG4gICAgICBsb2FkanMucmVzZXQgPSBmdW5jdGlvbiByZXNldCgpIHtcbiAgICAgICAgYnVuZGxlSWRDYWNoZSA9IHt9O1xuICAgICAgICBidW5kbGVSZXN1bHRDYWNoZSA9IHt9O1xuICAgICAgICBidW5kbGVDYWxsYmFja1F1ZXVlID0ge307XG4gICAgICB9O1xuICAgICAgLyoqXG4gICAgICAgKiBEZXRlcm1pbmUgaWYgYnVuZGxlIGhhcyBhbHJlYWR5IGJlZW4gZGVmaW5lZFxuICAgICAgICogQHBhcmFtIFN0cmluZ30gYnVuZGxlSWQgLSBUaGUgYnVuZGxlIGlkXG4gICAgICAgKi9cblxuXG4gICAgICBsb2FkanMuaXNEZWZpbmVkID0gZnVuY3Rpb24gaXNEZWZpbmVkKGJ1bmRsZUlkKSB7XG4gICAgICAgIHJldHVybiBidW5kbGVJZCBpbiBidW5kbGVJZENhY2hlO1xuICAgICAgfTsgLy8gZXhwb3J0XG5cblxuICAgICAgcmV0dXJuIGxvYWRqcztcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZnVuY3Rpb24gbG9hZFNjcmlwdCh1cmwpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgbG9hZGpzX3VtZCh1cmwsIHtcbiAgICAgICAgc3VjY2VzczogcmVzb2x2ZSxcbiAgICAgICAgZXJyb3I6IHJlamVjdFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGZ1bmN0aW9uIHBhcnNlSWQkMSh1cmwpIHtcbiAgICBpZiAoaXMuZW1wdHkodXJsKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKGlzLm51bWJlcihOdW1iZXIodXJsKSkpIHtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfVxuXG4gICAgY29uc3QgcmVnZXggPSAvXi4qKHZpbWVvLmNvbVxcL3x2aWRlb1xcLykoXFxkKykuKi87XG4gICAgcmV0dXJuIHVybC5tYXRjaChyZWdleCkgPyBSZWdFeHAuJDIgOiB1cmw7XG4gIH0gLy8gVHJ5IHRvIGV4dHJhY3QgYSBoYXNoIGZvciBwcml2YXRlIHZpZGVvcyBmcm9tIHRoZSBVUkxcblxuXG4gIGZ1bmN0aW9uIHBhcnNlSGFzaCh1cmwpIHtcbiAgICAvKiBUaGlzIHJlZ2V4IG1hdGNoZXMgYSBoZXhhZGVjaW1hbCBoYXNoIGlmIGdpdmVuIGluIGFueSBvZiB0aGVzZSBmb3JtczpcbiAgICAgKiAgLSBbaHR0cHM6Ly9wbGF5ZXIuXXZpbWVvLmNvbS92aWRlby97aWR9L3toYXNofVs/cGFyYW1zXVxuICAgICAqICAtIFtodHRwczovL3BsYXllci5ddmltZW8uY29tL3ZpZGVvL3tpZH0/aD17aGFzaH1bJnBhcmFtc11cbiAgICAgKiAgLSBbaHR0cHM6Ly9wbGF5ZXIuXXZpbWVvLmNvbS92aWRlby97aWR9P1twYXJhbXNdJmg9e2hhc2h9XG4gICAgICogIC0gdmlkZW8ve2lkfS97aGFzaH1cbiAgICAgKiBJZiBtYXRjaGVkLCB0aGUgaGFzaCBpcyBhdmFpbGFibGUgaW4gY2FwdHVyZSBncm91cCA0XG4gICAgICovXG4gICAgY29uc3QgcmVnZXggPSAvXi4qKHZpbWVvLmNvbVxcL3x2aWRlb1xcLykoXFxkKykoXFw/LiomKmg9fFxcLykrKFtcXGQsYS1mXSspLztcbiAgICBjb25zdCBmb3VuZCA9IHVybC5tYXRjaChyZWdleCk7XG4gICAgcmV0dXJuIGZvdW5kICYmIGZvdW5kLmxlbmd0aCA9PT0gNSA/IGZvdW5kWzRdIDogbnVsbDtcbiAgfSAvLyBTZXQgcGxheWJhY2sgc3RhdGUgYW5kIHRyaWdnZXIgY2hhbmdlIChvbmx5IG9uIGFjdHVhbCBjaGFuZ2UpXG5cblxuICBmdW5jdGlvbiBhc3N1cmVQbGF5YmFja1N0YXRlJDEocGxheSkge1xuICAgIGlmIChwbGF5ICYmICF0aGlzLmVtYmVkLmhhc1BsYXllZCkge1xuICAgICAgdGhpcy5lbWJlZC5oYXNQbGF5ZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmICh0aGlzLm1lZGlhLnBhdXNlZCA9PT0gcGxheSkge1xuICAgICAgdGhpcy5tZWRpYS5wYXVzZWQgPSAhcGxheTtcbiAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMsIHRoaXMubWVkaWEsIHBsYXkgPyAncGxheScgOiAncGF1c2UnKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCB2aW1lbyA9IHtcbiAgICBzZXR1cCgpIHtcbiAgICAgIGNvbnN0IHBsYXllciA9IHRoaXM7IC8vIEFkZCBlbWJlZCBjbGFzcyBmb3IgcmVzcG9uc2l2ZVxuXG4gICAgICB0b2dnbGVDbGFzcyhwbGF5ZXIuZWxlbWVudHMud3JhcHBlciwgcGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLmVtYmVkLCB0cnVlKTsgLy8gU2V0IHNwZWVkIG9wdGlvbnMgZnJvbSBjb25maWdcblxuICAgICAgcGxheWVyLm9wdGlvbnMuc3BlZWQgPSBwbGF5ZXIuY29uZmlnLnNwZWVkLm9wdGlvbnM7IC8vIFNldCBpbnRpYWwgcmF0aW9cblxuICAgICAgc2V0QXNwZWN0UmF0aW8uY2FsbChwbGF5ZXIpOyAvLyBMb2FkIHRoZSBTREsgaWYgbm90IGFscmVhZHlcblxuICAgICAgaWYgKCFpcy5vYmplY3Qod2luZG93LlZpbWVvKSkge1xuICAgICAgICBsb2FkU2NyaXB0KHBsYXllci5jb25maWcudXJscy52aW1lby5zZGspLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHZpbWVvLnJlYWR5LmNhbGwocGxheWVyKTtcbiAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgIHBsYXllci5kZWJ1Zy53YXJuKCdWaW1lbyBTREsgKHBsYXllci5qcykgZmFpbGVkIHRvIGxvYWQnLCBlcnJvcik7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmltZW8ucmVhZHkuY2FsbChwbGF5ZXIpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBBUEkgUmVhZHlcbiAgICByZWFkeSgpIHtcbiAgICAgIGNvbnN0IHBsYXllciA9IHRoaXM7XG4gICAgICBjb25zdCBjb25maWcgPSBwbGF5ZXIuY29uZmlnLnZpbWVvO1xuICAgICAgY29uc3Qge1xuICAgICAgICBwcmVtaXVtLFxuICAgICAgICByZWZlcnJlclBvbGljeSxcbiAgICAgICAgLi4uZnJhbWVQYXJhbXNcbiAgICAgIH0gPSBjb25maWc7IC8vIEdldCB0aGUgc291cmNlIFVSTCBvciBJRFxuXG4gICAgICBsZXQgc291cmNlID0gcGxheWVyLm1lZGlhLmdldEF0dHJpYnV0ZSgnc3JjJyk7XG4gICAgICBsZXQgaGFzaCA9ICcnOyAvLyBHZXQgZnJvbSA8ZGl2PiBpZiBuZWVkZWRcblxuICAgICAgaWYgKGlzLmVtcHR5KHNvdXJjZSkpIHtcbiAgICAgICAgc291cmNlID0gcGxheWVyLm1lZGlhLmdldEF0dHJpYnV0ZShwbGF5ZXIuY29uZmlnLmF0dHJpYnV0ZXMuZW1iZWQuaWQpOyAvLyBoYXNoIGNhbiBhbHNvIGJlIHNldCBhcyBhdHRyaWJ1dGUgb24gdGhlIDxkaXY+XG5cbiAgICAgICAgaGFzaCA9IHBsYXllci5tZWRpYS5nZXRBdHRyaWJ1dGUocGxheWVyLmNvbmZpZy5hdHRyaWJ1dGVzLmVtYmVkLmhhc2gpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaGFzaCA9IHBhcnNlSGFzaChzb3VyY2UpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBoYXNoUGFyYW0gPSBoYXNoID8ge1xuICAgICAgICBoOiBoYXNoXG4gICAgICB9IDoge307IC8vIElmIHRoZSBvd25lciBoYXMgYSBwcm8gb3IgcHJlbWl1bSBhY2NvdW50IHRoZW4gd2UgY2FuIGhpZGUgY29udHJvbHMgZXRjXG5cbiAgICAgIGlmIChwcmVtaXVtKSB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24oZnJhbWVQYXJhbXMsIHtcbiAgICAgICAgICBjb250cm9sczogZmFsc2UsXG4gICAgICAgICAgc2lkZWRvY2s6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgfSAvLyBHZXQgVmltZW8gcGFyYW1zIGZvciB0aGUgaWZyYW1lXG5cblxuICAgICAgY29uc3QgcGFyYW1zID0gYnVpbGRVcmxQYXJhbXMoe1xuICAgICAgICBsb29wOiBwbGF5ZXIuY29uZmlnLmxvb3AuYWN0aXZlLFxuICAgICAgICBhdXRvcGxheTogcGxheWVyLmF1dG9wbGF5LFxuICAgICAgICBtdXRlZDogcGxheWVyLm11dGVkLFxuICAgICAgICBnZXN0dXJlOiAnbWVkaWEnLFxuICAgICAgICBwbGF5c2lubGluZTogIXRoaXMuY29uZmlnLmZ1bGxzY3JlZW4uaW9zTmF0aXZlLFxuICAgICAgICAvLyBoYXNoIGhhcyB0byBiZSBhZGRlZCB0byBpZnJhbWUtVVJMXG4gICAgICAgIC4uLmhhc2hQYXJhbSxcbiAgICAgICAgLi4uZnJhbWVQYXJhbXNcbiAgICAgIH0pO1xuICAgICAgY29uc3QgaWQgPSBwYXJzZUlkJDEoc291cmNlKTsgLy8gQnVpbGQgYW4gaWZyYW1lXG5cbiAgICAgIGNvbnN0IGlmcmFtZSA9IGNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpO1xuICAgICAgY29uc3Qgc3JjID0gZm9ybWF0KHBsYXllci5jb25maWcudXJscy52aW1lby5pZnJhbWUsIGlkLCBwYXJhbXMpO1xuICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnc3JjJywgc3JjKTtcbiAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2FsbG93ZnVsbHNjcmVlbicsICcnKTtcbiAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2FsbG93JywgWydhdXRvcGxheScsICdmdWxsc2NyZWVuJywgJ3BpY3R1cmUtaW4tcGljdHVyZScsICdlbmNyeXB0ZWQtbWVkaWEnLCAnYWNjZWxlcm9tZXRlcicsICdneXJvc2NvcGUnXS5qb2luKCc7ICcpKTsgLy8gU2V0IHRoZSByZWZlcnJlciBwb2xpY3kgaWYgcmVxdWlyZWRcblxuICAgICAgaWYgKCFpcy5lbXB0eShyZWZlcnJlclBvbGljeSkpIHtcbiAgICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgncmVmZXJyZXJQb2xpY3knLCByZWZlcnJlclBvbGljeSk7XG4gICAgICB9IC8vIEluamVjdCB0aGUgcGFja2FnZVxuXG5cbiAgICAgIGlmIChwcmVtaXVtIHx8ICFjb25maWcuY3VzdG9tQ29udHJvbHMpIHtcbiAgICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnZGF0YS1wb3N0ZXInLCBwbGF5ZXIucG9zdGVyKTtcbiAgICAgICAgcGxheWVyLm1lZGlhID0gcmVwbGFjZUVsZW1lbnQoaWZyYW1lLCBwbGF5ZXIubWVkaWEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3Qgd3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICBjbGFzczogcGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLmVtYmVkQ29udGFpbmVyLFxuICAgICAgICAgICdkYXRhLXBvc3Rlcic6IHBsYXllci5wb3N0ZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcbiAgICAgICAgcGxheWVyLm1lZGlhID0gcmVwbGFjZUVsZW1lbnQod3JhcHBlciwgcGxheWVyLm1lZGlhKTtcbiAgICAgIH0gLy8gR2V0IHBvc3RlciBpbWFnZVxuXG5cbiAgICAgIGlmICghY29uZmlnLmN1c3RvbUNvbnRyb2xzKSB7XG4gICAgICAgIGZldGNoKGZvcm1hdChwbGF5ZXIuY29uZmlnLnVybHMudmltZW8uYXBpLCBzcmMpKS50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICBpZiAoaXMuZW1wdHkocmVzcG9uc2UpIHx8ICFyZXNwb25zZS50aHVtYm5haWxfdXJsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSAvLyBTZXQgYW5kIHNob3cgcG9zdGVyXG5cblxuICAgICAgICAgIHVpLnNldFBvc3Rlci5jYWxsKHBsYXllciwgcmVzcG9uc2UudGh1bWJuYWlsX3VybCkuY2F0Y2goKCkgPT4ge30pO1xuICAgICAgICB9KTtcbiAgICAgIH0gLy8gU2V0dXAgaW5zdGFuY2VcbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS92aW1lby9wbGF5ZXIuanNcblxuXG4gICAgICBwbGF5ZXIuZW1iZWQgPSBuZXcgd2luZG93LlZpbWVvLlBsYXllcihpZnJhbWUsIHtcbiAgICAgICAgYXV0b3BhdXNlOiBwbGF5ZXIuY29uZmlnLmF1dG9wYXVzZSxcbiAgICAgICAgbXV0ZWQ6IHBsYXllci5tdXRlZFxuICAgICAgfSk7XG4gICAgICBwbGF5ZXIubWVkaWEucGF1c2VkID0gdHJ1ZTtcbiAgICAgIHBsYXllci5tZWRpYS5jdXJyZW50VGltZSA9IDA7IC8vIERpc2FibGUgbmF0aXZlIHRleHQgdHJhY2sgcmVuZGVyaW5nXG5cbiAgICAgIGlmIChwbGF5ZXIuc3VwcG9ydGVkLnVpKSB7XG4gICAgICAgIHBsYXllci5lbWJlZC5kaXNhYmxlVGV4dFRyYWNrKCk7XG4gICAgICB9IC8vIENyZWF0ZSBhIGZhdXggSFRNTDUgQVBJIHVzaW5nIHRoZSBWaW1lbyBBUElcblxuXG4gICAgICBwbGF5ZXIubWVkaWEucGxheSA9ICgpID0+IHtcbiAgICAgICAgYXNzdXJlUGxheWJhY2tTdGF0ZSQxLmNhbGwocGxheWVyLCB0cnVlKTtcbiAgICAgICAgcmV0dXJuIHBsYXllci5lbWJlZC5wbGF5KCk7XG4gICAgICB9O1xuXG4gICAgICBwbGF5ZXIubWVkaWEucGF1c2UgPSAoKSA9PiB7XG4gICAgICAgIGFzc3VyZVBsYXliYWNrU3RhdGUkMS5jYWxsKHBsYXllciwgZmFsc2UpO1xuICAgICAgICByZXR1cm4gcGxheWVyLmVtYmVkLnBhdXNlKCk7XG4gICAgICB9O1xuXG4gICAgICBwbGF5ZXIubWVkaWEuc3RvcCA9ICgpID0+IHtcbiAgICAgICAgcGxheWVyLnBhdXNlKCk7XG4gICAgICAgIHBsYXllci5jdXJyZW50VGltZSA9IDA7XG4gICAgICB9OyAvLyBTZWVraW5nXG5cblxuICAgICAgbGV0IHtcbiAgICAgICAgY3VycmVudFRpbWVcbiAgICAgIH0gPSBwbGF5ZXIubWVkaWE7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnY3VycmVudFRpbWUnLCB7XG4gICAgICAgIGdldCgpIHtcbiAgICAgICAgICByZXR1cm4gY3VycmVudFRpbWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0KHRpbWUpIHtcbiAgICAgICAgICAvLyBWaW1lbyB3aWxsIGF1dG9tYXRpY2FsbHkgcGxheSBvbiBzZWVrIGlmIHRoZSB2aWRlbyBoYXNuJ3QgYmVlbiBwbGF5ZWQgYmVmb3JlXG4gICAgICAgICAgLy8gR2V0IGN1cnJlbnQgcGF1c2VkIHN0YXRlIGFuZCB2b2x1bWUgZXRjXG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgZW1iZWQsXG4gICAgICAgICAgICBtZWRpYSxcbiAgICAgICAgICAgIHBhdXNlZCxcbiAgICAgICAgICAgIHZvbHVtZVxuICAgICAgICAgIH0gPSBwbGF5ZXI7XG4gICAgICAgICAgY29uc3QgcmVzdG9yZVBhdXNlID0gcGF1c2VkICYmICFlbWJlZC5oYXNQbGF5ZWQ7IC8vIFNldCBzZWVraW5nIHN0YXRlIGFuZCB0cmlnZ2VyIGV2ZW50XG5cbiAgICAgICAgICBtZWRpYS5zZWVraW5nID0gdHJ1ZTtcbiAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIG1lZGlhLCAnc2Vla2luZycpOyAvLyBJZiBwYXVzZWQsIG11dGUgdW50aWwgc2VlayBpcyBjb21wbGV0ZVxuXG4gICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKHJlc3RvcmVQYXVzZSAmJiBlbWJlZC5zZXRWb2x1bWUoMCkpIC8vIFNlZWtcbiAgICAgICAgICAudGhlbigoKSA9PiBlbWJlZC5zZXRDdXJyZW50VGltZSh0aW1lKSkgLy8gUmVzdG9yZSBwYXVzZWRcbiAgICAgICAgICAudGhlbigoKSA9PiByZXN0b3JlUGF1c2UgJiYgZW1iZWQucGF1c2UoKSkgLy8gUmVzdG9yZSB2b2x1bWVcbiAgICAgICAgICAudGhlbigoKSA9PiByZXN0b3JlUGF1c2UgJiYgZW1iZWQuc2V0Vm9sdW1lKHZvbHVtZSkpLmNhdGNoKCgpID0+IHsvLyBEbyBub3RoaW5nXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgfSk7IC8vIFBsYXliYWNrIHNwZWVkXG5cbiAgICAgIGxldCBzcGVlZCA9IHBsYXllci5jb25maWcuc3BlZWQuc2VsZWN0ZWQ7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAncGxheWJhY2tSYXRlJywge1xuICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgcmV0dXJuIHNwZWVkO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldChpbnB1dCkge1xuICAgICAgICAgIHBsYXllci5lbWJlZC5zZXRQbGF5YmFja1JhdGUoaW5wdXQpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgc3BlZWQgPSBpbnB1dDtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncmF0ZWNoYW5nZScpO1xuICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgIC8vIENhbm5vdCBzZXQgUGxheWJhY2sgUmF0ZSwgVmlkZW8gaXMgcHJvYmFibHkgbm90IG9uIFBybyBhY2NvdW50XG4gICAgICAgICAgICBwbGF5ZXIub3B0aW9ucy5zcGVlZCA9IFsxXTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICB9KTsgLy8gVm9sdW1lXG5cbiAgICAgIGxldCB7XG4gICAgICAgIHZvbHVtZVxuICAgICAgfSA9IHBsYXllci5jb25maWc7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAndm9sdW1lJywge1xuICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgcmV0dXJuIHZvbHVtZTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgICBwbGF5ZXIuZW1iZWQuc2V0Vm9sdW1lKGlucHV0KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHZvbHVtZSA9IGlucHV0O1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd2b2x1bWVjaGFuZ2UnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICB9KTsgLy8gTXV0ZWRcblxuICAgICAgbGV0IHtcbiAgICAgICAgbXV0ZWRcbiAgICAgIH0gPSBwbGF5ZXIuY29uZmlnO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ211dGVkJywge1xuICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgcmV0dXJuIG11dGVkO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldChpbnB1dCkge1xuICAgICAgICAgIGNvbnN0IHRvZ2dsZSA9IGlzLmJvb2xlYW4oaW5wdXQpID8gaW5wdXQgOiBmYWxzZTtcbiAgICAgICAgICBwbGF5ZXIuZW1iZWQuc2V0Vm9sdW1lKHRvZ2dsZSA/IDAgOiBwbGF5ZXIuY29uZmlnLnZvbHVtZSkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBtdXRlZCA9IHRvZ2dsZTtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndm9sdW1lY2hhbmdlJyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgfSk7IC8vIExvb3BcblxuICAgICAgbGV0IHtcbiAgICAgICAgbG9vcFxuICAgICAgfSA9IHBsYXllci5jb25maWc7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnbG9vcCcsIHtcbiAgICAgICAgZ2V0KCkge1xuICAgICAgICAgIHJldHVybiBsb29wO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldChpbnB1dCkge1xuICAgICAgICAgIGNvbnN0IHRvZ2dsZSA9IGlzLmJvb2xlYW4oaW5wdXQpID8gaW5wdXQgOiBwbGF5ZXIuY29uZmlnLmxvb3AuYWN0aXZlO1xuICAgICAgICAgIHBsYXllci5lbWJlZC5zZXRMb29wKHRvZ2dsZSkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBsb29wID0gdG9nZ2xlO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgIH0pOyAvLyBTb3VyY2VcblxuICAgICAgbGV0IGN1cnJlbnRTcmM7XG4gICAgICBwbGF5ZXIuZW1iZWQuZ2V0VmlkZW9VcmwoKS50aGVuKHZhbHVlID0+IHtcbiAgICAgICAgY3VycmVudFNyYyA9IHZhbHVlO1xuICAgICAgICBjb250cm9scy5zZXREb3dubG9hZFVybC5jYWxsKHBsYXllcik7XG4gICAgICB9KS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIHRoaXMuZGVidWcud2FybihlcnJvcik7XG4gICAgICB9KTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwbGF5ZXIubWVkaWEsICdjdXJyZW50U3JjJywge1xuICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgcmV0dXJuIGN1cnJlbnRTcmM7XG4gICAgICAgIH1cblxuICAgICAgfSk7IC8vIEVuZGVkXG5cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwbGF5ZXIubWVkaWEsICdlbmRlZCcsIHtcbiAgICAgICAgZ2V0KCkge1xuICAgICAgICAgIHJldHVybiBwbGF5ZXIuY3VycmVudFRpbWUgPT09IHBsYXllci5kdXJhdGlvbjtcbiAgICAgICAgfVxuXG4gICAgICB9KTsgLy8gU2V0IGFzcGVjdCByYXRpbyBiYXNlZCBvbiB2aWRlbyBzaXplXG5cbiAgICAgIFByb21pc2UuYWxsKFtwbGF5ZXIuZW1iZWQuZ2V0VmlkZW9XaWR0aCgpLCBwbGF5ZXIuZW1iZWQuZ2V0VmlkZW9IZWlnaHQoKV0pLnRoZW4oZGltZW5zaW9ucyA9PiB7XG4gICAgICAgIGNvbnN0IFt3aWR0aCwgaGVpZ2h0XSA9IGRpbWVuc2lvbnM7XG4gICAgICAgIHBsYXllci5lbWJlZC5yYXRpbyA9IHJvdW5kQXNwZWN0UmF0aW8od2lkdGgsIGhlaWdodCk7XG4gICAgICAgIHNldEFzcGVjdFJhdGlvLmNhbGwodGhpcyk7XG4gICAgICB9KTsgLy8gU2V0IGF1dG9wYXVzZVxuXG4gICAgICBwbGF5ZXIuZW1iZWQuc2V0QXV0b3BhdXNlKHBsYXllci5jb25maWcuYXV0b3BhdXNlKS50aGVuKHN0YXRlID0+IHtcbiAgICAgICAgcGxheWVyLmNvbmZpZy5hdXRvcGF1c2UgPSBzdGF0ZTtcbiAgICAgIH0pOyAvLyBHZXQgdGl0bGVcblxuICAgICAgcGxheWVyLmVtYmVkLmdldFZpZGVvVGl0bGUoKS50aGVuKHRpdGxlID0+IHtcbiAgICAgICAgcGxheWVyLmNvbmZpZy50aXRsZSA9IHRpdGxlO1xuICAgICAgICB1aS5zZXRUaXRsZS5jYWxsKHRoaXMpO1xuICAgICAgfSk7IC8vIEdldCBjdXJyZW50IHRpbWVcblxuICAgICAgcGxheWVyLmVtYmVkLmdldEN1cnJlbnRUaW1lKCkudGhlbih2YWx1ZSA9PiB7XG4gICAgICAgIGN1cnJlbnRUaW1lID0gdmFsdWU7XG4gICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndGltZXVwZGF0ZScpO1xuICAgICAgfSk7IC8vIEdldCBkdXJhdGlvblxuXG4gICAgICBwbGF5ZXIuZW1iZWQuZ2V0RHVyYXRpb24oKS50aGVuKHZhbHVlID0+IHtcbiAgICAgICAgcGxheWVyLm1lZGlhLmR1cmF0aW9uID0gdmFsdWU7XG4gICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZHVyYXRpb25jaGFuZ2UnKTtcbiAgICAgIH0pOyAvLyBHZXQgY2FwdGlvbnNcblxuICAgICAgcGxheWVyLmVtYmVkLmdldFRleHRUcmFja3MoKS50aGVuKHRyYWNrcyA9PiB7XG4gICAgICAgIHBsYXllci5tZWRpYS50ZXh0VHJhY2tzID0gdHJhY2tzO1xuICAgICAgICBjYXB0aW9ucy5zZXR1cC5jYWxsKHBsYXllcik7XG4gICAgICB9KTtcbiAgICAgIHBsYXllci5lbWJlZC5vbignY3VlY2hhbmdlJywgKHtcbiAgICAgICAgY3VlcyA9IFtdXG4gICAgICB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHN0cmlwcGVkQ3VlcyA9IGN1ZXMubWFwKGN1ZSA9PiBzdHJpcEhUTUwoY3VlLnRleHQpKTtcbiAgICAgICAgY2FwdGlvbnMudXBkYXRlQ3Vlcy5jYWxsKHBsYXllciwgc3RyaXBwZWRDdWVzKTtcbiAgICAgIH0pO1xuICAgICAgcGxheWVyLmVtYmVkLm9uKCdsb2FkZWQnLCAoKSA9PiB7XG4gICAgICAgIC8vIEFzc3VyZSBzdGF0ZSBhbmQgZXZlbnRzIGFyZSB1cGRhdGVkIG9uIGF1dG9wbGF5XG4gICAgICAgIHBsYXllci5lbWJlZC5nZXRQYXVzZWQoKS50aGVuKHBhdXNlZCA9PiB7XG4gICAgICAgICAgYXNzdXJlUGxheWJhY2tTdGF0ZSQxLmNhbGwocGxheWVyLCAhcGF1c2VkKTtcblxuICAgICAgICAgIGlmICghcGF1c2VkKSB7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3BsYXlpbmcnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChpcy5lbGVtZW50KHBsYXllci5lbWJlZC5lbGVtZW50KSAmJiBwbGF5ZXIuc3VwcG9ydGVkLnVpKSB7XG4gICAgICAgICAgY29uc3QgZnJhbWUgPSBwbGF5ZXIuZW1iZWQuZWxlbWVudDsgLy8gRml4IGtleWJvYXJkIGZvY3VzIGlzc3Vlc1xuICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1wb3R0cy9wbHlyL2lzc3Vlcy8zMTdcblxuICAgICAgICAgIGZyYW1lLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAtMSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcGxheWVyLmVtYmVkLm9uKCdidWZmZXJzdGFydCcsICgpID0+IHtcbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd3YWl0aW5nJyk7XG4gICAgICB9KTtcbiAgICAgIHBsYXllci5lbWJlZC5vbignYnVmZmVyZW5kJywgKCkgPT4ge1xuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3BsYXlpbmcnKTtcbiAgICAgIH0pO1xuICAgICAgcGxheWVyLmVtYmVkLm9uKCdwbGF5JywgKCkgPT4ge1xuICAgICAgICBhc3N1cmVQbGF5YmFja1N0YXRlJDEuY2FsbChwbGF5ZXIsIHRydWUpO1xuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3BsYXlpbmcnKTtcbiAgICAgIH0pO1xuICAgICAgcGxheWVyLmVtYmVkLm9uKCdwYXVzZScsICgpID0+IHtcbiAgICAgICAgYXNzdXJlUGxheWJhY2tTdGF0ZSQxLmNhbGwocGxheWVyLCBmYWxzZSk7XG4gICAgICB9KTtcbiAgICAgIHBsYXllci5lbWJlZC5vbigndGltZXVwZGF0ZScsIGRhdGEgPT4ge1xuICAgICAgICBwbGF5ZXIubWVkaWEuc2Vla2luZyA9IGZhbHNlO1xuICAgICAgICBjdXJyZW50VGltZSA9IGRhdGEuc2Vjb25kcztcbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd0aW1ldXBkYXRlJyk7XG4gICAgICB9KTtcbiAgICAgIHBsYXllci5lbWJlZC5vbigncHJvZ3Jlc3MnLCBkYXRhID0+IHtcbiAgICAgICAgcGxheWVyLm1lZGlhLmJ1ZmZlcmVkID0gZGF0YS5wZXJjZW50O1xuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3Byb2dyZXNzJyk7IC8vIENoZWNrIGFsbCBsb2FkZWRcblxuICAgICAgICBpZiAocGFyc2VJbnQoZGF0YS5wZXJjZW50LCAxMCkgPT09IDEpIHtcbiAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2NhbnBsYXl0aHJvdWdoJyk7XG4gICAgICAgIH0gLy8gR2V0IGR1cmF0aW9uIGFzIGlmIHdlIGRvIGl0IGJlZm9yZSBsb2FkLCBpdCBnaXZlcyBhbiBpbmNvcnJlY3QgdmFsdWVcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzg5MVxuXG5cbiAgICAgICAgcGxheWVyLmVtYmVkLmdldER1cmF0aW9uKCkudGhlbih2YWx1ZSA9PiB7XG4gICAgICAgICAgaWYgKHZhbHVlICE9PSBwbGF5ZXIubWVkaWEuZHVyYXRpb24pIHtcbiAgICAgICAgICAgIHBsYXllci5tZWRpYS5kdXJhdGlvbiA9IHZhbHVlO1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdkdXJhdGlvbmNoYW5nZScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHBsYXllci5lbWJlZC5vbignc2Vla2VkJywgKCkgPT4ge1xuICAgICAgICBwbGF5ZXIubWVkaWEuc2Vla2luZyA9IGZhbHNlO1xuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3NlZWtlZCcpO1xuICAgICAgfSk7XG4gICAgICBwbGF5ZXIuZW1iZWQub24oJ2VuZGVkJywgKCkgPT4ge1xuICAgICAgICBwbGF5ZXIubWVkaWEucGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdlbmRlZCcpO1xuICAgICAgfSk7XG4gICAgICBwbGF5ZXIuZW1iZWQub24oJ2Vycm9yJywgZGV0YWlsID0+IHtcbiAgICAgICAgcGxheWVyLm1lZGlhLmVycm9yID0gZGV0YWlsO1xuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2Vycm9yJyk7XG4gICAgICB9KTsgLy8gUmVidWlsZCBVSVxuXG4gICAgICBpZiAoY29uZmlnLmN1c3RvbUNvbnRyb2xzKSB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdWkuYnVpbGQuY2FsbChwbGF5ZXIpLCAwKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgfTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGZ1bmN0aW9uIHBhcnNlSWQodXJsKSB7XG4gICAgaWYgKGlzLmVtcHR5KHVybCkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IHJlZ2V4ID0gL14uKih5b3V0dS5iZVxcL3x2XFwvfHVcXC9cXHdcXC98ZW1iZWRcXC98d2F0Y2hcXD92PXwmdj0pKFteIyY/XSopLiovO1xuICAgIHJldHVybiB1cmwubWF0Y2gocmVnZXgpID8gUmVnRXhwLiQyIDogdXJsO1xuICB9IC8vIFNldCBwbGF5YmFjayBzdGF0ZSBhbmQgdHJpZ2dlciBjaGFuZ2UgKG9ubHkgb24gYWN0dWFsIGNoYW5nZSlcblxuXG4gIGZ1bmN0aW9uIGFzc3VyZVBsYXliYWNrU3RhdGUocGxheSkge1xuICAgIGlmIChwbGF5ICYmICF0aGlzLmVtYmVkLmhhc1BsYXllZCkge1xuICAgICAgdGhpcy5lbWJlZC5oYXNQbGF5ZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmICh0aGlzLm1lZGlhLnBhdXNlZCA9PT0gcGxheSkge1xuICAgICAgdGhpcy5tZWRpYS5wYXVzZWQgPSAhcGxheTtcbiAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMsIHRoaXMubWVkaWEsIHBsYXkgPyAncGxheScgOiAncGF1c2UnKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBnZXRIb3N0KGNvbmZpZykge1xuICAgIGlmIChjb25maWcubm9Db29raWUpIHtcbiAgICAgIHJldHVybiAnaHR0cHM6Ly93d3cueW91dHViZS1ub2Nvb2tpZS5jb20nO1xuICAgIH1cblxuICAgIGlmICh3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgPT09ICdodHRwOicpIHtcbiAgICAgIHJldHVybiAnaHR0cDovL3d3dy55b3V0dWJlLmNvbSc7XG4gICAgfSAvLyBVc2UgWW91VHViZSdzIGRlZmF1bHRcblxuXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGNvbnN0IHlvdXR1YmUgPSB7XG4gICAgc2V0dXAoKSB7XG4gICAgICAvLyBBZGQgZW1iZWQgY2xhc3MgZm9yIHJlc3BvbnNpdmVcbiAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMud3JhcHBlciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5lbWJlZCwgdHJ1ZSk7IC8vIFNldHVwIEFQSVxuXG4gICAgICBpZiAoaXMub2JqZWN0KHdpbmRvdy5ZVCkgJiYgaXMuZnVuY3Rpb24od2luZG93LllULlBsYXllcikpIHtcbiAgICAgICAgeW91dHViZS5yZWFkeS5jYWxsKHRoaXMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gUmVmZXJlbmNlIGN1cnJlbnQgZ2xvYmFsIGNhbGxiYWNrXG4gICAgICAgIGNvbnN0IGNhbGxiYWNrID0gd2luZG93Lm9uWW91VHViZUlmcmFtZUFQSVJlYWR5OyAvLyBTZXQgY2FsbGJhY2sgdG8gcHJvY2VzcyBxdWV1ZVxuXG4gICAgICAgIHdpbmRvdy5vbllvdVR1YmVJZnJhbWVBUElSZWFkeSA9ICgpID0+IHtcbiAgICAgICAgICAvLyBDYWxsIGdsb2JhbCBjYWxsYmFjayBpZiBzZXRcbiAgICAgICAgICBpZiAoaXMuZnVuY3Rpb24oY2FsbGJhY2spKSB7XG4gICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHlvdXR1YmUucmVhZHkuY2FsbCh0aGlzKTtcbiAgICAgICAgfTsgLy8gTG9hZCB0aGUgU0RLXG5cblxuICAgICAgICBsb2FkU2NyaXB0KHRoaXMuY29uZmlnLnVybHMueW91dHViZS5zZGspLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICB0aGlzLmRlYnVnLndhcm4oJ1lvdVR1YmUgQVBJIGZhaWxlZCB0byBsb2FkJywgZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gR2V0IHRoZSBtZWRpYSB0aXRsZVxuICAgIGdldFRpdGxlKHZpZGVvSWQpIHtcbiAgICAgIGNvbnN0IHVybCA9IGZvcm1hdCh0aGlzLmNvbmZpZy51cmxzLnlvdXR1YmUuYXBpLCB2aWRlb0lkKTtcbiAgICAgIGZldGNoKHVybCkudGhlbihkYXRhID0+IHtcbiAgICAgICAgaWYgKGlzLm9iamVjdChkYXRhKSkge1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgaGVpZ2h0LFxuICAgICAgICAgICAgd2lkdGhcbiAgICAgICAgICB9ID0gZGF0YTsgLy8gU2V0IHRpdGxlXG5cbiAgICAgICAgICB0aGlzLmNvbmZpZy50aXRsZSA9IHRpdGxlO1xuICAgICAgICAgIHVpLnNldFRpdGxlLmNhbGwodGhpcyk7IC8vIFNldCBhc3BlY3QgcmF0aW9cblxuICAgICAgICAgIHRoaXMuZW1iZWQucmF0aW8gPSByb3VuZEFzcGVjdFJhdGlvKHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2V0QXNwZWN0UmF0aW8uY2FsbCh0aGlzKTtcbiAgICAgIH0pLmNhdGNoKCgpID0+IHtcbiAgICAgICAgLy8gU2V0IGFzcGVjdCByYXRpb1xuICAgICAgICBzZXRBc3BlY3RSYXRpby5jYWxsKHRoaXMpO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vIEFQSSByZWFkeVxuICAgIHJlYWR5KCkge1xuICAgICAgY29uc3QgcGxheWVyID0gdGhpcztcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHBsYXllci5jb25maWcueW91dHViZTsgLy8gSWdub3JlIGFscmVhZHkgc2V0dXAgKHJhY2UgY29uZGl0aW9uKVxuXG4gICAgICBjb25zdCBjdXJyZW50SWQgPSBwbGF5ZXIubWVkaWEgJiYgcGxheWVyLm1lZGlhLmdldEF0dHJpYnV0ZSgnaWQnKTtcblxuICAgICAgaWYgKCFpcy5lbXB0eShjdXJyZW50SWQpICYmIGN1cnJlbnRJZC5zdGFydHNXaXRoKCd5b3V0dWJlLScpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gR2V0IHRoZSBzb3VyY2UgVVJMIG9yIElEXG5cblxuICAgICAgbGV0IHNvdXJjZSA9IHBsYXllci5tZWRpYS5nZXRBdHRyaWJ1dGUoJ3NyYycpOyAvLyBHZXQgZnJvbSA8ZGl2PiBpZiBuZWVkZWRcblxuICAgICAgaWYgKGlzLmVtcHR5KHNvdXJjZSkpIHtcbiAgICAgICAgc291cmNlID0gcGxheWVyLm1lZGlhLmdldEF0dHJpYnV0ZSh0aGlzLmNvbmZpZy5hdHRyaWJ1dGVzLmVtYmVkLmlkKTtcbiAgICAgIH0gLy8gUmVwbGFjZSB0aGUgPGlmcmFtZT4gd2l0aCBhIDxkaXY+IGR1ZSB0byBZb3VUdWJlIEFQSSBpc3N1ZXNcblxuXG4gICAgICBjb25zdCB2aWRlb0lkID0gcGFyc2VJZChzb3VyY2UpO1xuICAgICAgY29uc3QgaWQgPSBnZW5lcmF0ZUlkKHBsYXllci5wcm92aWRlcik7IC8vIFJlcGxhY2UgbWVkaWEgZWxlbWVudFxuXG4gICAgICBjb25zdCBjb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgIGlkLFxuICAgICAgICAnZGF0YS1wb3N0ZXInOiBjb25maWcuY3VzdG9tQ29udHJvbHMgPyBwbGF5ZXIucG9zdGVyIDogdW5kZWZpbmVkXG4gICAgICB9KTtcbiAgICAgIHBsYXllci5tZWRpYSA9IHJlcGxhY2VFbGVtZW50KGNvbnRhaW5lciwgcGxheWVyLm1lZGlhKTsgLy8gT25seSBsb2FkIHRoZSBwb3N0ZXIgd2hlbiB1c2luZyBjdXN0b20gY29udHJvbHNcblxuICAgICAgaWYgKGNvbmZpZy5jdXN0b21Db250cm9scykge1xuICAgICAgICBjb25zdCBwb3N0ZXJTcmMgPSBzID0+IGBodHRwczovL2kueXRpbWcuY29tL3ZpLyR7dmlkZW9JZH0vJHtzfWRlZmF1bHQuanBnYDsgLy8gQ2hlY2sgdGh1bWJuYWlsIGltYWdlcyBpbiBvcmRlciBvZiBxdWFsaXR5LCBidXQgcmVqZWN0IGZhbGxiYWNrIHRodW1ibmFpbHMgKDEyMHB4IHdpZGUpXG5cblxuICAgICAgICBsb2FkSW1hZ2UocG9zdGVyU3JjKCdtYXhyZXMnKSwgMTIxKSAvLyBIaWdlc3QgcXVhbGl0eSBhbmQgdW5wYWRkZWRcbiAgICAgICAgLmNhdGNoKCgpID0+IGxvYWRJbWFnZShwb3N0ZXJTcmMoJ3NkJyksIDEyMSkpIC8vIDQ4MHAgcGFkZGVkIDQ6M1xuICAgICAgICAuY2F0Y2goKCkgPT4gbG9hZEltYWdlKHBvc3RlclNyYygnaHEnKSkpIC8vIDM2MHAgcGFkZGVkIDQ6My4gQWx3YXlzIGV4aXN0c1xuICAgICAgICAudGhlbihpbWFnZSA9PiB1aS5zZXRQb3N0ZXIuY2FsbChwbGF5ZXIsIGltYWdlLnNyYykpLnRoZW4oc3JjID0+IHtcbiAgICAgICAgICAvLyBJZiB0aGUgaW1hZ2UgaXMgcGFkZGVkLCB1c2UgYmFja2dyb3VuZC1zaXplIFwiY292ZXJcIiBpbnN0ZWFkIChsaWtlIHlvdXR1YmUgZG9lcyB0b28gd2l0aCB0aGVpciBwb3N0ZXJzKVxuICAgICAgICAgIGlmICghc3JjLmluY2x1ZGVzKCdtYXhyZXMnKSkge1xuICAgICAgICAgICAgcGxheWVyLmVsZW1lbnRzLnBvc3Rlci5zdHlsZS5iYWNrZ3JvdW5kU2l6ZSA9ICdjb3Zlcic7XG4gICAgICAgICAgfVxuICAgICAgICB9KS5jYXRjaCgoKSA9PiB7fSk7XG4gICAgICB9IC8vIFNldHVwIGluc3RhbmNlXG4gICAgICAvLyBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS95b3V0dWJlL2lmcmFtZV9hcGlfcmVmZXJlbmNlXG5cblxuICAgICAgcGxheWVyLmVtYmVkID0gbmV3IHdpbmRvdy5ZVC5QbGF5ZXIocGxheWVyLm1lZGlhLCB7XG4gICAgICAgIHZpZGVvSWQsXG4gICAgICAgIGhvc3Q6IGdldEhvc3QoY29uZmlnKSxcbiAgICAgICAgcGxheWVyVmFyczogZXh0ZW5kKHt9LCB7XG4gICAgICAgICAgLy8gQXV0b3BsYXlcbiAgICAgICAgICBhdXRvcGxheTogcGxheWVyLmNvbmZpZy5hdXRvcGxheSA/IDEgOiAwLFxuICAgICAgICAgIC8vIGlmcmFtZSBpbnRlcmZhY2UgbGFuZ3VhZ2VcbiAgICAgICAgICBobDogcGxheWVyLmNvbmZpZy5obCxcbiAgICAgICAgICAvLyBPbmx5IHNob3cgY29udHJvbHMgaWYgbm90IGZ1bGx5IHN1cHBvcnRlZCBvciBvcHRlZCBvdXRcbiAgICAgICAgICBjb250cm9sczogcGxheWVyLnN1cHBvcnRlZC51aSAmJiBjb25maWcuY3VzdG9tQ29udHJvbHMgPyAwIDogMSxcbiAgICAgICAgICAvLyBEaXNhYmxlIGtleWJvYXJkIGFzIHdlIGhhbmRsZSBpdFxuICAgICAgICAgIGRpc2FibGVrYjogMSxcbiAgICAgICAgICAvLyBBbGxvdyBpT1MgaW5saW5lIHBsYXliYWNrXG4gICAgICAgICAgcGxheXNpbmxpbmU6ICFwbGF5ZXIuY29uZmlnLmZ1bGxzY3JlZW4uaW9zTmF0aXZlID8gMSA6IDAsXG4gICAgICAgICAgLy8gQ2FwdGlvbnMgYXJlIGZsYWt5IG9uIFlvdVR1YmVcbiAgICAgICAgICBjY19sb2FkX3BvbGljeTogcGxheWVyLmNhcHRpb25zLmFjdGl2ZSA/IDEgOiAwLFxuICAgICAgICAgIGNjX2xhbmdfcHJlZjogcGxheWVyLmNvbmZpZy5jYXB0aW9ucy5sYW5ndWFnZSxcbiAgICAgICAgICAvLyBUcmFja2luZyBmb3Igc3RhdHNcbiAgICAgICAgICB3aWRnZXRfcmVmZXJyZXI6IHdpbmRvdyA/IHdpbmRvdy5sb2NhdGlvbi5ocmVmIDogbnVsbFxuICAgICAgICB9LCBjb25maWcpLFxuICAgICAgICBldmVudHM6IHtcbiAgICAgICAgICBvbkVycm9yKGV2ZW50KSB7XG4gICAgICAgICAgICAvLyBZb3VUdWJlIG1heSBmaXJlIG9uRXJyb3IgdHdpY2UsIHNvIG9ubHkgaGFuZGxlIGl0IG9uY2VcbiAgICAgICAgICAgIGlmICghcGxheWVyLm1lZGlhLmVycm9yKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGNvZGUgPSBldmVudC5kYXRhOyAvLyBNZXNzYWdlcyBjb3BpZWQgZnJvbSBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS95b3V0dWJlL2lmcmFtZV9hcGlfcmVmZXJlbmNlI29uRXJyb3JcblxuICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlID0ge1xuICAgICAgICAgICAgICAgIDI6ICdUaGUgcmVxdWVzdCBjb250YWlucyBhbiBpbnZhbGlkIHBhcmFtZXRlciB2YWx1ZS4gRm9yIGV4YW1wbGUsIHRoaXMgZXJyb3Igb2NjdXJzIGlmIHlvdSBzcGVjaWZ5IGEgdmlkZW8gSUQgdGhhdCBkb2VzIG5vdCBoYXZlIDExIGNoYXJhY3RlcnMsIG9yIGlmIHRoZSB2aWRlbyBJRCBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMsIHN1Y2ggYXMgZXhjbGFtYXRpb24gcG9pbnRzIG9yIGFzdGVyaXNrcy4nLFxuICAgICAgICAgICAgICAgIDU6ICdUaGUgcmVxdWVzdGVkIGNvbnRlbnQgY2Fubm90IGJlIHBsYXllZCBpbiBhbiBIVE1MNSBwbGF5ZXIgb3IgYW5vdGhlciBlcnJvciByZWxhdGVkIHRvIHRoZSBIVE1MNSBwbGF5ZXIgaGFzIG9jY3VycmVkLicsXG4gICAgICAgICAgICAgICAgMTAwOiAnVGhlIHZpZGVvIHJlcXVlc3RlZCB3YXMgbm90IGZvdW5kLiBUaGlzIGVycm9yIG9jY3VycyB3aGVuIGEgdmlkZW8gaGFzIGJlZW4gcmVtb3ZlZCAoZm9yIGFueSByZWFzb24pIG9yIGhhcyBiZWVuIG1hcmtlZCBhcyBwcml2YXRlLicsXG4gICAgICAgICAgICAgICAgMTAxOiAnVGhlIG93bmVyIG9mIHRoZSByZXF1ZXN0ZWQgdmlkZW8gZG9lcyBub3QgYWxsb3cgaXQgdG8gYmUgcGxheWVkIGluIGVtYmVkZGVkIHBsYXllcnMuJyxcbiAgICAgICAgICAgICAgICAxNTA6ICdUaGUgb3duZXIgb2YgdGhlIHJlcXVlc3RlZCB2aWRlbyBkb2VzIG5vdCBhbGxvdyBpdCB0byBiZSBwbGF5ZWQgaW4gZW1iZWRkZWQgcGxheWVycy4nXG4gICAgICAgICAgICAgIH1bY29kZV0gfHwgJ0FuIHVua25vd24gZXJyb3Igb2NjdXJlZCc7XG4gICAgICAgICAgICAgIHBsYXllci5tZWRpYS5lcnJvciA9IHtcbiAgICAgICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdlcnJvcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG5cbiAgICAgICAgICBvblBsYXliYWNrUmF0ZUNoYW5nZShldmVudCkge1xuICAgICAgICAgICAgLy8gR2V0IHRoZSBpbnN0YW5jZVxuICAgICAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBldmVudC50YXJnZXQ7IC8vIEdldCBjdXJyZW50IHNwZWVkXG5cbiAgICAgICAgICAgIHBsYXllci5tZWRpYS5wbGF5YmFja1JhdGUgPSBpbnN0YW5jZS5nZXRQbGF5YmFja1JhdGUoKTtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncmF0ZWNoYW5nZScpO1xuICAgICAgICAgIH0sXG5cbiAgICAgICAgICBvblJlYWR5KGV2ZW50KSB7XG4gICAgICAgICAgICAvLyBCYWlsIGlmIG9uUmVhZHkgaGFzIGFscmVhZHkgYmVlbiBjYWxsZWQuIFNlZSBpc3N1ZSAjMTEwOFxuICAgICAgICAgICAgaWYgKGlzLmZ1bmN0aW9uKHBsYXllci5tZWRpYS5wbGF5KSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IC8vIEdldCB0aGUgaW5zdGFuY2VcblxuXG4gICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IGV2ZW50LnRhcmdldDsgLy8gR2V0IHRoZSB0aXRsZVxuXG4gICAgICAgICAgICB5b3V0dWJlLmdldFRpdGxlLmNhbGwocGxheWVyLCB2aWRlb0lkKTsgLy8gQ3JlYXRlIGEgZmF1eCBIVE1MNSBBUEkgdXNpbmcgdGhlIFlvdVR1YmUgQVBJXG5cbiAgICAgICAgICAgIHBsYXllci5tZWRpYS5wbGF5ID0gKCkgPT4ge1xuICAgICAgICAgICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCB0cnVlKTtcbiAgICAgICAgICAgICAgaW5zdGFuY2UucGxheVZpZGVvKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBwbGF5ZXIubWVkaWEucGF1c2UgPSAoKSA9PiB7XG4gICAgICAgICAgICAgIGFzc3VyZVBsYXliYWNrU3RhdGUuY2FsbChwbGF5ZXIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgaW5zdGFuY2UucGF1c2VWaWRlbygpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcGxheWVyLm1lZGlhLnN0b3AgPSAoKSA9PiB7XG4gICAgICAgICAgICAgIGluc3RhbmNlLnN0b3BWaWRlbygpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcGxheWVyLm1lZGlhLmR1cmF0aW9uID0gaW5zdGFuY2UuZ2V0RHVyYXRpb24oKTtcbiAgICAgICAgICAgIHBsYXllci5tZWRpYS5wYXVzZWQgPSB0cnVlOyAvLyBTZWVraW5nXG5cbiAgICAgICAgICAgIHBsYXllci5tZWRpYS5jdXJyZW50VGltZSA9IDA7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnY3VycmVudFRpbWUnLCB7XG4gICAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gTnVtYmVyKGluc3RhbmNlLmdldEN1cnJlbnRUaW1lKCkpO1xuICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgIHNldCh0aW1lKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgcGF1c2VkIGFuZCBuZXZlciBwbGF5ZWQsIG11dGUgYXVkaW8gcHJldmVudGl2ZWx5IChZb3VUdWJlIHN0YXJ0cyBwbGF5aW5nIG9uIHNlZWsgaWYgdGhlIHZpZGVvIGhhc24ndCBiZWVuIHBsYXllZCB5ZXQpLlxuICAgICAgICAgICAgICAgIGlmIChwbGF5ZXIucGF1c2VkICYmICFwbGF5ZXIuZW1iZWQuaGFzUGxheWVkKSB7XG4gICAgICAgICAgICAgICAgICBwbGF5ZXIuZW1iZWQubXV0ZSgpO1xuICAgICAgICAgICAgICAgIH0gLy8gU2V0IHNlZWtpbmcgc3RhdGUgYW5kIHRyaWdnZXIgZXZlbnRcblxuXG4gICAgICAgICAgICAgICAgcGxheWVyLm1lZGlhLnNlZWtpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnc2Vla2luZycpOyAvLyBTZWVrIGFmdGVyIGV2ZW50cyBzZW50XG5cbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5zZWVrVG8odGltZSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7IC8vIFBsYXliYWNrIHNwZWVkXG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwbGF5ZXIubWVkaWEsICdwbGF5YmFja1JhdGUnLCB7XG4gICAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5zdGFuY2UuZ2V0UGxheWJhY2tSYXRlKCk7XG4gICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgc2V0KGlucHV0KSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2Uuc2V0UGxheWJhY2tSYXRlKGlucHV0KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTsgLy8gVm9sdW1lXG5cbiAgICAgICAgICAgIGxldCB7XG4gICAgICAgICAgICAgIHZvbHVtZVxuICAgICAgICAgICAgfSA9IHBsYXllci5jb25maWc7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAndm9sdW1lJywge1xuICAgICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZvbHVtZTtcbiAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgICAgICAgICB2b2x1bWUgPSBpbnB1dDtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5zZXRWb2x1bWUodm9sdW1lICogMTAwKTtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3ZvbHVtZWNoYW5nZScpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pOyAvLyBNdXRlZFxuXG4gICAgICAgICAgICBsZXQge1xuICAgICAgICAgICAgICBtdXRlZFxuICAgICAgICAgICAgfSA9IHBsYXllci5jb25maWc7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnbXV0ZWQnLCB7XG4gICAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbXV0ZWQ7XG4gICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgc2V0KGlucHV0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdG9nZ2xlID0gaXMuYm9vbGVhbihpbnB1dCkgPyBpbnB1dCA6IG11dGVkO1xuICAgICAgICAgICAgICAgIG11dGVkID0gdG9nZ2xlO1xuICAgICAgICAgICAgICAgIGluc3RhbmNlW3RvZ2dsZSA/ICdtdXRlJyA6ICd1bk11dGUnXSgpO1xuICAgICAgICAgICAgICAgIGluc3RhbmNlLnNldFZvbHVtZSh2b2x1bWUgKiAxMDApO1xuICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndm9sdW1lY2hhbmdlJyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7IC8vIFNvdXJjZVxuXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnY3VycmVudFNyYycsIHtcbiAgICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbnN0YW5jZS5nZXRWaWRlb1VybCgpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pOyAvLyBFbmRlZFxuXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnZW5kZWQnLCB7XG4gICAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGxheWVyLmN1cnJlbnRUaW1lID09PSBwbGF5ZXIuZHVyYXRpb247XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7IC8vIEdldCBhdmFpbGFibGUgc3BlZWRzXG5cbiAgICAgICAgICAgIGNvbnN0IHNwZWVkcyA9IGluc3RhbmNlLmdldEF2YWlsYWJsZVBsYXliYWNrUmF0ZXMoKTsgLy8gRmlsdGVyIGJhc2VkIG9uIGNvbmZpZ1xuXG4gICAgICAgICAgICBwbGF5ZXIub3B0aW9ucy5zcGVlZCA9IHNwZWVkcy5maWx0ZXIocyA9PiBwbGF5ZXIuY29uZmlnLnNwZWVkLm9wdGlvbnMuaW5jbHVkZXMocykpOyAvLyBTZXQgdGhlIHRhYmluZGV4IHRvIGF2b2lkIGZvY3VzIGVudGVyaW5nIGlmcmFtZVxuXG4gICAgICAgICAgICBpZiAocGxheWVyLnN1cHBvcnRlZC51aSAmJiBjb25maWcuY3VzdG9tQ29udHJvbHMpIHtcbiAgICAgICAgICAgICAgcGxheWVyLm1lZGlhLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAtMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndGltZXVwZGF0ZScpO1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdkdXJhdGlvbmNoYW5nZScpOyAvLyBSZXNldCB0aW1lclxuXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHBsYXllci50aW1lcnMuYnVmZmVyaW5nKTsgLy8gU2V0dXAgYnVmZmVyaW5nXG5cbiAgICAgICAgICAgIHBsYXllci50aW1lcnMuYnVmZmVyaW5nID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgICAvLyBHZXQgbG9hZGVkICUgZnJvbSBZb3VUdWJlXG4gICAgICAgICAgICAgIHBsYXllci5tZWRpYS5idWZmZXJlZCA9IGluc3RhbmNlLmdldFZpZGVvTG9hZGVkRnJhY3Rpb24oKTsgLy8gVHJpZ2dlciBwcm9ncmVzcyBvbmx5IHdoZW4gd2UgYWN0dWFsbHkgYnVmZmVyIHNvbWV0aGluZ1xuXG4gICAgICAgICAgICAgIGlmIChwbGF5ZXIubWVkaWEubGFzdEJ1ZmZlcmVkID09PSBudWxsIHx8IHBsYXllci5tZWRpYS5sYXN0QnVmZmVyZWQgPCBwbGF5ZXIubWVkaWEuYnVmZmVyZWQpIHtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3Byb2dyZXNzJyk7XG4gICAgICAgICAgICAgIH0gLy8gU2V0IGxhc3QgYnVmZmVyIHBvaW50XG5cblxuICAgICAgICAgICAgICBwbGF5ZXIubWVkaWEubGFzdEJ1ZmZlcmVkID0gcGxheWVyLm1lZGlhLmJ1ZmZlcmVkOyAvLyBCYWlsIGlmIHdlJ3JlIGF0IDEwMCVcblxuICAgICAgICAgICAgICBpZiAocGxheWVyLm1lZGlhLmJ1ZmZlcmVkID09PSAxKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChwbGF5ZXIudGltZXJzLmJ1ZmZlcmluZyk7IC8vIFRyaWdnZXIgZXZlbnRcblxuICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnY2FucGxheXRocm91Z2gnKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMjAwKTsgLy8gUmVidWlsZCBVSVxuXG4gICAgICAgICAgICBpZiAoY29uZmlnLmN1c3RvbUNvbnRyb2xzKSB7XG4gICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdWkuYnVpbGQuY2FsbChwbGF5ZXIpLCA1MCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcblxuICAgICAgICAgIG9uU3RhdGVDaGFuZ2UoZXZlbnQpIHtcbiAgICAgICAgICAgIC8vIEdldCB0aGUgaW5zdGFuY2VcbiAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gZXZlbnQudGFyZ2V0OyAvLyBSZXNldCB0aW1lclxuXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHBsYXllci50aW1lcnMucGxheWluZyk7XG4gICAgICAgICAgICBjb25zdCBzZWVrZWQgPSBwbGF5ZXIubWVkaWEuc2Vla2luZyAmJiBbMSwgMl0uaW5jbHVkZXMoZXZlbnQuZGF0YSk7XG5cbiAgICAgICAgICAgIGlmIChzZWVrZWQpIHtcbiAgICAgICAgICAgICAgLy8gVW5zZXQgc2Vla2luZyBhbmQgZmlyZSBzZWVrZWQgZXZlbnRcbiAgICAgICAgICAgICAgcGxheWVyLm1lZGlhLnNlZWtpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdzZWVrZWQnKTtcbiAgICAgICAgICAgIH0gLy8gSGFuZGxlIGV2ZW50c1xuICAgICAgICAgICAgLy8gLTEgICBVbnN0YXJ0ZWRcbiAgICAgICAgICAgIC8vIDAgICAgRW5kZWRcbiAgICAgICAgICAgIC8vIDEgICAgUGxheWluZ1xuICAgICAgICAgICAgLy8gMiAgICBQYXVzZWRcbiAgICAgICAgICAgIC8vIDMgICAgQnVmZmVyaW5nXG4gICAgICAgICAgICAvLyA1ICAgIFZpZGVvIGN1ZWRcblxuXG4gICAgICAgICAgICBzd2l0Y2ggKGV2ZW50LmRhdGEpIHtcbiAgICAgICAgICAgICAgY2FzZSAtMTpcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgc2NydWJiZXJcbiAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3RpbWV1cGRhdGUnKTsgLy8gR2V0IGxvYWRlZCAlIGZyb20gWW91VHViZVxuXG4gICAgICAgICAgICAgICAgcGxheWVyLm1lZGlhLmJ1ZmZlcmVkID0gaW5zdGFuY2UuZ2V0VmlkZW9Mb2FkZWRGcmFjdGlvbigpO1xuICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncHJvZ3Jlc3MnKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgYXNzdXJlUGxheWJhY2tTdGF0ZS5jYWxsKHBsYXllciwgZmFsc2UpOyAvLyBZb3VUdWJlIGRvZXNuJ3Qgc3VwcG9ydCBsb29wIGZvciBhIHNpbmdsZSB2aWRlbywgc28gbWltaWNrIGl0LlxuXG4gICAgICAgICAgICAgICAgaWYgKHBsYXllci5tZWRpYS5sb29wKSB7XG4gICAgICAgICAgICAgICAgICAvLyBZb3VUdWJlIG5lZWRzIGEgY2FsbCB0byBgc3RvcFZpZGVvYCBiZWZvcmUgcGxheWluZyBhZ2FpblxuICAgICAgICAgICAgICAgICAgaW5zdGFuY2Uuc3RvcFZpZGVvKCk7XG4gICAgICAgICAgICAgICAgICBpbnN0YW5jZS5wbGF5VmlkZW8oKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdlbmRlZCcpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAvLyBSZXN0b3JlIHBhdXNlZCBzdGF0ZSAoWW91VHViZSBzdGFydHMgcGxheWluZyBvbiBzZWVrIGlmIHRoZSB2aWRlbyBoYXNuJ3QgYmVlbiBwbGF5ZWQgeWV0KVxuICAgICAgICAgICAgICAgIGlmIChjb25maWcuY3VzdG9tQ29udHJvbHMgJiYgIXBsYXllci5jb25maWcuYXV0b3BsYXkgJiYgcGxheWVyLm1lZGlhLnBhdXNlZCAmJiAhcGxheWVyLmVtYmVkLmhhc1BsYXllZCkge1xuICAgICAgICAgICAgICAgICAgcGxheWVyLm1lZGlhLnBhdXNlKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGFzc3VyZVBsYXliYWNrU3RhdGUuY2FsbChwbGF5ZXIsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdwbGF5aW5nJyk7IC8vIFBvbGwgdG8gZ2V0IHBsYXliYWNrIHByb2dyZXNzXG5cbiAgICAgICAgICAgICAgICAgIHBsYXllci50aW1lcnMucGxheWluZyA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd0aW1ldXBkYXRlJyk7XG4gICAgICAgICAgICAgICAgICB9LCA1MCk7IC8vIENoZWNrIGR1cmF0aW9uIGFnYWluIGR1ZSB0byBZb3VUdWJlIGJ1Z1xuICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzM3NFxuICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9nZGF0YS1pc3N1ZXMvaXNzdWVzL2RldGFpbD9pZD04NjkwXG5cbiAgICAgICAgICAgICAgICAgIGlmIChwbGF5ZXIubWVkaWEuZHVyYXRpb24gIT09IGluc3RhbmNlLmdldER1cmF0aW9uKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcGxheWVyLm1lZGlhLmR1cmF0aW9uID0gaW5zdGFuY2UuZ2V0RHVyYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdkdXJhdGlvbmNoYW5nZScpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAvLyBSZXN0b3JlIGF1ZGlvIChZb3VUdWJlIHN0YXJ0cyBwbGF5aW5nIG9uIHNlZWsgaWYgdGhlIHZpZGVvIGhhc24ndCBiZWVuIHBsYXllZCB5ZXQpXG4gICAgICAgICAgICAgICAgaWYgKCFwbGF5ZXIubXV0ZWQpIHtcbiAgICAgICAgICAgICAgICAgIHBsYXllci5lbWJlZC51bk11dGUoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgd2FpdGluZyBldmVudCB0byBhZGQgbG9hZGluZyBjbGFzc2VzIHRvIGNvbnRhaW5lciBhcyB0aGUgdmlkZW8gYnVmZmVycy5cbiAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3dhaXRpbmcnKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIuZWxlbWVudHMuY29udGFpbmVyLCAnc3RhdGVjaGFuZ2UnLCBmYWxzZSwge1xuICAgICAgICAgICAgICBjb2RlOiBldmVudC5kYXRhXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gIH07XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgY29uc3QgbWVkaWEgPSB7XG4gICAgLy8gU2V0dXAgbWVkaWFcbiAgICBzZXR1cCgpIHtcbiAgICAgIC8vIElmIHRoZXJlJ3Mgbm8gbWVkaWEsIGJhaWxcbiAgICAgIGlmICghdGhpcy5tZWRpYSkge1xuICAgICAgICB0aGlzLmRlYnVnLndhcm4oJ05vIG1lZGlhIGVsZW1lbnQgZm91bmQhJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gQWRkIHR5cGUgY2xhc3NcblxuXG4gICAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy50eXBlLnJlcGxhY2UoJ3swfScsIHRoaXMudHlwZSksIHRydWUpOyAvLyBBZGQgcHJvdmlkZXIgY2xhc3NcblxuICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMucHJvdmlkZXIucmVwbGFjZSgnezB9JywgdGhpcy5wcm92aWRlciksIHRydWUpOyAvLyBBZGQgdmlkZW8gY2xhc3MgZm9yIGVtYmVkc1xuICAgICAgLy8gVGhpcyB3aWxsIHJlcXVpcmUgY2hhbmdlcyBpZiBhdWRpbyBlbWJlZHMgYXJlIGFkZGVkXG5cbiAgICAgIGlmICh0aGlzLmlzRW1iZWQpIHtcbiAgICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMudHlwZS5yZXBsYWNlKCd7MH0nLCAndmlkZW8nKSwgdHJ1ZSk7XG4gICAgICB9IC8vIEluamVjdCB0aGUgcGxheWVyIHdyYXBwZXJcblxuXG4gICAgICBpZiAodGhpcy5pc1ZpZGVvKSB7XG4gICAgICAgIC8vIENyZWF0ZSB0aGUgd3JhcHBlciBkaXZcbiAgICAgICAgdGhpcy5lbGVtZW50cy53cmFwcGVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnZpZGVvXG4gICAgICAgIH0pOyAvLyBXcmFwIHRoZSB2aWRlbyBpbiBhIGNvbnRhaW5lclxuXG4gICAgICAgIHdyYXAodGhpcy5tZWRpYSwgdGhpcy5lbGVtZW50cy53cmFwcGVyKTsgLy8gUG9zdGVyIGltYWdlIGNvbnRhaW5lclxuXG4gICAgICAgIHRoaXMuZWxlbWVudHMucG9zdGVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnBvc3RlclxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5lbGVtZW50cy53cmFwcGVyLmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudHMucG9zdGVyKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICBodG1sNS5zZXR1cC5jYWxsKHRoaXMpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLmlzWW91VHViZSkge1xuICAgICAgICB5b3V0dWJlLnNldHVwLmNhbGwodGhpcyk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuaXNWaW1lbykge1xuICAgICAgICB2aW1lby5zZXR1cC5jYWxsKHRoaXMpO1xuICAgICAgfVxuICAgIH1cblxuICB9O1xuXG4gIGNvbnN0IGRlc3Ryb3kgPSBpbnN0YW5jZSA9PiB7XG4gICAgLy8gRGVzdHJveSBvdXIgYWRzTWFuYWdlclxuICAgIGlmIChpbnN0YW5jZS5tYW5hZ2VyKSB7XG4gICAgICBpbnN0YW5jZS5tYW5hZ2VyLmRlc3Ryb3koKTtcbiAgICB9IC8vIERlc3Ryb3kgb3VyIGFkc01hbmFnZXJcblxuXG4gICAgaWYgKGluc3RhbmNlLmVsZW1lbnRzLmRpc3BsYXlDb250YWluZXIpIHtcbiAgICAgIGluc3RhbmNlLmVsZW1lbnRzLmRpc3BsYXlDb250YWluZXIuZGVzdHJveSgpO1xuICAgIH1cblxuICAgIGluc3RhbmNlLmVsZW1lbnRzLmNvbnRhaW5lci5yZW1vdmUoKTtcbiAgfTtcblxuICBjbGFzcyBBZHMge1xuICAgIC8qKlxuICAgICAqIEFkcyBjb25zdHJ1Y3Rvci5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcGxheWVyXG4gICAgICogQHJldHVybiB7QWRzfVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHBsYXllcikge1xuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJsb2FkXCIsICgpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gLy8gQ2hlY2sgaWYgdGhlIEdvb2dsZSBJTUEzIFNESyBpcyBsb2FkZWQgb3IgbG9hZCBpdCBvdXJzZWx2ZXNcblxuXG4gICAgICAgIGlmICghaXMub2JqZWN0KHdpbmRvdy5nb29nbGUpIHx8ICFpcy5vYmplY3Qod2luZG93Lmdvb2dsZS5pbWEpKSB7XG4gICAgICAgICAgbG9hZFNjcmlwdCh0aGlzLnBsYXllci5jb25maWcudXJscy5nb29nbGVJTUEuc2RrKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucmVhZHkoKTtcbiAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBTY3JpcHQgZmFpbGVkIHRvIGxvYWQgb3IgaXMgYmxvY2tlZFxuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdlcnJvcicsIG5ldyBFcnJvcignR29vZ2xlIElNQSBTREsgZmFpbGVkIHRvIGxvYWQnKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5yZWFkeSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJyZWFkeVwiLCAoKSA9PiB7XG4gICAgICAgIC8vIERvdWJsZSBjaGVjayB3ZSdyZSBlbmFibGVkXG4gICAgICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICAgICAgZGVzdHJveSh0aGlzKTtcbiAgICAgICAgfSAvLyBTdGFydCB0aWNraW5nIG91ciBzYWZldHkgdGltZXIuIElmIHRoZSB3aG9sZSBhZHZlcnRpc2VtZW50XG4gICAgICAgIC8vIHRoaW5nIGRvZXNuJ3QgcmVzb2x2ZSB3aXRoaW4gb3VyIHNldCB0aW1lOyB3ZSBiYWlsXG5cblxuICAgICAgICB0aGlzLnN0YXJ0U2FmZXR5VGltZXIoMTIwMDAsICdyZWFkeSgpJyk7IC8vIENsZWFyIHRoZSBzYWZldHkgdGltZXJcblxuICAgICAgICB0aGlzLm1hbmFnZXJQcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY2xlYXJTYWZldHlUaW1lcignb25BZHNNYW5hZ2VyTG9hZGVkKCknKTtcbiAgICAgICAgfSk7IC8vIFNldCBsaXN0ZW5lcnMgb24gdGhlIFBseXIgaW5zdGFuY2VcblxuICAgICAgICB0aGlzLmxpc3RlbmVycygpOyAvLyBTZXR1cCB0aGUgSU1BIFNES1xuXG4gICAgICAgIHRoaXMuc2V0dXBJTUEoKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInNldHVwSU1BXCIsICgpID0+IHtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBjb250YWluZXIgZm9yIG91ciBhZHZlcnRpc2VtZW50c1xuICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICBjbGFzczogdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMuYWRzXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBsYXllci5lbGVtZW50cy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50cy5jb250YWluZXIpOyAvLyBTbyB3ZSBjYW4gcnVuIFZQQUlEMlxuXG4gICAgICAgIGdvb2dsZS5pbWEuc2V0dGluZ3Muc2V0VnBhaWRNb2RlKGdvb2dsZS5pbWEuSW1hU2RrU2V0dGluZ3MuVnBhaWRNb2RlLkVOQUJMRUQpOyAvLyBTZXQgbGFuZ3VhZ2VcblxuICAgICAgICBnb29nbGUuaW1hLnNldHRpbmdzLnNldExvY2FsZSh0aGlzLnBsYXllci5jb25maWcuYWRzLmxhbmd1YWdlKTsgLy8gU2V0IHBsYXliYWNrIGZvciBpT1MxMCtcblxuICAgICAgICBnb29nbGUuaW1hLnNldHRpbmdzLnNldERpc2FibGVDdXN0b21QbGF5YmFja0ZvcklPUzEwUGx1cyh0aGlzLnBsYXllci5jb25maWcucGxheXNpbmxpbmUpOyAvLyBXZSBhc3N1bWUgdGhlIGFkQ29udGFpbmVyIGlzIHRoZSB2aWRlbyBjb250YWluZXIgb2YgdGhlIHBseXIgZWxlbWVudCB0aGF0IHdpbGwgaG91c2UgdGhlIGFkc1xuXG4gICAgICAgIHRoaXMuZWxlbWVudHMuZGlzcGxheUNvbnRhaW5lciA9IG5ldyBnb29nbGUuaW1hLkFkRGlzcGxheUNvbnRhaW5lcih0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5wbGF5ZXIubWVkaWEpOyAvLyBDcmVhdGUgYWRzIGxvYWRlclxuXG4gICAgICAgIHRoaXMubG9hZGVyID0gbmV3IGdvb2dsZS5pbWEuQWRzTG9hZGVyKHRoaXMuZWxlbWVudHMuZGlzcGxheUNvbnRhaW5lcik7IC8vIExpc3RlbiBhbmQgcmVzcG9uZCB0byBhZHMgbG9hZGVkIGFuZCBlcnJvciBldmVudHNcblxuICAgICAgICB0aGlzLmxvYWRlci5hZGRFdmVudExpc3RlbmVyKGdvb2dsZS5pbWEuQWRzTWFuYWdlckxvYWRlZEV2ZW50LlR5cGUuQURTX01BTkFHRVJfTE9BREVELCBldmVudCA9PiB0aGlzLm9uQWRzTWFuYWdlckxvYWRlZChldmVudCksIGZhbHNlKTtcbiAgICAgICAgdGhpcy5sb2FkZXIuYWRkRXZlbnRMaXN0ZW5lcihnb29nbGUuaW1hLkFkRXJyb3JFdmVudC5UeXBlLkFEX0VSUk9SLCBlcnJvciA9PiB0aGlzLm9uQWRFcnJvcihlcnJvciksIGZhbHNlKTsgLy8gUmVxdWVzdCB2aWRlbyBhZHMgdG8gYmUgcHJlLWxvYWRlZFxuXG4gICAgICAgIHRoaXMucmVxdWVzdEFkcygpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwicmVxdWVzdEFkc1wiLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBjb250YWluZXJcbiAgICAgICAgfSA9IHRoaXMucGxheWVyLmVsZW1lbnRzO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gUmVxdWVzdCB2aWRlbyBhZHNcbiAgICAgICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IGdvb2dsZS5pbWEuQWRzUmVxdWVzdCgpO1xuICAgICAgICAgIHJlcXVlc3QuYWRUYWdVcmwgPSB0aGlzLnRhZ1VybDsgLy8gU3BlY2lmeSB0aGUgbGluZWFyIGFuZCBub25saW5lYXIgc2xvdCBzaXplcy4gVGhpcyBoZWxwcyB0aGUgU0RLXG4gICAgICAgICAgLy8gdG8gc2VsZWN0IHRoZSBjb3JyZWN0IGNyZWF0aXZlIGlmIG11bHRpcGxlIGFyZSByZXR1cm5lZFxuXG4gICAgICAgICAgcmVxdWVzdC5saW5lYXJBZFNsb3RXaWR0aCA9IGNvbnRhaW5lci5vZmZzZXRXaWR0aDtcbiAgICAgICAgICByZXF1ZXN0LmxpbmVhckFkU2xvdEhlaWdodCA9IGNvbnRhaW5lci5vZmZzZXRIZWlnaHQ7XG4gICAgICAgICAgcmVxdWVzdC5ub25MaW5lYXJBZFNsb3RXaWR0aCA9IGNvbnRhaW5lci5vZmZzZXRXaWR0aDtcbiAgICAgICAgICByZXF1ZXN0Lm5vbkxpbmVhckFkU2xvdEhlaWdodCA9IGNvbnRhaW5lci5vZmZzZXRIZWlnaHQ7IC8vIFdlIG9ubHkgb3ZlcmxheSBhZHMgYXMgd2Ugb25seSBzdXBwb3J0IHZpZGVvLlxuXG4gICAgICAgICAgcmVxdWVzdC5mb3JjZU5vbkxpbmVhckZ1bGxTbG90ID0gZmFsc2U7IC8vIE11dGUgYmFzZWQgb24gY3VycmVudCBzdGF0ZVxuXG4gICAgICAgICAgcmVxdWVzdC5zZXRBZFdpbGxQbGF5TXV0ZWQoIXRoaXMucGxheWVyLm11dGVkKTtcbiAgICAgICAgICB0aGlzLmxvYWRlci5yZXF1ZXN0QWRzKHJlcXVlc3QpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHRoaXMub25BZEVycm9yKGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwicG9sbENvdW50ZG93blwiLCAoc3RhcnQgPSBmYWxzZSkgPT4ge1xuICAgICAgICBpZiAoIXN0YXJ0KSB7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNvdW50ZG93blRpbWVyKTtcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtYmFkZ2UtdGV4dCcpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHVwZGF0ZSA9ICgpID0+IHtcbiAgICAgICAgICBjb25zdCB0aW1lID0gZm9ybWF0VGltZShNYXRoLm1heCh0aGlzLm1hbmFnZXIuZ2V0UmVtYWluaW5nVGltZSgpLCAwKSk7XG4gICAgICAgICAgY29uc3QgbGFiZWwgPSBgJHtpMThuLmdldCgnYWR2ZXJ0aXNlbWVudCcsIHRoaXMucGxheWVyLmNvbmZpZyl9IC0gJHt0aW1lfWA7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIuc2V0QXR0cmlidXRlKCdkYXRhLWJhZGdlLXRleHQnLCBsYWJlbCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5jb3VudGRvd25UaW1lciA9IHNldEludGVydmFsKHVwZGF0ZSwgMTAwKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcIm9uQWRzTWFuYWdlckxvYWRlZFwiLCBldmVudCA9PiB7XG4gICAgICAgIC8vIExvYWQgY291bGQgb2NjdXIgYWZ0ZXIgYSBzb3VyY2UgY2hhbmdlIChyYWNlIGNvbmRpdGlvbilcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gLy8gR2V0IHRoZSBhZHMgbWFuYWdlclxuXG5cbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBuZXcgZ29vZ2xlLmltYS5BZHNSZW5kZXJpbmdTZXR0aW5ncygpOyAvLyBUZWxsIHRoZSBTREsgdG8gc2F2ZSBhbmQgcmVzdG9yZSBjb250ZW50IHZpZGVvIHN0YXRlIG9uIG91ciBiZWhhbGZcblxuICAgICAgICBzZXR0aW5ncy5yZXN0b3JlQ3VzdG9tUGxheWJhY2tTdGF0ZU9uQWRCcmVha0NvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgc2V0dGluZ3MuZW5hYmxlUHJlbG9hZGluZyA9IHRydWU7IC8vIFRoZSBTREsgaXMgcG9sbGluZyBjdXJyZW50VGltZSBvbiB0aGUgY29udGVudFBsYXliYWNrLiBBbmQgbmVlZHMgYSBkdXJhdGlvblxuICAgICAgICAvLyBzbyBpdCBjYW4gZGV0ZXJtaW5lIHdoZW4gdG8gc3RhcnQgdGhlIG1pZC0gYW5kIHBvc3Qtcm9sbFxuXG4gICAgICAgIHRoaXMubWFuYWdlciA9IGV2ZW50LmdldEFkc01hbmFnZXIodGhpcy5wbGF5ZXIsIHNldHRpbmdzKTsgLy8gR2V0IHRoZSBjdWUgcG9pbnRzIGZvciBhbnkgbWlkLXJvbGxzIGJ5IGZpbHRlcmluZyBvdXQgdGhlIHByZS0gYW5kIHBvc3Qtcm9sbFxuXG4gICAgICAgIHRoaXMuY3VlUG9pbnRzID0gdGhpcy5tYW5hZ2VyLmdldEN1ZVBvaW50cygpOyAvLyBBZGQgbGlzdGVuZXJzIHRvIHRoZSByZXF1aXJlZCBldmVudHNcbiAgICAgICAgLy8gQWR2ZXJ0aXNlbWVudCBlcnJvciBldmVudHNcblxuICAgICAgICB0aGlzLm1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihnb29nbGUuaW1hLkFkRXJyb3JFdmVudC5UeXBlLkFEX0VSUk9SLCBlcnJvciA9PiB0aGlzLm9uQWRFcnJvcihlcnJvcikpOyAvLyBBZHZlcnRpc2VtZW50IHJlZ3VsYXIgZXZlbnRzXG5cbiAgICAgICAgT2JqZWN0LmtleXMoZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUpLmZvckVhY2godHlwZSA9PiB7XG4gICAgICAgICAgdGhpcy5tYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGVbdHlwZV0sIGUgPT4gdGhpcy5vbkFkRXZlbnQoZSkpO1xuICAgICAgICB9KTsgLy8gUmVzb2x2ZSBvdXIgYWRzTWFuYWdlclxuXG4gICAgICAgIHRoaXMudHJpZ2dlcignbG9hZGVkJyk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJhZGRDdWVQb2ludHNcIiwgKCkgPT4ge1xuICAgICAgICAvLyBBZGQgYWR2ZXJ0aXNlbWVudCBjdWUncyB3aXRoaW4gdGhlIHRpbWUgbGluZSBpZiBhdmFpbGFibGVcbiAgICAgICAgaWYgKCFpcy5lbXB0eSh0aGlzLmN1ZVBvaW50cykpIHtcbiAgICAgICAgICB0aGlzLmN1ZVBvaW50cy5mb3JFYWNoKGN1ZVBvaW50ID0+IHtcbiAgICAgICAgICAgIGlmIChjdWVQb2ludCAhPT0gMCAmJiBjdWVQb2ludCAhPT0gLTEgJiYgY3VlUG9pbnQgPCB0aGlzLnBsYXllci5kdXJhdGlvbikge1xuICAgICAgICAgICAgICBjb25zdCBzZWVrRWxlbWVudCA9IHRoaXMucGxheWVyLmVsZW1lbnRzLnByb2dyZXNzO1xuXG4gICAgICAgICAgICAgIGlmIChpcy5lbGVtZW50KHNlZWtFbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1ZVBlcmNlbnRhZ2UgPSAxMDAgLyB0aGlzLnBsYXllci5kdXJhdGlvbiAqIGN1ZVBvaW50O1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1ZSA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7XG4gICAgICAgICAgICAgICAgICBjbGFzczogdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMuY3Vlc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGN1ZS5zdHlsZS5sZWZ0ID0gYCR7Y3VlUGVyY2VudGFnZS50b1N0cmluZygpfSVgO1xuICAgICAgICAgICAgICAgIHNlZWtFbGVtZW50LmFwcGVuZENoaWxkKGN1ZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwib25BZEV2ZW50XCIsIGV2ZW50ID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGNvbnRhaW5lclxuICAgICAgICB9ID0gdGhpcy5wbGF5ZXIuZWxlbWVudHM7IC8vIFJldHJpZXZlIHRoZSBhZCBmcm9tIHRoZSBldmVudC4gU29tZSBldmVudHMgKGUuZy4gQUxMX0FEU19DT01QTEVURUQpXG4gICAgICAgIC8vIGRvbid0IGhhdmUgYWQgb2JqZWN0IGFzc29jaWF0ZWRcblxuICAgICAgICBjb25zdCBhZCA9IGV2ZW50LmdldEFkKCk7XG4gICAgICAgIGNvbnN0IGFkRGF0YSA9IGV2ZW50LmdldEFkRGF0YSgpOyAvLyBQcm94eSBldmVudFxuXG4gICAgICAgIGNvbnN0IGRpc3BhdGNoRXZlbnQgPSB0eXBlID0+IHtcbiAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbCh0aGlzLnBsYXllciwgdGhpcy5wbGF5ZXIubWVkaWEsIGBhZHMke3R5cGUucmVwbGFjZSgvXy9nLCAnJykudG9Mb3dlckNhc2UoKX1gKTtcbiAgICAgICAgfTsgLy8gQnViYmxlIHRoZSBldmVudFxuXG5cbiAgICAgICAgZGlzcGF0Y2hFdmVudChldmVudC50eXBlKTtcblxuICAgICAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcbiAgICAgICAgICBjYXNlIGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlLkxPQURFRDpcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGZpcnN0IGV2ZW50IHNlbnQgZm9yIGFuIGFkIC0gaXQgaXMgcG9zc2libGUgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlXG4gICAgICAgICAgICAvLyBhZCBpcyBhIHZpZGVvIGFkIG9yIGFuIG92ZXJsYXlcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcignbG9hZGVkJyk7IC8vIFN0YXJ0IGNvdW50ZG93blxuXG4gICAgICAgICAgICB0aGlzLnBvbGxDb3VudGRvd24odHJ1ZSk7XG5cbiAgICAgICAgICAgIGlmICghYWQuaXNMaW5lYXIoKSkge1xuICAgICAgICAgICAgICAvLyBQb3NpdGlvbiBBZERpc3BsYXlDb250YWluZXIgY29ycmVjdGx5IGZvciBvdmVybGF5XG4gICAgICAgICAgICAgIGFkLndpZHRoID0gY29udGFpbmVyLm9mZnNldFdpZHRoO1xuICAgICAgICAgICAgICBhZC5oZWlnaHQgPSBjb250YWluZXIub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgfSAvLyBjb25zb2xlLmluZm8oJ0FkIHR5cGU6ICcgKyBldmVudC5nZXRBZCgpLmdldEFkUG9kSW5mbygpLmdldFBvZEluZGV4KCkpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5pbmZvKCdBZCB0aW1lOiAnICsgZXZlbnQuZ2V0QWQoKS5nZXRBZFBvZEluZm8oKS5nZXRUaW1lT2Zmc2V0KCkpO1xuXG5cbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5TVEFSVEVEOlxuICAgICAgICAgICAgLy8gU2V0IHZvbHVtZSB0byBtYXRjaCBwbGF5ZXJcbiAgICAgICAgICAgIHRoaXMubWFuYWdlci5zZXRWb2x1bWUodGhpcy5wbGF5ZXIudm9sdW1lKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5BTExfQURTX0NPTVBMRVRFRDpcbiAgICAgICAgICAgIC8vIEFsbCBhZHMgZm9yIHRoZSBjdXJyZW50IHZpZGVvcyBhcmUgZG9uZS4gV2UgY2FuIG5vdyByZXF1ZXN0IG5ldyBhZHZlcnRpc2VtZW50c1xuICAgICAgICAgICAgLy8gaW4gY2FzZSB0aGUgdmlkZW8gaXMgcmUtcGxheWVkXG4gICAgICAgICAgICAvLyBUT0RPOiBFeGFtcGxlIGZvciB3aGF0IGhhcHBlbnMgd2hlbiBhIG5leHQgdmlkZW8gaW4gYSBwbGF5bGlzdCB3b3VsZCBiZSBsb2FkZWQuXG4gICAgICAgICAgICAvLyBTbyBoZXJlIHdlIGxvYWQgYSBuZXcgdmlkZW8gd2hlbiBhbGwgYWRzIGFyZSBkb25lLlxuICAgICAgICAgICAgLy8gVGhlbiB3ZSBsb2FkIG5ldyBhZHMgd2l0aGluIGEgbmV3IGFkc01hbmFnZXIuIFdoZW4gdGhlIHZpZGVvXG4gICAgICAgICAgICAvLyBJcyBzdGFydGVkIC0gYWZ0ZXIgLSB0aGUgYWRzIGFyZSBsb2FkZWQsIHRoZW4gd2UgZ2V0IGFkcy5cbiAgICAgICAgICAgIC8vIFlvdSBjYW4gYWxzbyBlYXNpbHkgdGVzdCBjYW5jZWxsaW5nIGFuZCByZWxvYWRpbmcgYnkgcnVubmluZ1xuICAgICAgICAgICAgLy8gcGxheWVyLmFkcy5jYW5jZWwoKSBhbmQgcGxheWVyLmFkcy5wbGF5IGZyb20gdGhlIGNvbnNvbGUgSSBndWVzcy5cbiAgICAgICAgICAgIC8vIHRoaXMucGxheWVyLnNvdXJjZSA9IHtcbiAgICAgICAgICAgIC8vICAgICB0eXBlOiAndmlkZW8nLFxuICAgICAgICAgICAgLy8gICAgIHRpdGxlOiAnVmlldyBGcm9tIEEgQmx1ZSBNb29uJyxcbiAgICAgICAgICAgIC8vICAgICBzb3VyY2VzOiBbe1xuICAgICAgICAgICAgLy8gICAgICAgICBzcmM6XG4gICAgICAgICAgICAvLyAnaHR0cHM6Ly9jZG4ucGx5ci5pby9zdGF0aWMvZGVtby9WaWV3X0Zyb21fQV9CbHVlX01vb25fVHJhaWxlci1IRC5tcDQnLCB0eXBlOlxuICAgICAgICAgICAgLy8gJ3ZpZGVvL21wNCcsIH1dLCBwb3N0ZXI6XG4gICAgICAgICAgICAvLyAnaHR0cHM6Ly9jZG4ucGx5ci5pby9zdGF0aWMvZGVtby9WaWV3X0Zyb21fQV9CbHVlX01vb25fVHJhaWxlci1IRC5qcGcnLCB0cmFja3M6XG4gICAgICAgICAgICAvLyBbIHsga2luZDogJ2NhcHRpb25zJywgbGFiZWw6ICdFbmdsaXNoJywgc3JjbGFuZzogJ2VuJywgc3JjOlxuICAgICAgICAgICAgLy8gJ2h0dHBzOi8vY2RuLnBseXIuaW8vc3RhdGljL2RlbW8vVmlld19Gcm9tX0FfQmx1ZV9Nb29uX1RyYWlsZXItSEQuZW4udnR0JyxcbiAgICAgICAgICAgIC8vIGRlZmF1bHQ6IHRydWUsIH0sIHsga2luZDogJ2NhcHRpb25zJywgbGFiZWw6ICdGcmVuY2gnLCBzcmNsYW5nOiAnZnInLCBzcmM6XG4gICAgICAgICAgICAvLyAnaHR0cHM6Ly9jZG4ucGx5ci5pby9zdGF0aWMvZGVtby9WaWV3X0Zyb21fQV9CbHVlX01vb25fVHJhaWxlci1IRC5mci52dHQnLCB9LCBdLFxuICAgICAgICAgICAgLy8gfTtcbiAgICAgICAgICAgIC8vIFRPRE86IFNvIHRoZXJlIGlzIHN0aWxsIHRoaXMgdGhpbmcgd2hlcmUgYSB2aWRlbyBzaG91bGQgb25seSBiZSBhbGxvd2VkIHRvIHN0YXJ0XG4gICAgICAgICAgICAvLyBwbGF5aW5nIHdoZW4gdGhlIElNQSBTREsgaXMgcmVhZHkgb3IgaGFzIGZhaWxlZFxuICAgICAgICAgICAgaWYgKHRoaXMucGxheWVyLmVuZGVkKSB7XG4gICAgICAgICAgICAgIHRoaXMubG9hZEFkcygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgLy8gVGhlIFNESyB3b24ndCBhbGxvdyBuZXcgYWRzIHRvIGJlIGNhbGxlZCB3aXRob3V0IHJlY2VpdmluZyBhIGNvbnRlbnRDb21wbGV0ZSgpXG4gICAgICAgICAgICAgIHRoaXMubG9hZGVyLmNvbnRlbnRDb21wbGV0ZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuQ09OVEVOVF9QQVVTRV9SRVFVRVNURUQ6XG4gICAgICAgICAgICAvLyBUaGlzIGV2ZW50IGluZGljYXRlcyB0aGUgYWQgaGFzIHN0YXJ0ZWQgLSB0aGUgdmlkZW8gcGxheWVyIGNhbiBhZGp1c3QgdGhlIFVJLFxuICAgICAgICAgICAgLy8gZm9yIGV4YW1wbGUgZGlzcGxheSBhIHBhdXNlIGJ1dHRvbiBhbmQgcmVtYWluaW5nIHRpbWUuIEZpcmVkIHdoZW4gY29udGVudCBzaG91bGRcbiAgICAgICAgICAgIC8vIGJlIHBhdXNlZC4gVGhpcyB1c3VhbGx5IGhhcHBlbnMgcmlnaHQgYmVmb3JlIGFuIGFkIGlzIGFib3V0IHRvIGNvdmVyIHRoZSBjb250ZW50XG4gICAgICAgICAgICB0aGlzLnBhdXNlQ29udGVudCgpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlLkNPTlRFTlRfUkVTVU1FX1JFUVVFU1RFRDpcbiAgICAgICAgICAgIC8vIFRoaXMgZXZlbnQgaW5kaWNhdGVzIHRoZSBhZCBoYXMgZmluaXNoZWQgLSB0aGUgdmlkZW8gcGxheWVyIGNhbiBwZXJmb3JtXG4gICAgICAgICAgICAvLyBhcHByb3ByaWF0ZSBVSSBhY3Rpb25zLCBzdWNoIGFzIHJlbW92aW5nIHRoZSB0aW1lciBmb3IgcmVtYWluaW5nIHRpbWUgZGV0ZWN0aW9uLlxuICAgICAgICAgICAgLy8gRmlyZWQgd2hlbiBjb250ZW50IHNob3VsZCBiZSByZXN1bWVkLiBUaGlzIHVzdWFsbHkgaGFwcGVucyB3aGVuIGFuIGFkIGZpbmlzaGVzXG4gICAgICAgICAgICAvLyBvciBjb2xsYXBzZXNcbiAgICAgICAgICAgIHRoaXMucG9sbENvdW50ZG93bigpO1xuICAgICAgICAgICAgdGhpcy5yZXN1bWVDb250ZW50KCk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuTE9HOlxuICAgICAgICAgICAgaWYgKGFkRGF0YS5hZEVycm9yKSB7XG4gICAgICAgICAgICAgIHRoaXMucGxheWVyLmRlYnVnLndhcm4oYE5vbi1mYXRhbCBhZCBlcnJvcjogJHthZERhdGEuYWRFcnJvci5nZXRNZXNzYWdlKCl9YCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJvbkFkRXJyb3JcIiwgZXZlbnQgPT4ge1xuICAgICAgICB0aGlzLmNhbmNlbCgpO1xuICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy53YXJuKCdBZHMgZXJyb3InLCBldmVudCk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJsaXN0ZW5lcnNcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgY29udGFpbmVyXG4gICAgICAgIH0gPSB0aGlzLnBsYXllci5lbGVtZW50cztcbiAgICAgICAgbGV0IHRpbWU7XG4gICAgICAgIHRoaXMucGxheWVyLm9uKCdjYW5wbGF5JywgKCkgPT4ge1xuICAgICAgICAgIHRoaXMuYWRkQ3VlUG9pbnRzKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBsYXllci5vbignZW5kZWQnLCAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5sb2FkZXIuY29udGVudENvbXBsZXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBsYXllci5vbigndGltZXVwZGF0ZScsICgpID0+IHtcbiAgICAgICAgICB0aW1lID0gdGhpcy5wbGF5ZXIuY3VycmVudFRpbWU7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBsYXllci5vbignc2Vla2VkJywgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHNlZWtlZFRpbWUgPSB0aGlzLnBsYXllci5jdXJyZW50VGltZTtcblxuICAgICAgICAgIGlmIChpcy5lbXB0eSh0aGlzLmN1ZVBvaW50cykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLmN1ZVBvaW50cy5mb3JFYWNoKChjdWVQb2ludCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aW1lIDwgY3VlUG9pbnQgJiYgY3VlUG9pbnQgPCBzZWVrZWRUaW1lKSB7XG4gICAgICAgICAgICAgIHRoaXMubWFuYWdlci5kaXNjYXJkQWRCcmVhaygpO1xuICAgICAgICAgICAgICB0aGlzLmN1ZVBvaW50cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTsgLy8gTGlzdGVuIHRvIHRoZSByZXNpemluZyBvZiB0aGUgd2luZG93LiBBbmQgcmVzaXplIGFkIGFjY29yZGluZ2x5XG4gICAgICAgIC8vIFRPRE86IGV2ZW50dWFsbHkgaW1wbGVtZW50IFJlc2l6ZU9ic2VydmVyXG5cbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHtcbiAgICAgICAgICBpZiAodGhpcy5tYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aGlzLm1hbmFnZXIucmVzaXplKGNvbnRhaW5lci5vZmZzZXRXaWR0aCwgY29udGFpbmVyLm9mZnNldEhlaWdodCwgZ29vZ2xlLmltYS5WaWV3TW9kZS5OT1JNQUwpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJwbGF5XCIsICgpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGNvbnRhaW5lclxuICAgICAgICB9ID0gdGhpcy5wbGF5ZXIuZWxlbWVudHM7XG5cbiAgICAgICAgaWYgKCF0aGlzLm1hbmFnZXJQcm9taXNlKSB7XG4gICAgICAgICAgdGhpcy5yZXN1bWVDb250ZW50KCk7XG4gICAgICAgIH0gLy8gUGxheSB0aGUgcmVxdWVzdGVkIGFkdmVydGlzZW1lbnQgd2hlbmV2ZXIgdGhlIGFkc01hbmFnZXIgaXMgcmVhZHlcblxuXG4gICAgICAgIHRoaXMubWFuYWdlclByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICAgICAgLy8gU2V0IHZvbHVtZSB0byBtYXRjaCBwbGF5ZXJcbiAgICAgICAgICB0aGlzLm1hbmFnZXIuc2V0Vm9sdW1lKHRoaXMucGxheWVyLnZvbHVtZSk7IC8vIEluaXRpYWxpemUgdGhlIGNvbnRhaW5lci4gTXVzdCBiZSBkb25lIHZpYSBhIHVzZXIgYWN0aW9uIG9uIG1vYmlsZSBkZXZpY2VzXG5cbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLmRpc3BsYXlDb250YWluZXIuaW5pdGlhbGl6ZSgpO1xuXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBhZHMgbWFuYWdlci4gQWQgcnVsZXMgcGxheWxpc3Qgd2lsbCBzdGFydCBhdCB0aGlzIHRpbWVcbiAgICAgICAgICAgICAgdGhpcy5tYW5hZ2VyLmluaXQoY29udGFpbmVyLm9mZnNldFdpZHRoLCBjb250YWluZXIub2Zmc2V0SGVpZ2h0LCBnb29nbGUuaW1hLlZpZXdNb2RlLk5PUk1BTCk7IC8vIENhbGwgcGxheSB0byBzdGFydCBzaG93aW5nIHRoZSBhZC4gU2luZ2xlIHZpZGVvIGFuZCBvdmVybGF5IGFkcyB3aWxsXG4gICAgICAgICAgICAgIC8vIHN0YXJ0IGF0IHRoaXMgdGltZTsgdGhlIGNhbGwgd2lsbCBiZSBpZ25vcmVkIGZvciBhZCBydWxlc1xuXG4gICAgICAgICAgICAgIHRoaXMubWFuYWdlci5zdGFydCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgICB9IGNhdGNoIChhZEVycm9yKSB7XG4gICAgICAgICAgICAvLyBBbiBlcnJvciBtYXkgYmUgdGhyb3duIGlmIHRoZXJlIHdhcyBhIHByb2JsZW0gd2l0aCB0aGVcbiAgICAgICAgICAgIC8vIFZBU1QgcmVzcG9uc2VcbiAgICAgICAgICAgIHRoaXMub25BZEVycm9yKGFkRXJyb3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSkuY2F0Y2goKCkgPT4ge30pO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwicmVzdW1lQ29udGVudFwiLCAoKSA9PiB7XG4gICAgICAgIC8vIEhpZGUgdGhlIGFkdmVydGlzZW1lbnQgY29udGFpbmVyXG4gICAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLnN0eWxlLnpJbmRleCA9ICcnOyAvLyBBZCBpcyBzdG9wcGVkXG5cbiAgICAgICAgdGhpcy5wbGF5aW5nID0gZmFsc2U7IC8vIFBsYXkgdmlkZW9cblxuICAgICAgICBzaWxlbmNlUHJvbWlzZSh0aGlzLnBsYXllci5tZWRpYS5wbGF5KCkpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwicGF1c2VDb250ZW50XCIsICgpID0+IHtcbiAgICAgICAgLy8gU2hvdyB0aGUgYWR2ZXJ0aXNlbWVudCBjb250YWluZXJcbiAgICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIuc3R5bGUuekluZGV4ID0gMzsgLy8gQWQgaXMgcGxheWluZ1xuXG4gICAgICAgIHRoaXMucGxheWluZyA9IHRydWU7IC8vIFBhdXNlIG91ciB2aWRlby5cblxuICAgICAgICB0aGlzLnBsYXllci5tZWRpYS5wYXVzZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiY2FuY2VsXCIsICgpID0+IHtcbiAgICAgICAgLy8gUGF1c2Ugb3VyIHZpZGVvXG4gICAgICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgdGhpcy5yZXN1bWVDb250ZW50KCk7XG4gICAgICAgIH0gLy8gVGVsbCBvdXIgaW5zdGFuY2UgdGhhdCB3ZSdyZSBkb25lIGZvciBub3dcblxuXG4gICAgICAgIHRoaXMudHJpZ2dlcignZXJyb3InKTsgLy8gUmUtY3JlYXRlIG91ciBhZHNNYW5hZ2VyXG5cbiAgICAgICAgdGhpcy5sb2FkQWRzKCk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJsb2FkQWRzXCIsICgpID0+IHtcbiAgICAgICAgLy8gVGVsbCBvdXIgYWRzTWFuYWdlciB0byBnbyBieWUgYnllXG4gICAgICAgIHRoaXMubWFuYWdlclByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICAgICAgLy8gRGVzdHJveSBvdXIgYWRzTWFuYWdlclxuICAgICAgICAgIGlmICh0aGlzLm1hbmFnZXIpIHtcbiAgICAgICAgICAgIHRoaXMubWFuYWdlci5kZXN0cm95KCk7XG4gICAgICAgICAgfSAvLyBSZS1zZXQgb3VyIGFkc01hbmFnZXIgcHJvbWlzZXNcblxuXG4gICAgICAgICAgdGhpcy5tYW5hZ2VyUHJvbWlzZSA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICAgICAgdGhpcy5vbignbG9hZGVkJywgcmVzb2x2ZSk7XG4gICAgICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2codGhpcy5tYW5hZ2VyKTtcbiAgICAgICAgICB9KTsgLy8gTm93IHRoYXQgdGhlIG1hbmFnZXIgaGFzIGJlZW4gZGVzdHJveWVkIHNldCBpdCB0byBhbHNvIGJlIHVuLWluaXRpYWxpemVkXG5cbiAgICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7IC8vIE5vdyByZXF1ZXN0IHNvbWUgbmV3IGFkdmVydGlzZW1lbnRzXG5cbiAgICAgICAgICB0aGlzLnJlcXVlc3RBZHMoKTtcbiAgICAgICAgfSkuY2F0Y2goKCkgPT4ge30pO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwidHJpZ2dlclwiLCAoZXZlbnQsIC4uLmFyZ3MpID0+IHtcbiAgICAgICAgY29uc3QgaGFuZGxlcnMgPSB0aGlzLmV2ZW50c1tldmVudF07XG5cbiAgICAgICAgaWYgKGlzLmFycmF5KGhhbmRsZXJzKSkge1xuICAgICAgICAgIGhhbmRsZXJzLmZvckVhY2goaGFuZGxlciA9PiB7XG4gICAgICAgICAgICBpZiAoaXMuZnVuY3Rpb24oaGFuZGxlcikpIHtcbiAgICAgICAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwib25cIiwgKGV2ZW50LCBjYWxsYmFjaykgPT4ge1xuICAgICAgICBpZiAoIWlzLmFycmF5KHRoaXMuZXZlbnRzW2V2ZW50XSkpIHtcbiAgICAgICAgICB0aGlzLmV2ZW50c1tldmVudF0gPSBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50XS5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJzdGFydFNhZmV0eVRpbWVyXCIsICh0aW1lLCBmcm9tKSA9PiB7XG4gICAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZyhgU2FmZXR5IHRpbWVyIGludm9rZWQgZnJvbTogJHtmcm9tfWApO1xuICAgICAgICB0aGlzLnNhZmV0eVRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5jYW5jZWwoKTtcbiAgICAgICAgICB0aGlzLmNsZWFyU2FmZXR5VGltZXIoJ3N0YXJ0U2FmZXR5VGltZXIoKScpO1xuICAgICAgICB9LCB0aW1lKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImNsZWFyU2FmZXR5VGltZXJcIiwgZnJvbSA9PiB7XG4gICAgICAgIGlmICghaXMubnVsbE9yVW5kZWZpbmVkKHRoaXMuc2FmZXR5VGltZXIpKSB7XG4gICAgICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKGBTYWZldHkgdGltZXIgY2xlYXJlZCBmcm9tOiAke2Zyb219YCk7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuc2FmZXR5VGltZXIpO1xuICAgICAgICAgIHRoaXMuc2FmZXR5VGltZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5wbGF5ZXIgPSBwbGF5ZXI7XG4gICAgICB0aGlzLmNvbmZpZyA9IHBsYXllci5jb25maWcuYWRzO1xuICAgICAgdGhpcy5wbGF5aW5nID0gZmFsc2U7XG4gICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICB0aGlzLmVsZW1lbnRzID0ge1xuICAgICAgICBjb250YWluZXI6IG51bGwsXG4gICAgICAgIGRpc3BsYXlDb250YWluZXI6IG51bGxcbiAgICAgIH07XG4gICAgICB0aGlzLm1hbmFnZXIgPSBudWxsO1xuICAgICAgdGhpcy5sb2FkZXIgPSBudWxsO1xuICAgICAgdGhpcy5jdWVQb2ludHMgPSBudWxsO1xuICAgICAgdGhpcy5ldmVudHMgPSB7fTtcbiAgICAgIHRoaXMuc2FmZXR5VGltZXIgPSBudWxsO1xuICAgICAgdGhpcy5jb3VudGRvd25UaW1lciA9IG51bGw7IC8vIFNldHVwIGEgcHJvbWlzZSB0byByZXNvbHZlIHdoZW4gdGhlIElNQSBtYW5hZ2VyIGlzIHJlYWR5XG5cbiAgICAgIHRoaXMubWFuYWdlclByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIC8vIFRoZSBhZCBpcyBsb2FkZWQgYW5kIHJlYWR5XG4gICAgICAgIHRoaXMub24oJ2xvYWRlZCcsIHJlc29sdmUpOyAvLyBBZHMgZmFpbGVkXG5cbiAgICAgICAgdGhpcy5vbignZXJyb3InLCByZWplY3QpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmxvYWQoKTtcbiAgICB9XG5cbiAgICBnZXQgZW5hYmxlZCgpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgY29uZmlnXG4gICAgICB9ID0gdGhpcztcbiAgICAgIHJldHVybiB0aGlzLnBsYXllci5pc0hUTUw1ICYmIHRoaXMucGxheWVyLmlzVmlkZW8gJiYgY29uZmlnLmVuYWJsZWQgJiYgKCFpcy5lbXB0eShjb25maWcucHVibGlzaGVySWQpIHx8IGlzLnVybChjb25maWcudGFnVXJsKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvYWQgdGhlIElNQSBTREtcbiAgICAgKi9cblxuXG4gICAgLy8gQnVpbGQgdGhlIHRhZyBVUkxcbiAgICBnZXQgdGFnVXJsKCkge1xuICAgICAgY29uc3Qge1xuICAgICAgICBjb25maWdcbiAgICAgIH0gPSB0aGlzO1xuXG4gICAgICBpZiAoaXMudXJsKGNvbmZpZy50YWdVcmwpKSB7XG4gICAgICAgIHJldHVybiBjb25maWcudGFnVXJsO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgIEFWX1BVQkxJU0hFUklEOiAnNThjMjViYjAwNzNlZjQ0OGIxMDg3YWQ2JyxcbiAgICAgICAgQVZfQ0hBTk5FTElEOiAnNWEwNDU4ZGMyOGEwNjE0NWU0NTE5ZDIxJyxcbiAgICAgICAgQVZfVVJMOiB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUsXG4gICAgICAgIGNiOiBEYXRlLm5vdygpLFxuICAgICAgICBBVl9XSURUSDogNjQwLFxuICAgICAgICBBVl9IRUlHSFQ6IDQ4MCxcbiAgICAgICAgQVZfQ0RJTTI6IGNvbmZpZy5wdWJsaXNoZXJJZFxuICAgICAgfTtcbiAgICAgIGNvbnN0IGJhc2UgPSAnaHR0cHM6Ly9nby5hbml2aWV3LmNvbS9hcGkvYWRzZXJ2ZXI2L3Zhc3QvJztcbiAgICAgIHJldHVybiBgJHtiYXNlfT8ke2J1aWxkVXJsUGFyYW1zKHBhcmFtcyl9YDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW4gb3JkZXIgZm9yIHRoZSBTREsgdG8gZGlzcGxheSBhZHMgZm9yIG91ciB2aWRlbywgd2UgbmVlZCB0byB0ZWxsIGl0IHdoZXJlIHRvIHB1dCB0aGVtLFxuICAgICAqIHNvIGhlcmUgd2UgZGVmaW5lIG91ciBhZCBjb250YWluZXIuIFRoaXMgZGl2IGlzIHNldCB1cCB0byByZW5kZXIgb24gdG9wIG9mIHRoZSB2aWRlbyBwbGF5ZXIuXG4gICAgICogVXNpbmcgdGhlIGNvZGUgYmVsb3csIHdlIHRlbGwgdGhlIFNESyB0byByZW5kZXIgYWRzIHdpdGhpbiB0aGF0IGRpdi4gV2UgYWxzbyBwcm92aWRlIGFcbiAgICAgKiBoYW5kbGUgdG8gdGhlIGNvbnRlbnQgdmlkZW8gcGxheWVyIC0gdGhlIFNESyB3aWxsIHBvbGwgdGhlIGN1cnJlbnQgdGltZSBvZiBvdXIgcGxheWVyIHRvXG4gICAgICogcHJvcGVybHkgcGxhY2UgbWlkLXJvbGxzLiBBZnRlciB3ZSBjcmVhdGUgdGhlIGFkIGRpc3BsYXkgY29udGFpbmVyLCB3ZSBpbml0aWFsaXplIGl0LiBPblxuICAgICAqIG1vYmlsZSBkZXZpY2VzLCB0aGlzIGluaXRpYWxpemF0aW9uIGlzIGRvbmUgYXMgdGhlIHJlc3VsdCBvZiBhIHVzZXIgYWN0aW9uLlxuICAgICAqL1xuXG5cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgbnVtYmVyIHdob3NlIHZhbHVlIGlzIGxpbWl0ZWQgdG8gdGhlIGdpdmVuIHJhbmdlLlxuICAgKlxuICAgKiBFeGFtcGxlOiBsaW1pdCB0aGUgb3V0cHV0IG9mIHRoaXMgY29tcHV0YXRpb24gdG8gYmV0d2VlbiAwIGFuZCAyNTVcbiAgICogKHggKiAyNTUpLmNsYW1wKDAsIDI1NSlcbiAgICpcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGlucHV0XG4gICAqIEBwYXJhbSB7TnVtYmVyfSBtaW4gVGhlIGxvd2VyIGJvdW5kYXJ5IG9mIHRoZSBvdXRwdXQgcmFuZ2VcbiAgICogQHBhcmFtIHtOdW1iZXJ9IG1heCBUaGUgdXBwZXIgYm91bmRhcnkgb2YgdGhlIG91dHB1dCByYW5nZVxuICAgKiBAcmV0dXJucyBBIG51bWJlciB3aXRoaW4gdGhlIGJvdW5kcyBvZiBtaW4gYW5kIG1heFxuICAgKiBAdHlwZSBOdW1iZXJcbiAgICovXG4gIGZ1bmN0aW9uIGNsYW1wKGlucHV0ID0gMCwgbWluID0gMCwgbWF4ID0gMjU1KSB7XG4gICAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KGlucHV0LCBtaW4pLCBtYXgpO1xuICB9XG5cbiAgY29uc3QgcGFyc2VWdHQgPSB2dHREYXRhU3RyaW5nID0+IHtcbiAgICBjb25zdCBwcm9jZXNzZWRMaXN0ID0gW107XG4gICAgY29uc3QgZnJhbWVzID0gdnR0RGF0YVN0cmluZy5zcGxpdCgvXFxyXFxuXFxyXFxufFxcblxcbnxcXHJcXHIvKTtcbiAgICBmcmFtZXMuZm9yRWFjaChmcmFtZSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICAgIGNvbnN0IGxpbmVzID0gZnJhbWUuc3BsaXQoL1xcclxcbnxcXG58XFxyLyk7XG4gICAgICBsaW5lcy5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICBpZiAoIWlzLm51bWJlcihyZXN1bHQuc3RhcnRUaW1lKSkge1xuICAgICAgICAgIC8vIFRoZSBsaW5lIHdpdGggc3RhcnQgYW5kIGVuZCB0aW1lcyBvbiBpdCBpcyB0aGUgZmlyc3QgbGluZSBvZiBpbnRlcmVzdFxuICAgICAgICAgIGNvbnN0IG1hdGNoVGltZXMgPSBsaW5lLm1hdGNoKC8oWzAtOV17Mn0pPzo/KFswLTldezJ9KTooWzAtOV17Mn0pLihbMC05XXsyLDN9KSggPy0tPiA/KShbMC05XXsyfSk/Oj8oWzAtOV17Mn0pOihbMC05XXsyfSkuKFswLTldezIsM30pLyk7IC8vIE5vdGUgdGhhdCB0aGlzIGN1cnJlbnRseSBpZ25vcmVzIGNhcHRpb24gZm9ybWF0dGluZyBkaXJlY3RpdmVzIHRoYXQgYXJlIG9wdGlvbmFsbHkgb24gdGhlIGVuZCBvZiB0aGlzIGxpbmUgLSBmaW5lIGZvciBub24tY2FwdGlvbnMgVlRUXG5cbiAgICAgICAgICBpZiAobWF0Y2hUaW1lcykge1xuICAgICAgICAgICAgcmVzdWx0LnN0YXJ0VGltZSA9IE51bWJlcihtYXRjaFRpbWVzWzFdIHx8IDApICogNjAgKiA2MCArIE51bWJlcihtYXRjaFRpbWVzWzJdKSAqIDYwICsgTnVtYmVyKG1hdGNoVGltZXNbM10pICsgTnVtYmVyKGAwLiR7bWF0Y2hUaW1lc1s0XX1gKTtcbiAgICAgICAgICAgIHJlc3VsdC5lbmRUaW1lID0gTnVtYmVyKG1hdGNoVGltZXNbNl0gfHwgMCkgKiA2MCAqIDYwICsgTnVtYmVyKG1hdGNoVGltZXNbN10pICogNjAgKyBOdW1iZXIobWF0Y2hUaW1lc1s4XSkgKyBOdW1iZXIoYDAuJHttYXRjaFRpbWVzWzldfWApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICghaXMuZW1wdHkobGluZS50cmltKCkpICYmIGlzLmVtcHR5KHJlc3VsdC50ZXh0KSkge1xuICAgICAgICAgIC8vIElmIHdlIGFscmVhZHkgaGF2ZSB0aGUgc3RhcnRUaW1lLCB0aGVuIHdlJ3JlIGRlZmluaXRlbHkgdXAgdG8gdGhlIHRleHQgbGluZShzKVxuICAgICAgICAgIGNvbnN0IGxpbmVTcGxpdCA9IGxpbmUudHJpbSgpLnNwbGl0KCcjeHl3aD0nKTtcbiAgICAgICAgICBbcmVzdWx0LnRleHRdID0gbGluZVNwbGl0OyAvLyBJZiB0aGVyZSdzIGNvbnRlbnQgaW4gbGluZVNwbGl0WzFdLCB0aGVuIHdlIGhhdmUgc3ByaXRlcy4gSWYgbm90LCB0aGVuIGl0J3MganVzdCBvbmUgZnJhbWUgcGVyIGltYWdlXG5cbiAgICAgICAgICBpZiAobGluZVNwbGl0WzFdKSB7XG4gICAgICAgICAgICBbcmVzdWx0LngsIHJlc3VsdC55LCByZXN1bHQudywgcmVzdWx0LmhdID0gbGluZVNwbGl0WzFdLnNwbGl0KCcsJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKHJlc3VsdC50ZXh0KSB7XG4gICAgICAgIHByb2Nlc3NlZExpc3QucHVzaChyZXN1bHQpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBwcm9jZXNzZWRMaXN0O1xuICB9O1xuICAvKipcbiAgICogUHJldmlldyB0aHVtYm5haWxzIGZvciBzZWVrIGhvdmVyIGFuZCBzY3J1YmJpbmdcbiAgICogU2Vla2luZzogSG92ZXIgb3ZlciB0aGUgc2VlayBiYXIgKGRlc2t0b3Agb25seSk6IHNob3dzIGEgc21hbGwgcHJldmlldyBjb250YWluZXIgYWJvdmUgdGhlIHNlZWsgYmFyXG4gICAqIFNjcnViYmluZzogQ2xpY2sgYW5kIGRyYWcgdGhlIHNlZWsgYmFyIChkZXNrdG9wIGFuZCBtb2JpbGUpOiBzaG93cyB0aGUgcHJldmlldyBpbWFnZSBvdmVyIHRoZSBlbnRpcmUgdmlkZW8sIGFzIGlmIHRoZSB2aWRlbyBpcyBzY3J1YmJpbmcgYXQgdmVyeSBoaWdoIHNwZWVkXG4gICAqXG4gICAqIE5vdGVzOlxuICAgKiAtIFRodW1icyBhcmUgc2V0IHZpYSBKUyBzZXR0aW5ncyBvbiBQbHlyIGluaXQsIG5vdCBIVE1MNSAndHJhY2snIHByb3BlcnR5LiBVc2luZyB0aGUgdHJhY2sgcHJvcGVydHkgd291bGQgYmUgYSBiaXQgZ3Jvc3MsIGJlY2F1c2UgaXQgZG9lc24ndCBzdXBwb3J0IGN1c3RvbSAna2luZHMnLiBraW5kPW1ldGFkYXRhIG1pZ2h0IGJlIHVzZWQgZm9yIHNvbWV0aGluZyBlbHNlLCBhbmQgd2Ugd2FudCB0byBhbGxvdyBtdWx0aXBsZSB0aHVtYm5haWxzIHRyYWNrcy4gVHJhY2tzIG11c3QgaGF2ZSBhIHVuaXF1ZSBjb21iaW5hdGlvbiBvZiAna2luZCcgYW5kICdsYWJlbCcuIFdlIHdvdWxkIGhhdmUgdG8gZG8gc29tZXRoaW5nIGxpa2Uga2luZD1tZXRhZGF0YSxsYWJlbD10aHVtYm5haWxzMSAvIGtpbmQ9bWV0YWRhdGEsbGFiZWw9dGh1bWJuYWlsczIuIFNxdWFyZSBwZWcsIHJvdW5kIGhvbGVcbiAgICogLSBWVFQgaW5mbzogdGhlIGltYWdlIFVSTCBpcyByZWxhdGl2ZSB0byB0aGUgVlRULCBub3QgdGhlIGN1cnJlbnQgZG9jdW1lbnQuIEJ1dCBpZiB0aGUgdXJsIHN0YXJ0cyB3aXRoIGEgc2xhc2gsIGl0IHdpbGwgbmF0dXJhbGx5IGJlIHJlbGF0aXZlIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4gaHR0cHM6Ly9zdXBwb3J0Lmp3cGxheWVyLmNvbS9hcnRpY2xlcy9ob3ctdG8tYWRkLXByZXZpZXctdGh1bWJuYWlsc1xuICAgKiAtIFRoaXMgaW1wbGVtZW50YXRpb24gdXNlcyBtdWx0aXBsZSBzZXBhcmF0ZSBpbWcgZWxlbWVudHMuIE90aGVyIGltcGxlbWVudGF0aW9ucyB1c2UgYmFja2dyb3VuZC1pbWFnZSBvbiBvbmUgZWxlbWVudC4gVGhpcyB3b3VsZCBiZSBuaWNlIGFuZCBzaW1wbGUsIGJ1dCBGaXJlZm94IGFuZCBTYWZhcmkgaGF2ZSBmbGlja2VyaW5nIGlzc3VlcyB3aXRoIHJlcGxhY2luZyBiYWNrZ3JvdW5kcyBvZiBsYXJnZXIgaW1hZ2VzLiBJdCBzZWVtcyB0aGF0IFlvdVR1YmUgcGVyaGFwcyBvbmx5IGF2b2lkcyB0aGlzIGJlY2F1c2UgdGhleSBkb24ndCBoYXZlIHRoZSBvcHRpb24gZm9yIGhpZ2gtcmVzIHByZXZpZXdzIChldmVuIHRoZSBmdWxsc2NyZWVuIG9uZXMsIHdoZW4gbW91c2Vkb3duL3NlZWtpbmcpLiBJbWFnZXMgYXBwZWFyIG92ZXIgdGhlIHRvcCBvZiBlYWNoIG90aGVyLCBhbmQgcHJldmlvdXMgb25lcyBhcmUgZGlzY2FyZGVkIG9uY2UgdGhlIG5ldyBvbmVzIGhhdmUgYmVlbiByZW5kZXJlZFxuICAgKi9cblxuXG4gIGNvbnN0IGZpdFJhdGlvID0gKHJhdGlvLCBvdXRlcikgPT4ge1xuICAgIGNvbnN0IHRhcmdldFJhdGlvID0gb3V0ZXIud2lkdGggLyBvdXRlci5oZWlnaHQ7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG5cbiAgICBpZiAocmF0aW8gPiB0YXJnZXRSYXRpbykge1xuICAgICAgcmVzdWx0LndpZHRoID0gb3V0ZXIud2lkdGg7XG4gICAgICByZXN1bHQuaGVpZ2h0ID0gMSAvIHJhdGlvICogb3V0ZXIud2lkdGg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdC5oZWlnaHQgPSBvdXRlci5oZWlnaHQ7XG4gICAgICByZXN1bHQud2lkdGggPSByYXRpbyAqIG91dGVyLmhlaWdodDtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIGNsYXNzIFByZXZpZXdUaHVtYm5haWxzIHtcbiAgICAvKipcbiAgICAgKiBQcmV2aWV3VGh1bWJuYWlscyBjb25zdHJ1Y3Rvci5cbiAgICAgKiBAcGFyYW0ge1BseXJ9IHBsYXllclxuICAgICAqIEByZXR1cm4ge1ByZXZpZXdUaHVtYm5haWxzfVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHBsYXllcikge1xuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJsb2FkXCIsICgpID0+IHtcbiAgICAgICAgLy8gVG9nZ2xlIHRoZSByZWd1bGFyIHNlZWsgdG9vbHRpcFxuICAgICAgICBpZiAodGhpcy5wbGF5ZXIuZWxlbWVudHMuZGlzcGxheS5zZWVrVG9vbHRpcCkge1xuICAgICAgICAgIHRoaXMucGxheWVyLmVsZW1lbnRzLmRpc3BsYXkuc2Vla1Rvb2x0aXAuaGlkZGVuID0gdGhpcy5lbmFibGVkO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZWQpIHJldHVybjtcbiAgICAgICAgdGhpcy5nZXRUaHVtYm5haWxzKCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IC8vIFJlbmRlciBET00gZWxlbWVudHNcblxuXG4gICAgICAgICAgdGhpcy5yZW5kZXIoKTsgLy8gQ2hlY2sgdG8gc2VlIGlmIHRodW1iIGNvbnRhaW5lciBzaXplIHdhcyBzcGVjaWZpZWQgbWFudWFsbHkgaW4gQ1NTXG5cbiAgICAgICAgICB0aGlzLmRldGVybWluZUNvbnRhaW5lckF1dG9TaXppbmcoKTtcbiAgICAgICAgICB0aGlzLmxvYWRlZCA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiZ2V0VGh1bWJuYWlsc1wiLCAoKSA9PiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBzcmNcbiAgICAgICAgICB9ID0gdGhpcy5wbGF5ZXIuY29uZmlnLnByZXZpZXdUaHVtYm5haWxzO1xuXG4gICAgICAgICAgaWYgKGlzLmVtcHR5KHNyYykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBwcmV2aWV3VGh1bWJuYWlscy5zcmMgY29uZmlnIGF0dHJpYnV0ZScpO1xuICAgICAgICAgIH0gLy8gUmVzb2x2ZSBwcm9taXNlXG5cblxuICAgICAgICAgIGNvbnN0IHNvcnRBbmRSZXNvbHZlID0gKCkgPT4ge1xuICAgICAgICAgICAgLy8gU29ydCBzbWFsbGVzdCB0byBiaWdnZXN0IChlLmcuLCBbMTIwcCwgNDgwcCwgMTA4MHBdKVxuICAgICAgICAgICAgdGhpcy50aHVtYm5haWxzLnNvcnQoKHgsIHkpID0+IHguaGVpZ2h0IC0geS5oZWlnaHQpO1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKCdQcmV2aWV3IHRodW1ibmFpbHMnLCB0aGlzLnRodW1ibmFpbHMpO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH07IC8vIFZpYSBjYWxsYmFjaygpXG5cblxuICAgICAgICAgIGlmIChpcy5mdW5jdGlvbihzcmMpKSB7XG4gICAgICAgICAgICBzcmModGh1bWJuYWlscyA9PiB7XG4gICAgICAgICAgICAgIHRoaXMudGh1bWJuYWlscyA9IHRodW1ibmFpbHM7XG4gICAgICAgICAgICAgIHNvcnRBbmRSZXNvbHZlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IC8vIFZUVCB1cmxzXG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBJZiBzdHJpbmcsIGNvbnZlcnQgaW50byBzaW5nbGUtZWxlbWVudCBsaXN0XG4gICAgICAgICAgICBjb25zdCB1cmxzID0gaXMuc3RyaW5nKHNyYykgPyBbc3JjXSA6IHNyYzsgLy8gTG9vcCB0aHJvdWdoIGVhY2ggc3JjIFVSTC4gRG93bmxvYWQgYW5kIHByb2Nlc3MgdGhlIFZUVCBmaWxlLCBzdG9yaW5nIHRoZSByZXN1bHRpbmcgZGF0YSBpbiB0aGlzLnRodW1ibmFpbHNcblxuICAgICAgICAgICAgY29uc3QgcHJvbWlzZXMgPSB1cmxzLm1hcCh1ID0+IHRoaXMuZ2V0VGh1bWJuYWlsKHUpKTsgLy8gUmVzb2x2ZVxuXG4gICAgICAgICAgICBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihzb3J0QW5kUmVzb2x2ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImdldFRodW1ibmFpbFwiLCB1cmwgPT4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgZmV0Y2godXJsKS50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRodW1ibmFpbCA9IHtcbiAgICAgICAgICAgICAgZnJhbWVzOiBwYXJzZVZ0dChyZXNwb25zZSksXG4gICAgICAgICAgICAgIGhlaWdodDogbnVsbCxcbiAgICAgICAgICAgICAgdXJsUHJlZml4OiAnJ1xuICAgICAgICAgICAgfTsgLy8gSWYgdGhlIFVSTHMgZG9uJ3Qgc3RhcnQgd2l0aCAnLycsIHRoZW4gd2UgbmVlZCB0byBzZXQgdGhlaXIgcmVsYXRpdmUgcGF0aCB0byBiZSB0aGUgbG9jYXRpb24gb2YgdGhlIFZUVCBmaWxlXG4gICAgICAgICAgICAvLyBJZiB0aGUgVVJMcyBkbyBzdGFydCB3aXRoICcvJywgdGhlbiB0aGV5IG9idmlvdXNseSBkb24ndCBuZWVkIGEgcHJlZml4LCBzbyBpdCB3aWxsIHJlbWFpbiBibGFua1xuICAgICAgICAgICAgLy8gSWYgdGhlIHRodW1ibmFpbCBVUkxzIHN0YXJ0IHdpdGggd2l0aCBub25lIG9mICcvJywgJ2h0dHA6Ly8nIG9yICdodHRwczovLycsIHRoZW4gd2UgbmVlZCB0byBzZXQgdGhlaXIgcmVsYXRpdmUgcGF0aCB0byBiZSB0aGUgbG9jYXRpb24gb2YgdGhlIFZUVCBmaWxlXG5cbiAgICAgICAgICAgIGlmICghdGh1bWJuYWlsLmZyYW1lc1swXS50ZXh0LnN0YXJ0c1dpdGgoJy8nKSAmJiAhdGh1bWJuYWlsLmZyYW1lc1swXS50ZXh0LnN0YXJ0c1dpdGgoJ2h0dHA6Ly8nKSAmJiAhdGh1bWJuYWlsLmZyYW1lc1swXS50ZXh0LnN0YXJ0c1dpdGgoJ2h0dHBzOi8vJykpIHtcbiAgICAgICAgICAgICAgdGh1bWJuYWlsLnVybFByZWZpeCA9IHVybC5zdWJzdHJpbmcoMCwgdXJsLmxhc3RJbmRleE9mKCcvJykgKyAxKTtcbiAgICAgICAgICAgIH0gLy8gRG93bmxvYWQgdGhlIGZpcnN0IGZyYW1lLCBzbyB0aGF0IHdlIGNhbiBkZXRlcm1pbmUvc2V0IHRoZSBoZWlnaHQgb2YgdGhpcyB0aHVtYm5haWxzRGVmXG5cblxuICAgICAgICAgICAgY29uc3QgdGVtcEltYWdlID0gbmV3IEltYWdlKCk7XG5cbiAgICAgICAgICAgIHRlbXBJbWFnZS5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgIHRodW1ibmFpbC5oZWlnaHQgPSB0ZW1wSW1hZ2UubmF0dXJhbEhlaWdodDtcbiAgICAgICAgICAgICAgdGh1bWJuYWlsLndpZHRoID0gdGVtcEltYWdlLm5hdHVyYWxXaWR0aDtcbiAgICAgICAgICAgICAgdGhpcy50aHVtYm5haWxzLnB1c2godGh1bWJuYWlsKTtcbiAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGVtcEltYWdlLnNyYyA9IHRodW1ibmFpbC51cmxQcmVmaXggKyB0aHVtYm5haWwuZnJhbWVzWzBdLnRleHQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwic3RhcnRNb3ZlXCIsIGV2ZW50ID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLmxvYWRlZCkgcmV0dXJuO1xuICAgICAgICBpZiAoIWlzLmV2ZW50KGV2ZW50KSB8fCAhWyd0b3VjaG1vdmUnLCAnbW91c2Vtb3ZlJ10uaW5jbHVkZXMoZXZlbnQudHlwZSkpIHJldHVybjsgLy8gV2FpdCB1bnRpbCBtZWRpYSBoYXMgYSBkdXJhdGlvblxuXG4gICAgICAgIGlmICghdGhpcy5wbGF5ZXIubWVkaWEuZHVyYXRpb24pIHJldHVybjtcblxuICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ3RvdWNobW92ZScpIHtcbiAgICAgICAgICAvLyBDYWxjdWxhdGUgc2VlayBob3ZlciBwb3NpdGlvbiBhcyBhcHByb3ggdmlkZW8gc2Vjb25kc1xuICAgICAgICAgIHRoaXMuc2Vla1RpbWUgPSB0aGlzLnBsYXllci5tZWRpYS5kdXJhdGlvbiAqICh0aGlzLnBsYXllci5lbGVtZW50cy5pbnB1dHMuc2Vlay52YWx1ZSAvIDEwMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIF90aGlzJHBsYXllciRjb25maWckbSwgX3RoaXMkcGxheWVyJGNvbmZpZyRtMjtcblxuICAgICAgICAgIC8vIENhbGN1bGF0ZSBzZWVrIGhvdmVyIHBvc2l0aW9uIGFzIGFwcHJveCB2aWRlbyBzZWNvbmRzXG4gICAgICAgICAgY29uc3QgY2xpZW50UmVjdCA9IHRoaXMucGxheWVyLmVsZW1lbnRzLnByb2dyZXNzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgIGNvbnN0IHBlcmNlbnRhZ2UgPSAxMDAgLyBjbGllbnRSZWN0LndpZHRoICogKGV2ZW50LnBhZ2VYIC0gY2xpZW50UmVjdC5sZWZ0KTtcbiAgICAgICAgICB0aGlzLnNlZWtUaW1lID0gdGhpcy5wbGF5ZXIubWVkaWEuZHVyYXRpb24gKiAocGVyY2VudGFnZSAvIDEwMCk7XG5cbiAgICAgICAgICBpZiAodGhpcy5zZWVrVGltZSA8IDApIHtcbiAgICAgICAgICAgIC8vIFRoZSBtb3VzZW1vdmUgZmlyZXMgZm9yIDEwK3B4IG91dCB0byB0aGUgbGVmdFxuICAgICAgICAgICAgdGhpcy5zZWVrVGltZSA9IDA7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHRoaXMuc2Vla1RpbWUgPiB0aGlzLnBsYXllci5tZWRpYS5kdXJhdGlvbiAtIDEpIHtcbiAgICAgICAgICAgIC8vIFRvb2sgMSBzZWNvbmQgb2ZmIHRoZSBkdXJhdGlvbiBmb3Igc2FmZXR5LCBiZWNhdXNlIGRpZmZlcmVudCBwbGF5ZXJzIGNhbiBkaXNhZ3JlZSBvbiB0aGUgcmVhbCBkdXJhdGlvbiBvZiBhIHZpZGVvXG4gICAgICAgICAgICB0aGlzLnNlZWtUaW1lID0gdGhpcy5wbGF5ZXIubWVkaWEuZHVyYXRpb24gLSAxO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMubW91c2VQb3NYID0gZXZlbnQucGFnZVg7IC8vIFNldCB0aW1lIHRleHQgaW5zaWRlIGltYWdlIGNvbnRhaW5lclxuXG4gICAgICAgICAgdGhpcy5lbGVtZW50cy50aHVtYi50aW1lLmlubmVyVGV4dCA9IGZvcm1hdFRpbWUodGhpcy5zZWVrVGltZSk7IC8vIEdldCBtYXJrZXIgcG9pbnQgZm9yIHRpbWVcblxuICAgICAgICAgIGNvbnN0IHBvaW50ID0gKF90aGlzJHBsYXllciRjb25maWckbSA9IHRoaXMucGxheWVyLmNvbmZpZy5tYXJrZXJzKSA9PT0gbnVsbCB8fCBfdGhpcyRwbGF5ZXIkY29uZmlnJG0gPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfdGhpcyRwbGF5ZXIkY29uZmlnJG0yID0gX3RoaXMkcGxheWVyJGNvbmZpZyRtLnBvaW50cykgPT09IG51bGwgfHwgX3RoaXMkcGxheWVyJGNvbmZpZyRtMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkcGxheWVyJGNvbmZpZyRtMi5maW5kKCh7XG4gICAgICAgICAgICB0aW1lOiB0XG4gICAgICAgICAgfSkgPT4gdCA9PT0gTWF0aC5yb3VuZCh0aGlzLnNlZWtUaW1lKSk7IC8vIEFwcGVuZCB0aGUgcG9pbnQgbGFiZWwgdG8gdGhlIHRvb2x0aXBcblxuICAgICAgICAgIGlmIChwb2ludCkge1xuICAgICAgICAgICAgLy8gdGhpcy5lbGVtZW50cy50aHVtYi50aW1lLmlubmVyVGV4dC5jb25jYXQoJ1xcbicpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50cy50aHVtYi50aW1lLmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsIGAke3BvaW50LmxhYmVsfTxicj5gKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gLy8gRG93bmxvYWQgYW5kIHNob3cgaW1hZ2VcblxuXG4gICAgICAgIHRoaXMuc2hvd0ltYWdlQXRDdXJyZW50VGltZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiZW5kTW92ZVwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMudG9nZ2xlVGh1bWJDb250YWluZXIoZmFsc2UsIHRydWUpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwic3RhcnRTY3J1YmJpbmdcIiwgZXZlbnQgPT4ge1xuICAgICAgICAvLyBPbmx5IGFjdCBvbiBsZWZ0IG1vdXNlIGJ1dHRvbiAoMCksIG9yIHRvdWNoIGRldmljZSAoZXZlbnQuYnV0dG9uIGRvZXMgbm90IGV4aXN0IG9yIGlzIGZhbHNlKVxuICAgICAgICBpZiAoaXMubnVsbE9yVW5kZWZpbmVkKGV2ZW50LmJ1dHRvbikgfHwgZXZlbnQuYnV0dG9uID09PSBmYWxzZSB8fCBldmVudC5idXR0b24gPT09IDApIHtcbiAgICAgICAgICB0aGlzLm1vdXNlRG93biA9IHRydWU7IC8vIFdhaXQgdW50aWwgbWVkaWEgaGFzIGEgZHVyYXRpb25cblxuICAgICAgICAgIGlmICh0aGlzLnBsYXllci5tZWRpYS5kdXJhdGlvbikge1xuICAgICAgICAgICAgdGhpcy50b2dnbGVTY3J1YmJpbmdDb250YWluZXIodHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVRodW1iQ29udGFpbmVyKGZhbHNlLCB0cnVlKTsgLy8gRG93bmxvYWQgYW5kIHNob3cgaW1hZ2VcblxuICAgICAgICAgICAgdGhpcy5zaG93SW1hZ2VBdEN1cnJlbnRUaW1lKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJlbmRTY3J1YmJpbmdcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLm1vdXNlRG93biA9IGZhbHNlOyAvLyBIaWRlIHNjcnViYmluZyBwcmV2aWV3LiBCdXQgd2FpdCB1bnRpbCB0aGUgdmlkZW8gaGFzIHN1Y2Nlc3NmdWxseSBzZWVrZWQgYmVmb3JlIGhpZGluZyB0aGUgc2NydWJiaW5nIHByZXZpZXdcblxuICAgICAgICBpZiAoTWF0aC5jZWlsKHRoaXMubGFzdFRpbWUpID09PSBNYXRoLmNlaWwodGhpcy5wbGF5ZXIubWVkaWEuY3VycmVudFRpbWUpKSB7XG4gICAgICAgICAgLy8gVGhlIHZpZGVvIHdhcyBhbHJlYWR5IHNlZWtlZC9sb2FkZWQgYXQgdGhlIGNob3NlbiB0aW1lIC0gaGlkZSBpbW1lZGlhdGVseVxuICAgICAgICAgIHRoaXMudG9nZ2xlU2NydWJiaW5nQ29udGFpbmVyKGZhbHNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBUaGUgdmlkZW8gaGFzbid0IHNlZWtlZCB5ZXQuIFdhaXQgZm9yIHRoYXRcbiAgICAgICAgICBvbmNlLmNhbGwodGhpcy5wbGF5ZXIsIHRoaXMucGxheWVyLm1lZGlhLCAndGltZXVwZGF0ZScsICgpID0+IHtcbiAgICAgICAgICAgIC8vIFJlLWNoZWNrIG1vdXNlZG93biAtIHdlIG1pZ2h0IGhhdmUgYWxyZWFkeSBzdGFydGVkIHNjcnViYmluZyBhZ2FpblxuICAgICAgICAgICAgaWYgKCF0aGlzLm1vdXNlRG93bikge1xuICAgICAgICAgICAgICB0aGlzLnRvZ2dsZVNjcnViYmluZ0NvbnRhaW5lcihmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImxpc3RlbmVyc1wiLCAoKSA9PiB7XG4gICAgICAgIC8vIEhpZGUgdGh1bWJuYWlsIHByZXZpZXcgLSBvbiBtb3VzZSBjbGljaywgbW91c2UgbGVhdmUgKGluIGxpc3RlbmVycy5qcyBmb3Igbm93KSwgYW5kIHZpZGVvIHBsYXkvc2Vlay4gQWxsIGZvdXIgYXJlIHJlcXVpcmVkLCBlLmcuLCBmb3IgYnVmZmVyaW5nXG4gICAgICAgIHRoaXMucGxheWVyLm9uKCdwbGF5JywgKCkgPT4ge1xuICAgICAgICAgIHRoaXMudG9nZ2xlVGh1bWJDb250YWluZXIoZmFsc2UsIHRydWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wbGF5ZXIub24oJ3NlZWtlZCcsICgpID0+IHtcbiAgICAgICAgICB0aGlzLnRvZ2dsZVRodW1iQ29udGFpbmVyKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucGxheWVyLm9uKCd0aW1ldXBkYXRlJywgKCkgPT4ge1xuICAgICAgICAgIHRoaXMubGFzdFRpbWUgPSB0aGlzLnBsYXllci5tZWRpYS5jdXJyZW50VGltZTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJyZW5kZXJcIiwgKCkgPT4ge1xuICAgICAgICAvLyBDcmVhdGUgSFRNTCBlbGVtZW50OiBwbHlyX19wcmV2aWV3LXRodW1ibmFpbC1jb250YWluZXJcbiAgICAgICAgdGhpcy5lbGVtZW50cy50aHVtYi5jb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgY2xhc3M6IHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLnByZXZpZXdUaHVtYm5haWxzLnRodW1iQ29udGFpbmVyXG4gICAgICAgIH0pOyAvLyBXcmFwcGVyIGZvciB0aGUgaW1hZ2UgZm9yIHN0eWxpbmdcblxuICAgICAgICB0aGlzLmVsZW1lbnRzLnRodW1iLmltYWdlQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgIGNsYXNzOiB0aGlzLnBsYXllci5jb25maWcuY2xhc3NOYW1lcy5wcmV2aWV3VGh1bWJuYWlscy5pbWFnZUNvbnRhaW5lclxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5lbGVtZW50cy50aHVtYi5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50cy50aHVtYi5pbWFnZUNvbnRhaW5lcik7IC8vIENyZWF0ZSBIVE1MIGVsZW1lbnQsIHBhcmVudCtzcGFuOiB0aW1lIHRleHQgKGUuZy4sIDAxOjMyOjAwKVxuXG4gICAgICAgIGNvbnN0IHRpbWVDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgY2xhc3M6IHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLnByZXZpZXdUaHVtYm5haWxzLnRpbWVDb250YWluZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZWxlbWVudHMudGh1bWIudGltZSA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7fSwgJzAwOjAwJyk7XG4gICAgICAgIHRpbWVDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50cy50aHVtYi50aW1lKTtcbiAgICAgICAgdGhpcy5lbGVtZW50cy50aHVtYi5pbWFnZUNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aW1lQ29udGFpbmVyKTsgLy8gSW5qZWN0IHRoZSB3aG9sZSB0aHVtYlxuXG4gICAgICAgIGlmIChpcy5lbGVtZW50KHRoaXMucGxheWVyLmVsZW1lbnRzLnByb2dyZXNzKSkge1xuICAgICAgICAgIHRoaXMucGxheWVyLmVsZW1lbnRzLnByb2dyZXNzLmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudHMudGh1bWIuY29udGFpbmVyKTtcbiAgICAgICAgfSAvLyBDcmVhdGUgSFRNTCBlbGVtZW50OiBwbHlyX19wcmV2aWV3LXNjcnViYmluZy1jb250YWluZXJcblxuXG4gICAgICAgIHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICBjbGFzczogdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMucHJldmlld1RodW1ibmFpbHMuc2NydWJiaW5nQ29udGFpbmVyXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBsYXllci5lbGVtZW50cy53cmFwcGVyLmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lcik7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJkZXN0cm95XCIsICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudHMudGh1bWIuY29udGFpbmVyKSB7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy50aHVtYi5jb250YWluZXIucmVtb3ZlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5lbGVtZW50cy5zY3J1YmJpbmcuY29udGFpbmVyKSB7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5zY3J1YmJpbmcuY29udGFpbmVyLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJzaG93SW1hZ2VBdEN1cnJlbnRUaW1lXCIsICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMubW91c2VEb3duKSB7XG4gICAgICAgICAgdGhpcy5zZXRTY3J1YmJpbmdDb250YWluZXJTaXplKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5zZXRUaHVtYkNvbnRhaW5lclNpemVBbmRQb3MoKTtcbiAgICAgICAgfSAvLyBGaW5kIHRoZSBkZXNpcmVkIHRodW1ibmFpbCBpbmRleFxuICAgICAgICAvLyBUT0RPOiBIYW5kbGUgYSB2aWRlbyBsb25nZXIgdGhhbiB0aGUgdGh1bWJzIHdoZXJlIHRodW1iTnVtIGlzIG51bGxcblxuXG4gICAgICAgIGNvbnN0IHRodW1iTnVtID0gdGhpcy50aHVtYm5haWxzWzBdLmZyYW1lcy5maW5kSW5kZXgoZnJhbWUgPT4gdGhpcy5zZWVrVGltZSA+PSBmcmFtZS5zdGFydFRpbWUgJiYgdGhpcy5zZWVrVGltZSA8PSBmcmFtZS5lbmRUaW1lKTtcbiAgICAgICAgY29uc3QgaGFzVGh1bWIgPSB0aHVtYk51bSA+PSAwO1xuICAgICAgICBsZXQgcXVhbGl0eUluZGV4ID0gMDsgLy8gU2hvdyB0aGUgdGh1bWIgY29udGFpbmVyIGlmIHdlJ3JlIG5vdCBzY3J1YmJpbmdcblxuICAgICAgICBpZiAoIXRoaXMubW91c2VEb3duKSB7XG4gICAgICAgICAgdGhpcy50b2dnbGVUaHVtYkNvbnRhaW5lcihoYXNUaHVtYik7XG4gICAgICAgIH0gLy8gTm8gbWF0Y2hpbmcgdGh1bWIgZm91bmRcblxuXG4gICAgICAgIGlmICghaGFzVGh1bWIpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gLy8gQ2hlY2sgdG8gc2VlIGlmIHdlJ3ZlIGFscmVhZHkgZG93bmxvYWRlZCBoaWdoZXIgcXVhbGl0eSB2ZXJzaW9ucyBvZiB0aGlzIGltYWdlXG5cblxuICAgICAgICB0aGlzLnRodW1ibmFpbHMuZm9yRWFjaCgodGh1bWJuYWlsLCBpbmRleCkgPT4ge1xuICAgICAgICAgIGlmICh0aGlzLmxvYWRlZEltYWdlcy5pbmNsdWRlcyh0aHVtYm5haWwuZnJhbWVzW3RodW1iTnVtXS50ZXh0KSkge1xuICAgICAgICAgICAgcXVhbGl0eUluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgfVxuICAgICAgICB9KTsgLy8gT25seSBwcm9jZWVkIGlmIGVpdGhlciB0aHVtYiBudW0gb3IgdGh1bWJmaWxlbmFtZSBoYXMgY2hhbmdlZFxuXG4gICAgICAgIGlmICh0aHVtYk51bSAhPT0gdGhpcy5zaG93aW5nVGh1bWIpIHtcbiAgICAgICAgICB0aGlzLnNob3dpbmdUaHVtYiA9IHRodW1iTnVtO1xuICAgICAgICAgIHRoaXMubG9hZEltYWdlKHF1YWxpdHlJbmRleCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImxvYWRJbWFnZVwiLCAocXVhbGl0eUluZGV4ID0gMCkgPT4ge1xuICAgICAgICBjb25zdCB0aHVtYk51bSA9IHRoaXMuc2hvd2luZ1RodW1iO1xuICAgICAgICBjb25zdCB0aHVtYm5haWwgPSB0aGlzLnRodW1ibmFpbHNbcXVhbGl0eUluZGV4XTtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHVybFByZWZpeFxuICAgICAgICB9ID0gdGh1bWJuYWlsO1xuICAgICAgICBjb25zdCBmcmFtZSA9IHRodW1ibmFpbC5mcmFtZXNbdGh1bWJOdW1dO1xuICAgICAgICBjb25zdCB0aHVtYkZpbGVuYW1lID0gdGh1bWJuYWlsLmZyYW1lc1t0aHVtYk51bV0udGV4dDtcbiAgICAgICAgY29uc3QgdGh1bWJVcmwgPSB1cmxQcmVmaXggKyB0aHVtYkZpbGVuYW1lO1xuXG4gICAgICAgIGlmICghdGhpcy5jdXJyZW50SW1hZ2VFbGVtZW50IHx8IHRoaXMuY3VycmVudEltYWdlRWxlbWVudC5kYXRhc2V0LmZpbGVuYW1lICE9PSB0aHVtYkZpbGVuYW1lKSB7XG4gICAgICAgICAgLy8gSWYgd2UncmUgYWxyZWFkeSBsb2FkaW5nIGEgcHJldmlvdXMgaW1hZ2UsIHJlbW92ZSBpdHMgb25sb2FkIGhhbmRsZXIgLSB3ZSBkb24ndCB3YW50IGl0IHRvIGxvYWQgYWZ0ZXIgdGhpcyBvbmVcbiAgICAgICAgICAvLyBPbmx5IGRvIHRoaXMgaWYgbm90IHVzaW5nIHNwcml0ZXMuIFdpdGhvdXQgc3ByaXRlcyB3ZSByZWFsbHkgd2FudCB0byBzaG93IGFzIG1hbnkgaW1hZ2VzIGFzIHBvc3NpYmxlLCBhcyBhIGJlc3QtZWZmb3J0XG4gICAgICAgICAgaWYgKHRoaXMubG9hZGluZ0ltYWdlICYmIHRoaXMudXNpbmdTcHJpdGVzKSB7XG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdJbWFnZS5vbmxvYWQgPSBudWxsO1xuICAgICAgICAgIH0gLy8gV2UncmUgYnVpbGRpbmcgYW5kIGFkZGluZyBhIG5ldyBpbWFnZS4gSW4gb3RoZXIgaW1wbGVtZW50YXRpb25zIG9mIHNpbWlsYXIgZnVuY3Rpb25hbGl0eSAoWW91VHViZSksIGJhY2tncm91bmQgaW1hZ2VcbiAgICAgICAgICAvLyBpcyBpbnN0ZWFkIHVzZWQuIEJ1dCB0aGlzIGNhdXNlcyBpc3N1ZXMgd2l0aCBsYXJnZXIgaW1hZ2VzIGluIEZpcmVmb3ggYW5kIFNhZmFyaSAtIHN3aXRjaGluZyBiZXR3ZWVuIGJhY2tncm91bmRcbiAgICAgICAgICAvLyBpbWFnZXMgY2F1c2VzIGEgZmxpY2tlci4gUHV0dGluZyBhIG5ldyBpbWFnZSBvdmVyIHRoZSB0b3AgZG9lcyBub3RcblxuXG4gICAgICAgICAgY29uc3QgcHJldmlld0ltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgcHJldmlld0ltYWdlLnNyYyA9IHRodW1iVXJsO1xuICAgICAgICAgIHByZXZpZXdJbWFnZS5kYXRhc2V0LmluZGV4ID0gdGh1bWJOdW07XG4gICAgICAgICAgcHJldmlld0ltYWdlLmRhdGFzZXQuZmlsZW5hbWUgPSB0aHVtYkZpbGVuYW1lO1xuICAgICAgICAgIHRoaXMuc2hvd2luZ1RodW1iRmlsZW5hbWUgPSB0aHVtYkZpbGVuYW1lO1xuICAgICAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZyhgTG9hZGluZyBpbWFnZTogJHt0aHVtYlVybH1gKTsgLy8gRm9yIHNvbWUgcmVhc29uLCBwYXNzaW5nIHRoZSBuYW1lZCBmdW5jdGlvbiBkaXJlY3RseSBjYXVzZXMgaXQgdG8gZXhlY3V0ZSBpbW1lZGlhdGVseS4gU28gSSd2ZSB3cmFwcGVkIGl0IGluIGFuIGFub255bW91cyBmdW5jdGlvbi4uLlxuXG4gICAgICAgICAgcHJldmlld0ltYWdlLm9ubG9hZCA9ICgpID0+IHRoaXMuc2hvd0ltYWdlKHByZXZpZXdJbWFnZSwgZnJhbWUsIHF1YWxpdHlJbmRleCwgdGh1bWJOdW0sIHRodW1iRmlsZW5hbWUsIHRydWUpO1xuXG4gICAgICAgICAgdGhpcy5sb2FkaW5nSW1hZ2UgPSBwcmV2aWV3SW1hZ2U7XG4gICAgICAgICAgdGhpcy5yZW1vdmVPbGRJbWFnZXMocHJldmlld0ltYWdlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBVcGRhdGUgdGhlIGV4aXN0aW5nIGltYWdlXG4gICAgICAgICAgdGhpcy5zaG93SW1hZ2UodGhpcy5jdXJyZW50SW1hZ2VFbGVtZW50LCBmcmFtZSwgcXVhbGl0eUluZGV4LCB0aHVtYk51bSwgdGh1bWJGaWxlbmFtZSwgZmFsc2UpO1xuICAgICAgICAgIHRoaXMuY3VycmVudEltYWdlRWxlbWVudC5kYXRhc2V0LmluZGV4ID0gdGh1bWJOdW07XG4gICAgICAgICAgdGhpcy5yZW1vdmVPbGRJbWFnZXModGhpcy5jdXJyZW50SW1hZ2VFbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwic2hvd0ltYWdlXCIsIChwcmV2aWV3SW1hZ2UsIGZyYW1lLCBxdWFsaXR5SW5kZXgsIHRodW1iTnVtLCB0aHVtYkZpbGVuYW1lLCBuZXdJbWFnZSA9IHRydWUpID0+IHtcbiAgICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKGBTaG93aW5nIHRodW1iOiAke3RodW1iRmlsZW5hbWV9LiBudW06ICR7dGh1bWJOdW19LiBxdWFsOiAke3F1YWxpdHlJbmRleH0uIG5ld2ltZzogJHtuZXdJbWFnZX1gKTtcbiAgICAgICAgdGhpcy5zZXRJbWFnZVNpemVBbmRPZmZzZXQocHJldmlld0ltYWdlLCBmcmFtZSk7XG5cbiAgICAgICAgaWYgKG5ld0ltYWdlKSB7XG4gICAgICAgICAgdGhpcy5jdXJyZW50SW1hZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQocHJldmlld0ltYWdlKTtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRJbWFnZUVsZW1lbnQgPSBwcmV2aWV3SW1hZ2U7XG5cbiAgICAgICAgICBpZiAoIXRoaXMubG9hZGVkSW1hZ2VzLmluY2x1ZGVzKHRodW1iRmlsZW5hbWUpKSB7XG4gICAgICAgICAgICB0aGlzLmxvYWRlZEltYWdlcy5wdXNoKHRodW1iRmlsZW5hbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSAvLyBQcmVsb2FkIGltYWdlcyBiZWZvcmUgYW5kIGFmdGVyIHRoZSBjdXJyZW50IG9uZVxuICAgICAgICAvLyBTaG93IGhpZ2hlciBxdWFsaXR5IG9mIHRoZSBzYW1lIGZyYW1lXG4gICAgICAgIC8vIEVhY2ggc3RlcCBoZXJlIGhhcyBhIHNob3J0IHRpbWUgZGVsYXksIGFuZCBvbmx5IGNvbnRpbnVlcyBpZiBzdGlsbCBob3ZlcmluZy9zZWVraW5nIHRoZSBzYW1lIHNwb3QuIFRoaXMgaXMgdG8gcHJvdGVjdCBzbG93IGNvbm5lY3Rpb25zIGZyb20gb3ZlcmxvYWRpbmdcblxuXG4gICAgICAgIHRoaXMucHJlbG9hZE5lYXJieSh0aHVtYk51bSwgdHJ1ZSkudGhlbih0aGlzLnByZWxvYWROZWFyYnkodGh1bWJOdW0sIGZhbHNlKSkudGhlbih0aGlzLmdldEhpZ2hlclF1YWxpdHkocXVhbGl0eUluZGV4LCBwcmV2aWV3SW1hZ2UsIGZyYW1lLCB0aHVtYkZpbGVuYW1lKSk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJyZW1vdmVPbGRJbWFnZXNcIiwgY3VycmVudEltYWdlID0+IHtcbiAgICAgICAgLy8gR2V0IGEgbGlzdCBvZiBhbGwgaW1hZ2VzLCBjb252ZXJ0IGl0IGZyb20gYSBET00gbGlzdCB0byBhbiBhcnJheVxuICAgICAgICBBcnJheS5mcm9tKHRoaXMuY3VycmVudEltYWdlQ29udGFpbmVyLmNoaWxkcmVuKS5mb3JFYWNoKGltYWdlID0+IHtcbiAgICAgICAgICBpZiAoaW1hZ2UudGFnTmFtZS50b0xvd2VyQ2FzZSgpICE9PSAnaW1nJykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IHJlbW92ZURlbGF5ID0gdGhpcy51c2luZ1Nwcml0ZXMgPyA1MDAgOiAxMDAwO1xuXG4gICAgICAgICAgaWYgKGltYWdlLmRhdGFzZXQuaW5kZXggIT09IGN1cnJlbnRJbWFnZS5kYXRhc2V0LmluZGV4ICYmICFpbWFnZS5kYXRhc2V0LmRlbGV0aW5nKSB7XG4gICAgICAgICAgICAvLyBXYWl0IDIwMG1zLCBhcyB0aGUgbmV3IGltYWdlIGNhbiB0YWtlIHNvbWUgdGltZSB0byBzaG93IG9uIGNlcnRhaW4gYnJvd3NlcnMgKGV2ZW4gdGhvdWdoIGl0IHdhcyBkb3dubG9hZGVkIGJlZm9yZSBzaG93aW5nKS4gVGhpcyB3aWxsIHByZXZlbnQgZmxpY2tlciwgYW5kIHNob3cgc29tZSBnZW5lcm9zaXR5IHRvd2FyZHMgc2xvd2VyIGNsaWVudHNcbiAgICAgICAgICAgIC8vIEZpcnN0IHNldCBhdHRyaWJ1dGUgJ2RlbGV0aW5nJyB0byBwcmV2ZW50IG11bHRpLWhhbmRsaW5nIG9mIHRoaXMgb24gcmVwZWF0IGZpcmluZyBvZiB0aGlzIGZ1bmN0aW9uXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgICAgICAgIGltYWdlLmRhdGFzZXQuZGVsZXRpbmcgPSB0cnVlOyAvLyBUaGlzIGhhcyB0byBiZSBzZXQgYmVmb3JlIHRoZSB0aW1lb3V0IC0gdG8gcHJldmVudCBpc3N1ZXMgc3dpdGNoaW5nIGJldHdlZW4gaG92ZXIgYW5kIHNjcnViXG5cbiAgICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgICAgY3VycmVudEltYWdlQ29udGFpbmVyXG4gICAgICAgICAgICB9ID0gdGhpcztcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICBjdXJyZW50SW1hZ2VDb250YWluZXIucmVtb3ZlQ2hpbGQoaW1hZ2UpO1xuICAgICAgICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coYFJlbW92aW5nIHRodW1iOiAke2ltYWdlLmRhdGFzZXQuZmlsZW5hbWV9YCk7XG4gICAgICAgICAgICB9LCByZW1vdmVEZWxheSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInByZWxvYWROZWFyYnlcIiwgKHRodW1iTnVtLCBmb3J3YXJkID0gdHJ1ZSkgPT4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBvbGRUaHVtYkZpbGVuYW1lID0gdGhpcy50aHVtYm5haWxzWzBdLmZyYW1lc1t0aHVtYk51bV0udGV4dDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuc2hvd2luZ1RodW1iRmlsZW5hbWUgPT09IG9sZFRodW1iRmlsZW5hbWUpIHtcbiAgICAgICAgICAgICAgLy8gRmluZCB0aGUgbmVhcmVzdCB0aHVtYnMgd2l0aCBkaWZmZXJlbnQgZmlsZW5hbWVzLiBTb21ldGltZXMgaXQnbGwgYmUgdGhlIG5leHQgaW5kZXgsIGJ1dCBpbiB0aGUgY2FzZSBvZiBzcHJpdGVzLCBpdCBtaWdodCBiZSAxMDArIGF3YXlcbiAgICAgICAgICAgICAgbGV0IHRodW1ibmFpbHNDbG9uZTtcblxuICAgICAgICAgICAgICBpZiAoZm9yd2FyZCkge1xuICAgICAgICAgICAgICAgIHRodW1ibmFpbHNDbG9uZSA9IHRoaXMudGh1bWJuYWlsc1swXS5mcmFtZXMuc2xpY2UodGh1bWJOdW0pO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRodW1ibmFpbHNDbG9uZSA9IHRoaXMudGh1bWJuYWlsc1swXS5mcmFtZXMuc2xpY2UoMCwgdGh1bWJOdW0pLnJldmVyc2UoKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGxldCBmb3VuZE9uZSA9IGZhbHNlO1xuICAgICAgICAgICAgICB0aHVtYm5haWxzQ2xvbmUuZm9yRWFjaChmcmFtZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VGh1bWJGaWxlbmFtZSA9IGZyYW1lLnRleHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAobmV3VGh1bWJGaWxlbmFtZSAhPT0gb2xkVGh1bWJGaWxlbmFtZSkge1xuICAgICAgICAgICAgICAgICAgLy8gRm91bmQgb25lIHdpdGggYSBkaWZmZXJlbnQgZmlsZW5hbWUuIE1ha2Ugc3VyZSBpdCBoYXNuJ3QgYWxyZWFkeSBiZWVuIGxvYWRlZCBvbiB0aGlzIHBhZ2UgdmlzaXRcbiAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5sb2FkZWRJbWFnZXMuaW5jbHVkZXMobmV3VGh1bWJGaWxlbmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm91bmRPbmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coYFByZWxvYWRpbmcgdGh1bWIgZmlsZW5hbWU6ICR7bmV3VGh1bWJGaWxlbmFtZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgICAgICAgICAgIHVybFByZWZpeFxuICAgICAgICAgICAgICAgICAgICB9ID0gdGhpcy50aHVtYm5haWxzWzBdO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0aHVtYlVSTCA9IHVybFByZWZpeCArIG5ld1RodW1iRmlsZW5hbWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZpZXdJbWFnZSA9IG5ldyBJbWFnZSgpO1xuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3SW1hZ2Uuc3JjID0gdGh1bWJVUkw7XG5cbiAgICAgICAgICAgICAgICAgICAgcHJldmlld0ltYWdlLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coYFByZWxvYWRlZCB0aHVtYiBmaWxlbmFtZTogJHtuZXdUaHVtYkZpbGVuYW1lfWApO1xuICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5sb2FkZWRJbWFnZXMuaW5jbHVkZXMobmV3VGh1bWJGaWxlbmFtZSkpIHRoaXMubG9hZGVkSW1hZ2VzLnB1c2gobmV3VGh1bWJGaWxlbmFtZSk7IC8vIFdlIGRvbid0IHJlc29sdmUgdW50aWwgdGhlIHRodW1iIGlzIGxvYWRlZFxuXG4gICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7IC8vIElmIHRoZXJlIGFyZSBub25lIHRvIHByZWxvYWQgdGhlbiB3ZSB3YW50IHRvIHJlc29sdmUgaW1tZWRpYXRlbHlcblxuICAgICAgICAgICAgICBpZiAoIWZvdW5kT25lKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgMzAwKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJnZXRIaWdoZXJRdWFsaXR5XCIsIChjdXJyZW50UXVhbGl0eUluZGV4LCBwcmV2aWV3SW1hZ2UsIGZyYW1lLCB0aHVtYkZpbGVuYW1lKSA9PiB7XG4gICAgICAgIGlmIChjdXJyZW50UXVhbGl0eUluZGV4IDwgdGhpcy50aHVtYm5haWxzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAvLyBPbmx5IHVzZSB0aGUgaGlnaGVyIHF1YWxpdHkgdmVyc2lvbiBpZiBpdCdzIGdvaW5nIHRvIGxvb2sgYW55IGJldHRlciAtIGlmIHRoZSBjdXJyZW50IHRodW1iIGlzIG9mIGEgbG93ZXIgcGl4ZWwgZGVuc2l0eSB0aGFuIHRoZSB0aHVtYm5haWwgY29udGFpbmVyXG4gICAgICAgICAgbGV0IHByZXZpZXdJbWFnZUhlaWdodCA9IHByZXZpZXdJbWFnZS5uYXR1cmFsSGVpZ2h0O1xuXG4gICAgICAgICAgaWYgKHRoaXMudXNpbmdTcHJpdGVzKSB7XG4gICAgICAgICAgICBwcmV2aWV3SW1hZ2VIZWlnaHQgPSBmcmFtZS5oO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChwcmV2aWV3SW1hZ2VIZWlnaHQgPCB0aGlzLnRodW1iQ29udGFpbmVySGVpZ2h0KSB7XG4gICAgICAgICAgICAvLyBSZWN1cnNlIGJhY2sgdG8gdGhlIGxvYWRJbWFnZSBmdW5jdGlvbiAtIHNob3cgYSBoaWdoZXIgcXVhbGl0eSBvbmUsIGJ1dCBvbmx5IGlmIHRoZSB2aWV3ZXIgaXMgb24gdGhpcyBmcmFtZSBmb3IgYSB3aGlsZVxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgbW91c2UgaGFzbid0IGFscmVhZHkgbW92ZWQgb24gYW5kIHN0YXJ0ZWQgaG92ZXJpbmcgYXQgYW5vdGhlciBpbWFnZVxuICAgICAgICAgICAgICBpZiAodGhpcy5zaG93aW5nVGh1bWJGaWxlbmFtZSA9PT0gdGh1bWJGaWxlbmFtZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZyhgU2hvd2luZyBoaWdoZXIgcXVhbGl0eSB0aHVtYiBmb3I6ICR7dGh1bWJGaWxlbmFtZX1gKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRJbWFnZShjdXJyZW50UXVhbGl0eUluZGV4ICsgMSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDMwMCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJ0b2dnbGVUaHVtYkNvbnRhaW5lclwiLCAodG9nZ2xlID0gZmFsc2UsIGNsZWFyU2hvd2luZyA9IGZhbHNlKSA9PiB7XG4gICAgICAgIGNvbnN0IGNsYXNzTmFtZSA9IHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLnByZXZpZXdUaHVtYm5haWxzLnRodW1iQ29udGFpbmVyU2hvd247XG4gICAgICAgIHRoaXMuZWxlbWVudHMudGh1bWIuY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoY2xhc3NOYW1lLCB0b2dnbGUpO1xuXG4gICAgICAgIGlmICghdG9nZ2xlICYmIGNsZWFyU2hvd2luZykge1xuICAgICAgICAgIHRoaXMuc2hvd2luZ1RodW1iID0gbnVsbDtcbiAgICAgICAgICB0aGlzLnNob3dpbmdUaHVtYkZpbGVuYW1lID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwidG9nZ2xlU2NydWJiaW5nQ29udGFpbmVyXCIsICh0b2dnbGUgPSBmYWxzZSkgPT4ge1xuICAgICAgICBjb25zdCBjbGFzc05hbWUgPSB0aGlzLnBsYXllci5jb25maWcuY2xhc3NOYW1lcy5wcmV2aWV3VGh1bWJuYWlscy5zY3J1YmJpbmdDb250YWluZXJTaG93bjtcbiAgICAgICAgdGhpcy5lbGVtZW50cy5zY3J1YmJpbmcuY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoY2xhc3NOYW1lLCB0b2dnbGUpO1xuXG4gICAgICAgIGlmICghdG9nZ2xlKSB7XG4gICAgICAgICAgdGhpcy5zaG93aW5nVGh1bWIgPSBudWxsO1xuICAgICAgICAgIHRoaXMuc2hvd2luZ1RodW1iRmlsZW5hbWUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJkZXRlcm1pbmVDb250YWluZXJBdXRvU2l6aW5nXCIsICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudHMudGh1bWIuaW1hZ2VDb250YWluZXIuY2xpZW50SGVpZ2h0ID4gMjAgfHwgdGhpcy5lbGVtZW50cy50aHVtYi5pbWFnZUNvbnRhaW5lci5jbGllbnRXaWR0aCA+IDIwKSB7XG4gICAgICAgICAgLy8gVGhpcyB3aWxsIHByZXZlbnQgYXV0byBzaXppbmcgaW4gdGhpcy5zZXRUaHVtYkNvbnRhaW5lclNpemVBbmRQb3MoKVxuICAgICAgICAgIHRoaXMuc2l6ZVNwZWNpZmllZEluQ1NTID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwic2V0VGh1bWJDb250YWluZXJTaXplQW5kUG9zXCIsICgpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGltYWdlQ29udGFpbmVyXG4gICAgICAgIH0gPSB0aGlzLmVsZW1lbnRzLnRodW1iO1xuXG4gICAgICAgIGlmICghdGhpcy5zaXplU3BlY2lmaWVkSW5DU1MpIHtcbiAgICAgICAgICBjb25zdCB0aHVtYldpZHRoID0gTWF0aC5mbG9vcih0aGlzLnRodW1iQ29udGFpbmVySGVpZ2h0ICogdGhpcy50aHVtYkFzcGVjdFJhdGlvKTtcbiAgICAgICAgICBpbWFnZUNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBgJHt0aGlzLnRodW1iQ29udGFpbmVySGVpZ2h0fXB4YDtcbiAgICAgICAgICBpbWFnZUNvbnRhaW5lci5zdHlsZS53aWR0aCA9IGAke3RodW1iV2lkdGh9cHhgO1xuICAgICAgICB9IGVsc2UgaWYgKGltYWdlQ29udGFpbmVyLmNsaWVudEhlaWdodCA+IDIwICYmIGltYWdlQ29udGFpbmVyLmNsaWVudFdpZHRoIDwgMjApIHtcbiAgICAgICAgICBjb25zdCB0aHVtYldpZHRoID0gTWF0aC5mbG9vcihpbWFnZUNvbnRhaW5lci5jbGllbnRIZWlnaHQgKiB0aGlzLnRodW1iQXNwZWN0UmF0aW8pO1xuICAgICAgICAgIGltYWdlQ29udGFpbmVyLnN0eWxlLndpZHRoID0gYCR7dGh1bWJXaWR0aH1weGA7XG4gICAgICAgIH0gZWxzZSBpZiAoaW1hZ2VDb250YWluZXIuY2xpZW50SGVpZ2h0IDwgMjAgJiYgaW1hZ2VDb250YWluZXIuY2xpZW50V2lkdGggPiAyMCkge1xuICAgICAgICAgIGNvbnN0IHRodW1iSGVpZ2h0ID0gTWF0aC5mbG9vcihpbWFnZUNvbnRhaW5lci5jbGllbnRXaWR0aCAvIHRoaXMudGh1bWJBc3BlY3RSYXRpbyk7XG4gICAgICAgICAgaW1hZ2VDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gYCR7dGh1bWJIZWlnaHR9cHhgO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRUaHVtYkNvbnRhaW5lclBvcygpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwic2V0VGh1bWJDb250YWluZXJQb3NcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCBzY3J1YmJlclJlY3QgPSB0aGlzLnBsYXllci5lbGVtZW50cy5wcm9ncmVzcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgY29uc3QgY29udGFpbmVyUmVjdCA9IHRoaXMucGxheWVyLmVsZW1lbnRzLmNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGNvbnRhaW5lclxuICAgICAgICB9ID0gdGhpcy5lbGVtZW50cy50aHVtYjsgLy8gRmluZCB0aGUgbG93ZXN0IGFuZCBoaWdoZXN0IGRlc2lyZWQgbGVmdC1wb3NpdGlvbiwgc28gd2UgZG9uJ3Qgc2xpZGUgb3V0IHRoZSBzaWRlIG9mIHRoZSB2aWRlbyBjb250YWluZXJcblxuICAgICAgICBjb25zdCBtaW4gPSBjb250YWluZXJSZWN0LmxlZnQgLSBzY3J1YmJlclJlY3QubGVmdCArIDEwO1xuICAgICAgICBjb25zdCBtYXggPSBjb250YWluZXJSZWN0LnJpZ2h0IC0gc2NydWJiZXJSZWN0LmxlZnQgLSBjb250YWluZXIuY2xpZW50V2lkdGggLSAxMDsgLy8gU2V0IHByZXZpZXcgY29udGFpbmVyIHBvc2l0aW9uIHRvOiBtb3VzZXBvcywgbWludXMgc2Vla2Jhci5sZWZ0LCBtaW51cyBoYWxmIG9mIHByZXZpZXdDb250YWluZXIuY2xpZW50V2lkdGhcblxuICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHRoaXMubW91c2VQb3NYIC0gc2NydWJiZXJSZWN0LmxlZnQgLSBjb250YWluZXIuY2xpZW50V2lkdGggLyAyO1xuICAgICAgICBjb25zdCBjbGFtcGVkID0gY2xhbXAocG9zaXRpb24sIG1pbiwgbWF4KTsgLy8gTW92ZSB0aGUgcG9wb3ZlciBwb3NpdGlvblxuXG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gYCR7Y2xhbXBlZH1weGA7IC8vIFRoZSBhcnJvdyBjYW4gZm9sbG93IHRoZSBjdXJzb3JcblxuICAgICAgICBjb250YWluZXIuc3R5bGUuc2V0UHJvcGVydHkoJy0tcHJldmlldy1hcnJvdy1vZmZzZXQnLCBgJHtwb3NpdGlvbiAtIGNsYW1wZWR9cHhgKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInNldFNjcnViYmluZ0NvbnRhaW5lclNpemVcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgd2lkdGgsXG4gICAgICAgICAgaGVpZ2h0XG4gICAgICAgIH0gPSBmaXRSYXRpbyh0aGlzLnRodW1iQXNwZWN0UmF0aW8sIHtcbiAgICAgICAgICB3aWR0aDogdGhpcy5wbGF5ZXIubWVkaWEuY2xpZW50V2lkdGgsXG4gICAgICAgICAgaGVpZ2h0OiB0aGlzLnBsYXllci5tZWRpYS5jbGllbnRIZWlnaHRcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lci5zdHlsZS53aWR0aCA9IGAke3dpZHRofXB4YDtcbiAgICAgICAgdGhpcy5lbGVtZW50cy5zY3J1YmJpbmcuY29udGFpbmVyLnN0eWxlLmhlaWdodCA9IGAke2hlaWdodH1weGA7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJzZXRJbWFnZVNpemVBbmRPZmZzZXRcIiwgKHByZXZpZXdJbWFnZSwgZnJhbWUpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLnVzaW5nU3ByaXRlcykgcmV0dXJuOyAvLyBGaW5kIGRpZmZlcmVuY2UgYmV0d2VlbiBoZWlnaHQgYW5kIHByZXZpZXcgY29udGFpbmVyIGhlaWdodFxuXG4gICAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSB0aGlzLnRodW1iQ29udGFpbmVySGVpZ2h0IC8gZnJhbWUuaDsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG5cbiAgICAgICAgcHJldmlld0ltYWdlLnN0eWxlLmhlaWdodCA9IGAke3ByZXZpZXdJbWFnZS5uYXR1cmFsSGVpZ2h0ICogbXVsdGlwbGllcn1weGA7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuXG4gICAgICAgIHByZXZpZXdJbWFnZS5zdHlsZS53aWR0aCA9IGAke3ByZXZpZXdJbWFnZS5uYXR1cmFsV2lkdGggKiBtdWx0aXBsaWVyfXB4YDsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG5cbiAgICAgICAgcHJldmlld0ltYWdlLnN0eWxlLmxlZnQgPSBgLSR7ZnJhbWUueCAqIG11bHRpcGxpZXJ9cHhgOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cblxuICAgICAgICBwcmV2aWV3SW1hZ2Uuc3R5bGUudG9wID0gYC0ke2ZyYW1lLnkgKiBtdWx0aXBsaWVyfXB4YDtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLnBsYXllciA9IHBsYXllcjtcbiAgICAgIHRoaXMudGh1bWJuYWlscyA9IFtdO1xuICAgICAgdGhpcy5sb2FkZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMubGFzdE1vdXNlTW92ZVRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgdGhpcy5tb3VzZURvd24gPSBmYWxzZTtcbiAgICAgIHRoaXMubG9hZGVkSW1hZ2VzID0gW107XG4gICAgICB0aGlzLmVsZW1lbnRzID0ge1xuICAgICAgICB0aHVtYjoge30sXG4gICAgICAgIHNjcnViYmluZzoge31cbiAgICAgIH07XG4gICAgICB0aGlzLmxvYWQoKTtcbiAgICB9XG5cbiAgICBnZXQgZW5hYmxlZCgpIHtcbiAgICAgIHJldHVybiB0aGlzLnBsYXllci5pc0hUTUw1ICYmIHRoaXMucGxheWVyLmlzVmlkZW8gJiYgdGhpcy5wbGF5ZXIuY29uZmlnLnByZXZpZXdUaHVtYm5haWxzLmVuYWJsZWQ7XG4gICAgfVxuXG4gICAgZ2V0IGN1cnJlbnRJbWFnZUNvbnRhaW5lcigpIHtcbiAgICAgIHJldHVybiB0aGlzLm1vdXNlRG93biA/IHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lciA6IHRoaXMuZWxlbWVudHMudGh1bWIuaW1hZ2VDb250YWluZXI7XG4gICAgfVxuXG4gICAgZ2V0IHVzaW5nU3ByaXRlcygpIHtcbiAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnRodW1ibmFpbHNbMF0uZnJhbWVzWzBdKS5pbmNsdWRlcygndycpO1xuICAgIH1cblxuICAgIGdldCB0aHVtYkFzcGVjdFJhdGlvKCkge1xuICAgICAgaWYgKHRoaXMudXNpbmdTcHJpdGVzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRodW1ibmFpbHNbMF0uZnJhbWVzWzBdLncgLyB0aGlzLnRodW1ibmFpbHNbMF0uZnJhbWVzWzBdLmg7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLnRodW1ibmFpbHNbMF0ud2lkdGggLyB0aGlzLnRodW1ibmFpbHNbMF0uaGVpZ2h0O1xuICAgIH1cblxuICAgIGdldCB0aHVtYkNvbnRhaW5lckhlaWdodCgpIHtcbiAgICAgIGlmICh0aGlzLm1vdXNlRG93bikge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgaGVpZ2h0XG4gICAgICAgIH0gPSBmaXRSYXRpbyh0aGlzLnRodW1iQXNwZWN0UmF0aW8sIHtcbiAgICAgICAgICB3aWR0aDogdGhpcy5wbGF5ZXIubWVkaWEuY2xpZW50V2lkdGgsXG4gICAgICAgICAgaGVpZ2h0OiB0aGlzLnBsYXllci5tZWRpYS5jbGllbnRIZWlnaHRcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBoZWlnaHQ7XG4gICAgICB9IC8vIElmIGNzcyBpcyB1c2VkIHRoaXMgbmVlZHMgdG8gcmV0dXJuIHRoZSBjc3MgaGVpZ2h0IGZvciBzcHJpdGVzIHRvIHdvcmsgKHNlZSBzZXRJbWFnZVNpemVBbmRPZmZzZXQpXG5cblxuICAgICAgaWYgKHRoaXMuc2l6ZVNwZWNpZmllZEluQ1NTKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzLnRodW1iLmltYWdlQ29udGFpbmVyLmNsaWVudEhlaWdodDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE1hdGguZmxvb3IodGhpcy5wbGF5ZXIubWVkaWEuY2xpZW50V2lkdGggLyB0aGlzLnRodW1iQXNwZWN0UmF0aW8gLyA0KTtcbiAgICB9XG5cbiAgICBnZXQgY3VycmVudEltYWdlRWxlbWVudCgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1vdXNlRG93biA/IHRoaXMuY3VycmVudFNjcnViYmluZ0ltYWdlRWxlbWVudCA6IHRoaXMuY3VycmVudFRodW1ibmFpbEltYWdlRWxlbWVudDtcbiAgICB9XG5cbiAgICBzZXQgY3VycmVudEltYWdlRWxlbWVudChlbGVtZW50KSB7XG4gICAgICBpZiAodGhpcy5tb3VzZURvd24pIHtcbiAgICAgICAgdGhpcy5jdXJyZW50U2NydWJiaW5nSW1hZ2VFbGVtZW50ID0gZWxlbWVudDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY3VycmVudFRodW1ibmFpbEltYWdlRWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICB9XG4gICAgfVxuXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBzb3VyY2UgPSB7XG4gICAgLy8gQWRkIGVsZW1lbnRzIHRvIEhUTUw1IG1lZGlhIChzb3VyY2UsIHRyYWNrcywgZXRjKVxuICAgIGluc2VydEVsZW1lbnRzKHR5cGUsIGF0dHJpYnV0ZXMpIHtcbiAgICAgIGlmIChpcy5zdHJpbmcoYXR0cmlidXRlcykpIHtcbiAgICAgICAgaW5zZXJ0RWxlbWVudCh0eXBlLCB0aGlzLm1lZGlhLCB7XG4gICAgICAgICAgc3JjOiBhdHRyaWJ1dGVzXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChpcy5hcnJheShhdHRyaWJ1dGVzKSkge1xuICAgICAgICBhdHRyaWJ1dGVzLmZvckVhY2goYXR0cmlidXRlID0+IHtcbiAgICAgICAgICBpbnNlcnRFbGVtZW50KHR5cGUsIHRoaXMubWVkaWEsIGF0dHJpYnV0ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBVcGRhdGUgc291cmNlXG4gICAgLy8gU291cmNlcyBhcmUgbm90IGNoZWNrZWQgZm9yIHN1cHBvcnQgc28gYmUgY2FyZWZ1bFxuICAgIGNoYW5nZShpbnB1dCkge1xuICAgICAgaWYgKCFnZXREZWVwKGlucHV0LCAnc291cmNlcy5sZW5ndGgnKSkge1xuICAgICAgICB0aGlzLmRlYnVnLndhcm4oJ0ludmFsaWQgc291cmNlIGZvcm1hdCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIENhbmNlbCBjdXJyZW50IG5ldHdvcmsgcmVxdWVzdHNcblxuXG4gICAgICBodG1sNS5jYW5jZWxSZXF1ZXN0cy5jYWxsKHRoaXMpOyAvLyBEZXN0cm95IGluc3RhbmNlIGFuZCByZS1zZXR1cFxuXG4gICAgICB0aGlzLmRlc3Ryb3kuY2FsbCh0aGlzLCAoKSA9PiB7XG4gICAgICAgIC8vIFJlc2V0IHF1YWxpdHkgb3B0aW9uc1xuICAgICAgICB0aGlzLm9wdGlvbnMucXVhbGl0eSA9IFtdOyAvLyBSZW1vdmUgZWxlbWVudHNcblxuICAgICAgICByZW1vdmVFbGVtZW50KHRoaXMubWVkaWEpO1xuICAgICAgICB0aGlzLm1lZGlhID0gbnVsbDsgLy8gUmVzZXQgY2xhc3MgbmFtZVxuXG4gICAgICAgIGlmIChpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuY29udGFpbmVyKSkge1xuICAgICAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLnJlbW92ZUF0dHJpYnV0ZSgnY2xhc3MnKTtcbiAgICAgICAgfSAvLyBTZXQgdGhlIHR5cGUgYW5kIHByb3ZpZGVyXG5cblxuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgc291cmNlcyxcbiAgICAgICAgICB0eXBlXG4gICAgICAgIH0gPSBpbnB1dDtcbiAgICAgICAgY29uc3QgW3tcbiAgICAgICAgICBwcm92aWRlciA9IHByb3ZpZGVycy5odG1sNSxcbiAgICAgICAgICBzcmNcbiAgICAgICAgfV0gPSBzb3VyY2VzO1xuICAgICAgICBjb25zdCB0YWdOYW1lID0gcHJvdmlkZXIgPT09ICdodG1sNScgPyB0eXBlIDogJ2Rpdic7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBwcm92aWRlciA9PT0gJ2h0bWw1JyA/IHt9IDoge1xuICAgICAgICAgIHNyY1xuICAgICAgICB9O1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIHtcbiAgICAgICAgICBwcm92aWRlcixcbiAgICAgICAgICB0eXBlLFxuICAgICAgICAgIC8vIENoZWNrIGZvciBzdXBwb3J0XG4gICAgICAgICAgc3VwcG9ydGVkOiBzdXBwb3J0LmNoZWNrKHR5cGUsIHByb3ZpZGVyLCB0aGlzLmNvbmZpZy5wbGF5c2lubGluZSksXG4gICAgICAgICAgLy8gQ3JlYXRlIG5ldyBlbGVtZW50XG4gICAgICAgICAgbWVkaWE6IGNyZWF0ZUVsZW1lbnQodGFnTmFtZSwgYXR0cmlidXRlcylcbiAgICAgICAgfSk7IC8vIEluamVjdCB0aGUgbmV3IGVsZW1lbnRcblxuICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLm1lZGlhKTsgLy8gQXV0b3BsYXkgdGhlIG5ldyBzb3VyY2U/XG5cbiAgICAgICAgaWYgKGlzLmJvb2xlYW4oaW5wdXQuYXV0b3BsYXkpKSB7XG4gICAgICAgICAgdGhpcy5jb25maWcuYXV0b3BsYXkgPSBpbnB1dC5hdXRvcGxheTtcbiAgICAgICAgfSAvLyBTZXQgYXR0cmlidXRlcyBmb3IgYXVkaW8gYW5kIHZpZGVvXG5cblxuICAgICAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmNyb3Nzb3JpZ2luKSB7XG4gICAgICAgICAgICB0aGlzLm1lZGlhLnNldEF0dHJpYnV0ZSgnY3Jvc3NvcmlnaW4nLCAnJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmF1dG9wbGF5KSB7XG4gICAgICAgICAgICB0aGlzLm1lZGlhLnNldEF0dHJpYnV0ZSgnYXV0b3BsYXknLCAnJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCFpcy5lbXB0eShpbnB1dC5wb3N0ZXIpKSB7XG4gICAgICAgICAgICB0aGlzLnBvc3RlciA9IGlucHV0LnBvc3RlcjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodGhpcy5jb25maWcubG9vcC5hY3RpdmUpIHtcbiAgICAgICAgICAgIHRoaXMubWVkaWEuc2V0QXR0cmlidXRlKCdsb29wJywgJycpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5tdXRlZCkge1xuICAgICAgICAgICAgdGhpcy5tZWRpYS5zZXRBdHRyaWJ1dGUoJ211dGVkJywgJycpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5wbGF5c2lubGluZSkge1xuICAgICAgICAgICAgdGhpcy5tZWRpYS5zZXRBdHRyaWJ1dGUoJ3BsYXlzaW5saW5lJywgJycpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSAvLyBSZXN0b3JlIGNsYXNzIGhvb2tcblxuXG4gICAgICAgIHVpLmFkZFN0eWxlSG9vay5jYWxsKHRoaXMpOyAvLyBTZXQgbmV3IHNvdXJjZXMgZm9yIGh0bWw1XG5cbiAgICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICAgIHNvdXJjZS5pbnNlcnRFbGVtZW50cy5jYWxsKHRoaXMsICdzb3VyY2UnLCBzb3VyY2VzKTtcbiAgICAgICAgfSAvLyBTZXQgdmlkZW8gdGl0bGVcblxuXG4gICAgICAgIHRoaXMuY29uZmlnLnRpdGxlID0gaW5wdXQudGl0bGU7IC8vIFNldCB1cCBmcm9tIHNjcmF0Y2hcblxuICAgICAgICBtZWRpYS5zZXR1cC5jYWxsKHRoaXMpOyAvLyBIVE1MNSBzdHVmZlxuXG4gICAgICAgIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgICAvLyBTZXR1cCBjYXB0aW9uc1xuICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhpbnB1dCkuaW5jbHVkZXMoJ3RyYWNrcycpKSB7XG4gICAgICAgICAgICBzb3VyY2UuaW5zZXJ0RWxlbWVudHMuY2FsbCh0aGlzLCAndHJhY2snLCBpbnB1dC50cmFja3MpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSAvLyBJZiBIVE1MNSBvciBlbWJlZCBidXQgbm90IGZ1bGx5IHN1cHBvcnRlZCwgc2V0dXBJbnRlcmZhY2UgYW5kIGNhbGwgcmVhZHkgbm93XG5cblxuICAgICAgICBpZiAodGhpcy5pc0hUTUw1IHx8IHRoaXMuaXNFbWJlZCAmJiAhdGhpcy5zdXBwb3J0ZWQudWkpIHtcbiAgICAgICAgICAvLyBTZXR1cCBpbnRlcmZhY2VcbiAgICAgICAgICB1aS5idWlsZC5jYWxsKHRoaXMpO1xuICAgICAgICB9IC8vIExvYWQgSFRNTDUgc291cmNlc1xuXG5cbiAgICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICAgIHRoaXMubWVkaWEubG9hZCgpO1xuICAgICAgICB9IC8vIFVwZGF0ZSBwcmV2aWV3VGh1bWJuYWlscyBjb25maWcgJiByZWxvYWQgcGx1Z2luXG5cblxuICAgICAgICBpZiAoIWlzLmVtcHR5KGlucHV0LnByZXZpZXdUaHVtYm5haWxzKSkge1xuICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5jb25maWcucHJldmlld1RodW1ibmFpbHMsIGlucHV0LnByZXZpZXdUaHVtYm5haWxzKTsgLy8gQ2xlYW51cCBwcmV2aWV3VGh1bWJuYWlscyBwbHVnaW4gaWYgaXQgd2FzIGxvYWRlZFxuXG4gICAgICAgICAgaWYgKHRoaXMucHJldmlld1RodW1ibmFpbHMgJiYgdGhpcy5wcmV2aWV3VGh1bWJuYWlscy5sb2FkZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJldmlld1RodW1ibmFpbHMuZGVzdHJveSgpO1xuICAgICAgICAgICAgdGhpcy5wcmV2aWV3VGh1bWJuYWlscyA9IG51bGw7XG4gICAgICAgICAgfSAvLyBDcmVhdGUgbmV3IGluc3RhbmNlIGlmIGl0IGlzIHN0aWxsIGVuYWJsZWRcblxuXG4gICAgICAgICAgaWYgKHRoaXMuY29uZmlnLnByZXZpZXdUaHVtYm5haWxzLmVuYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJldmlld1RodW1ibmFpbHMgPSBuZXcgUHJldmlld1RodW1ibmFpbHModGhpcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IC8vIFVwZGF0ZSB0aGUgZnVsbHNjcmVlbiBzdXBwb3J0XG5cblxuICAgICAgICB0aGlzLmZ1bGxzY3JlZW4udXBkYXRlKCk7XG4gICAgICB9LCB0cnVlKTtcbiAgICB9XG5cbiAgfTtcblxuICAvLyBUT0RPOiBVc2UgYSBXZWFrTWFwIGZvciBwcml2YXRlIGdsb2JhbHNcbiAgLy8gY29uc3QgZ2xvYmFscyA9IG5ldyBXZWFrTWFwKCk7XG4gIC8vIFBseXIgaW5zdGFuY2VcblxuICBjbGFzcyBQbHlyIHtcbiAgICBjb25zdHJ1Y3Rvcih0YXJnZXQsIG9wdGlvbnMpIHtcbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwicGxheVwiLCAoKSA9PiB7XG4gICAgICAgIGlmICghaXMuZnVuY3Rpb24odGhpcy5tZWRpYS5wbGF5KSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9IC8vIEludGVjZXB0IHBsYXkgd2l0aCBhZHNcblxuXG4gICAgICAgIGlmICh0aGlzLmFkcyAmJiB0aGlzLmFkcy5lbmFibGVkKSB7XG4gICAgICAgICAgdGhpcy5hZHMubWFuYWdlclByb21pc2UudGhlbigoKSA9PiB0aGlzLmFkcy5wbGF5KCkpLmNhdGNoKCgpID0+IHNpbGVuY2VQcm9taXNlKHRoaXMubWVkaWEucGxheSgpKSk7XG4gICAgICAgIH0gLy8gUmV0dXJuIHRoZSBwcm9taXNlIChmb3IgSFRNTDUpXG5cblxuICAgICAgICByZXR1cm4gdGhpcy5tZWRpYS5wbGF5KCk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJwYXVzZVwiLCAoKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5wbGF5aW5nIHx8ICFpcy5mdW5jdGlvbih0aGlzLm1lZGlhLnBhdXNlKSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMubWVkaWEucGF1c2UoKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInRvZ2dsZVBsYXlcIiwgaW5wdXQgPT4ge1xuICAgICAgICAvLyBUb2dnbGUgYmFzZWQgb24gY3VycmVudCBzdGF0ZSBpZiBub3RoaW5nIHBhc3NlZFxuICAgICAgICBjb25zdCB0b2dnbGUgPSBpcy5ib29sZWFuKGlucHV0KSA/IGlucHV0IDogIXRoaXMucGxheWluZztcblxuICAgICAgICBpZiAodG9nZ2xlKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMucGxheSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMucGF1c2UoKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInN0b3BcIiwgKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICAgICAgdGhpcy5wYXVzZSgpO1xuICAgICAgICAgIHRoaXMucmVzdGFydCgpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzLmZ1bmN0aW9uKHRoaXMubWVkaWEuc3RvcCkpIHtcbiAgICAgICAgICB0aGlzLm1lZGlhLnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwicmVzdGFydFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuY3VycmVudFRpbWUgPSAwO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwicmV3aW5kXCIsIHNlZWtUaW1lID0+IHtcbiAgICAgICAgdGhpcy5jdXJyZW50VGltZSAtPSBpcy5udW1iZXIoc2Vla1RpbWUpID8gc2Vla1RpbWUgOiB0aGlzLmNvbmZpZy5zZWVrVGltZTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImZvcndhcmRcIiwgc2Vla1RpbWUgPT4ge1xuICAgICAgICB0aGlzLmN1cnJlbnRUaW1lICs9IGlzLm51bWJlcihzZWVrVGltZSkgPyBzZWVrVGltZSA6IHRoaXMuY29uZmlnLnNlZWtUaW1lO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiaW5jcmVhc2VWb2x1bWVcIiwgc3RlcCA9PiB7XG4gICAgICAgIGNvbnN0IHZvbHVtZSA9IHRoaXMubWVkaWEubXV0ZWQgPyAwIDogdGhpcy52b2x1bWU7XG4gICAgICAgIHRoaXMudm9sdW1lID0gdm9sdW1lICsgKGlzLm51bWJlcihzdGVwKSA/IHN0ZXAgOiAwKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImRlY3JlYXNlVm9sdW1lXCIsIHN0ZXAgPT4ge1xuICAgICAgICB0aGlzLmluY3JlYXNlVm9sdW1lKC1zdGVwKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImFpcnBsYXlcIiwgKCkgPT4ge1xuICAgICAgICAvLyBTaG93IGRpYWxvZyBpZiBzdXBwb3J0ZWRcbiAgICAgICAgaWYgKHN1cHBvcnQuYWlycGxheSkge1xuICAgICAgICAgIHRoaXMubWVkaWEud2Via2l0U2hvd1BsYXliYWNrVGFyZ2V0UGlja2VyKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInRvZ2dsZUNvbnRyb2xzXCIsIHRvZ2dsZSA9PiB7XG4gICAgICAgIC8vIERvbid0IHRvZ2dsZSBpZiBtaXNzaW5nIFVJIHN1cHBvcnQgb3IgaWYgaXQncyBhdWRpb1xuICAgICAgICBpZiAodGhpcy5zdXBwb3J0ZWQudWkgJiYgIXRoaXMuaXNBdWRpbykge1xuICAgICAgICAgIC8vIEdldCBzdGF0ZSBiZWZvcmUgY2hhbmdlXG4gICAgICAgICAgY29uc3QgaXNIaWRkZW4gPSBoYXNDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5oaWRlQ29udHJvbHMpOyAvLyBOZWdhdGUgdGhlIGFyZ3VtZW50IGlmIG5vdCB1bmRlZmluZWQgc2luY2UgYWRkaW5nIHRoZSBjbGFzcyB0byBoaWRlcyB0aGUgY29udHJvbHNcblxuICAgICAgICAgIGNvbnN0IGZvcmNlID0gdHlwZW9mIHRvZ2dsZSA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiAhdG9nZ2xlOyAvLyBBcHBseSBhbmQgZ2V0IHVwZGF0ZWQgc3RhdGVcblxuICAgICAgICAgIGNvbnN0IGhpZGluZyA9IHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmhpZGVDb250cm9scywgZm9yY2UpOyAvLyBDbG9zZSBtZW51XG5cbiAgICAgICAgICBpZiAoaGlkaW5nICYmIGlzLmFycmF5KHRoaXMuY29uZmlnLmNvbnRyb2xzKSAmJiB0aGlzLmNvbmZpZy5jb250cm9scy5pbmNsdWRlcygnc2V0dGluZ3MnKSAmJiAhaXMuZW1wdHkodGhpcy5jb25maWcuc2V0dGluZ3MpKSB7XG4gICAgICAgICAgICBjb250cm9scy50b2dnbGVNZW51LmNhbGwodGhpcywgZmFsc2UpO1xuICAgICAgICAgIH0gLy8gVHJpZ2dlciBldmVudCBvbiBjaGFuZ2VcblxuXG4gICAgICAgICAgaWYgKGhpZGluZyAhPT0gaXNIaWRkZW4pIHtcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50TmFtZSA9IGhpZGluZyA/ICdjb250cm9sc2hpZGRlbicgOiAnY29udHJvbHNzaG93bic7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbCh0aGlzLCB0aGlzLm1lZGlhLCBldmVudE5hbWUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiAhaGlkaW5nO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwib25cIiwgKGV2ZW50LCBjYWxsYmFjaykgPT4ge1xuICAgICAgICBvbi5jYWxsKHRoaXMsIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCBldmVudCwgY2FsbGJhY2spO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwib25jZVwiLCAoZXZlbnQsIGNhbGxiYWNrKSA9PiB7XG4gICAgICAgIG9uY2UuY2FsbCh0aGlzLCB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgZXZlbnQsIGNhbGxiYWNrKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcIm9mZlwiLCAoZXZlbnQsIGNhbGxiYWNrKSA9PiB7XG4gICAgICAgIG9mZih0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgZXZlbnQsIGNhbGxiYWNrKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImRlc3Ryb3lcIiwgKGNhbGxiYWNrLCBzb2Z0ID0gZmFsc2UpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLnJlYWR5KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZG9uZSA9ICgpID0+IHtcbiAgICAgICAgICAvLyBSZXNldCBvdmVyZmxvdyAoaW5jYXNlIGRlc3Ryb3llZCB3aGlsZSBpbiBmdWxsc2NyZWVuKVxuICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnJzsgLy8gR0MgZm9yIGVtYmVkXG5cbiAgICAgICAgICB0aGlzLmVtYmVkID0gbnVsbDsgLy8gSWYgaXQncyBhIHNvZnQgZGVzdHJveSwgbWFrZSBtaW5pbWFsIGNoYW5nZXNcblxuICAgICAgICAgIGlmIChzb2Z0KSB7XG4gICAgICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5lbGVtZW50cykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIC8vIFJlbW92ZSBlbGVtZW50c1xuICAgICAgICAgICAgICByZW1vdmVFbGVtZW50KHRoaXMuZWxlbWVudHMuYnV0dG9ucy5wbGF5KTtcbiAgICAgICAgICAgICAgcmVtb3ZlRWxlbWVudCh0aGlzLmVsZW1lbnRzLmNhcHRpb25zKTtcbiAgICAgICAgICAgICAgcmVtb3ZlRWxlbWVudCh0aGlzLmVsZW1lbnRzLmNvbnRyb2xzKTtcbiAgICAgICAgICAgICAgcmVtb3ZlRWxlbWVudCh0aGlzLmVsZW1lbnRzLndyYXBwZXIpOyAvLyBDbGVhciBmb3IgR0NcblxuICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRzLmJ1dHRvbnMucGxheSA9IG51bGw7XG4gICAgICAgICAgICAgIHRoaXMuZWxlbWVudHMuY2FwdGlvbnMgPSBudWxsO1xuICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRyb2xzID0gbnVsbDtcbiAgICAgICAgICAgICAgdGhpcy5lbGVtZW50cy53cmFwcGVyID0gbnVsbDtcbiAgICAgICAgICAgIH0gLy8gQ2FsbGJhY2tcblxuXG4gICAgICAgICAgICBpZiAoaXMuZnVuY3Rpb24oY2FsbGJhY2spKSB7XG4gICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFVuYmluZCBsaXN0ZW5lcnNcbiAgICAgICAgICAgIHVuYmluZExpc3RlbmVycy5jYWxsKHRoaXMpOyAvLyBDYW5jZWwgY3VycmVudCBuZXR3b3JrIHJlcXVlc3RzXG5cbiAgICAgICAgICAgIGh0bWw1LmNhbmNlbFJlcXVlc3RzLmNhbGwodGhpcyk7IC8vIFJlcGxhY2UgdGhlIGNvbnRhaW5lciB3aXRoIHRoZSBvcmlnaW5hbCBlbGVtZW50IHByb3ZpZGVkXG5cbiAgICAgICAgICAgIHJlcGxhY2VFbGVtZW50KHRoaXMuZWxlbWVudHMub3JpZ2luYWwsIHRoaXMuZWxlbWVudHMuY29udGFpbmVyKTsgLy8gRXZlbnRcblxuICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwodGhpcywgdGhpcy5lbGVtZW50cy5vcmlnaW5hbCwgJ2Rlc3Ryb3llZCcsIHRydWUpOyAvLyBDYWxsYmFja1xuXG4gICAgICAgICAgICBpZiAoaXMuZnVuY3Rpb24oY2FsbGJhY2spKSB7XG4gICAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpcy5lbGVtZW50cy5vcmlnaW5hbCk7XG4gICAgICAgICAgICB9IC8vIFJlc2V0IHN0YXRlXG5cblxuICAgICAgICAgICAgdGhpcy5yZWFkeSA9IGZhbHNlOyAvLyBDbGVhciBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uXG5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRzID0gbnVsbDtcbiAgICAgICAgICAgICAgdGhpcy5tZWRpYSA9IG51bGw7XG4gICAgICAgICAgICB9LCAyMDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfTsgLy8gU3RvcCBwbGF5YmFja1xuXG5cbiAgICAgICAgdGhpcy5zdG9wKCk7IC8vIENsZWFyIHRpbWVvdXRzXG5cbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmxvYWRpbmcpO1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcnMuY29udHJvbHMpO1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcnMucmVzaXplZCk7IC8vIFByb3ZpZGVyIHNwZWNpZmljIHN0dWZmXG5cbiAgICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICAgIC8vIFJlc3RvcmUgbmF0aXZlIHZpZGVvIGNvbnRyb2xzXG4gICAgICAgICAgdWkudG9nZ2xlTmF0aXZlQ29udHJvbHMuY2FsbCh0aGlzLCB0cnVlKTsgLy8gQ2xlYW4gdXBcblxuICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzWW91VHViZSkge1xuICAgICAgICAgIC8vIENsZWFyIHRpbWVyc1xuICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcnMuYnVmZmVyaW5nKTtcbiAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXJzLnBsYXlpbmcpOyAvLyBEZXN0cm95IFlvdVR1YmUgQVBJXG5cbiAgICAgICAgICBpZiAodGhpcy5lbWJlZCAhPT0gbnVsbCAmJiBpcy5mdW5jdGlvbih0aGlzLmVtYmVkLmRlc3Ryb3kpKSB7XG4gICAgICAgICAgICB0aGlzLmVtYmVkLmRlc3Ryb3koKTtcbiAgICAgICAgICB9IC8vIENsZWFuIHVwXG5cblxuICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzVmltZW8pIHtcbiAgICAgICAgICAvLyBEZXN0cm95IFZpbWVvIEFQSVxuICAgICAgICAgIC8vIHRoZW4gY2xlYW4gdXAgKHdhaXQsIHRvIHByZXZlbnQgcG9zdG1lc3NhZ2UgZXJyb3JzKVxuICAgICAgICAgIGlmICh0aGlzLmVtYmVkICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmVtYmVkLnVubG9hZCgpLnRoZW4oZG9uZSk7XG4gICAgICAgICAgfSAvLyBWaW1lbyBkb2VzIG5vdCBhbHdheXMgcmV0dXJuXG5cblxuICAgICAgICAgIHNldFRpbWVvdXQoZG9uZSwgMjAwKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwic3VwcG9ydHNcIiwgdHlwZSA9PiBzdXBwb3J0Lm1pbWUuY2FsbCh0aGlzLCB0eXBlKSk7XG5cbiAgICAgIHRoaXMudGltZXJzID0ge307IC8vIFN0YXRlXG5cbiAgICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5mYWlsZWQgPSBmYWxzZTsgLy8gVG91Y2ggZGV2aWNlXG5cbiAgICAgIHRoaXMudG91Y2ggPSBzdXBwb3J0LnRvdWNoOyAvLyBTZXQgdGhlIG1lZGlhIGVsZW1lbnRcblxuICAgICAgdGhpcy5tZWRpYSA9IHRhcmdldDsgLy8gU3RyaW5nIHNlbGVjdG9yIHBhc3NlZFxuXG4gICAgICBpZiAoaXMuc3RyaW5nKHRoaXMubWVkaWEpKSB7XG4gICAgICAgIHRoaXMubWVkaWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMubWVkaWEpO1xuICAgICAgfSAvLyBqUXVlcnksIE5vZGVMaXN0IG9yIEFycmF5IHBhc3NlZCwgdXNlIGZpcnN0IGVsZW1lbnRcblxuXG4gICAgICBpZiAod2luZG93LmpRdWVyeSAmJiB0aGlzLm1lZGlhIGluc3RhbmNlb2YgalF1ZXJ5IHx8IGlzLm5vZGVMaXN0KHRoaXMubWVkaWEpIHx8IGlzLmFycmF5KHRoaXMubWVkaWEpKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgICB0aGlzLm1lZGlhID0gdGhpcy5tZWRpYVswXTtcbiAgICAgIH0gLy8gU2V0IGNvbmZpZ1xuXG5cbiAgICAgIHRoaXMuY29uZmlnID0gZXh0ZW5kKHt9LCBkZWZhdWx0cywgUGx5ci5kZWZhdWx0cywgb3B0aW9ucyB8fCB7fSwgKCgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSh0aGlzLm1lZGlhLmdldEF0dHJpYnV0ZSgnZGF0YS1wbHlyLWNvbmZpZycpKTtcbiAgICAgICAgfSBjYXRjaCAoXykge1xuICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfVxuICAgICAgfSkoKSk7IC8vIEVsZW1lbnRzIGNhY2hlXG5cbiAgICAgIHRoaXMuZWxlbWVudHMgPSB7XG4gICAgICAgIGNvbnRhaW5lcjogbnVsbCxcbiAgICAgICAgZnVsbHNjcmVlbjogbnVsbCxcbiAgICAgICAgY2FwdGlvbnM6IG51bGwsXG4gICAgICAgIGJ1dHRvbnM6IHt9LFxuICAgICAgICBkaXNwbGF5OiB7fSxcbiAgICAgICAgcHJvZ3Jlc3M6IHt9LFxuICAgICAgICBpbnB1dHM6IHt9LFxuICAgICAgICBzZXR0aW5nczoge1xuICAgICAgICAgIHBvcHVwOiBudWxsLFxuICAgICAgICAgIG1lbnU6IG51bGwsXG4gICAgICAgICAgcGFuZWxzOiB7fSxcbiAgICAgICAgICBidXR0b25zOiB7fVxuICAgICAgICB9XG4gICAgICB9OyAvLyBDYXB0aW9uc1xuXG4gICAgICB0aGlzLmNhcHRpb25zID0ge1xuICAgICAgICBhY3RpdmU6IG51bGwsXG4gICAgICAgIGN1cnJlbnRUcmFjazogLTEsXG4gICAgICAgIG1ldGE6IG5ldyBXZWFrTWFwKClcbiAgICAgIH07IC8vIEZ1bGxzY3JlZW5cblxuICAgICAgdGhpcy5mdWxsc2NyZWVuID0ge1xuICAgICAgICBhY3RpdmU6IGZhbHNlXG4gICAgICB9OyAvLyBPcHRpb25zXG5cbiAgICAgIHRoaXMub3B0aW9ucyA9IHtcbiAgICAgICAgc3BlZWQ6IFtdLFxuICAgICAgICBxdWFsaXR5OiBbXVxuICAgICAgfTsgLy8gRGVidWdnaW5nXG4gICAgICAvLyBUT0RPOiBtb3ZlIHRvIGdsb2JhbHNcblxuICAgICAgdGhpcy5kZWJ1ZyA9IG5ldyBDb25zb2xlKHRoaXMuY29uZmlnLmRlYnVnKTsgLy8gTG9nIGNvbmZpZyBvcHRpb25zIGFuZCBzdXBwb3J0XG5cbiAgICAgIHRoaXMuZGVidWcubG9nKCdDb25maWcnLCB0aGlzLmNvbmZpZyk7XG4gICAgICB0aGlzLmRlYnVnLmxvZygnU3VwcG9ydCcsIHN1cHBvcnQpOyAvLyBXZSBuZWVkIGFuIGVsZW1lbnQgdG8gc2V0dXBcblxuICAgICAgaWYgKGlzLm51bGxPclVuZGVmaW5lZCh0aGlzLm1lZGlhKSB8fCAhaXMuZWxlbWVudCh0aGlzLm1lZGlhKSkge1xuICAgICAgICB0aGlzLmRlYnVnLmVycm9yKCdTZXR1cCBmYWlsZWQ6IG5vIHN1aXRhYmxlIGVsZW1lbnQgcGFzc2VkJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gQmFpbCBpZiB0aGUgZWxlbWVudCBpcyBpbml0aWFsaXplZFxuXG5cbiAgICAgIGlmICh0aGlzLm1lZGlhLnBseXIpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdUYXJnZXQgYWxyZWFkeSBzZXR1cCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIEJhaWwgaWYgbm90IGVuYWJsZWRcblxuXG4gICAgICBpZiAoIXRoaXMuY29uZmlnLmVuYWJsZWQpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy5lcnJvcignU2V0dXAgZmFpbGVkOiBkaXNhYmxlZCBieSBjb25maWcnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBCYWlsIGlmIGRpc2FibGVkIG9yIG5vIGJhc2ljIHN1cHBvcnRcbiAgICAgIC8vIFlvdSBtYXkgd2FudCB0byBkaXNhYmxlIGNlcnRhaW4gVUFzIGV0Y1xuXG5cbiAgICAgIGlmICghc3VwcG9ydC5jaGVjaygpLmFwaSkge1xuICAgICAgICB0aGlzLmRlYnVnLmVycm9yKCdTZXR1cCBmYWlsZWQ6IG5vIHN1cHBvcnQnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBDYWNoZSBvcmlnaW5hbCBlbGVtZW50IHN0YXRlIGZvciAuZGVzdHJveSgpXG5cblxuICAgICAgY29uc3QgY2xvbmUgPSB0aGlzLm1lZGlhLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgIGNsb25lLmF1dG9wbGF5ID0gZmFsc2U7XG4gICAgICB0aGlzLmVsZW1lbnRzLm9yaWdpbmFsID0gY2xvbmU7IC8vIFNldCBtZWRpYSB0eXBlIGJhc2VkIG9uIHRhZyBvciBkYXRhIGF0dHJpYnV0ZVxuICAgICAgLy8gU3VwcG9ydGVkOiB2aWRlbywgYXVkaW8sIHZpbWVvLCB5b3V0dWJlXG5cbiAgICAgIGNvbnN0IF90eXBlID0gdGhpcy5tZWRpYS50YWdOYW1lLnRvTG93ZXJDYXNlKCk7IC8vIEVtYmVkIHByb3BlcnRpZXNcblxuXG4gICAgICBsZXQgaWZyYW1lID0gbnVsbDtcbiAgICAgIGxldCB1cmwgPSBudWxsOyAvLyBEaWZmZXJlbnQgc2V0dXAgYmFzZWQgb24gdHlwZVxuXG4gICAgICBzd2l0Y2ggKF90eXBlKSB7XG4gICAgICAgIGNhc2UgJ2Rpdic6XG4gICAgICAgICAgLy8gRmluZCB0aGUgZnJhbWVcbiAgICAgICAgICBpZnJhbWUgPSB0aGlzLm1lZGlhLnF1ZXJ5U2VsZWN0b3IoJ2lmcmFtZScpOyAvLyA8aWZyYW1lPiB0eXBlXG5cbiAgICAgICAgICBpZiAoaXMuZWxlbWVudChpZnJhbWUpKSB7XG4gICAgICAgICAgICAvLyBEZXRlY3QgcHJvdmlkZXJcbiAgICAgICAgICAgIHVybCA9IHBhcnNlVXJsKGlmcmFtZS5nZXRBdHRyaWJ1dGUoJ3NyYycpKTtcbiAgICAgICAgICAgIHRoaXMucHJvdmlkZXIgPSBnZXRQcm92aWRlckJ5VXJsKHVybC50b1N0cmluZygpKTsgLy8gUmV3b3JrIGVsZW1lbnRzXG5cbiAgICAgICAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyID0gdGhpcy5tZWRpYTtcbiAgICAgICAgICAgIHRoaXMubWVkaWEgPSBpZnJhbWU7IC8vIFJlc2V0IGNsYXNzbmFtZVxuXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5jbGFzc05hbWUgPSAnJzsgLy8gR2V0IGF0dHJpYnV0ZXMgZnJvbSBVUkwgYW5kIHNldCBjb25maWdcblxuICAgICAgICAgICAgaWYgKHVybC5zZWFyY2gubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHRydXRoeSA9IFsnMScsICd0cnVlJ107XG5cbiAgICAgICAgICAgICAgaWYgKHRydXRoeS5pbmNsdWRlcyh1cmwuc2VhcmNoUGFyYW1zLmdldCgnYXV0b3BsYXknKSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5hdXRvcGxheSA9IHRydWU7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAodHJ1dGh5LmluY2x1ZGVzKHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdsb29wJykpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICB9IC8vIFRPRE86IHJlcGxhY2UgZnVsbHNjcmVlbi5pb3NOYXRpdmUgd2l0aCB0aGlzIHBsYXlzaW5saW5lIGNvbmZpZyBvcHRpb25cbiAgICAgICAgICAgICAgLy8gWW91VHViZSByZXF1aXJlcyB0aGUgcGxheXNpbmxpbmUgaW4gdGhlIFVSTFxuXG5cbiAgICAgICAgICAgICAgaWYgKHRoaXMuaXNZb3VUdWJlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcucGxheXNpbmxpbmUgPSB0cnV0aHkuaW5jbHVkZXModXJsLnNlYXJjaFBhcmFtcy5nZXQoJ3BsYXlzaW5saW5lJykpO1xuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLnlvdXR1YmUuaGwgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnaGwnKTsgLy8gVE9ETzogU2hvdWxkIHRoaXMgYmUgc2V0dGluZyBsYW5ndWFnZT9cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5wbGF5c2lubGluZSA9IHRydWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gPGRpdj4gd2l0aCBhdHRyaWJ1dGVzXG4gICAgICAgICAgICB0aGlzLnByb3ZpZGVyID0gdGhpcy5tZWRpYS5nZXRBdHRyaWJ1dGUodGhpcy5jb25maWcuYXR0cmlidXRlcy5lbWJlZC5wcm92aWRlcik7IC8vIFJlbW92ZSBhdHRyaWJ1dGVcblxuICAgICAgICAgICAgdGhpcy5tZWRpYS5yZW1vdmVBdHRyaWJ1dGUodGhpcy5jb25maWcuYXR0cmlidXRlcy5lbWJlZC5wcm92aWRlcik7XG4gICAgICAgICAgfSAvLyBVbnN1cHBvcnRlZCBvciBtaXNzaW5nIHByb3ZpZGVyXG5cblxuICAgICAgICAgIGlmIChpcy5lbXB0eSh0aGlzLnByb3ZpZGVyKSB8fCAhT2JqZWN0LnZhbHVlcyhwcm92aWRlcnMpLmluY2x1ZGVzKHRoaXMucHJvdmlkZXIpKSB7XG4gICAgICAgICAgICB0aGlzLmRlYnVnLmVycm9yKCdTZXR1cCBmYWlsZWQ6IEludmFsaWQgcHJvdmlkZXInKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IC8vIEF1ZGlvIHdpbGwgY29tZSBsYXRlciBmb3IgZXh0ZXJuYWwgcHJvdmlkZXJzXG5cblxuICAgICAgICAgIHRoaXMudHlwZSA9IHR5cGVzLnZpZGVvO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3ZpZGVvJzpcbiAgICAgICAgY2FzZSAnYXVkaW8nOlxuICAgICAgICAgIHRoaXMudHlwZSA9IF90eXBlO1xuICAgICAgICAgIHRoaXMucHJvdmlkZXIgPSBwcm92aWRlcnMuaHRtbDU7IC8vIEdldCBjb25maWcgZnJvbSBhdHRyaWJ1dGVzXG5cbiAgICAgICAgICBpZiAodGhpcy5tZWRpYS5oYXNBdHRyaWJ1dGUoJ2Nyb3Nzb3JpZ2luJykpIHtcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLmNyb3Nzb3JpZ2luID0gdHJ1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodGhpcy5tZWRpYS5oYXNBdHRyaWJ1dGUoJ2F1dG9wbGF5JykpIHtcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLmF1dG9wbGF5ID0gdHJ1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodGhpcy5tZWRpYS5oYXNBdHRyaWJ1dGUoJ3BsYXlzaW5saW5lJykgfHwgdGhpcy5tZWRpYS5oYXNBdHRyaWJ1dGUoJ3dlYmtpdC1wbGF5c2lubGluZScpKSB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5wbGF5c2lubGluZSA9IHRydWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHRoaXMubWVkaWEuaGFzQXR0cmlidXRlKCdtdXRlZCcpKSB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5tdXRlZCA9IHRydWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHRoaXMubWVkaWEuaGFzQXR0cmlidXRlKCdsb29wJykpIHtcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRoaXMuZGVidWcuZXJyb3IoJ1NldHVwIGZhaWxlZDogdW5zdXBwb3J0ZWQgdHlwZScpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gQ2hlY2sgZm9yIHN1cHBvcnQgYWdhaW4gYnV0IHdpdGggdHlwZVxuXG5cbiAgICAgIHRoaXMuc3VwcG9ydGVkID0gc3VwcG9ydC5jaGVjayh0aGlzLnR5cGUsIHRoaXMucHJvdmlkZXIsIHRoaXMuY29uZmlnLnBsYXlzaW5saW5lKTsgLy8gSWYgbm8gc3VwcG9ydCBmb3IgZXZlbiBBUEksIGJhaWxcblxuICAgICAgaWYgKCF0aGlzLnN1cHBvcnRlZC5hcGkpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy5lcnJvcignU2V0dXAgZmFpbGVkOiBubyBzdXBwb3J0Jyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5ldmVudExpc3RlbmVycyA9IFtdOyAvLyBDcmVhdGUgbGlzdGVuZXJzXG5cbiAgICAgIHRoaXMubGlzdGVuZXJzID0gbmV3IExpc3RlbmVycyh0aGlzKTsgLy8gU2V0dXAgbG9jYWwgc3RvcmFnZSBmb3IgdXNlciBzZXR0aW5nc1xuXG4gICAgICB0aGlzLnN0b3JhZ2UgPSBuZXcgU3RvcmFnZSh0aGlzKTsgLy8gU3RvcmUgcmVmZXJlbmNlXG5cbiAgICAgIHRoaXMubWVkaWEucGx5ciA9IHRoaXM7IC8vIFdyYXAgbWVkaWFcblxuICAgICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuY29udGFpbmVyKSkge1xuICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICB0YWJpbmRleDogMFxuICAgICAgICB9KTtcbiAgICAgICAgd3JhcCh0aGlzLm1lZGlhLCB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lcik7XG4gICAgICB9IC8vIE1pZ3JhdGUgY3VzdG9tIHByb3BlcnRpZXMgZnJvbSBtZWRpYSB0byBjb250YWluZXIgKHNvIHRoZXkgd29yayDwn5iJKVxuXG5cbiAgICAgIHVpLm1pZ3JhdGVTdHlsZXMuY2FsbCh0aGlzKTsgLy8gQWRkIHN0eWxlIGhvb2tcblxuICAgICAgdWkuYWRkU3R5bGVIb29rLmNhbGwodGhpcyk7IC8vIFNldHVwIG1lZGlhXG5cbiAgICAgIG1lZGlhLnNldHVwLmNhbGwodGhpcyk7IC8vIExpc3RlbiBmb3IgZXZlbnRzIGlmIGRlYnVnZ2luZ1xuXG4gICAgICBpZiAodGhpcy5jb25maWcuZGVidWcpIHtcbiAgICAgICAgb24uY2FsbCh0aGlzLCB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuZXZlbnRzLmpvaW4oJyAnKSwgZXZlbnQgPT4ge1xuICAgICAgICAgIHRoaXMuZGVidWcubG9nKGBldmVudDogJHtldmVudC50eXBlfWApO1xuICAgICAgICB9KTtcbiAgICAgIH0gLy8gU2V0dXAgZnVsbHNjcmVlblxuXG5cbiAgICAgIHRoaXMuZnVsbHNjcmVlbiA9IG5ldyBGdWxsc2NyZWVuKHRoaXMpOyAvLyBTZXR1cCBpbnRlcmZhY2VcbiAgICAgIC8vIElmIGVtYmVkIGJ1dCBub3QgZnVsbHkgc3VwcG9ydGVkLCBidWlsZCBpbnRlcmZhY2Ugbm93IHRvIGF2b2lkIGZsYXNoIG9mIGNvbnRyb2xzXG5cbiAgICAgIGlmICh0aGlzLmlzSFRNTDUgfHwgdGhpcy5pc0VtYmVkICYmICF0aGlzLnN1cHBvcnRlZC51aSkge1xuICAgICAgICB1aS5idWlsZC5jYWxsKHRoaXMpO1xuICAgICAgfSAvLyBDb250YWluZXIgbGlzdGVuZXJzXG5cblxuICAgICAgdGhpcy5saXN0ZW5lcnMuY29udGFpbmVyKCk7IC8vIEdsb2JhbCBsaXN0ZW5lcnNcblxuICAgICAgdGhpcy5saXN0ZW5lcnMuZ2xvYmFsKCk7IC8vIFNldHVwIGFkcyBpZiBwcm92aWRlZFxuXG4gICAgICBpZiAodGhpcy5jb25maWcuYWRzLmVuYWJsZWQpIHtcbiAgICAgICAgdGhpcy5hZHMgPSBuZXcgQWRzKHRoaXMpO1xuICAgICAgfSAvLyBBdXRvcGxheSBpZiByZXF1aXJlZFxuXG5cbiAgICAgIGlmICh0aGlzLmlzSFRNTDUgJiYgdGhpcy5jb25maWcuYXV0b3BsYXkpIHtcbiAgICAgICAgdGhpcy5vbmNlKCdjYW5wbGF5JywgKCkgPT4gc2lsZW5jZVByb21pc2UodGhpcy5wbGF5KCkpKTtcbiAgICAgIH0gLy8gU2VlayB0aW1lIHdpbGwgYmUgcmVjb3JkZWQgKGluIGxpc3RlbmVycy5qcykgc28gd2UgY2FuIHByZXZlbnQgaGlkaW5nIGNvbnRyb2xzIGZvciBhIGZldyBzZWNvbmRzIGFmdGVyIHNlZWtcblxuXG4gICAgICB0aGlzLmxhc3RTZWVrVGltZSA9IDA7IC8vIFNldHVwIHByZXZpZXcgdGh1bWJuYWlscyBpZiBlbmFibGVkXG5cbiAgICAgIGlmICh0aGlzLmNvbmZpZy5wcmV2aWV3VGh1bWJuYWlscy5lbmFibGVkKSB7XG4gICAgICAgIHRoaXMucHJldmlld1RodW1ibmFpbHMgPSBuZXcgUHJldmlld1RodW1ibmFpbHModGhpcyk7XG4gICAgICB9XG4gICAgfSAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBBUElcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFR5cGVzIGFuZCBwcm92aWRlciBoZWxwZXJzXG4gICAgICovXG5cblxuICAgIGdldCBpc0hUTUw1KCkge1xuICAgICAgcmV0dXJuIHRoaXMucHJvdmlkZXIgPT09IHByb3ZpZGVycy5odG1sNTtcbiAgICB9XG5cbiAgICBnZXQgaXNFbWJlZCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzWW91VHViZSB8fCB0aGlzLmlzVmltZW87XG4gICAgfVxuXG4gICAgZ2V0IGlzWW91VHViZSgpIHtcbiAgICAgIHJldHVybiB0aGlzLnByb3ZpZGVyID09PSBwcm92aWRlcnMueW91dHViZTtcbiAgICB9XG5cbiAgICBnZXQgaXNWaW1lbygpIHtcbiAgICAgIHJldHVybiB0aGlzLnByb3ZpZGVyID09PSBwcm92aWRlcnMudmltZW87XG4gICAgfVxuXG4gICAgZ2V0IGlzVmlkZW8oKSB7XG4gICAgICByZXR1cm4gdGhpcy50eXBlID09PSB0eXBlcy52aWRlbztcbiAgICB9XG5cbiAgICBnZXQgaXNBdWRpbygpIHtcbiAgICAgIHJldHVybiB0aGlzLnR5cGUgPT09IHR5cGVzLmF1ZGlvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQbGF5IHRoZSBtZWRpYSwgb3IgcGxheSB0aGUgYWR2ZXJ0aXNlbWVudCAoaWYgdGhleSBhcmUgbm90IGJsb2NrZWQpXG4gICAgICovXG5cblxuICAgIC8qKlxuICAgICAqIEdldCBwbGF5aW5nIHN0YXRlXG4gICAgICovXG4gICAgZ2V0IHBsYXlpbmcoKSB7XG4gICAgICByZXR1cm4gQm9vbGVhbih0aGlzLnJlYWR5ICYmICF0aGlzLnBhdXNlZCAmJiAhdGhpcy5lbmRlZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBwYXVzZWQgc3RhdGVcbiAgICAgKi9cblxuXG4gICAgZ2V0IHBhdXNlZCgpIHtcbiAgICAgIHJldHVybiBCb29sZWFuKHRoaXMubWVkaWEucGF1c2VkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHN0b3BwZWQgc3RhdGVcbiAgICAgKi9cblxuXG4gICAgZ2V0IHN0b3BwZWQoKSB7XG4gICAgICByZXR1cm4gQm9vbGVhbih0aGlzLnBhdXNlZCAmJiB0aGlzLmN1cnJlbnRUaW1lID09PSAwKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGVuZGVkIHN0YXRlXG4gICAgICovXG5cblxuICAgIGdldCBlbmRlZCgpIHtcbiAgICAgIHJldHVybiBCb29sZWFuKHRoaXMubWVkaWEuZW5kZWQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUb2dnbGUgcGxheWJhY2sgYmFzZWQgb24gY3VycmVudCBzdGF0dXNcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlucHV0XG4gICAgICovXG5cblxuICAgIC8qKlxuICAgICAqIFNlZWsgdG8gYSB0aW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGlucHV0IC0gd2hlcmUgdG8gc2VlayB0byBpbiBzZWNvbmRzLiBEZWZhdWx0cyB0byAwICh0aGUgc3RhcnQpXG4gICAgICovXG4gICAgc2V0IGN1cnJlbnRUaW1lKGlucHV0KSB7XG4gICAgICAvLyBCYWlsIGlmIG1lZGlhIGR1cmF0aW9uIGlzbid0IGF2YWlsYWJsZSB5ZXRcbiAgICAgIGlmICghdGhpcy5kdXJhdGlvbikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIFZhbGlkYXRlIGlucHV0XG5cblxuICAgICAgY29uc3QgaW5wdXRJc1ZhbGlkID0gaXMubnVtYmVyKGlucHV0KSAmJiBpbnB1dCA+IDA7IC8vIFNldFxuXG4gICAgICB0aGlzLm1lZGlhLmN1cnJlbnRUaW1lID0gaW5wdXRJc1ZhbGlkID8gTWF0aC5taW4oaW5wdXQsIHRoaXMuZHVyYXRpb24pIDogMDsgLy8gTG9nZ2luZ1xuXG4gICAgICB0aGlzLmRlYnVnLmxvZyhgU2Vla2luZyB0byAke3RoaXMuY3VycmVudFRpbWV9IHNlY29uZHNgKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGN1cnJlbnQgdGltZVxuICAgICAqL1xuXG5cbiAgICBnZXQgY3VycmVudFRpbWUoKSB7XG4gICAgICByZXR1cm4gTnVtYmVyKHRoaXMubWVkaWEuY3VycmVudFRpbWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgYnVmZmVyZWRcbiAgICAgKi9cblxuXG4gICAgZ2V0IGJ1ZmZlcmVkKCkge1xuICAgICAgY29uc3Qge1xuICAgICAgICBidWZmZXJlZFxuICAgICAgfSA9IHRoaXMubWVkaWE7IC8vIFlvdVR1YmUgLyBWaW1lbyByZXR1cm4gYSBmbG9hdCBiZXR3ZWVuIDAtMVxuXG4gICAgICBpZiAoaXMubnVtYmVyKGJ1ZmZlcmVkKSkge1xuICAgICAgICByZXR1cm4gYnVmZmVyZWQ7XG4gICAgICB9IC8vIEhUTUw1XG4gICAgICAvLyBUT0RPOiBIYW5kbGUgYnVmZmVyZWQgY2h1bmtzIG9mIHRoZSBtZWRpYVxuICAgICAgLy8gKGkuZS4gc2VlayB0byBhbm90aGVyIHNlY3Rpb24gYnVmZmVycyBvbmx5IHRoYXQgc2VjdGlvbilcblxuXG4gICAgICBpZiAoYnVmZmVyZWQgJiYgYnVmZmVyZWQubGVuZ3RoICYmIHRoaXMuZHVyYXRpb24gPiAwKSB7XG4gICAgICAgIHJldHVybiBidWZmZXJlZC5lbmQoMCkgLyB0aGlzLmR1cmF0aW9uO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHNlZWtpbmcgc3RhdHVzXG4gICAgICovXG5cblxuICAgIGdldCBzZWVraW5nKCkge1xuICAgICAgcmV0dXJuIEJvb2xlYW4odGhpcy5tZWRpYS5zZWVraW5nKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBkdXJhdGlvbiBvZiB0aGUgY3VycmVudCBtZWRpYVxuICAgICAqL1xuXG5cbiAgICBnZXQgZHVyYXRpb24oKSB7XG4gICAgICAvLyBGYXV4IGR1cmF0aW9uIHNldCB2aWEgY29uZmlnXG4gICAgICBjb25zdCBmYXV4RHVyYXRpb24gPSBwYXJzZUZsb2F0KHRoaXMuY29uZmlnLmR1cmF0aW9uKTsgLy8gTWVkaWEgZHVyYXRpb24gY2FuIGJlIE5hTiBvciBJbmZpbml0eSBiZWZvcmUgdGhlIG1lZGlhIGhhcyBsb2FkZWRcblxuICAgICAgY29uc3QgcmVhbER1cmF0aW9uID0gKHRoaXMubWVkaWEgfHwge30pLmR1cmF0aW9uO1xuICAgICAgY29uc3QgZHVyYXRpb24gPSAhaXMubnVtYmVyKHJlYWxEdXJhdGlvbikgfHwgcmVhbER1cmF0aW9uID09PSBJbmZpbml0eSA/IDAgOiByZWFsRHVyYXRpb247IC8vIElmIGNvbmZpZyBkdXJhdGlvbiBpcyBmdW5reSwgdXNlIHJlZ3VsYXIgZHVyYXRpb25cblxuICAgICAgcmV0dXJuIGZhdXhEdXJhdGlvbiB8fCBkdXJhdGlvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBwbGF5ZXIgdm9sdW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHZhbHVlIC0gbXVzdCBiZSBiZXR3ZWVuIDAgYW5kIDEuIERlZmF1bHRzIHRvIHRoZSB2YWx1ZSBmcm9tIGxvY2FsIHN0b3JhZ2UgYW5kIGNvbmZpZy52b2x1bWUgaWYgbm90IHNldCBpbiBzdG9yYWdlXG4gICAgICovXG5cblxuICAgIHNldCB2b2x1bWUodmFsdWUpIHtcbiAgICAgIGxldCB2b2x1bWUgPSB2YWx1ZTtcbiAgICAgIGNvbnN0IG1heCA9IDE7XG4gICAgICBjb25zdCBtaW4gPSAwO1xuXG4gICAgICBpZiAoaXMuc3RyaW5nKHZvbHVtZSkpIHtcbiAgICAgICAgdm9sdW1lID0gTnVtYmVyKHZvbHVtZSk7XG4gICAgICB9IC8vIExvYWQgdm9sdW1lIGZyb20gc3RvcmFnZSBpZiBubyB2YWx1ZSBzcGVjaWZpZWRcblxuXG4gICAgICBpZiAoIWlzLm51bWJlcih2b2x1bWUpKSB7XG4gICAgICAgIHZvbHVtZSA9IHRoaXMuc3RvcmFnZS5nZXQoJ3ZvbHVtZScpO1xuICAgICAgfSAvLyBVc2UgY29uZmlnIGlmIGFsbCBlbHNlIGZhaWxzXG5cblxuICAgICAgaWYgKCFpcy5udW1iZXIodm9sdW1lKSkge1xuICAgICAgICAoe1xuICAgICAgICAgIHZvbHVtZVxuICAgICAgICB9ID0gdGhpcy5jb25maWcpO1xuICAgICAgfSAvLyBNYXhpbXVtIGlzIHZvbHVtZU1heFxuXG5cbiAgICAgIGlmICh2b2x1bWUgPiBtYXgpIHtcbiAgICAgICAgdm9sdW1lID0gbWF4O1xuICAgICAgfSAvLyBNaW5pbXVtIGlzIHZvbHVtZU1pblxuXG5cbiAgICAgIGlmICh2b2x1bWUgPCBtaW4pIHtcbiAgICAgICAgdm9sdW1lID0gbWluO1xuICAgICAgfSAvLyBVcGRhdGUgY29uZmlnXG5cblxuICAgICAgdGhpcy5jb25maWcudm9sdW1lID0gdm9sdW1lOyAvLyBTZXQgdGhlIHBsYXllciB2b2x1bWVcblxuICAgICAgdGhpcy5tZWRpYS52b2x1bWUgPSB2b2x1bWU7IC8vIElmIG11dGVkLCBhbmQgd2UncmUgaW5jcmVhc2luZyB2b2x1bWUgbWFudWFsbHksIHJlc2V0IG11dGVkIHN0YXRlXG5cbiAgICAgIGlmICghaXMuZW1wdHkodmFsdWUpICYmIHRoaXMubXV0ZWQgJiYgdm9sdW1lID4gMCkge1xuICAgICAgICB0aGlzLm11dGVkID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudCBwbGF5ZXIgdm9sdW1lXG4gICAgICovXG5cblxuICAgIGdldCB2b2x1bWUoKSB7XG4gICAgICByZXR1cm4gTnVtYmVyKHRoaXMubWVkaWEudm9sdW1lKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5jcmVhc2Ugdm9sdW1lXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBzdGVwIC0gSG93IG11Y2ggdG8gZGVjcmVhc2UgYnkgKGJldHdlZW4gMCBhbmQgMSlcbiAgICAgKi9cblxuXG4gICAgLyoqXG4gICAgICogU2V0IG11dGVkIHN0YXRlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBtdXRlXG4gICAgICovXG4gICAgc2V0IG11dGVkKG11dGUpIHtcbiAgICAgIGxldCB0b2dnbGUgPSBtdXRlOyAvLyBMb2FkIG11dGVkIHN0YXRlIGZyb20gc3RvcmFnZVxuXG4gICAgICBpZiAoIWlzLmJvb2xlYW4odG9nZ2xlKSkge1xuICAgICAgICB0b2dnbGUgPSB0aGlzLnN0b3JhZ2UuZ2V0KCdtdXRlZCcpO1xuICAgICAgfSAvLyBVc2UgY29uZmlnIGlmIGFsbCBlbHNlIGZhaWxzXG5cblxuICAgICAgaWYgKCFpcy5ib29sZWFuKHRvZ2dsZSkpIHtcbiAgICAgICAgdG9nZ2xlID0gdGhpcy5jb25maWcubXV0ZWQ7XG4gICAgICB9IC8vIFVwZGF0ZSBjb25maWdcblxuXG4gICAgICB0aGlzLmNvbmZpZy5tdXRlZCA9IHRvZ2dsZTsgLy8gU2V0IG11dGUgb24gdGhlIHBsYXllclxuXG4gICAgICB0aGlzLm1lZGlhLm11dGVkID0gdG9nZ2xlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgY3VycmVudCBtdXRlZCBzdGF0ZVxuICAgICAqL1xuXG5cbiAgICBnZXQgbXV0ZWQoKSB7XG4gICAgICByZXR1cm4gQm9vbGVhbih0aGlzLm1lZGlhLm11dGVkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgdGhlIG1lZGlhIGhhcyBhdWRpb1xuICAgICAqL1xuXG5cbiAgICBnZXQgaGFzQXVkaW8oKSB7XG4gICAgICAvLyBBc3N1bWUgeWVzIGZvciBhbGwgbm9uIEhUTUw1IChhcyB3ZSBjYW4ndCB0ZWxsLi4uKVxuICAgICAgaWYgKCF0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmlzQXVkaW8pIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IC8vIEdldCBhdWRpbyB0cmFja3NcblxuXG4gICAgICByZXR1cm4gQm9vbGVhbih0aGlzLm1lZGlhLm1vekhhc0F1ZGlvKSB8fCBCb29sZWFuKHRoaXMubWVkaWEud2Via2l0QXVkaW9EZWNvZGVkQnl0ZUNvdW50KSB8fCBCb29sZWFuKHRoaXMubWVkaWEuYXVkaW9UcmFja3MgJiYgdGhpcy5tZWRpYS5hdWRpb1RyYWNrcy5sZW5ndGgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgcGxheWJhY2sgc3BlZWRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gaW5wdXQgLSB0aGUgc3BlZWQgb2YgcGxheWJhY2sgKDAuNS0yLjApXG4gICAgICovXG5cblxuICAgIHNldCBzcGVlZChpbnB1dCkge1xuICAgICAgbGV0IHNwZWVkID0gbnVsbDtcblxuICAgICAgaWYgKGlzLm51bWJlcihpbnB1dCkpIHtcbiAgICAgICAgc3BlZWQgPSBpbnB1dDtcbiAgICAgIH1cblxuICAgICAgaWYgKCFpcy5udW1iZXIoc3BlZWQpKSB7XG4gICAgICAgIHNwZWVkID0gdGhpcy5zdG9yYWdlLmdldCgnc3BlZWQnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFpcy5udW1iZXIoc3BlZWQpKSB7XG4gICAgICAgIHNwZWVkID0gdGhpcy5jb25maWcuc3BlZWQuc2VsZWN0ZWQ7XG4gICAgICB9IC8vIENsYW1wIHRvIG1pbi9tYXhcblxuXG4gICAgICBjb25zdCB7XG4gICAgICAgIG1pbmltdW1TcGVlZDogbWluLFxuICAgICAgICBtYXhpbXVtU3BlZWQ6IG1heFxuICAgICAgfSA9IHRoaXM7XG4gICAgICBzcGVlZCA9IGNsYW1wKHNwZWVkLCBtaW4sIG1heCk7IC8vIFVwZGF0ZSBjb25maWdcblxuICAgICAgdGhpcy5jb25maWcuc3BlZWQuc2VsZWN0ZWQgPSBzcGVlZDsgLy8gU2V0IG1lZGlhIHNwZWVkXG5cbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5tZWRpYSkge1xuICAgICAgICAgIHRoaXMubWVkaWEucGxheWJhY2tSYXRlID0gc3BlZWQ7XG4gICAgICAgIH1cbiAgICAgIH0sIDApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgY3VycmVudCBwbGF5YmFjayBzcGVlZFxuICAgICAqL1xuXG5cbiAgICBnZXQgc3BlZWQoKSB7XG4gICAgICByZXR1cm4gTnVtYmVyKHRoaXMubWVkaWEucGxheWJhY2tSYXRlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBtaW5pbXVtIGFsbG93ZWQgc3BlZWRcbiAgICAgKi9cblxuXG4gICAgZ2V0IG1pbmltdW1TcGVlZCgpIHtcbiAgICAgIGlmICh0aGlzLmlzWW91VHViZSkge1xuICAgICAgICAvLyBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS95b3V0dWJlL2lmcmFtZV9hcGlfcmVmZXJlbmNlI3NldFBsYXliYWNrUmF0ZVxuICAgICAgICByZXR1cm4gTWF0aC5taW4oLi4udGhpcy5vcHRpb25zLnNwZWVkKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuaXNWaW1lbykge1xuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vdmltZW8vcGxheWVyLmpzLyNzZXRwbGF5YmFja3JhdGVwbGF5YmFja3JhdGUtbnVtYmVyLXByb21pc2VudW1iZXItcmFuZ2VlcnJvcmVycm9yXG4gICAgICAgIHJldHVybiAwLjU7XG4gICAgICB9IC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8zMjMyMDAyMC8xMTkxMzE5XG5cblxuICAgICAgcmV0dXJuIDAuMDYyNTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBtYXhpbXVtIGFsbG93ZWQgc3BlZWRcbiAgICAgKi9cblxuXG4gICAgZ2V0IG1heGltdW1TcGVlZCgpIHtcbiAgICAgIGlmICh0aGlzLmlzWW91VHViZSkge1xuICAgICAgICAvLyBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS95b3V0dWJlL2lmcmFtZV9hcGlfcmVmZXJlbmNlI3NldFBsYXliYWNrUmF0ZVxuICAgICAgICByZXR1cm4gTWF0aC5tYXgoLi4udGhpcy5vcHRpb25zLnNwZWVkKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuaXNWaW1lbykge1xuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vdmltZW8vcGxheWVyLmpzLyNzZXRwbGF5YmFja3JhdGVwbGF5YmFja3JhdGUtbnVtYmVyLXByb21pc2VudW1iZXItcmFuZ2VlcnJvcmVycm9yXG4gICAgICAgIHJldHVybiAyO1xuICAgICAgfSAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMzIzMjAwMjAvMTE5MTMxOVxuXG5cbiAgICAgIHJldHVybiAxNjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IHBsYXliYWNrIHF1YWxpdHlcbiAgICAgKiBDdXJyZW50bHkgSFRNTDUgJiBZb3VUdWJlIG9ubHlcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gaW5wdXQgLSBRdWFsaXR5IGxldmVsXG4gICAgICovXG5cblxuICAgIHNldCBxdWFsaXR5KGlucHV0KSB7XG4gICAgICBjb25zdCBjb25maWcgPSB0aGlzLmNvbmZpZy5xdWFsaXR5O1xuICAgICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMub3B0aW9ucy5xdWFsaXR5O1xuXG4gICAgICBpZiAoIW9wdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbGV0IHF1YWxpdHkgPSBbIWlzLmVtcHR5KGlucHV0KSAmJiBOdW1iZXIoaW5wdXQpLCB0aGlzLnN0b3JhZ2UuZ2V0KCdxdWFsaXR5JyksIGNvbmZpZy5zZWxlY3RlZCwgY29uZmlnLmRlZmF1bHRdLmZpbmQoaXMubnVtYmVyKTtcbiAgICAgIGxldCB1cGRhdGVTdG9yYWdlID0gdHJ1ZTtcblxuICAgICAgaWYgKCFvcHRpb25zLmluY2x1ZGVzKHF1YWxpdHkpKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gY2xvc2VzdChvcHRpb25zLCBxdWFsaXR5KTtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKGBVbnN1cHBvcnRlZCBxdWFsaXR5IG9wdGlvbjogJHtxdWFsaXR5fSwgdXNpbmcgJHt2YWx1ZX0gaW5zdGVhZGApO1xuICAgICAgICBxdWFsaXR5ID0gdmFsdWU7IC8vIERvbid0IHVwZGF0ZSBzdG9yYWdlIGlmIHF1YWxpdHkgaXMgbm90IHN1cHBvcnRlZFxuXG4gICAgICAgIHVwZGF0ZVN0b3JhZ2UgPSBmYWxzZTtcbiAgICAgIH0gLy8gVXBkYXRlIGNvbmZpZ1xuXG5cbiAgICAgIGNvbmZpZy5zZWxlY3RlZCA9IHF1YWxpdHk7IC8vIFNldCBxdWFsaXR5XG5cbiAgICAgIHRoaXMubWVkaWEucXVhbGl0eSA9IHF1YWxpdHk7IC8vIFNhdmUgdG8gc3RvcmFnZVxuXG4gICAgICBpZiAodXBkYXRlU3RvcmFnZSkge1xuICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0KHtcbiAgICAgICAgICBxdWFsaXR5XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgY3VycmVudCBxdWFsaXR5IGxldmVsXG4gICAgICovXG5cblxuICAgIGdldCBxdWFsaXR5KCkge1xuICAgICAgcmV0dXJuIHRoaXMubWVkaWEucXVhbGl0eTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVG9nZ2xlIGxvb3BcbiAgICAgKiBUT0RPOiBGaW5pc2ggZmFuY3kgbmV3IGxvZ2ljLiBTZXQgdGhlIGluZGljYXRvciBvbiBsb2FkIGFzIHVzZXIgbWF5IHBhc3MgbG9vcCBhcyBjb25maWdcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlucHV0IC0gV2hldGhlciB0byBsb29wIG9yIG5vdFxuICAgICAqL1xuXG5cbiAgICBzZXQgbG9vcChpbnB1dCkge1xuICAgICAgY29uc3QgdG9nZ2xlID0gaXMuYm9vbGVhbihpbnB1dCkgPyBpbnB1dCA6IHRoaXMuY29uZmlnLmxvb3AuYWN0aXZlO1xuICAgICAgdGhpcy5jb25maWcubG9vcC5hY3RpdmUgPSB0b2dnbGU7XG4gICAgICB0aGlzLm1lZGlhLmxvb3AgPSB0b2dnbGU7IC8vIFNldCBkZWZhdWx0IHRvIGJlIGEgdHJ1ZSB0b2dnbGVcblxuICAgICAgLyogY29uc3QgdHlwZSA9IFsnc3RhcnQnLCAnZW5kJywgJ2FsbCcsICdub25lJywgJ3RvZ2dsZSddLmluY2x1ZGVzKGlucHV0KSA/IGlucHV0IDogJ3RvZ2dsZSc7XG4gICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgICBjYXNlICdzdGFydCc6XG4gICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb25maWcubG9vcC5lbmQgJiYgdGhpcy5jb25maWcubG9vcC5lbmQgPD0gdGhpcy5jdXJyZW50VGltZSkge1xuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuZW5kID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3Auc3RhcnQgPSB0aGlzLmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgICAgICAgLy8gdGhpcy5jb25maWcubG9vcC5pbmRpY2F0b3Iuc3RhcnQgPSB0aGlzLmVsZW1lbnRzLmRpc3BsYXkucGxheWVkLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmxvb3Auc3RhcnQgPj0gdGhpcy5jdXJyZW50VGltZSkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5lbmQgPSB0aGlzLmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgICAgICAgLy8gdGhpcy5jb25maWcubG9vcC5pbmRpY2F0b3IuZW5kID0gdGhpcy5lbGVtZW50cy5kaXNwbGF5LnBsYXllZC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgY2FzZSAnYWxsJzpcbiAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3Auc3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5lbmQgPSB0aGlzLmR1cmF0aW9uIC0gMjtcbiAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuaW5kaWNhdG9yLnN0YXJ0ID0gMDtcbiAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuaW5kaWNhdG9yLmVuZCA9IDEwMDtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgY2FzZSAndG9nZ2xlJzpcbiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5sb29wLmFjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3Auc3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuZW5kID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5zdGFydCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5lbmQgPSB0aGlzLmR1cmF0aW9uIC0gMjtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3Auc3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5lbmQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfSAqL1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgY3VycmVudCBsb29wIHN0YXRlXG4gICAgICovXG5cblxuICAgIGdldCBsb29wKCkge1xuICAgICAgcmV0dXJuIEJvb2xlYW4odGhpcy5tZWRpYS5sb29wKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IG5ldyBtZWRpYSBzb3VyY2VcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gaW5wdXQgLSBUaGUgbmV3IHNvdXJjZSBvYmplY3QgKHNlZSBkb2NzKVxuICAgICAqL1xuXG5cbiAgICBzZXQgc291cmNlKGlucHV0KSB7XG4gICAgICBzb3VyY2UuY2hhbmdlLmNhbGwodGhpcywgaW5wdXQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgY3VycmVudCBzb3VyY2VcbiAgICAgKi9cblxuXG4gICAgZ2V0IHNvdXJjZSgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1lZGlhLmN1cnJlbnRTcmM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBhIGRvd25sb2FkIFVSTCAoZWl0aGVyIHNvdXJjZSBvciBjdXN0b20pXG4gICAgICovXG5cblxuICAgIGdldCBkb3dubG9hZCgpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZG93bmxvYWRcbiAgICAgIH0gPSB0aGlzLmNvbmZpZy51cmxzO1xuICAgICAgcmV0dXJuIGlzLnVybChkb3dubG9hZCkgPyBkb3dubG9hZCA6IHRoaXMuc291cmNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGRvd25sb2FkIFVSTFxuICAgICAqL1xuXG5cbiAgICBzZXQgZG93bmxvYWQoaW5wdXQpIHtcbiAgICAgIGlmICghaXMudXJsKGlucHV0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY29uZmlnLnVybHMuZG93bmxvYWQgPSBpbnB1dDtcbiAgICAgIGNvbnRyb2xzLnNldERvd25sb2FkVXJsLmNhbGwodGhpcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgcG9zdGVyIGltYWdlIGZvciBhIHZpZGVvXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IC0gdGhlIFVSTCBmb3IgdGhlIG5ldyBwb3N0ZXIgaW1hZ2VcbiAgICAgKi9cblxuXG4gICAgc2V0IHBvc3RlcihpbnB1dCkge1xuICAgICAgaWYgKCF0aGlzLmlzVmlkZW8pIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdQb3N0ZXIgY2FuIG9ubHkgYmUgc2V0IGZvciB2aWRlbycpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHVpLnNldFBvc3Rlci5jYWxsKHRoaXMsIGlucHV0LCBmYWxzZSkuY2F0Y2goKCkgPT4ge30pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgcG9zdGVyIGltYWdlXG4gICAgICovXG5cblxuICAgIGdldCBwb3N0ZXIoKSB7XG4gICAgICBpZiAoIXRoaXMuaXNWaWRlbykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMubWVkaWEuZ2V0QXR0cmlidXRlKCdwb3N0ZXInKSB8fCB0aGlzLm1lZGlhLmdldEF0dHJpYnV0ZSgnZGF0YS1wb3N0ZXInKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50IGFzcGVjdCByYXRpbyBpbiB1c2VcbiAgICAgKi9cblxuXG4gICAgZ2V0IHJhdGlvKCkge1xuICAgICAgaWYgKCF0aGlzLmlzVmlkZW8pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJhdGlvID0gcmVkdWNlQXNwZWN0UmF0aW8oZ2V0QXNwZWN0UmF0aW8uY2FsbCh0aGlzKSk7XG4gICAgICByZXR1cm4gaXMuYXJyYXkocmF0aW8pID8gcmF0aW8uam9pbignOicpIDogcmF0aW87XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB2aWRlbyBhc3BlY3QgcmF0aW9cbiAgICAgKi9cblxuXG4gICAgc2V0IHJhdGlvKGlucHV0KSB7XG4gICAgICBpZiAoIXRoaXMuaXNWaWRlbykge1xuICAgICAgICB0aGlzLmRlYnVnLndhcm4oJ0FzcGVjdCByYXRpbyBjYW4gb25seSBiZSBzZXQgZm9yIHZpZGVvJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKCFpcy5zdHJpbmcoaW5wdXQpIHx8ICF2YWxpZGF0ZUFzcGVjdFJhdGlvKGlucHV0KSkge1xuICAgICAgICB0aGlzLmRlYnVnLmVycm9yKGBJbnZhbGlkIGFzcGVjdCByYXRpbyBzcGVjaWZpZWQgKCR7aW5wdXR9KWApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY29uZmlnLnJhdGlvID0gcmVkdWNlQXNwZWN0UmF0aW8oaW5wdXQpO1xuICAgICAgc2V0QXNwZWN0UmF0aW8uY2FsbCh0aGlzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBhdXRvcGxheSBzdGF0ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gaW5wdXQgLSBXaGV0aGVyIHRvIGF1dG9wbGF5IG9yIG5vdFxuICAgICAqL1xuXG5cbiAgICBzZXQgYXV0b3BsYXkoaW5wdXQpIHtcbiAgICAgIHRoaXMuY29uZmlnLmF1dG9wbGF5ID0gaXMuYm9vbGVhbihpbnB1dCkgPyBpbnB1dCA6IHRoaXMuY29uZmlnLmF1dG9wbGF5O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgYXV0b3BsYXkgc3RhdGVcbiAgICAgKi9cblxuXG4gICAgZ2V0IGF1dG9wbGF5KCkge1xuICAgICAgcmV0dXJuIEJvb2xlYW4odGhpcy5jb25maWcuYXV0b3BsYXkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUb2dnbGUgY2FwdGlvbnNcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlucHV0IC0gV2hldGhlciB0byBlbmFibGUgY2FwdGlvbnNcbiAgICAgKi9cblxuXG4gICAgdG9nZ2xlQ2FwdGlvbnMoaW5wdXQpIHtcbiAgICAgIGNhcHRpb25zLnRvZ2dsZS5jYWxsKHRoaXMsIGlucHV0LCBmYWxzZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgY2FwdGlvbiB0cmFjayBieSBpbmRleFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbnB1dCAtIENhcHRpb24gaW5kZXhcbiAgICAgKi9cblxuXG4gICAgc2V0IGN1cnJlbnRUcmFjayhpbnB1dCkge1xuICAgICAgY2FwdGlvbnMuc2V0LmNhbGwodGhpcywgaW5wdXQsIGZhbHNlKTtcbiAgICAgIGNhcHRpb25zLnNldHVwLmNhbGwodGhpcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudCBjYXB0aW9uIHRyYWNrIGluZGV4ICgtMSBpZiBkaXNhYmxlZClcbiAgICAgKi9cblxuXG4gICAgZ2V0IGN1cnJlbnRUcmFjaygpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdG9nZ2xlZCxcbiAgICAgICAgY3VycmVudFRyYWNrXG4gICAgICB9ID0gdGhpcy5jYXB0aW9ucztcbiAgICAgIHJldHVybiB0b2dnbGVkID8gY3VycmVudFRyYWNrIDogLTE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgd2FudGVkIGxhbmd1YWdlIGZvciBjYXB0aW9uc1xuICAgICAqIFNpbmNlIHRyYWNrcyBjYW4gYmUgYWRkZWQgbGF0ZXIgaXQgd29uJ3QgdXBkYXRlIHRoZSBhY3R1YWwgY2FwdGlvbiB0cmFjayB1bnRpbCB0aGVyZSBpcyBhIG1hdGNoaW5nIHRyYWNrXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IC0gVHdvIGNoYXJhY3RlciBJU08gbGFuZ3VhZ2UgY29kZSAoZS5nLiBFTiwgRlIsIFBULCBldGMpXG4gICAgICovXG5cblxuICAgIHNldCBsYW5ndWFnZShpbnB1dCkge1xuICAgICAgY2FwdGlvbnMuc2V0TGFuZ3VhZ2UuY2FsbCh0aGlzLCBpbnB1dCwgZmFsc2UpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgdHJhY2sncyBsYW5ndWFnZVxuICAgICAqL1xuXG5cbiAgICBnZXQgbGFuZ3VhZ2UoKSB7XG4gICAgICByZXR1cm4gKGNhcHRpb25zLmdldEN1cnJlbnRUcmFjay5jYWxsKHRoaXMpIHx8IHt9KS5sYW5ndWFnZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVG9nZ2xlIHBpY3R1cmUtaW4tcGljdHVyZSBwbGF5YmFjayBvbiBXZWJLaXQvTWFjT1NcbiAgICAgKiBUT0RPOiB1cGRhdGUgcGxheWVyIHdpdGggc3RhdGUsIHN1cHBvcnQsIGVuYWJsZWRcbiAgICAgKiBUT0RPOiBkZXRlY3Qgb3V0c2lkZSBjaGFuZ2VzXG4gICAgICovXG5cblxuICAgIHNldCBwaXAoaW5wdXQpIHtcbiAgICAgIC8vIEJhaWwgaWYgbm8gc3VwcG9ydFxuICAgICAgaWYgKCFzdXBwb3J0LnBpcCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIFRvZ2dsZSBiYXNlZCBvbiBjdXJyZW50IHN0YXRlIGlmIG5vdCBwYXNzZWRcblxuXG4gICAgICBjb25zdCB0b2dnbGUgPSBpcy5ib29sZWFuKGlucHV0KSA/IGlucHV0IDogIXRoaXMucGlwOyAvLyBUb2dnbGUgYmFzZWQgb24gY3VycmVudCBzdGF0ZVxuICAgICAgLy8gU2FmYXJpXG5cbiAgICAgIGlmIChpcy5mdW5jdGlvbih0aGlzLm1lZGlhLndlYmtpdFNldFByZXNlbnRhdGlvbk1vZGUpKSB7XG4gICAgICAgIHRoaXMubWVkaWEud2Via2l0U2V0UHJlc2VudGF0aW9uTW9kZSh0b2dnbGUgPyBwaXAuYWN0aXZlIDogcGlwLmluYWN0aXZlKTtcbiAgICAgIH0gLy8gQ2hyb21lXG5cblxuICAgICAgaWYgKGlzLmZ1bmN0aW9uKHRoaXMubWVkaWEucmVxdWVzdFBpY3R1cmVJblBpY3R1cmUpKSB7XG4gICAgICAgIGlmICghdGhpcy5waXAgJiYgdG9nZ2xlKSB7XG4gICAgICAgICAgdGhpcy5tZWRpYS5yZXF1ZXN0UGljdHVyZUluUGljdHVyZSgpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMucGlwICYmICF0b2dnbGUpIHtcbiAgICAgICAgICBkb2N1bWVudC5leGl0UGljdHVyZUluUGljdHVyZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudCBwaWN0dXJlLWluLXBpY3R1cmUgc3RhdGVcbiAgICAgKi9cblxuXG4gICAgZ2V0IHBpcCgpIHtcbiAgICAgIGlmICghc3VwcG9ydC5waXApIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9IC8vIFNhZmFyaVxuXG5cbiAgICAgIGlmICghaXMuZW1wdHkodGhpcy5tZWRpYS53ZWJraXRQcmVzZW50YXRpb25Nb2RlKSkge1xuICAgICAgICByZXR1cm4gdGhpcy5tZWRpYS53ZWJraXRQcmVzZW50YXRpb25Nb2RlID09PSBwaXAuYWN0aXZlO1xuICAgICAgfSAvLyBDaHJvbWVcblxuXG4gICAgICByZXR1cm4gdGhpcy5tZWRpYSA9PT0gZG9jdW1lbnQucGljdHVyZUluUGljdHVyZUVsZW1lbnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHByZXZpZXcgdGh1Ym1uYWlscyBmb3IgdGhlIGN1cnJlbnQgc291cmNlXG4gICAgICovXG5cblxuICAgIHNldFByZXZpZXdUaHVtYm5haWxzKHRodW1ibmFpbFNvdXJjZSkge1xuICAgICAgaWYgKHRoaXMucHJldmlld1RodW1ibmFpbHMgJiYgdGhpcy5wcmV2aWV3VGh1bWJuYWlscy5sb2FkZWQpIHtcbiAgICAgICAgdGhpcy5wcmV2aWV3VGh1bWJuYWlscy5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMucHJldmlld1RodW1ibmFpbHMgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICBPYmplY3QuYXNzaWduKHRoaXMuY29uZmlnLnByZXZpZXdUaHVtYm5haWxzLCB0aHVtYm5haWxTb3VyY2UpOyAvLyBDcmVhdGUgbmV3IGluc3RhbmNlIGlmIGl0IGlzIHN0aWxsIGVuYWJsZWRcblxuICAgICAgaWYgKHRoaXMuY29uZmlnLnByZXZpZXdUaHVtYm5haWxzLmVuYWJsZWQpIHtcbiAgICAgICAgdGhpcy5wcmV2aWV3VGh1bWJuYWlscyA9IG5ldyBQcmV2aWV3VGh1bWJuYWlscyh0aGlzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogVHJpZ2dlciB0aGUgYWlycGxheSBkaWFsb2dcbiAgICAgKiBUT0RPOiB1cGRhdGUgcGxheWVyIHdpdGggc3RhdGUsIHN1cHBvcnQsIGVuYWJsZWRcbiAgICAgKi9cblxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgZm9yIHN1cHBvcnRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdHlwZSAtIFBsYXllciB0eXBlIChhdWRpby92aWRlbylcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvdmlkZXIgLSBQcm92aWRlciAoaHRtbDUveW91dHViZS92aW1lbylcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlubGluZSAtIFdoZXJlIHBsYXllciBoYXMgYHBsYXlzaW5saW5lYCBzdHRyaWJ1dGVcbiAgICAgKi9cbiAgICBzdGF0aWMgc3VwcG9ydGVkKHR5cGUsIHByb3ZpZGVyLCBpbmxpbmUpIHtcbiAgICAgIHJldHVybiBzdXBwb3J0LmNoZWNrKHR5cGUsIHByb3ZpZGVyLCBpbmxpbmUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb2FkIGFuIFNWRyBzcHJpdGUgaW50byB0aGUgcGFnZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgLSBVUkwgZm9yIHRoZSBTVkcgc3ByaXRlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtpZF0gLSBVbmlxdWUgSURcbiAgICAgKi9cblxuXG4gICAgc3RhdGljIGxvYWRTcHJpdGUodXJsLCBpZCkge1xuICAgICAgcmV0dXJuIGxvYWRTcHJpdGUodXJsLCBpZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHVwIG11bHRpcGxlIGluc3RhbmNlc1xuICAgICAqIEBwYXJhbSB7Kn0gc2VsZWN0b3JcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuICAgICAqL1xuXG5cbiAgICBzdGF0aWMgc2V0dXAoc2VsZWN0b3IsIG9wdGlvbnMgPSB7fSkge1xuICAgICAgbGV0IHRhcmdldHMgPSBudWxsO1xuXG4gICAgICBpZiAoaXMuc3RyaW5nKHNlbGVjdG9yKSkge1xuICAgICAgICB0YXJnZXRzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSk7XG4gICAgICB9IGVsc2UgaWYgKGlzLm5vZGVMaXN0KHNlbGVjdG9yKSkge1xuICAgICAgICB0YXJnZXRzID0gQXJyYXkuZnJvbShzZWxlY3Rvcik7XG4gICAgICB9IGVsc2UgaWYgKGlzLmFycmF5KHNlbGVjdG9yKSkge1xuICAgICAgICB0YXJnZXRzID0gc2VsZWN0b3IuZmlsdGVyKGlzLmVsZW1lbnQpO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXMuZW1wdHkodGFyZ2V0cykpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0YXJnZXRzLm1hcCh0ID0+IG5ldyBQbHlyKHQsIG9wdGlvbnMpKTtcbiAgICB9XG5cbiAgfVxuXG4gIFBseXIuZGVmYXVsdHMgPSBjbG9uZURlZXAoZGVmYXVsdHMpO1xuXG4gIHJldHVybiBQbHlyO1xuXG59KSk7XG4iLCJmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfWZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKGUsdCl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciByPXRbbl07ci5lbnVtZXJhYmxlPXIuZW51bWVyYWJsZXx8ITEsci5jb25maWd1cmFibGU9ITAsXCJ2YWx1ZVwiaW4gciYmKHIud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHIua2V5LHIpfX1mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoZSx0LG4pe3JldHVybiB0JiZfZGVmaW5lUHJvcGVydGllcyhlLnByb3RvdHlwZSx0KSxuJiZfZGVmaW5lUHJvcGVydGllcyhlLG4pLGV9ZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KGUsdCxuKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOm4sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPW4sZX1mdW5jdGlvbiBvd25LZXlzKGUsdCl7dmFyIG49T2JqZWN0LmtleXMoZSk7aWYoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTt0JiYocj1yLmZpbHRlcigoZnVuY3Rpb24odCl7cmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSx0KS5lbnVtZXJhYmxlfSkpKSxuLnB1c2guYXBwbHkobixyKX1yZXR1cm4gbn1mdW5jdGlvbiBfb2JqZWN0U3ByZWFkMihlKXtmb3IodmFyIHQ9MTt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXt2YXIgbj1udWxsIT1hcmd1bWVudHNbdF0/YXJndW1lbnRzW3RdOnt9O3QlMj9vd25LZXlzKE9iamVjdChuKSwhMCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7X2RlZmluZVByb3BlcnR5KGUsdCxuW3RdKX0pKTpPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycz9PYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKG4pKTpvd25LZXlzKE9iamVjdChuKSkuZm9yRWFjaCgoZnVuY3Rpb24odCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG4sdCkpfSkpfXJldHVybiBlfXZhciBkZWZhdWx0cz17YWRkQ1NTOiEwLHRodW1iV2lkdGg6MTUsd2F0Y2g6ITB9O2Z1bmN0aW9uIG1hdGNoZXMoZSx0KXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHQpKS5pbmNsdWRlcyh0aGlzKX0uY2FsbChlLHQpfWZ1bmN0aW9uIHRyaWdnZXIoZSx0KXtpZihlJiZ0KXt2YXIgbj1uZXcgRXZlbnQodCx7YnViYmxlczohMH0pO2UuZGlzcGF0Y2hFdmVudChuKX19dmFyIGdldENvbnN0cnVjdG9yPWZ1bmN0aW9uKGUpe3JldHVybiBudWxsIT1lP2UuY29uc3RydWN0b3I6bnVsbH0saW5zdGFuY2VPZj1mdW5jdGlvbihlLHQpe3JldHVybiEhKGUmJnQmJmUgaW5zdGFuY2VvZiB0KX0saXNOdWxsT3JVbmRlZmluZWQ9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PWV9LGlzT2JqZWN0PWZ1bmN0aW9uKGUpe3JldHVybiBnZXRDb25zdHJ1Y3RvcihlKT09PU9iamVjdH0saXNOdW1iZXI9ZnVuY3Rpb24oZSl7cmV0dXJuIGdldENvbnN0cnVjdG9yKGUpPT09TnVtYmVyJiYhTnVtYmVyLmlzTmFOKGUpfSxpc1N0cmluZz1mdW5jdGlvbihlKXtyZXR1cm4gZ2V0Q29uc3RydWN0b3IoZSk9PT1TdHJpbmd9LGlzQm9vbGVhbj1mdW5jdGlvbihlKXtyZXR1cm4gZ2V0Q29uc3RydWN0b3IoZSk9PT1Cb29sZWFufSxpc0Z1bmN0aW9uPWZ1bmN0aW9uKGUpe3JldHVybiBnZXRDb25zdHJ1Y3RvcihlKT09PUZ1bmN0aW9ufSxpc0FycmF5PWZ1bmN0aW9uKGUpe3JldHVybiBBcnJheS5pc0FycmF5KGUpfSxpc05vZGVMaXN0PWZ1bmN0aW9uKGUpe3JldHVybiBpbnN0YW5jZU9mKGUsTm9kZUxpc3QpfSxpc0VsZW1lbnQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGluc3RhbmNlT2YoZSxFbGVtZW50KX0saXNFdmVudD1mdW5jdGlvbihlKXtyZXR1cm4gaW5zdGFuY2VPZihlLEV2ZW50KX0saXNFbXB0eT1mdW5jdGlvbihlKXtyZXR1cm4gaXNOdWxsT3JVbmRlZmluZWQoZSl8fChpc1N0cmluZyhlKXx8aXNBcnJheShlKXx8aXNOb2RlTGlzdChlKSkmJiFlLmxlbmd0aHx8aXNPYmplY3QoZSkmJiFPYmplY3Qua2V5cyhlKS5sZW5ndGh9LGlzPXtudWxsT3JVbmRlZmluZWQ6aXNOdWxsT3JVbmRlZmluZWQsb2JqZWN0OmlzT2JqZWN0LG51bWJlcjppc051bWJlcixzdHJpbmc6aXNTdHJpbmcsYm9vbGVhbjppc0Jvb2xlYW4sZnVuY3Rpb246aXNGdW5jdGlvbixhcnJheTppc0FycmF5LG5vZGVMaXN0OmlzTm9kZUxpc3QsZWxlbWVudDppc0VsZW1lbnQsZXZlbnQ6aXNFdmVudCxlbXB0eTppc0VtcHR5fTtmdW5jdGlvbiBnZXREZWNpbWFsUGxhY2VzKGUpe3ZhciB0PVwiXCIuY29uY2F0KGUpLm1hdGNoKC8oPzpcXC4oXFxkKykpPyg/OltlRV0oWystXT9cXGQrKSk/JC8pO3JldHVybiB0P01hdGgubWF4KDAsKHRbMV0/dFsxXS5sZW5ndGg6MCktKHRbMl0/K3RbMl06MCkpOjB9ZnVuY3Rpb24gcm91bmQoZSx0KXtpZigxPnQpe3ZhciBuPWdldERlY2ltYWxQbGFjZXModCk7cmV0dXJuIHBhcnNlRmxvYXQoZS50b0ZpeGVkKG4pKX1yZXR1cm4gTWF0aC5yb3VuZChlL3QpKnR9dmFyIFJhbmdlVG91Y2g9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsbil7X2NsYXNzQ2FsbENoZWNrKHRoaXMsZSksaXMuZWxlbWVudCh0KT90aGlzLmVsZW1lbnQ9dDppcy5zdHJpbmcodCkmJih0aGlzLmVsZW1lbnQ9ZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0KSksaXMuZWxlbWVudCh0aGlzLmVsZW1lbnQpJiZpcy5lbXB0eSh0aGlzLmVsZW1lbnQucmFuZ2VUb3VjaCkmJih0aGlzLmNvbmZpZz1fb2JqZWN0U3ByZWFkMih7fSxkZWZhdWx0cyx7fSxuKSx0aGlzLmluaXQoKSl9cmV0dXJuIF9jcmVhdGVDbGFzcyhlLFt7a2V5OlwiaW5pdFwiLHZhbHVlOmZ1bmN0aW9uKCl7ZS5lbmFibGVkJiYodGhpcy5jb25maWcuYWRkQ1NTJiYodGhpcy5lbGVtZW50LnN0eWxlLnVzZXJTZWxlY3Q9XCJub25lXCIsdGhpcy5lbGVtZW50LnN0eWxlLndlYktpdFVzZXJTZWxlY3Q9XCJub25lXCIsdGhpcy5lbGVtZW50LnN0eWxlLnRvdWNoQWN0aW9uPVwibWFuaXB1bGF0aW9uXCIpLHRoaXMubGlzdGVuZXJzKCEwKSx0aGlzLmVsZW1lbnQucmFuZ2VUb3VjaD10aGlzKX19LHtrZXk6XCJkZXN0cm95XCIsdmFsdWU6ZnVuY3Rpb24oKXtlLmVuYWJsZWQmJih0aGlzLmNvbmZpZy5hZGRDU1MmJih0aGlzLmVsZW1lbnQuc3R5bGUudXNlclNlbGVjdD1cIlwiLHRoaXMuZWxlbWVudC5zdHlsZS53ZWJLaXRVc2VyU2VsZWN0PVwiXCIsdGhpcy5lbGVtZW50LnN0eWxlLnRvdWNoQWN0aW9uPVwiXCIpLHRoaXMubGlzdGVuZXJzKCExKSx0aGlzLmVsZW1lbnQucmFuZ2VUb3VjaD1udWxsKX19LHtrZXk6XCJsaXN0ZW5lcnNcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZT9cImFkZEV2ZW50TGlzdGVuZXJcIjpcInJlbW92ZUV2ZW50TGlzdGVuZXJcIjtbXCJ0b3VjaHN0YXJ0XCIsXCJ0b3VjaG1vdmVcIixcInRvdWNoZW5kXCJdLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QuZWxlbWVudFtuXShlLChmdW5jdGlvbihlKXtyZXR1cm4gdC5zZXQoZSl9KSwhMSl9KSl9fSx7a2V5OlwiZ2V0XCIsdmFsdWU6ZnVuY3Rpb24odCl7aWYoIWUuZW5hYmxlZHx8IWlzLmV2ZW50KHQpKXJldHVybiBudWxsO3ZhciBuLHI9dC50YXJnZXQsaT10LmNoYW5nZWRUb3VjaGVzWzBdLG89cGFyc2VGbG9hdChyLmdldEF0dHJpYnV0ZShcIm1pblwiKSl8fDAscz1wYXJzZUZsb2F0KHIuZ2V0QXR0cmlidXRlKFwibWF4XCIpKXx8MTAwLHU9cGFyc2VGbG9hdChyLmdldEF0dHJpYnV0ZShcInN0ZXBcIikpfHwxLGM9ci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxhPTEwMC9jLndpZHRoKih0aGlzLmNvbmZpZy50aHVtYldpZHRoLzIpLzEwMDtyZXR1cm4gMD4obj0xMDAvYy53aWR0aCooaS5jbGllbnRYLWMubGVmdCkpP249MDoxMDA8biYmKG49MTAwKSw1MD5uP24tPSgxMDAtMipuKSphOjUwPG4mJihuKz0yKihuLTUwKSphKSxvK3JvdW5kKG4vMTAwKihzLW8pLHUpfX0se2tleTpcInNldFwiLHZhbHVlOmZ1bmN0aW9uKHQpe2UuZW5hYmxlZCYmaXMuZXZlbnQodCkmJiF0LnRhcmdldC5kaXNhYmxlZCYmKHQucHJldmVudERlZmF1bHQoKSx0LnRhcmdldC52YWx1ZT10aGlzLmdldCh0KSx0cmlnZ2VyKHQudGFyZ2V0LFwidG91Y2hlbmRcIj09PXQudHlwZT9cImNoYW5nZVwiOlwiaW5wdXRcIikpfX1dLFt7a2V5Olwic2V0dXBcIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgbj0xPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06e30scj1udWxsO2lmKGlzLmVtcHR5KHQpfHxpcy5zdHJpbmcodCk/cj1BcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoaXMuc3RyaW5nKHQpP3Q6J2lucHV0W3R5cGU9XCJyYW5nZVwiXScpKTppcy5lbGVtZW50KHQpP3I9W3RdOmlzLm5vZGVMaXN0KHQpP3I9QXJyYXkuZnJvbSh0KTppcy5hcnJheSh0KSYmKHI9dC5maWx0ZXIoaXMuZWxlbWVudCkpLGlzLmVtcHR5KHIpKXJldHVybiBudWxsO3ZhciBpPV9vYmplY3RTcHJlYWQyKHt9LGRlZmF1bHRzLHt9LG4pO2lmKGlzLnN0cmluZyh0KSYmaS53YXRjaCl7dmFyIG89bmV3IE11dGF0aW9uT2JzZXJ2ZXIoKGZ1bmN0aW9uKG4pe0FycmF5LmZyb20obikuZm9yRWFjaCgoZnVuY3Rpb24obil7QXJyYXkuZnJvbShuLmFkZGVkTm9kZXMpLmZvckVhY2goKGZ1bmN0aW9uKG4pe2lzLmVsZW1lbnQobikmJm1hdGNoZXMobix0KSYmbmV3IGUobixpKX0pKX0pKX0pKTtvLm9ic2VydmUoZG9jdW1lbnQuYm9keSx7Y2hpbGRMaXN0OiEwLHN1YnRyZWU6ITB9KX1yZXR1cm4gci5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0LG4pfSkpfX0se2tleTpcImVuYWJsZWRcIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm5cIm9udG91Y2hzdGFydFwiaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50fX1dKSxlfSgpO2V4cG9ydCBkZWZhdWx0IFJhbmdlVG91Y2g7IiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFR5cGUgY2hlY2tpbmcgdXRpbHNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmNvbnN0IGdldENvbnN0cnVjdG9yID0gKGlucHV0KSA9PiAoaW5wdXQgIT09IG51bGwgJiYgdHlwZW9mIGlucHV0ICE9PSAndW5kZWZpbmVkJyA/IGlucHV0LmNvbnN0cnVjdG9yIDogbnVsbCk7XG5jb25zdCBpbnN0YW5jZU9mID0gKGlucHV0LCBjb25zdHJ1Y3RvcikgPT4gQm9vbGVhbihpbnB1dCAmJiBjb25zdHJ1Y3RvciAmJiBpbnB1dCBpbnN0YW5jZW9mIGNvbnN0cnVjdG9yKTtcbmNvbnN0IGlzTnVsbE9yVW5kZWZpbmVkID0gKGlucHV0KSA9PiBpbnB1dCA9PT0gbnVsbCB8fCB0eXBlb2YgaW5wdXQgPT09ICd1bmRlZmluZWQnO1xuY29uc3QgaXNPYmplY3QgPSAoaW5wdXQpID0+IGdldENvbnN0cnVjdG9yKGlucHV0KSA9PT0gT2JqZWN0O1xuY29uc3QgaXNOdW1iZXIgPSAoaW5wdXQpID0+IGdldENvbnN0cnVjdG9yKGlucHV0KSA9PT0gTnVtYmVyICYmICFOdW1iZXIuaXNOYU4oaW5wdXQpO1xuY29uc3QgaXNTdHJpbmcgPSAoaW5wdXQpID0+IGdldENvbnN0cnVjdG9yKGlucHV0KSA9PT0gU3RyaW5nO1xuY29uc3QgaXNCb29sZWFuID0gKGlucHV0KSA9PiBnZXRDb25zdHJ1Y3RvcihpbnB1dCkgPT09IEJvb2xlYW47XG5jb25zdCBpc0Z1bmN0aW9uID0gKGlucHV0KSA9PiBnZXRDb25zdHJ1Y3RvcihpbnB1dCkgPT09IEZ1bmN0aW9uO1xuY29uc3QgaXNBcnJheSA9IChpbnB1dCkgPT4gQXJyYXkuaXNBcnJheShpbnB1dCk7XG5jb25zdCBpc1dlYWtNYXAgPSAoaW5wdXQpID0+IGluc3RhbmNlT2YoaW5wdXQsIFdlYWtNYXApO1xuY29uc3QgaXNOb2RlTGlzdCA9IChpbnB1dCkgPT4gaW5zdGFuY2VPZihpbnB1dCwgTm9kZUxpc3QpO1xuY29uc3QgaXNUZXh0Tm9kZSA9IChpbnB1dCkgPT4gZ2V0Q29uc3RydWN0b3IoaW5wdXQpID09PSBUZXh0O1xuY29uc3QgaXNFdmVudCA9IChpbnB1dCkgPT4gaW5zdGFuY2VPZihpbnB1dCwgRXZlbnQpO1xuY29uc3QgaXNLZXlib2FyZEV2ZW50ID0gKGlucHV0KSA9PiBpbnN0YW5jZU9mKGlucHV0LCBLZXlib2FyZEV2ZW50KTtcbmNvbnN0IGlzQ3VlID0gKGlucHV0KSA9PiBpbnN0YW5jZU9mKGlucHV0LCB3aW5kb3cuVGV4dFRyYWNrQ3VlKSB8fCBpbnN0YW5jZU9mKGlucHV0LCB3aW5kb3cuVlRUQ3VlKTtcbmNvbnN0IGlzVHJhY2sgPSAoaW5wdXQpID0+IGluc3RhbmNlT2YoaW5wdXQsIFRleHRUcmFjaykgfHwgKCFpc051bGxPclVuZGVmaW5lZChpbnB1dCkgJiYgaXNTdHJpbmcoaW5wdXQua2luZCkpO1xuY29uc3QgaXNQcm9taXNlID0gKGlucHV0KSA9PiBpbnN0YW5jZU9mKGlucHV0LCBQcm9taXNlKSAmJiBpc0Z1bmN0aW9uKGlucHV0LnRoZW4pO1xuXG5jb25zdCBpc0VsZW1lbnQgPSAoaW5wdXQpID0+XG4gIGlucHV0ICE9PSBudWxsICYmXG4gIHR5cGVvZiBpbnB1dCA9PT0gJ29iamVjdCcgJiZcbiAgaW5wdXQubm9kZVR5cGUgPT09IDEgJiZcbiAgdHlwZW9mIGlucHV0LnN0eWxlID09PSAnb2JqZWN0JyAmJlxuICB0eXBlb2YgaW5wdXQub3duZXJEb2N1bWVudCA9PT0gJ29iamVjdCc7XG5cbmNvbnN0IGlzRW1wdHkgPSAoaW5wdXQpID0+XG4gIGlzTnVsbE9yVW5kZWZpbmVkKGlucHV0KSB8fFxuICAoKGlzU3RyaW5nKGlucHV0KSB8fCBpc0FycmF5KGlucHV0KSB8fCBpc05vZGVMaXN0KGlucHV0KSkgJiYgIWlucHV0Lmxlbmd0aCkgfHxcbiAgKGlzT2JqZWN0KGlucHV0KSAmJiAhT2JqZWN0LmtleXMoaW5wdXQpLmxlbmd0aCk7XG5cbmNvbnN0IGlzVXJsID0gKGlucHV0KSA9PiB7XG4gIC8vIEFjY2VwdCBhIFVSTCBvYmplY3RcbiAgaWYgKGluc3RhbmNlT2YoaW5wdXQsIHdpbmRvdy5VUkwpKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvLyBNdXN0IGJlIHN0cmluZyBmcm9tIGhlcmVcbiAgaWYgKCFpc1N0cmluZyhpbnB1dCkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvLyBBZGQgdGhlIHByb3RvY29sIGlmIHJlcXVpcmVkXG4gIGxldCBzdHJpbmcgPSBpbnB1dDtcbiAgaWYgKCFpbnB1dC5zdGFydHNXaXRoKCdodHRwOi8vJykgfHwgIWlucHV0LnN0YXJ0c1dpdGgoJ2h0dHBzOi8vJykpIHtcbiAgICBzdHJpbmcgPSBgaHR0cDovLyR7aW5wdXR9YDtcbiAgfVxuXG4gIHRyeSB7XG4gICAgcmV0dXJuICFpc0VtcHR5KG5ldyBVUkwoc3RyaW5nKS5ob3N0bmFtZSk7XG4gIH0gY2F0Y2ggKF8pIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbnVsbE9yVW5kZWZpbmVkOiBpc051bGxPclVuZGVmaW5lZCxcbiAgb2JqZWN0OiBpc09iamVjdCxcbiAgbnVtYmVyOiBpc051bWJlcixcbiAgc3RyaW5nOiBpc1N0cmluZyxcbiAgYm9vbGVhbjogaXNCb29sZWFuLFxuICBmdW5jdGlvbjogaXNGdW5jdGlvbixcbiAgYXJyYXk6IGlzQXJyYXksXG4gIHdlYWtNYXA6IGlzV2Vha01hcCxcbiAgbm9kZUxpc3Q6IGlzTm9kZUxpc3QsXG4gIGVsZW1lbnQ6IGlzRWxlbWVudCxcbiAgdGV4dE5vZGU6IGlzVGV4dE5vZGUsXG4gIGV2ZW50OiBpc0V2ZW50LFxuICBrZXlib2FyZEV2ZW50OiBpc0tleWJvYXJkRXZlbnQsXG4gIGN1ZTogaXNDdWUsXG4gIHRyYWNrOiBpc1RyYWNrLFxuICBwcm9taXNlOiBpc1Byb21pc2UsXG4gIHVybDogaXNVcmwsXG4gIGVtcHR5OiBpc0VtcHR5LFxufTtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBBbmltYXRpb24gdXRpbHNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBpcyBmcm9tICcuL2lzJztcblxuZXhwb3J0IGNvbnN0IHRyYW5zaXRpb25FbmRFdmVudCA9ICgoKSA9PiB7XG4gIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG5cbiAgY29uc3QgZXZlbnRzID0ge1xuICAgIFdlYmtpdFRyYW5zaXRpb246ICd3ZWJraXRUcmFuc2l0aW9uRW5kJyxcbiAgICBNb3pUcmFuc2l0aW9uOiAndHJhbnNpdGlvbmVuZCcsXG4gICAgT1RyYW5zaXRpb246ICdvVHJhbnNpdGlvbkVuZCBvdHJhbnNpdGlvbmVuZCcsXG4gICAgdHJhbnNpdGlvbjogJ3RyYW5zaXRpb25lbmQnLFxuICB9O1xuXG4gIGNvbnN0IHR5cGUgPSBPYmplY3Qua2V5cyhldmVudHMpLmZpbmQoKGV2ZW50KSA9PiBlbGVtZW50LnN0eWxlW2V2ZW50XSAhPT0gdW5kZWZpbmVkKTtcblxuICByZXR1cm4gaXMuc3RyaW5nKHR5cGUpID8gZXZlbnRzW3R5cGVdIDogZmFsc2U7XG59KSgpO1xuXG4vLyBGb3JjZSByZXBhaW50IG9mIGVsZW1lbnRcbmV4cG9ydCBmdW5jdGlvbiByZXBhaW50KGVsZW1lbnQsIGRlbGF5KSB7XG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgIGVsZW1lbnQuaGlkZGVuID0gdHJ1ZTtcblxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC1leHByZXNzaW9uc1xuICAgICAgZWxlbWVudC5vZmZzZXRIZWlnaHQ7XG5cbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgICAgZWxlbWVudC5oaWRkZW4gPSBmYWxzZTtcbiAgICB9IGNhdGNoIChfKSB7XG4gICAgICAvLyBEbyBub3RoaW5nXG4gICAgfVxuICB9LCBkZWxheSk7XG59XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQnJvd3NlciBzbmlmZmluZ1xuLy8gVW5mb3J0dW5hdGVseSwgZHVlIHRvIG1peGVkIHN1cHBvcnQsIFVBIHNuaWZmaW5nIGlzIHJlcXVpcmVkXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBicm93c2VyID0ge1xuICBpc0lFOiBCb29sZWFuKHdpbmRvdy5kb2N1bWVudC5kb2N1bWVudE1vZGUpLFxuICBpc0VkZ2U6IHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdFZGdlJyksXG4gIGlzV2Via2l0OiAnV2Via2l0QXBwZWFyYW5jZScgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlICYmICEvRWRnZS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSxcbiAgaXNJUGhvbmU6IC8oaVBob25lfGlQb2QpL2dpLnRlc3QobmF2aWdhdG9yLnBsYXRmb3JtKSxcbiAgaXNJb3M6XG4gICAgKG5hdmlnYXRvci5wbGF0Zm9ybSA9PT0gJ01hY0ludGVsJyAmJiBuYXZpZ2F0b3IubWF4VG91Y2hQb2ludHMgPiAxKSB8fFxuICAgIC8oaVBhZHxpUGhvbmV8aVBvZCkvZ2kudGVzdChuYXZpZ2F0b3IucGxhdGZvcm0pLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgYnJvd3NlcjtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBPYmplY3QgdXRpbHNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBpcyBmcm9tICcuL2lzJztcblxuLy8gQ2xvbmUgbmVzdGVkIG9iamVjdHNcbmV4cG9ydCBmdW5jdGlvbiBjbG9uZURlZXAob2JqZWN0KSB7XG4gIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iamVjdCkpO1xufVxuXG4vLyBHZXQgYSBuZXN0ZWQgdmFsdWUgaW4gYW4gb2JqZWN0XG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVlcChvYmplY3QsIHBhdGgpIHtcbiAgcmV0dXJuIHBhdGguc3BsaXQoJy4nKS5yZWR1Y2UoKG9iaiwga2V5KSA9PiBvYmogJiYgb2JqW2tleV0sIG9iamVjdCk7XG59XG5cbi8vIERlZXAgZXh0ZW5kIGRlc3RpbmF0aW9uIG9iamVjdCB3aXRoIE4gbW9yZSBvYmplY3RzXG5leHBvcnQgZnVuY3Rpb24gZXh0ZW5kKHRhcmdldCA9IHt9LCAuLi5zb3VyY2VzKSB7XG4gIGlmICghc291cmNlcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9XG5cbiAgY29uc3Qgc291cmNlID0gc291cmNlcy5zaGlmdCgpO1xuXG4gIGlmICghaXMub2JqZWN0KHNvdXJjZSkpIHtcbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9XG5cbiAgT2JqZWN0LmtleXMoc291cmNlKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICBpZiAoaXMub2JqZWN0KHNvdXJjZVtrZXldKSkge1xuICAgICAgaWYgKCFPYmplY3Qua2V5cyh0YXJnZXQpLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHsgW2tleV06IHt9IH0pO1xuICAgICAgfVxuXG4gICAgICBleHRlbmQodGFyZ2V0W2tleV0sIHNvdXJjZVtrZXldKTtcbiAgICB9IGVsc2Uge1xuICAgICAgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHsgW2tleV06IHNvdXJjZVtrZXldIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIGV4dGVuZCh0YXJnZXQsIC4uLnNvdXJjZXMpO1xufVxuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVsZW1lbnQgdXRpbHNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBpcyBmcm9tICcuL2lzJztcbmltcG9ydCB7IGV4dGVuZCB9IGZyb20gJy4vb2JqZWN0cyc7XG5cbi8vIFdyYXAgYW4gZWxlbWVudFxuZXhwb3J0IGZ1bmN0aW9uIHdyYXAoZWxlbWVudHMsIHdyYXBwZXIpIHtcbiAgLy8gQ29udmVydCBgZWxlbWVudHNgIHRvIGFuIGFycmF5LCBpZiBuZWNlc3NhcnkuXG4gIGNvbnN0IHRhcmdldHMgPSBlbGVtZW50cy5sZW5ndGggPyBlbGVtZW50cyA6IFtlbGVtZW50c107XG5cbiAgLy8gTG9vcHMgYmFja3dhcmRzIHRvIHByZXZlbnQgaGF2aW5nIHRvIGNsb25lIHRoZSB3cmFwcGVyIG9uIHRoZVxuICAvLyBmaXJzdCBlbGVtZW50IChzZWUgYGNoaWxkYCBiZWxvdykuXG4gIEFycmF5LmZyb20odGFyZ2V0cylcbiAgICAucmV2ZXJzZSgpXG4gICAgLmZvckVhY2goKGVsZW1lbnQsIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBjaGlsZCA9IGluZGV4ID4gMCA/IHdyYXBwZXIuY2xvbmVOb2RlKHRydWUpIDogd3JhcHBlcjtcbiAgICAgIC8vIENhY2hlIHRoZSBjdXJyZW50IHBhcmVudCBhbmQgc2libGluZy5cbiAgICAgIGNvbnN0IHBhcmVudCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcbiAgICAgIGNvbnN0IHNpYmxpbmcgPSBlbGVtZW50Lm5leHRTaWJsaW5nO1xuXG4gICAgICAvLyBXcmFwIHRoZSBlbGVtZW50IChpcyBhdXRvbWF0aWNhbGx5IHJlbW92ZWQgZnJvbSBpdHMgY3VycmVudFxuICAgICAgLy8gcGFyZW50KS5cbiAgICAgIGNoaWxkLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuXG4gICAgICAvLyBJZiB0aGUgZWxlbWVudCBoYWQgYSBzaWJsaW5nLCBpbnNlcnQgdGhlIHdyYXBwZXIgYmVmb3JlXG4gICAgICAvLyB0aGUgc2libGluZyB0byBtYWludGFpbiB0aGUgSFRNTCBzdHJ1Y3R1cmU7IG90aGVyd2lzZSwganVzdFxuICAgICAgLy8gYXBwZW5kIGl0IHRvIHRoZSBwYXJlbnQuXG4gICAgICBpZiAoc2libGluZykge1xuICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKGNoaWxkLCBzaWJsaW5nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZChjaGlsZCk7XG4gICAgICB9XG4gICAgfSk7XG59XG5cbi8vIFNldCBhdHRyaWJ1dGVzXG5leHBvcnQgZnVuY3Rpb24gc2V0QXR0cmlidXRlcyhlbGVtZW50LCBhdHRyaWJ1dGVzKSB7XG4gIGlmICghaXMuZWxlbWVudChlbGVtZW50KSB8fCBpcy5lbXB0eShhdHRyaWJ1dGVzKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIEFzc3VtZSBudWxsIGFuZCB1bmRlZmluZWQgYXR0cmlidXRlcyBzaG91bGQgYmUgbGVmdCBvdXQsXG4gIC8vIFNldHRpbmcgdGhlbSB3b3VsZCBvdGhlcndpc2UgY29udmVydCB0aGVtIHRvIFwibnVsbFwiIGFuZCBcInVuZGVmaW5lZFwiXG4gIE9iamVjdC5lbnRyaWVzKGF0dHJpYnV0ZXMpXG4gICAgLmZpbHRlcigoWywgdmFsdWVdKSA9PiAhaXMubnVsbE9yVW5kZWZpbmVkKHZhbHVlKSlcbiAgICAuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiBlbGVtZW50LnNldEF0dHJpYnV0ZShrZXksIHZhbHVlKSk7XG59XG5cbi8vIENyZWF0ZSBhIERvY3VtZW50RnJhZ21lbnRcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFbGVtZW50KHR5cGUsIGF0dHJpYnV0ZXMsIHRleHQpIHtcbiAgLy8gQ3JlYXRlIGEgbmV3IDxlbGVtZW50PlxuICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0eXBlKTtcblxuICAvLyBTZXQgYWxsIHBhc3NlZCBhdHRyaWJ1dGVzXG4gIGlmIChpcy5vYmplY3QoYXR0cmlidXRlcykpIHtcbiAgICBzZXRBdHRyaWJ1dGVzKGVsZW1lbnQsIGF0dHJpYnV0ZXMpO1xuICB9XG5cbiAgLy8gQWRkIHRleHQgbm9kZVxuICBpZiAoaXMuc3RyaW5nKHRleHQpKSB7XG4gICAgZWxlbWVudC5pbm5lclRleHQgPSB0ZXh0O1xuICB9XG5cbiAgLy8gUmV0dXJuIGJ1aWx0IGVsZW1lbnRcbiAgcmV0dXJuIGVsZW1lbnQ7XG59XG5cbi8vIEluYWVydCBhbiBlbGVtZW50IGFmdGVyIGFub3RoZXJcbmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRBZnRlcihlbGVtZW50LCB0YXJnZXQpIHtcbiAgaWYgKCFpcy5lbGVtZW50KGVsZW1lbnQpIHx8ICFpcy5lbGVtZW50KHRhcmdldCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB0YXJnZXQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZWxlbWVudCwgdGFyZ2V0Lm5leHRTaWJsaW5nKTtcbn1cblxuLy8gSW5zZXJ0IGEgRG9jdW1lbnRGcmFnbWVudFxuZXhwb3J0IGZ1bmN0aW9uIGluc2VydEVsZW1lbnQodHlwZSwgcGFyZW50LCBhdHRyaWJ1dGVzLCB0ZXh0KSB7XG4gIGlmICghaXMuZWxlbWVudChwYXJlbnQpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcGFyZW50LmFwcGVuZENoaWxkKGNyZWF0ZUVsZW1lbnQodHlwZSwgYXR0cmlidXRlcywgdGV4dCkpO1xufVxuXG4vLyBSZW1vdmUgZWxlbWVudChzKVxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUVsZW1lbnQoZWxlbWVudCkge1xuICBpZiAoaXMubm9kZUxpc3QoZWxlbWVudCkgfHwgaXMuYXJyYXkoZWxlbWVudCkpIHtcbiAgICBBcnJheS5mcm9tKGVsZW1lbnQpLmZvckVhY2gocmVtb3ZlRWxlbWVudCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKCFpcy5lbGVtZW50KGVsZW1lbnQpIHx8ICFpcy5lbGVtZW50KGVsZW1lbnQucGFyZW50Tm9kZSkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBlbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG59XG5cbi8vIFJlbW92ZSBhbGwgY2hpbGQgZWxlbWVudHNcbmV4cG9ydCBmdW5jdGlvbiBlbXB0eUVsZW1lbnQoZWxlbWVudCkge1xuICBpZiAoIWlzLmVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgeyBsZW5ndGggfSA9IGVsZW1lbnQuY2hpbGROb2RlcztcblxuICB3aGlsZSAobGVuZ3RoID4gMCkge1xuICAgIGVsZW1lbnQucmVtb3ZlQ2hpbGQoZWxlbWVudC5sYXN0Q2hpbGQpO1xuICAgIGxlbmd0aCAtPSAxO1xuICB9XG59XG5cbi8vIFJlcGxhY2UgZWxlbWVudFxuZXhwb3J0IGZ1bmN0aW9uIHJlcGxhY2VFbGVtZW50KG5ld0NoaWxkLCBvbGRDaGlsZCkge1xuICBpZiAoIWlzLmVsZW1lbnQob2xkQ2hpbGQpIHx8ICFpcy5lbGVtZW50KG9sZENoaWxkLnBhcmVudE5vZGUpIHx8ICFpcy5lbGVtZW50KG5ld0NoaWxkKSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgb2xkQ2hpbGQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobmV3Q2hpbGQsIG9sZENoaWxkKTtcblxuICByZXR1cm4gbmV3Q2hpbGQ7XG59XG5cbi8vIEdldCBhbiBhdHRyaWJ1dGUgb2JqZWN0IGZyb20gYSBzdHJpbmcgc2VsZWN0b3JcbmV4cG9ydCBmdW5jdGlvbiBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHNlbCwgZXhpc3RpbmdBdHRyaWJ1dGVzKSB7XG4gIC8vIEZvciBleGFtcGxlOlxuICAvLyAnLnRlc3QnIHRvIHsgY2xhc3M6ICd0ZXN0JyB9XG4gIC8vICcjdGVzdCcgdG8geyBpZDogJ3Rlc3QnIH1cbiAgLy8gJ1tkYXRhLXRlc3Q9XCJ0ZXN0XCJdJyB0byB7ICdkYXRhLXRlc3QnOiAndGVzdCcgfVxuXG4gIGlmICghaXMuc3RyaW5nKHNlbCkgfHwgaXMuZW1wdHkoc2VsKSkge1xuICAgIHJldHVybiB7fTtcbiAgfVxuXG4gIGNvbnN0IGF0dHJpYnV0ZXMgPSB7fTtcbiAgY29uc3QgZXhpc3RpbmcgPSBleHRlbmQoe30sIGV4aXN0aW5nQXR0cmlidXRlcyk7XG5cbiAgc2VsLnNwbGl0KCcsJykuZm9yRWFjaCgocykgPT4ge1xuICAgIC8vIFJlbW92ZSB3aGl0ZXNwYWNlXG4gICAgY29uc3Qgc2VsZWN0b3IgPSBzLnRyaW0oKTtcbiAgICBjb25zdCBjbGFzc05hbWUgPSBzZWxlY3Rvci5yZXBsYWNlKCcuJywgJycpO1xuICAgIGNvbnN0IHN0cmlwcGVkID0gc2VsZWN0b3IucmVwbGFjZSgvW1tcXF1dL2csICcnKTtcbiAgICAvLyBHZXQgdGhlIHBhcnRzIGFuZCB2YWx1ZVxuICAgIGNvbnN0IHBhcnRzID0gc3RyaXBwZWQuc3BsaXQoJz0nKTtcbiAgICBjb25zdCBba2V5XSA9IHBhcnRzO1xuICAgIGNvbnN0IHZhbHVlID0gcGFydHMubGVuZ3RoID4gMSA/IHBhcnRzWzFdLnJlcGxhY2UoL1tcIiddL2csICcnKSA6ICcnO1xuICAgIC8vIEdldCB0aGUgZmlyc3QgY2hhcmFjdGVyXG4gICAgY29uc3Qgc3RhcnQgPSBzZWxlY3Rvci5jaGFyQXQoMCk7XG5cbiAgICBzd2l0Y2ggKHN0YXJ0KSB7XG4gICAgICBjYXNlICcuJzpcbiAgICAgICAgLy8gQWRkIHRvIGV4aXN0aW5nIGNsYXNzbmFtZVxuICAgICAgICBpZiAoaXMuc3RyaW5nKGV4aXN0aW5nLmNsYXNzKSkge1xuICAgICAgICAgIGF0dHJpYnV0ZXMuY2xhc3MgPSBgJHtleGlzdGluZy5jbGFzc30gJHtjbGFzc05hbWV9YDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzID0gY2xhc3NOYW1lO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICcjJzpcbiAgICAgICAgLy8gSUQgc2VsZWN0b3JcbiAgICAgICAgYXR0cmlidXRlcy5pZCA9IHNlbGVjdG9yLnJlcGxhY2UoJyMnLCAnJyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdbJzpcbiAgICAgICAgLy8gQXR0cmlidXRlIHNlbGVjdG9yXG4gICAgICAgIGF0dHJpYnV0ZXNba2V5XSA9IHZhbHVlO1xuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBicmVhaztcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBleHRlbmQoZXhpc3RpbmcsIGF0dHJpYnV0ZXMpO1xufVxuXG4vLyBUb2dnbGUgaGlkZGVuXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlSGlkZGVuKGVsZW1lbnQsIGhpZGRlbikge1xuICBpZiAoIWlzLmVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgaGlkZSA9IGhpZGRlbjtcblxuICBpZiAoIWlzLmJvb2xlYW4oaGlkZSkpIHtcbiAgICBoaWRlID0gIWVsZW1lbnQuaGlkZGVuO1xuICB9XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gIGVsZW1lbnQuaGlkZGVuID0gaGlkZTtcbn1cblxuLy8gTWlycm9yIEVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZSwgd2l0aCBJRSBjb21wYXRpYmlsaXR5IGZvciBcImZvcmNlXCIgYXJndW1lbnRcbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGVDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUsIGZvcmNlKSB7XG4gIGlmIChpcy5ub2RlTGlzdChlbGVtZW50KSkge1xuICAgIHJldHVybiBBcnJheS5mcm9tKGVsZW1lbnQpLm1hcCgoZSkgPT4gdG9nZ2xlQ2xhc3MoZSwgY2xhc3NOYW1lLCBmb3JjZSkpO1xuICB9XG5cbiAgaWYgKGlzLmVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICBsZXQgbWV0aG9kID0gJ3RvZ2dsZSc7XG4gICAgaWYgKHR5cGVvZiBmb3JjZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIG1ldGhvZCA9IGZvcmNlID8gJ2FkZCcgOiAncmVtb3ZlJztcbiAgICB9XG5cbiAgICBlbGVtZW50LmNsYXNzTGlzdFttZXRob2RdKGNsYXNzTmFtZSk7XG4gICAgcmV0dXJuIGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSk7XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8vIEhhcyBjbGFzcyBuYW1lXG5leHBvcnQgZnVuY3Rpb24gaGFzQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gIHJldHVybiBpcy5lbGVtZW50KGVsZW1lbnQpICYmIGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSk7XG59XG5cbi8vIEVsZW1lbnQgbWF0Y2hlcyBzZWxlY3RvclxuZXhwb3J0IGZ1bmN0aW9uIG1hdGNoZXMoZWxlbWVudCwgc2VsZWN0b3IpIHtcbiAgY29uc3QgeyBwcm90b3R5cGUgfSA9IEVsZW1lbnQ7XG5cbiAgZnVuY3Rpb24gbWF0Y2goKSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpLmluY2x1ZGVzKHRoaXMpO1xuICB9XG5cbiAgY29uc3QgbWV0aG9kID1cbiAgICBwcm90b3R5cGUubWF0Y2hlcyB8fFxuICAgIHByb3RvdHlwZS53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHxcbiAgICBwcm90b3R5cGUubW96TWF0Y2hlc1NlbGVjdG9yIHx8XG4gICAgcHJvdG90eXBlLm1zTWF0Y2hlc1NlbGVjdG9yIHx8XG4gICAgbWF0Y2g7XG5cbiAgcmV0dXJuIG1ldGhvZC5jYWxsKGVsZW1lbnQsIHNlbGVjdG9yKTtcbn1cblxuLy8gQ2xvc2VzdCBhbmNlc3RvciBlbGVtZW50IG1hdGNoaW5nIHNlbGVjdG9yIChhbHNvIHRlc3RzIGVsZW1lbnQgaXRzZWxmKVxuZXhwb3J0IGZ1bmN0aW9uIGNsb3Nlc3QoZWxlbWVudCwgc2VsZWN0b3IpIHtcbiAgY29uc3QgeyBwcm90b3R5cGUgfSA9IEVsZW1lbnQ7XG5cbiAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0VsZW1lbnQvY2xvc2VzdCNQb2x5ZmlsbFxuICBmdW5jdGlvbiBjbG9zZXN0RWxlbWVudCgpIHtcbiAgICBsZXQgZWwgPSB0aGlzO1xuXG4gICAgZG8ge1xuICAgICAgaWYgKG1hdGNoZXMubWF0Y2hlcyhlbCwgc2VsZWN0b3IpKSByZXR1cm4gZWw7XG4gICAgICBlbCA9IGVsLnBhcmVudEVsZW1lbnQgfHwgZWwucGFyZW50Tm9kZTtcbiAgICB9IHdoaWxlIChlbCAhPT0gbnVsbCAmJiBlbC5ub2RlVHlwZSA9PT0gMSk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBjb25zdCBtZXRob2QgPSBwcm90b3R5cGUuY2xvc2VzdCB8fCBjbG9zZXN0RWxlbWVudDtcblxuICByZXR1cm4gbWV0aG9kLmNhbGwoZWxlbWVudCwgc2VsZWN0b3IpO1xufVxuXG4vLyBGaW5kIGFsbCBlbGVtZW50c1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRzKHNlbGVjdG9yKSB7XG4gIHJldHVybiB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbn1cblxuLy8gRmluZCBhIHNpbmdsZSBlbGVtZW50XG5leHBvcnQgZnVuY3Rpb24gZ2V0RWxlbWVudChzZWxlY3Rvcikge1xuICByZXR1cm4gdGhpcy5lbGVtZW50cy5jb250YWluZXIucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG59XG5cbi8vIFNldCBmb2N1cyBhbmQgdGFiIGZvY3VzIGNsYXNzXG5leHBvcnQgZnVuY3Rpb24gc2V0Rm9jdXMoZWxlbWVudCA9IG51bGwsIHRhYkZvY3VzID0gZmFsc2UpIHtcbiAgaWYgKCFpcy5lbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gU2V0IHJlZ3VsYXIgZm9jdXNcbiAgZWxlbWVudC5mb2N1cyh7IHByZXZlbnRTY3JvbGw6IHRydWUgfSk7XG5cbiAgLy8gSWYgd2Ugd2FudCB0byBtaW1pYyBrZXlib2FyZCBmb2N1cyB2aWEgdGFiXG4gIGlmICh0YWJGb2N1cykge1xuICAgIHRvZ2dsZUNsYXNzKGVsZW1lbnQsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMudGFiRm9jdXMpO1xuICB9XG59XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUGx5ciBzdXBwb3J0IGNoZWNrc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IHsgdHJhbnNpdGlvbkVuZEV2ZW50IH0gZnJvbSAnLi91dGlscy9hbmltYXRpb24nO1xuaW1wb3J0IGJyb3dzZXIgZnJvbSAnLi91dGlscy9icm93c2VyJztcbmltcG9ydCB7IGNyZWF0ZUVsZW1lbnQgfSBmcm9tICcuL3V0aWxzL2VsZW1lbnRzJztcbmltcG9ydCBpcyBmcm9tICcuL3V0aWxzL2lzJztcblxuLy8gRGVmYXVsdCBjb2RlY3MgZm9yIGNoZWNraW5nIG1pbWV0eXBlIHN1cHBvcnRcbmNvbnN0IGRlZmF1bHRDb2RlY3MgPSB7XG4gICdhdWRpby9vZ2cnOiAndm9yYmlzJyxcbiAgJ2F1ZGlvL3dhdic6ICcxJyxcbiAgJ3ZpZGVvL3dlYm0nOiAndnA4LCB2b3JiaXMnLFxuICAndmlkZW8vbXA0JzogJ2F2YzEuNDJFMDFFLCBtcDRhLjQwLjInLFxuICAndmlkZW8vb2dnJzogJ3RoZW9yYScsXG59O1xuXG4vLyBDaGVjayBmb3IgZmVhdHVyZSBzdXBwb3J0XG5jb25zdCBzdXBwb3J0ID0ge1xuICAvLyBCYXNpYyBzdXBwb3J0XG4gIGF1ZGlvOiAnY2FuUGxheVR5cGUnIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2F1ZGlvJyksXG4gIHZpZGVvOiAnY2FuUGxheVR5cGUnIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJyksXG5cbiAgLy8gQ2hlY2sgZm9yIHN1cHBvcnRcbiAgLy8gQmFzaWMgZnVuY3Rpb25hbGl0eSB2cyBmdWxsIFVJXG4gIGNoZWNrKHR5cGUsIHByb3ZpZGVyLCBwbGF5c2lubGluZSkge1xuICAgIGNvbnN0IGNhblBsYXlJbmxpbmUgPSBicm93c2VyLmlzSVBob25lICYmIHBsYXlzaW5saW5lICYmIHN1cHBvcnQucGxheXNpbmxpbmU7XG4gICAgY29uc3QgYXBpID0gc3VwcG9ydFt0eXBlXSB8fCBwcm92aWRlciAhPT0gJ2h0bWw1JztcbiAgICBjb25zdCB1aSA9IGFwaSAmJiBzdXBwb3J0LnJhbmdlSW5wdXQgJiYgKHR5cGUgIT09ICd2aWRlbycgfHwgIWJyb3dzZXIuaXNJUGhvbmUgfHwgY2FuUGxheUlubGluZSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgYXBpLFxuICAgICAgdWksXG4gICAgfTtcbiAgfSxcblxuICAvLyBQaWN0dXJlLWluLXBpY3R1cmUgc3VwcG9ydFxuICAvLyBTYWZhcmkgJiBDaHJvbWUgb25seSBjdXJyZW50bHlcbiAgcGlwOiAoKCkgPT4ge1xuICAgIGlmIChicm93c2VyLmlzSVBob25lKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gU2FmYXJpXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2RvY3VtZW50YXRpb24vd2Via2l0anMvYWRkaW5nX3BpY3R1cmVfaW5fcGljdHVyZV90b195b3VyX3NhZmFyaV9tZWRpYV9jb250cm9sc1xuICAgIGlmIChpcy5mdW5jdGlvbihjcmVhdGVFbGVtZW50KCd2aWRlbycpLndlYmtpdFNldFByZXNlbnRhdGlvbk1vZGUpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBDaHJvbWVcbiAgICAvLyBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS93ZWIvdXBkYXRlcy8yMDE4LzEwL3dhdGNoLXZpZGVvLXVzaW5nLXBpY3R1cmUtaW4tcGljdHVyZVxuICAgIGlmIChkb2N1bWVudC5waWN0dXJlSW5QaWN0dXJlRW5hYmxlZCAmJiAhY3JlYXRlRWxlbWVudCgndmlkZW8nKS5kaXNhYmxlUGljdHVyZUluUGljdHVyZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KSgpLFxuXG4gIC8vIEFpcnBsYXkgc3VwcG9ydFxuICAvLyBTYWZhcmkgb25seSBjdXJyZW50bHlcbiAgYWlycGxheTogaXMuZnVuY3Rpb24od2luZG93LldlYktpdFBsYXliYWNrVGFyZ2V0QXZhaWxhYmlsaXR5RXZlbnQpLFxuXG4gIC8vIElubGluZSBwbGF5YmFjayBzdXBwb3J0XG4gIC8vIGh0dHBzOi8vd2Via2l0Lm9yZy9ibG9nLzY3ODQvbmV3LXZpZGVvLXBvbGljaWVzLWZvci1pb3MvXG4gIHBsYXlzaW5saW5lOiAncGxheXNJbmxpbmUnIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJyksXG5cbiAgLy8gQ2hlY2sgZm9yIG1pbWUgdHlwZSBzdXBwb3J0IGFnYWluc3QgYSBwbGF5ZXIgaW5zdGFuY2VcbiAgLy8gQ3JlZGl0czogaHR0cDovL2RpdmVpbnRvaHRtbDUuaW5mby9ldmVyeXRoaW5nLmh0bWxcbiAgLy8gUmVsYXRlZDogaHR0cDovL3d3dy5sZWFuYmFja3BsYXllci5jb20vdGVzdC9oNW10Lmh0bWxcbiAgbWltZShpbnB1dCkge1xuICAgIGlmIChpcy5lbXB0eShpbnB1dCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBjb25zdCBbbWVkaWFUeXBlXSA9IGlucHV0LnNwbGl0KCcvJyk7XG4gICAgbGV0IHR5cGUgPSBpbnB1dDtcblxuICAgIC8vIFZlcmlmeSB3ZSdyZSB1c2luZyBIVE1MNSBhbmQgdGhlcmUncyBubyBtZWRpYSB0eXBlIG1pc21hdGNoXG4gICAgaWYgKCF0aGlzLmlzSFRNTDUgfHwgbWVkaWFUeXBlICE9PSB0aGlzLnR5cGUpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBBZGQgY29kZWMgaWYgcmVxdWlyZWRcbiAgICBpZiAoT2JqZWN0LmtleXMoZGVmYXVsdENvZGVjcykuaW5jbHVkZXModHlwZSkpIHtcbiAgICAgIHR5cGUgKz0gYDsgY29kZWNzPVwiJHtkZWZhdWx0Q29kZWNzW2lucHV0XX1cImA7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBCb29sZWFuKHR5cGUgJiYgdGhpcy5tZWRpYS5jYW5QbGF5VHlwZSh0eXBlKS5yZXBsYWNlKC9uby8sICcnKSk7XG4gICAgfSBjYXRjaCAoXykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfSxcblxuICAvLyBDaGVjayBmb3IgdGV4dFRyYWNrcyBzdXBwb3J0XG4gIHRleHRUcmFja3M6ICd0ZXh0VHJhY2tzJyBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2aWRlbycpLFxuXG4gIC8vIDxpbnB1dCB0eXBlPVwicmFuZ2VcIj4gU2xpZGVyc1xuICByYW5nZUlucHV0OiAoKCkgPT4ge1xuICAgIGNvbnN0IHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICByYW5nZS50eXBlID0gJ3JhbmdlJztcbiAgICByZXR1cm4gcmFuZ2UudHlwZSA9PT0gJ3JhbmdlJztcbiAgfSkoKSxcblxuICAvLyBUb3VjaFxuICAvLyBOT1RFOiBSZW1lbWJlciBhIGRldmljZSBjYW4gYmUgbW91c2UgKyB0b3VjaCBlbmFibGVkIHNvIHdlIGNoZWNrIG9uIGZpcnN0IHRvdWNoIGV2ZW50XG4gIHRvdWNoOiAnb250b3VjaHN0YXJ0JyBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsXG5cbiAgLy8gRGV0ZWN0IHRyYW5zaXRpb25zIHN1cHBvcnRcbiAgdHJhbnNpdGlvbnM6IHRyYW5zaXRpb25FbmRFdmVudCAhPT0gZmFsc2UsXG5cbiAgLy8gUmVkdWNlZCBtb3Rpb24gaU9TICYgTWFjT1Mgc2V0dGluZ1xuICAvLyBodHRwczovL3dlYmtpdC5vcmcvYmxvZy83NTUxL3Jlc3BvbnNpdmUtZGVzaWduLWZvci1tb3Rpb24vXG4gIHJlZHVjZWRNb3Rpb246ICdtYXRjaE1lZGlhJyBpbiB3aW5kb3cgJiYgd2luZG93Lm1hdGNoTWVkaWEoJyhwcmVmZXJzLXJlZHVjZWQtbW90aW9uKScpLm1hdGNoZXMsXG59O1xuXG5leHBvcnQgZGVmYXVsdCBzdXBwb3J0O1xuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEV2ZW50IHV0aWxzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgaXMgZnJvbSAnLi9pcyc7XG5cbi8vIENoZWNrIGZvciBwYXNzaXZlIGV2ZW50IGxpc3RlbmVyIHN1cHBvcnRcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9XSUNHL0V2ZW50TGlzdGVuZXJPcHRpb25zL2Jsb2IvZ2gtcGFnZXMvZXhwbGFpbmVyLm1kXG4vLyBodHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PU5QTTYxNzJKMjJnXG5jb25zdCBzdXBwb3J0c1Bhc3NpdmVMaXN0ZW5lcnMgPSAoKCkgPT4ge1xuICAvLyBUZXN0IHZpYSBhIGdldHRlciBpbiB0aGUgb3B0aW9ucyBvYmplY3QgdG8gc2VlIGlmIHRoZSBwYXNzaXZlIHByb3BlcnR5IGlzIGFjY2Vzc2VkXG4gIGxldCBzdXBwb3J0ZWQgPSBmYWxzZTtcbiAgdHJ5IHtcbiAgICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAncGFzc2l2ZScsIHtcbiAgICAgIGdldCgpIHtcbiAgICAgICAgc3VwcG9ydGVkID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LFxuICAgIH0pO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0ZXN0JywgbnVsbCwgb3B0aW9ucyk7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Rlc3QnLCBudWxsLCBvcHRpb25zKTtcbiAgfSBjYXRjaCAoXykge1xuICAgIC8vIERvIG5vdGhpbmdcbiAgfVxuXG4gIHJldHVybiBzdXBwb3J0ZWQ7XG59KSgpO1xuXG4vLyBUb2dnbGUgZXZlbnQgbGlzdGVuZXJcbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGVMaXN0ZW5lcihlbGVtZW50LCBldmVudCwgY2FsbGJhY2ssIHRvZ2dsZSA9IGZhbHNlLCBwYXNzaXZlID0gdHJ1ZSwgY2FwdHVyZSA9IGZhbHNlKSB7XG4gIC8vIEJhaWwgaWYgbm8gZWxlbWVudCwgZXZlbnQsIG9yIGNhbGxiYWNrXG4gIGlmICghZWxlbWVudCB8fCAhKCdhZGRFdmVudExpc3RlbmVyJyBpbiBlbGVtZW50KSB8fCBpcy5lbXB0eShldmVudCkgfHwgIWlzLmZ1bmN0aW9uKGNhbGxiYWNrKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIEFsbG93IG11bHRpcGxlIGV2ZW50c1xuICBjb25zdCBldmVudHMgPSBldmVudC5zcGxpdCgnICcpO1xuICAvLyBCdWlsZCBvcHRpb25zXG4gIC8vIERlZmF1bHQgdG8ganVzdCB0aGUgY2FwdHVyZSBib29sZWFuIGZvciBicm93c2VycyB3aXRoIG5vIHBhc3NpdmUgbGlzdGVuZXIgc3VwcG9ydFxuICBsZXQgb3B0aW9ucyA9IGNhcHR1cmU7XG5cbiAgLy8gSWYgcGFzc2l2ZSBldmVudHMgbGlzdGVuZXJzIGFyZSBzdXBwb3J0ZWRcbiAgaWYgKHN1cHBvcnRzUGFzc2l2ZUxpc3RlbmVycykge1xuICAgIG9wdGlvbnMgPSB7XG4gICAgICAvLyBXaGV0aGVyIHRoZSBsaXN0ZW5lciBjYW4gYmUgcGFzc2l2ZSAoaS5lLiBkZWZhdWx0IG5ldmVyIHByZXZlbnRlZClcbiAgICAgIHBhc3NpdmUsXG4gICAgICAvLyBXaGV0aGVyIHRoZSBsaXN0ZW5lciBpcyBhIGNhcHR1cmluZyBsaXN0ZW5lciBvciBub3RcbiAgICAgIGNhcHR1cmUsXG4gICAgfTtcbiAgfVxuXG4gIC8vIElmIGEgc2luZ2xlIG5vZGUgaXMgcGFzc2VkLCBiaW5kIHRoZSBldmVudCBsaXN0ZW5lclxuICBldmVudHMuZm9yRWFjaCgodHlwZSkgPT4ge1xuICAgIGlmICh0aGlzICYmIHRoaXMuZXZlbnRMaXN0ZW5lcnMgJiYgdG9nZ2xlKSB7XG4gICAgICAvLyBDYWNoZSBldmVudCBsaXN0ZW5lclxuICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5wdXNoKHsgZWxlbWVudCwgdHlwZSwgY2FsbGJhY2ssIG9wdGlvbnMgfSk7XG4gICAgfVxuXG4gICAgZWxlbWVudFt0b2dnbGUgPyAnYWRkRXZlbnRMaXN0ZW5lcicgOiAncmVtb3ZlRXZlbnRMaXN0ZW5lciddKHR5cGUsIGNhbGxiYWNrLCBvcHRpb25zKTtcbiAgfSk7XG59XG5cbi8vIEJpbmQgZXZlbnQgaGFuZGxlclxuZXhwb3J0IGZ1bmN0aW9uIG9uKGVsZW1lbnQsIGV2ZW50cyA9ICcnLCBjYWxsYmFjaywgcGFzc2l2ZSA9IHRydWUsIGNhcHR1cmUgPSBmYWxzZSkge1xuICB0b2dnbGVMaXN0ZW5lci5jYWxsKHRoaXMsIGVsZW1lbnQsIGV2ZW50cywgY2FsbGJhY2ssIHRydWUsIHBhc3NpdmUsIGNhcHR1cmUpO1xufVxuXG4vLyBVbmJpbmQgZXZlbnQgaGFuZGxlclxuZXhwb3J0IGZ1bmN0aW9uIG9mZihlbGVtZW50LCBldmVudHMgPSAnJywgY2FsbGJhY2ssIHBhc3NpdmUgPSB0cnVlLCBjYXB0dXJlID0gZmFsc2UpIHtcbiAgdG9nZ2xlTGlzdGVuZXIuY2FsbCh0aGlzLCBlbGVtZW50LCBldmVudHMsIGNhbGxiYWNrLCBmYWxzZSwgcGFzc2l2ZSwgY2FwdHVyZSk7XG59XG5cbi8vIEJpbmQgb25jZS1vbmx5IGV2ZW50IGhhbmRsZXJcbmV4cG9ydCBmdW5jdGlvbiBvbmNlKGVsZW1lbnQsIGV2ZW50cyA9ICcnLCBjYWxsYmFjaywgcGFzc2l2ZSA9IHRydWUsIGNhcHR1cmUgPSBmYWxzZSkge1xuICBjb25zdCBvbmNlQ2FsbGJhY2sgPSAoLi4uYXJncykgPT4ge1xuICAgIG9mZihlbGVtZW50LCBldmVudHMsIG9uY2VDYWxsYmFjaywgcGFzc2l2ZSwgY2FwdHVyZSk7XG4gICAgY2FsbGJhY2suYXBwbHkodGhpcywgYXJncyk7XG4gIH07XG5cbiAgdG9nZ2xlTGlzdGVuZXIuY2FsbCh0aGlzLCBlbGVtZW50LCBldmVudHMsIG9uY2VDYWxsYmFjaywgdHJ1ZSwgcGFzc2l2ZSwgY2FwdHVyZSk7XG59XG5cbi8vIFRyaWdnZXIgZXZlbnRcbmV4cG9ydCBmdW5jdGlvbiB0cmlnZ2VyRXZlbnQoZWxlbWVudCwgdHlwZSA9ICcnLCBidWJibGVzID0gZmFsc2UsIGRldGFpbCA9IHt9KSB7XG4gIC8vIEJhaWwgaWYgbm8gZWxlbWVudFxuICBpZiAoIWlzLmVsZW1lbnQoZWxlbWVudCkgfHwgaXMuZW1wdHkodHlwZSkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBDcmVhdGUgYW5kIGRpc3BhdGNoIHRoZSBldmVudFxuICBjb25zdCBldmVudCA9IG5ldyBDdXN0b21FdmVudCh0eXBlLCB7XG4gICAgYnViYmxlcyxcbiAgICBkZXRhaWw6IHsgLi4uZGV0YWlsLCBwbHlyOiB0aGlzIH0sXG4gIH0pO1xuXG4gIC8vIERpc3BhdGNoIHRoZSBldmVudFxuICBlbGVtZW50LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xufVxuXG4vLyBVbmJpbmQgYWxsIGNhY2hlZCBldmVudCBsaXN0ZW5lcnNcbmV4cG9ydCBmdW5jdGlvbiB1bmJpbmRMaXN0ZW5lcnMoKSB7XG4gIGlmICh0aGlzICYmIHRoaXMuZXZlbnRMaXN0ZW5lcnMpIHtcbiAgICB0aGlzLmV2ZW50TGlzdGVuZXJzLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIGNvbnN0IHsgZWxlbWVudCwgdHlwZSwgY2FsbGJhY2ssIG9wdGlvbnMgfSA9IGl0ZW07XG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgY2FsbGJhY2ssIG9wdGlvbnMpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5ldmVudExpc3RlbmVycyA9IFtdO1xuICB9XG59XG5cbi8vIFJ1biBtZXRob2Qgd2hlbiAvIGlmIHBsYXllciBpcyByZWFkeVxuZXhwb3J0IGZ1bmN0aW9uIHJlYWR5KCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+XG4gICAgdGhpcy5yZWFkeSA/IHNldFRpbWVvdXQocmVzb2x2ZSwgMCkgOiBvbi5jYWxsKHRoaXMsIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCAncmVhZHknLCByZXNvbHZlKSxcbiAgKS50aGVuKCgpID0+IHt9KTtcbn1cbiIsImltcG9ydCBpcyBmcm9tICcuL2lzJztcbi8qKlxuICogU2lsZW5jZSBhIFByb21pc2UtbGlrZSBvYmplY3QuXG4gKiBUaGlzIGlzIHVzZWZ1bCBmb3IgYXZvaWRpbmcgbm9uLWhhcm1mdWwsIGJ1dCBwb3RlbnRpYWxseSBjb25mdXNpbmcgXCJ1bmNhdWdodFxuICogcGxheSBwcm9taXNlXCIgcmVqZWN0aW9uIGVycm9yIG1lc3NhZ2VzLlxuICogQHBhcmFtICB7T2JqZWN0fSB2YWx1ZSBBbiBvYmplY3QgdGhhdCBtYXkgb3IgbWF5IG5vdCBiZSBgUHJvbWlzZWAtbGlrZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNpbGVuY2VQcm9taXNlKHZhbHVlKSB7XG4gIGlmIChpcy5wcm9taXNlKHZhbHVlKSkge1xuICAgIHZhbHVlLnRoZW4obnVsbCwgKCkgPT4ge30pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHsgc2lsZW5jZVByb21pc2UgfTtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBBcnJheSB1dGlsc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IGlzIGZyb20gJy4vaXMnO1xuXG4vLyBSZW1vdmUgZHVwbGljYXRlcyBpbiBhbiBhcnJheVxuZXhwb3J0IGZ1bmN0aW9uIGRlZHVwZShhcnJheSkge1xuICBpZiAoIWlzLmFycmF5KGFycmF5KSkge1xuICAgIHJldHVybiBhcnJheTtcbiAgfVxuXG4gIHJldHVybiBhcnJheS5maWx0ZXIoKGl0ZW0sIGluZGV4KSA9PiBhcnJheS5pbmRleE9mKGl0ZW0pID09PSBpbmRleCk7XG59XG5cbi8vIEdldCB0aGUgY2xvc2VzdCB2YWx1ZSBpbiBhbiBhcnJheVxuZXhwb3J0IGZ1bmN0aW9uIGNsb3Nlc3QoYXJyYXksIHZhbHVlKSB7XG4gIGlmICghaXMuYXJyYXkoYXJyYXkpIHx8ICFhcnJheS5sZW5ndGgpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiBhcnJheS5yZWR1Y2UoKHByZXYsIGN1cnIpID0+IChNYXRoLmFicyhjdXJyIC0gdmFsdWUpIDwgTWF0aC5hYnMocHJldiAtIHZhbHVlKSA/IGN1cnIgOiBwcmV2KSk7XG59XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gU3R5bGUgdXRpbHNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCB7IGNsb3Nlc3QgfSBmcm9tICcuL2FycmF5cyc7XG5pbXBvcnQgaXMgZnJvbSAnLi9pcyc7XG5cbi8vIENoZWNrIHN1cHBvcnQgZm9yIGEgQ1NTIGRlY2xhcmF0aW9uXG5leHBvcnQgZnVuY3Rpb24gc3VwcG9ydHNDU1MoZGVjbGFyYXRpb24pIHtcbiAgaWYgKCF3aW5kb3cgfHwgIXdpbmRvdy5DU1MpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gd2luZG93LkNTUy5zdXBwb3J0cyhkZWNsYXJhdGlvbik7XG59XG5cbi8vIFN0YW5kYXJkL2NvbW1vbiBhc3BlY3QgcmF0aW9zXG5jb25zdCBzdGFuZGFyZFJhdGlvcyA9IFtcbiAgWzEsIDFdLFxuICBbNCwgM10sXG4gIFszLCA0XSxcbiAgWzUsIDRdLFxuICBbNCwgNV0sXG4gIFszLCAyXSxcbiAgWzIsIDNdLFxuICBbMTYsIDEwXSxcbiAgWzEwLCAxNl0sXG4gIFsxNiwgOV0sXG4gIFs5LCAxNl0sXG4gIFsyMSwgOV0sXG4gIFs5LCAyMV0sXG4gIFszMiwgOV0sXG4gIFs5LCAzMl0sXG5dLnJlZHVjZSgob3V0LCBbeCwgeV0pID0+ICh7IC4uLm91dCwgW3ggLyB5XTogW3gsIHldIH0pLCB7fSk7XG5cbi8vIFZhbGlkYXRlIGFuIGFzcGVjdCByYXRpb1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlQXNwZWN0UmF0aW8oaW5wdXQpIHtcbiAgaWYgKCFpcy5hcnJheShpbnB1dCkgJiYgKCFpcy5zdHJpbmcoaW5wdXQpIHx8ICFpbnB1dC5pbmNsdWRlcygnOicpKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IHJhdGlvID0gaXMuYXJyYXkoaW5wdXQpID8gaW5wdXQgOiBpbnB1dC5zcGxpdCgnOicpO1xuXG4gIHJldHVybiByYXRpby5tYXAoTnVtYmVyKS5ldmVyeShpcy5udW1iZXIpO1xufVxuXG4vLyBSZWR1Y2UgYW4gYXNwZWN0IHJhdGlvIHRvIGl0J3MgbG93ZXN0IGZvcm1cbmV4cG9ydCBmdW5jdGlvbiByZWR1Y2VBc3BlY3RSYXRpbyhyYXRpbykge1xuICBpZiAoIWlzLmFycmF5KHJhdGlvKSB8fCAhcmF0aW8uZXZlcnkoaXMubnVtYmVyKSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgY29uc3QgW3dpZHRoLCBoZWlnaHRdID0gcmF0aW87XG4gIGNvbnN0IGdldERpdmlkZXIgPSAodywgaCkgPT4gKGggPT09IDAgPyB3IDogZ2V0RGl2aWRlcihoLCB3ICUgaCkpO1xuICBjb25zdCBkaXZpZGVyID0gZ2V0RGl2aWRlcih3aWR0aCwgaGVpZ2h0KTtcblxuICByZXR1cm4gW3dpZHRoIC8gZGl2aWRlciwgaGVpZ2h0IC8gZGl2aWRlcl07XG59XG5cbi8vIENhbGN1bGF0ZSBhbiBhc3BlY3QgcmF0aW9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBc3BlY3RSYXRpbyhpbnB1dCkge1xuICBjb25zdCBwYXJzZSA9IChyYXRpbykgPT4gKHZhbGlkYXRlQXNwZWN0UmF0aW8ocmF0aW8pID8gcmF0aW8uc3BsaXQoJzonKS5tYXAoTnVtYmVyKSA6IG51bGwpO1xuICAvLyBUcnkgcHJvdmlkZWQgcmF0aW9cbiAgbGV0IHJhdGlvID0gcGFyc2UoaW5wdXQpO1xuXG4gIC8vIEdldCBmcm9tIGNvbmZpZ1xuICBpZiAocmF0aW8gPT09IG51bGwpIHtcbiAgICByYXRpbyA9IHBhcnNlKHRoaXMuY29uZmlnLnJhdGlvKTtcbiAgfVxuXG4gIC8vIEdldCBmcm9tIGVtYmVkXG4gIGlmIChyYXRpbyA9PT0gbnVsbCAmJiAhaXMuZW1wdHkodGhpcy5lbWJlZCkgJiYgaXMuYXJyYXkodGhpcy5lbWJlZC5yYXRpbykpIHtcbiAgICAoeyByYXRpbyB9ID0gdGhpcy5lbWJlZCk7XG4gIH1cblxuICAvLyBHZXQgZnJvbSBIVE1MNSB2aWRlb1xuICBpZiAocmF0aW8gPT09IG51bGwgJiYgdGhpcy5pc0hUTUw1KSB7XG4gICAgY29uc3QgeyB2aWRlb1dpZHRoLCB2aWRlb0hlaWdodCB9ID0gdGhpcy5tZWRpYTtcbiAgICByYXRpbyA9IFt2aWRlb1dpZHRoLCB2aWRlb0hlaWdodF07XG4gIH1cblxuICByZXR1cm4gcmVkdWNlQXNwZWN0UmF0aW8ocmF0aW8pO1xufVxuXG4vLyBTZXQgYXNwZWN0IHJhdGlvIGZvciByZXNwb25zaXZlIGNvbnRhaW5lclxuZXhwb3J0IGZ1bmN0aW9uIHNldEFzcGVjdFJhdGlvKGlucHV0KSB7XG4gIGlmICghdGhpcy5pc1ZpZGVvKSB7XG4gICAgcmV0dXJuIHt9O1xuICB9XG5cbiAgY29uc3QgeyB3cmFwcGVyIH0gPSB0aGlzLmVsZW1lbnRzO1xuICBjb25zdCByYXRpbyA9IGdldEFzcGVjdFJhdGlvLmNhbGwodGhpcywgaW5wdXQpO1xuXG4gIGlmICghaXMuYXJyYXkocmF0aW8pKSB7XG4gICAgcmV0dXJuIHt9O1xuICB9XG5cbiAgY29uc3QgW3gsIHldID0gcmVkdWNlQXNwZWN0UmF0aW8ocmF0aW8pO1xuICBjb25zdCB1c2VOYXRpdmUgPSBzdXBwb3J0c0NTUyhgYXNwZWN0LXJhdGlvOiAke3h9LyR7eX1gKTtcbiAgY29uc3QgcGFkZGluZyA9ICgxMDAgLyB4KSAqIHk7XG5cbiAgaWYgKHVzZU5hdGl2ZSkge1xuICAgIHdyYXBwZXIuc3R5bGUuYXNwZWN0UmF0aW8gPSBgJHt4fS8ke3l9YDtcbiAgfSBlbHNlIHtcbiAgICB3cmFwcGVyLnN0eWxlLnBhZGRpbmdCb3R0b20gPSBgJHtwYWRkaW5nfSVgO1xuICB9XG5cbiAgLy8gRm9yIFZpbWVvIHdlIGhhdmUgYW4gZXh0cmEgPGRpdj4gdG8gaGlkZSB0aGUgc3RhbmRhcmQgY29udHJvbHMgYW5kIFVJXG4gIGlmICh0aGlzLmlzVmltZW8gJiYgIXRoaXMuY29uZmlnLnZpbWVvLnByZW1pdW0gJiYgdGhpcy5zdXBwb3J0ZWQudWkpIHtcbiAgICBjb25zdCBoZWlnaHQgPSAoMTAwIC8gdGhpcy5tZWRpYS5vZmZzZXRXaWR0aCkgKiBwYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLm1lZGlhKS5wYWRkaW5nQm90dG9tLCAxMCk7XG4gICAgY29uc3Qgb2Zmc2V0ID0gKGhlaWdodCAtIHBhZGRpbmcpIC8gKGhlaWdodCAvIDUwKTtcblxuICAgIGlmICh0aGlzLmZ1bGxzY3JlZW4uYWN0aXZlKSB7XG4gICAgICB3cmFwcGVyLnN0eWxlLnBhZGRpbmdCb3R0b20gPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1lZGlhLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVZKC0ke29mZnNldH0lKWA7XG4gICAgfVxuICB9IGVsc2UgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZCh0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnZpZGVvRml4ZWRSYXRpbyk7XG4gIH1cblxuICByZXR1cm4geyBwYWRkaW5nLCByYXRpbyB9O1xufVxuXG4vLyBSb3VuZCBhbiBhc3BlY3QgcmF0aW8gdG8gY2xvc2VzdCBzdGFuZGFyZCByYXRpb1xuZXhwb3J0IGZ1bmN0aW9uIHJvdW5kQXNwZWN0UmF0aW8oeCwgeSwgdG9sZXJhbmNlID0gMC4wNSkge1xuICBjb25zdCByYXRpbyA9IHggLyB5O1xuICBjb25zdCBjbG9zZXN0UmF0aW8gPSBjbG9zZXN0KE9iamVjdC5rZXlzKHN0YW5kYXJkUmF0aW9zKSwgcmF0aW8pO1xuXG4gIC8vIENoZWNrIG1hdGNoIGlzIHdpdGhpbiB0b2xlcmFuY2VcbiAgaWYgKE1hdGguYWJzKGNsb3Nlc3RSYXRpbyAtIHJhdGlvKSA8PSB0b2xlcmFuY2UpIHtcbiAgICByZXR1cm4gc3RhbmRhcmRSYXRpb3NbY2xvc2VzdFJhdGlvXTtcbiAgfVxuXG4gIC8vIE5vIG1hdGNoXG4gIHJldHVybiBbeCwgeV07XG59XG5cbi8vIEdldCB0aGUgc2l6ZSBvZiB0aGUgdmlld3BvcnRcbi8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEyNDgwODEvaG93LXRvLWdldC10aGUtYnJvd3Nlci12aWV3cG9ydC1kaW1lbnNpb25zXG5leHBvcnQgZnVuY3Rpb24gZ2V0Vmlld3BvcnRTaXplKCkge1xuICBjb25zdCB3aWR0aCA9IE1hdGgubWF4KGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCB8fCAwLCB3aW5kb3cuaW5uZXJXaWR0aCB8fCAwKTtcbiAgY29uc3QgaGVpZ2h0ID0gTWF0aC5tYXgoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCB8fCAwLCB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgMCk7XG4gIHJldHVybiBbd2lkdGgsIGhlaWdodF07XG59XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUGx5ciBIVE1MNSBoZWxwZXJzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgc3VwcG9ydCBmcm9tICcuL3N1cHBvcnQnO1xuaW1wb3J0IHsgcmVtb3ZlRWxlbWVudCB9IGZyb20gJy4vdXRpbHMvZWxlbWVudHMnO1xuaW1wb3J0IHsgdHJpZ2dlckV2ZW50IH0gZnJvbSAnLi91dGlscy9ldmVudHMnO1xuaW1wb3J0IGlzIGZyb20gJy4vdXRpbHMvaXMnO1xuaW1wb3J0IHsgc2lsZW5jZVByb21pc2UgfSBmcm9tICcuL3V0aWxzL3Byb21pc2UnO1xuaW1wb3J0IHsgc2V0QXNwZWN0UmF0aW8gfSBmcm9tICcuL3V0aWxzL3N0eWxlJztcblxuY29uc3QgaHRtbDUgPSB7XG4gIGdldFNvdXJjZXMoKSB7XG4gICAgaWYgKCF0aGlzLmlzSFRNTDUpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBjb25zdCBzb3VyY2VzID0gQXJyYXkuZnJvbSh0aGlzLm1lZGlhLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NvdXJjZScpKTtcblxuICAgIC8vIEZpbHRlciBvdXQgdW5zdXBwb3J0ZWQgc291cmNlcyAoaWYgdHlwZSBpcyBzcGVjaWZpZWQpXG4gICAgcmV0dXJuIHNvdXJjZXMuZmlsdGVyKChzb3VyY2UpID0+IHtcbiAgICAgIGNvbnN0IHR5cGUgPSBzb3VyY2UuZ2V0QXR0cmlidXRlKCd0eXBlJyk7XG5cbiAgICAgIGlmIChpcy5lbXB0eSh0eXBlKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHN1cHBvcnQubWltZS5jYWxsKHRoaXMsIHR5cGUpO1xuICAgIH0pO1xuICB9LFxuXG4gIC8vIEdldCBxdWFsaXR5IGxldmVsc1xuICBnZXRRdWFsaXR5T3B0aW9ucygpIHtcbiAgICAvLyBXaGV0aGVyIHdlJ3JlIGZvcmNpbmcgYWxsIG9wdGlvbnMgKGUuZy4gZm9yIHN0cmVhbWluZylcbiAgICBpZiAodGhpcy5jb25maWcucXVhbGl0eS5mb3JjZWQpIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbmZpZy5xdWFsaXR5Lm9wdGlvbnM7XG4gICAgfVxuXG4gICAgLy8gR2V0IHNpemVzIGZyb20gPHNvdXJjZT4gZWxlbWVudHNcbiAgICByZXR1cm4gaHRtbDUuZ2V0U291cmNlc1xuICAgICAgLmNhbGwodGhpcylcbiAgICAgIC5tYXAoKHNvdXJjZSkgPT4gTnVtYmVyKHNvdXJjZS5nZXRBdHRyaWJ1dGUoJ3NpemUnKSkpXG4gICAgICAuZmlsdGVyKEJvb2xlYW4pO1xuICB9LFxuXG4gIHNldHVwKCkge1xuICAgIGlmICghdGhpcy5pc0hUTUw1KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgcGxheWVyID0gdGhpcztcblxuICAgIC8vIFNldCBzcGVlZCBvcHRpb25zIGZyb20gY29uZmlnXG4gICAgcGxheWVyLm9wdGlvbnMuc3BlZWQgPSBwbGF5ZXIuY29uZmlnLnNwZWVkLm9wdGlvbnM7XG5cbiAgICAvLyBTZXQgYXNwZWN0IHJhdGlvIGlmIGZpeGVkXG4gICAgaWYgKCFpcy5lbXB0eSh0aGlzLmNvbmZpZy5yYXRpbykpIHtcbiAgICAgIHNldEFzcGVjdFJhdGlvLmNhbGwocGxheWVyKTtcbiAgICB9XG5cbiAgICAvLyBRdWFsaXR5XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ3F1YWxpdHknLCB7XG4gICAgICBnZXQoKSB7XG4gICAgICAgIC8vIEdldCBzb3VyY2VzXG4gICAgICAgIGNvbnN0IHNvdXJjZXMgPSBodG1sNS5nZXRTb3VyY2VzLmNhbGwocGxheWVyKTtcbiAgICAgICAgY29uc3Qgc291cmNlID0gc291cmNlcy5maW5kKChzKSA9PiBzLmdldEF0dHJpYnV0ZSgnc3JjJykgPT09IHBsYXllci5zb3VyY2UpO1xuXG4gICAgICAgIC8vIFJldHVybiBzaXplLCBpZiBtYXRjaCBpcyBmb3VuZFxuICAgICAgICByZXR1cm4gc291cmNlICYmIE51bWJlcihzb3VyY2UuZ2V0QXR0cmlidXRlKCdzaXplJykpO1xuICAgICAgfSxcbiAgICAgIHNldChpbnB1dCkge1xuICAgICAgICBpZiAocGxheWVyLnF1YWxpdHkgPT09IGlucHV0KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgd2UncmUgdXNpbmcgYW4gZXh0ZXJuYWwgaGFuZGxlci4uLlxuICAgICAgICBpZiAocGxheWVyLmNvbmZpZy5xdWFsaXR5LmZvcmNlZCAmJiBpcy5mdW5jdGlvbihwbGF5ZXIuY29uZmlnLnF1YWxpdHkub25DaGFuZ2UpKSB7XG4gICAgICAgICAgcGxheWVyLmNvbmZpZy5xdWFsaXR5Lm9uQ2hhbmdlKGlucHV0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBHZXQgc291cmNlc1xuICAgICAgICAgIGNvbnN0IHNvdXJjZXMgPSBodG1sNS5nZXRTb3VyY2VzLmNhbGwocGxheWVyKTtcbiAgICAgICAgICAvLyBHZXQgZmlyc3QgbWF0Y2ggZm9yIHJlcXVlc3RlZCBzaXplXG4gICAgICAgICAgY29uc3Qgc291cmNlID0gc291cmNlcy5maW5kKChzKSA9PiBOdW1iZXIocy5nZXRBdHRyaWJ1dGUoJ3NpemUnKSkgPT09IGlucHV0KTtcblxuICAgICAgICAgIC8vIE5vIG1hdGNoaW5nIHNvdXJjZSBmb3VuZFxuICAgICAgICAgIGlmICghc291cmNlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gR2V0IGN1cnJlbnQgc3RhdGVcbiAgICAgICAgICBjb25zdCB7IGN1cnJlbnRUaW1lLCBwYXVzZWQsIHByZWxvYWQsIHJlYWR5U3RhdGUsIHBsYXliYWNrUmF0ZSB9ID0gcGxheWVyLm1lZGlhO1xuXG4gICAgICAgICAgLy8gU2V0IG5ldyBzb3VyY2VcbiAgICAgICAgICBwbGF5ZXIubWVkaWEuc3JjID0gc291cmNlLmdldEF0dHJpYnV0ZSgnc3JjJyk7XG5cbiAgICAgICAgICAvLyBQcmV2ZW50IGxvYWRpbmcgaWYgcHJlbG9hZD1cIm5vbmVcIiBhbmQgdGhlIGN1cnJlbnQgc291cmNlIGlzbid0IGxvYWRlZCAoIzEwNDQpXG4gICAgICAgICAgaWYgKHByZWxvYWQgIT09ICdub25lJyB8fCByZWFkeVN0YXRlKSB7XG4gICAgICAgICAgICAvLyBSZXN0b3JlIHRpbWVcbiAgICAgICAgICAgIHBsYXllci5vbmNlKCdsb2FkZWRtZXRhZGF0YScsICgpID0+IHtcbiAgICAgICAgICAgICAgcGxheWVyLnNwZWVkID0gcGxheWJhY2tSYXRlO1xuICAgICAgICAgICAgICBwbGF5ZXIuY3VycmVudFRpbWUgPSBjdXJyZW50VGltZTtcblxuICAgICAgICAgICAgICAvLyBSZXN1bWUgcGxheWluZ1xuICAgICAgICAgICAgICBpZiAoIXBhdXNlZCkge1xuICAgICAgICAgICAgICAgIHNpbGVuY2VQcm9taXNlKHBsYXllci5wbGF5KCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gTG9hZCBuZXcgc291cmNlXG4gICAgICAgICAgICBwbGF5ZXIubWVkaWEubG9hZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyaWdnZXIgY2hhbmdlIGV2ZW50XG4gICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncXVhbGl0eWNoYW5nZScsIGZhbHNlLCB7XG4gICAgICAgICAgcXVhbGl0eTogaW5wdXQsXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfSxcblxuICAvLyBDYW5jZWwgY3VycmVudCBuZXR3b3JrIHJlcXVlc3RzXG4gIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vc2FtcG90dHMvcGx5ci9pc3N1ZXMvMTc0XG4gIGNhbmNlbFJlcXVlc3RzKCkge1xuICAgIGlmICghdGhpcy5pc0hUTUw1KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlIGNoaWxkIHNvdXJjZXNcbiAgICByZW1vdmVFbGVtZW50KGh0bWw1LmdldFNvdXJjZXMuY2FsbCh0aGlzKSk7XG5cbiAgICAvLyBTZXQgYmxhbmsgdmlkZW8gc3JjIGF0dHJpYnV0ZVxuICAgIC8vIFRoaXMgaXMgdG8gcHJldmVudCBhIE1FRElBX0VSUl9TUkNfTk9UX1NVUFBPUlRFRCBlcnJvclxuICAgIC8vIEluZm86IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzIyMzE1NzkvaG93LXRvLXByb3Blcmx5LWRpc3Bvc2Utb2YtYW4taHRtbDUtdmlkZW8tYW5kLWNsb3NlLXNvY2tldC1vci1jb25uZWN0aW9uXG4gICAgdGhpcy5tZWRpYS5zZXRBdHRyaWJ1dGUoJ3NyYycsIHRoaXMuY29uZmlnLmJsYW5rVmlkZW8pO1xuXG4gICAgLy8gTG9hZCB0aGUgbmV3IGVtcHR5IHNvdXJjZVxuICAgIC8vIFRoaXMgd2lsbCBjYW5jZWwgZXhpc3RpbmcgcmVxdWVzdHNcbiAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzE3NFxuICAgIHRoaXMubWVkaWEubG9hZCgpO1xuXG4gICAgLy8gRGVidWdnaW5nXG4gICAgdGhpcy5kZWJ1Zy5sb2coJ0NhbmNlbGxlZCBuZXR3b3JrIHJlcXVlc3RzJyk7XG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCBodG1sNTtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBTdHJpbmcgdXRpbHNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBpcyBmcm9tICcuL2lzJztcblxuLy8gR2VuZXJhdGUgYSByYW5kb20gSURcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUlkKHByZWZpeCkge1xuICByZXR1cm4gYCR7cHJlZml4fS0ke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKX1gO1xufVxuXG4vLyBGb3JtYXQgc3RyaW5nXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0KGlucHV0LCAuLi5hcmdzKSB7XG4gIGlmIChpcy5lbXB0eShpbnB1dCkpIHJldHVybiBpbnB1dDtcblxuICByZXR1cm4gaW5wdXQudG9TdHJpbmcoKS5yZXBsYWNlKC97KFxcZCspfS9nLCAobWF0Y2gsIGkpID0+IGFyZ3NbaV0udG9TdHJpbmcoKSk7XG59XG5cbi8vIEdldCBwZXJjZW50YWdlXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGVyY2VudGFnZShjdXJyZW50LCBtYXgpIHtcbiAgaWYgKGN1cnJlbnQgPT09IDAgfHwgbWF4ID09PSAwIHx8IE51bWJlci5pc05hTihjdXJyZW50KSB8fCBOdW1iZXIuaXNOYU4obWF4KSkge1xuICAgIHJldHVybiAwO1xuICB9XG5cbiAgcmV0dXJuICgoY3VycmVudCAvIG1heCkgKiAxMDApLnRvRml4ZWQoMik7XG59XG5cbi8vIFJlcGxhY2UgYWxsIG9jY3VycmVuY2VzIG9mIGEgc3RyaW5nIGluIGEgc3RyaW5nXG5leHBvcnQgY29uc3QgcmVwbGFjZUFsbCA9IChpbnB1dCA9ICcnLCBmaW5kID0gJycsIHJlcGxhY2UgPSAnJykgPT5cbiAgaW5wdXQucmVwbGFjZShuZXcgUmVnRXhwKGZpbmQudG9TdHJpbmcoKS5yZXBsYWNlKC8oWy4qKz9ePSE6JHt9KCl8W1xcXS9cXFxcXSkvZywgJ1xcXFwkMScpLCAnZycpLCByZXBsYWNlLnRvU3RyaW5nKCkpO1xuXG4vLyBDb252ZXJ0IHRvIHRpdGxlIGNhc2VcbmV4cG9ydCBjb25zdCB0b1RpdGxlQ2FzZSA9IChpbnB1dCA9ICcnKSA9PlxuICBpbnB1dC50b1N0cmluZygpLnJlcGxhY2UoL1xcd1xcUyovZywgKHRleHQpID0+IHRleHQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0ZXh0LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCkpO1xuXG4vLyBDb252ZXJ0IHN0cmluZyB0byBwYXNjYWxDYXNlXG5leHBvcnQgZnVuY3Rpb24gdG9QYXNjYWxDYXNlKGlucHV0ID0gJycpIHtcbiAgbGV0IHN0cmluZyA9IGlucHV0LnRvU3RyaW5nKCk7XG5cbiAgLy8gQ29udmVydCBrZWJhYiBjYXNlXG4gIHN0cmluZyA9IHJlcGxhY2VBbGwoc3RyaW5nLCAnLScsICcgJyk7XG5cbiAgLy8gQ29udmVydCBzbmFrZSBjYXNlXG4gIHN0cmluZyA9IHJlcGxhY2VBbGwoc3RyaW5nLCAnXycsICcgJyk7XG5cbiAgLy8gQ29udmVydCB0byB0aXRsZSBjYXNlXG4gIHN0cmluZyA9IHRvVGl0bGVDYXNlKHN0cmluZyk7XG5cbiAgLy8gQ29udmVydCB0byBwYXNjYWwgY2FzZVxuICByZXR1cm4gcmVwbGFjZUFsbChzdHJpbmcsICcgJywgJycpO1xufVxuXG4vLyBDb252ZXJ0IHN0cmluZyB0byBwYXNjYWxDYXNlXG5leHBvcnQgZnVuY3Rpb24gdG9DYW1lbENhc2UoaW5wdXQgPSAnJykge1xuICBsZXQgc3RyaW5nID0gaW5wdXQudG9TdHJpbmcoKTtcblxuICAvLyBDb252ZXJ0IHRvIHBhc2NhbCBjYXNlXG4gIHN0cmluZyA9IHRvUGFzY2FsQ2FzZShzdHJpbmcpO1xuXG4gIC8vIENvbnZlcnQgZmlyc3QgY2hhcmFjdGVyIHRvIGxvd2VyY2FzZVxuICByZXR1cm4gc3RyaW5nLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpICsgc3RyaW5nLnNsaWNlKDEpO1xufVxuXG4vLyBSZW1vdmUgSFRNTCBmcm9tIGEgc3RyaW5nXG5leHBvcnQgZnVuY3Rpb24gc3RyaXBIVE1MKHNvdXJjZSkge1xuICBjb25zdCBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBmcmFnbWVudC5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgZWxlbWVudC5pbm5lckhUTUwgPSBzb3VyY2U7XG4gIHJldHVybiBmcmFnbWVudC5maXJzdENoaWxkLmlubmVyVGV4dDtcbn1cblxuLy8gTGlrZSBvdXRlckhUTUwsIGJ1dCBhbHNvIHdvcmtzIGZvciBEb2N1bWVudEZyYWdtZW50XG5leHBvcnQgZnVuY3Rpb24gZ2V0SFRNTChlbGVtZW50KSB7XG4gIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgd3JhcHBlci5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgcmV0dXJuIHdyYXBwZXIuaW5uZXJIVE1MO1xufVxuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBseXIgaW50ZXJuYXRpb25hbGl6YXRpb25cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBpcyBmcm9tICcuL2lzJztcbmltcG9ydCB7IGdldERlZXAgfSBmcm9tICcuL29iamVjdHMnO1xuaW1wb3J0IHsgcmVwbGFjZUFsbCB9IGZyb20gJy4vc3RyaW5ncyc7XG5cbi8vIFNraXAgaTE4biBmb3IgYWJicmV2aWF0aW9ucyBhbmQgYnJhbmQgbmFtZXNcbmNvbnN0IHJlc291cmNlcyA9IHtcbiAgcGlwOiAnUElQJyxcbiAgYWlycGxheTogJ0FpclBsYXknLFxuICBodG1sNTogJ0hUTUw1JyxcbiAgdmltZW86ICdWaW1lbycsXG4gIHlvdXR1YmU6ICdZb3VUdWJlJyxcbn07XG5cbmNvbnN0IGkxOG4gPSB7XG4gIGdldChrZXkgPSAnJywgY29uZmlnID0ge30pIHtcbiAgICBpZiAoaXMuZW1wdHkoa2V5KSB8fCBpcy5lbXB0eShjb25maWcpKSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuXG4gICAgbGV0IHN0cmluZyA9IGdldERlZXAoY29uZmlnLmkxOG4sIGtleSk7XG5cbiAgICBpZiAoaXMuZW1wdHkoc3RyaW5nKSkge1xuICAgICAgaWYgKE9iamVjdC5rZXlzKHJlc291cmNlcykuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgICByZXR1cm4gcmVzb3VyY2VzW2tleV07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICBjb25zdCByZXBsYWNlID0ge1xuICAgICAgJ3tzZWVrdGltZX0nOiBjb25maWcuc2Vla1RpbWUsXG4gICAgICAne3RpdGxlfSc6IGNvbmZpZy50aXRsZSxcbiAgICB9O1xuXG4gICAgT2JqZWN0LmVudHJpZXMocmVwbGFjZSkuZm9yRWFjaCgoW2ssIHZdKSA9PiB7XG4gICAgICBzdHJpbmcgPSByZXBsYWNlQWxsKHN0cmluZywgaywgdik7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3RyaW5nO1xuICB9LFxufTtcblxuZXhwb3J0IGRlZmF1bHQgaTE4bjtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQbHlyIHN0b3JhZ2Vcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBpcyBmcm9tICcuL3V0aWxzL2lzJztcbmltcG9ydCB7IGV4dGVuZCB9IGZyb20gJy4vdXRpbHMvb2JqZWN0cyc7XG5cbmNsYXNzIFN0b3JhZ2Uge1xuICBjb25zdHJ1Y3RvcihwbGF5ZXIpIHtcbiAgICB0aGlzLmVuYWJsZWQgPSBwbGF5ZXIuY29uZmlnLnN0b3JhZ2UuZW5hYmxlZDtcbiAgICB0aGlzLmtleSA9IHBsYXllci5jb25maWcuc3RvcmFnZS5rZXk7XG4gIH1cblxuICAvLyBDaGVjayBmb3IgYWN0dWFsIHN1cHBvcnQgKHNlZSBpZiB3ZSBjYW4gdXNlIGl0KVxuICBzdGF0aWMgZ2V0IHN1cHBvcnRlZCgpIHtcbiAgICB0cnkge1xuICAgICAgaWYgKCEoJ2xvY2FsU3RvcmFnZScgaW4gd2luZG93KSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRlc3QgPSAnX19fdGVzdCc7XG5cbiAgICAgIC8vIFRyeSB0byB1c2UgaXQgKGl0IG1pZ2h0IGJlIGRpc2FibGVkLCBlLmcuIHVzZXIgaXMgaW4gcHJpdmF0ZSBtb2RlKVxuICAgICAgLy8gc2VlOiBodHRwczovL2dpdGh1Yi5jb20vc2FtcG90dHMvcGx5ci9pc3N1ZXMvMTMxXG4gICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0odGVzdCwgdGVzdCk7XG4gICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0odGVzdCk7XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBnZXQgPSAoa2V5KSA9PiB7XG4gICAgaWYgKCFTdG9yYWdlLnN1cHBvcnRlZCB8fCAhdGhpcy5lbmFibGVkKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBzdG9yZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmtleSk7XG5cbiAgICBpZiAoaXMuZW1wdHkoc3RvcmUpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZShzdG9yZSk7XG5cbiAgICByZXR1cm4gaXMuc3RyaW5nKGtleSkgJiYga2V5Lmxlbmd0aCA/IGpzb25ba2V5XSA6IGpzb247XG4gIH07XG5cbiAgc2V0ID0gKG9iamVjdCkgPT4ge1xuICAgIC8vIEJhaWwgaWYgd2UgZG9uJ3QgaGF2ZSBsb2NhbFN0b3JhZ2Ugc3VwcG9ydCBvciBpdCdzIGRpc2FibGVkXG4gICAgaWYgKCFTdG9yYWdlLnN1cHBvcnRlZCB8fCAhdGhpcy5lbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ2FuIG9ubHkgc3RvcmUgb2JqZWN0c3RcbiAgICBpZiAoIWlzLm9iamVjdChvYmplY3QpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gR2V0IGN1cnJlbnQgc3RvcmFnZVxuICAgIGxldCBzdG9yYWdlID0gdGhpcy5nZXQoKTtcblxuICAgIC8vIERlZmF1bHQgdG8gZW1wdHkgb2JqZWN0XG4gICAgaWYgKGlzLmVtcHR5KHN0b3JhZ2UpKSB7XG4gICAgICBzdG9yYWdlID0ge307XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHRoZSB3b3JraW5nIGNvcHkgb2YgdGhlIHZhbHVlc1xuICAgIGV4dGVuZChzdG9yYWdlLCBvYmplY3QpO1xuXG4gICAgLy8gVXBkYXRlIHN0b3JhZ2VcbiAgICB0cnkge1xuICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKHRoaXMua2V5LCBKU09OLnN0cmluZ2lmeShzdG9yYWdlKSk7XG4gICAgfSBjYXRjaCAoXykge1xuICAgICAgLy8gRG8gbm90aGluZ1xuICAgIH1cbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgU3RvcmFnZTtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBGZXRjaCB3cmFwcGVyXG4vLyBVc2luZyBYSFIgdG8gYXZvaWQgaXNzdWVzIHdpdGggb2xkZXIgYnJvd3NlcnNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGZldGNoKHVybCwgcmVzcG9uc2VUeXBlID0gJ3RleHQnKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgICAgLy8gQ2hlY2sgZm9yIENPUlMgc3VwcG9ydFxuICAgICAgaWYgKCEoJ3dpdGhDcmVkZW50aWFscycgaW4gcmVxdWVzdCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4gICAgICAgIGlmIChyZXNwb25zZVR5cGUgPT09ICd0ZXh0Jykge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXNvbHZlKEpTT04ucGFyc2UocmVxdWVzdC5yZXNwb25zZVRleHQpKTtcbiAgICAgICAgICB9IGNhdGNoIChfKSB7XG4gICAgICAgICAgICByZXNvbHZlKHJlcXVlc3QucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzb2x2ZShyZXF1ZXN0LnJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCAoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihyZXF1ZXN0LnN0YXR1cyk7XG4gICAgICB9KTtcblxuICAgICAgcmVxdWVzdC5vcGVuKCdHRVQnLCB1cmwsIHRydWUpO1xuXG4gICAgICAvLyBTZXQgdGhlIHJlcXVpcmVkIHJlc3BvbnNlIHR5cGVcbiAgICAgIHJlcXVlc3QucmVzcG9uc2VUeXBlID0gcmVzcG9uc2VUeXBlO1xuXG4gICAgICByZXF1ZXN0LnNlbmQoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICB9XG4gIH0pO1xufVxuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFNwcml0ZSBsb2FkZXJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBTdG9yYWdlIGZyb20gJy4uL3N0b3JhZ2UnO1xuaW1wb3J0IGZldGNoIGZyb20gJy4vZmV0Y2gnO1xuaW1wb3J0IGlzIGZyb20gJy4vaXMnO1xuXG4vLyBMb2FkIGFuIGV4dGVybmFsIFNWRyBzcHJpdGVcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGxvYWRTcHJpdGUodXJsLCBpZCkge1xuICBpZiAoIWlzLnN0cmluZyh1cmwpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgcHJlZml4ID0gJ2NhY2hlJztcbiAgY29uc3QgaGFzSWQgPSBpcy5zdHJpbmcoaWQpO1xuICBsZXQgaXNDYWNoZWQgPSBmYWxzZTtcbiAgY29uc3QgZXhpc3RzID0gKCkgPT4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpICE9PSBudWxsO1xuXG4gIGNvbnN0IHVwZGF0ZSA9IChjb250YWluZXIsIGRhdGEpID0+IHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICBjb250YWluZXIuaW5uZXJIVE1MID0gZGF0YTtcblxuICAgIC8vIENoZWNrIGFnYWluIGluY2FzZSBvZiByYWNlIGNvbmRpdGlvblxuICAgIGlmIChoYXNJZCAmJiBleGlzdHMoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEluamVjdCB0aGUgU1ZHIHRvIHRoZSBib2R5XG4gICAgZG9jdW1lbnQuYm9keS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBjb250YWluZXIpO1xuICB9O1xuXG4gIC8vIE9ubHkgbG9hZCBvbmNlIGlmIElEIHNldFxuICBpZiAoIWhhc0lkIHx8ICFleGlzdHMoKSkge1xuICAgIGNvbnN0IHVzZVN0b3JhZ2UgPSBTdG9yYWdlLnN1cHBvcnRlZDtcbiAgICAvLyBDcmVhdGUgY29udGFpbmVyXG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnaGlkZGVuJywgJycpO1xuXG4gICAgaWYgKGhhc0lkKSB7XG4gICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCdpZCcsIGlkKTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpbiBjYWNoZVxuICAgIGlmICh1c2VTdG9yYWdlKSB7XG4gICAgICBjb25zdCBjYWNoZWQgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oYCR7cHJlZml4fS0ke2lkfWApO1xuICAgICAgaXNDYWNoZWQgPSBjYWNoZWQgIT09IG51bGw7XG5cbiAgICAgIGlmIChpc0NhY2hlZCkge1xuICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShjYWNoZWQpO1xuICAgICAgICB1cGRhdGUoY29udGFpbmVyLCBkYXRhLmNvbnRlbnQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEdldCB0aGUgc3ByaXRlXG4gICAgZmV0Y2godXJsKVxuICAgICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICBpZiAoaXMuZW1wdHkocmVzdWx0KSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh1c2VTdG9yYWdlKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcbiAgICAgICAgICAgICAgYCR7cHJlZml4fS0ke2lkfWAsXG4gICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBjb250ZW50OiByZXN1bHQsXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9IGNhdGNoIChfKSB7XG4gICAgICAgICAgICAvLyBEbyBub3RoaW5nXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdXBkYXRlKGNvbnRhaW5lciwgcmVzdWx0KTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKCkgPT4ge30pO1xuICB9XG59XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVGltZSB1dGlsc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IGlzIGZyb20gJy4vaXMnO1xuXG4vLyBUaW1lIGhlbHBlcnNcbmV4cG9ydCBjb25zdCBnZXRIb3VycyA9ICh2YWx1ZSkgPT4gTWF0aC50cnVuYygodmFsdWUgLyA2MCAvIDYwKSAlIDYwLCAxMCk7XG5leHBvcnQgY29uc3QgZ2V0TWludXRlcyA9ICh2YWx1ZSkgPT4gTWF0aC50cnVuYygodmFsdWUgLyA2MCkgJSA2MCwgMTApO1xuZXhwb3J0IGNvbnN0IGdldFNlY29uZHMgPSAodmFsdWUpID0+IE1hdGgudHJ1bmModmFsdWUgJSA2MCwgMTApO1xuXG4vLyBGb3JtYXQgdGltZSB0byBVSSBmcmllbmRseSBzdHJpbmdcbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRUaW1lKHRpbWUgPSAwLCBkaXNwbGF5SG91cnMgPSBmYWxzZSwgaW52ZXJ0ZWQgPSBmYWxzZSkge1xuICAvLyBCYWlsIGlmIHRoZSB2YWx1ZSBpc24ndCBhIG51bWJlclxuICBpZiAoIWlzLm51bWJlcih0aW1lKSkge1xuICAgIHJldHVybiBmb3JtYXRUaW1lKHVuZGVmaW5lZCwgZGlzcGxheUhvdXJzLCBpbnZlcnRlZCk7XG4gIH1cblxuICAvLyBGb3JtYXQgdGltZSBjb21wb25lbnQgdG8gYWRkIGxlYWRpbmcgemVyb1xuICBjb25zdCBmb3JtYXQgPSAodmFsdWUpID0+IGAwJHt2YWx1ZX1gLnNsaWNlKC0yKTtcbiAgLy8gQnJlYWtkb3duIHRvIGhvdXJzLCBtaW5zLCBzZWNzXG4gIGxldCBob3VycyA9IGdldEhvdXJzKHRpbWUpO1xuICBjb25zdCBtaW5zID0gZ2V0TWludXRlcyh0aW1lKTtcbiAgY29uc3Qgc2VjcyA9IGdldFNlY29uZHModGltZSk7XG5cbiAgLy8gRG8gd2UgbmVlZCB0byBkaXNwbGF5IGhvdXJzP1xuICBpZiAoZGlzcGxheUhvdXJzIHx8IGhvdXJzID4gMCkge1xuICAgIGhvdXJzID0gYCR7aG91cnN9OmA7XG4gIH0gZWxzZSB7XG4gICAgaG91cnMgPSAnJztcbiAgfVxuXG4gIC8vIFJlbmRlclxuICByZXR1cm4gYCR7aW52ZXJ0ZWQgJiYgdGltZSA+IDAgPyAnLScgOiAnJ30ke2hvdXJzfSR7Zm9ybWF0KG1pbnMpfToke2Zvcm1hdChzZWNzKX1gO1xufVxuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBseXIgY29udHJvbHNcbi8vIFRPRE86IFRoaXMgbmVlZHMgdG8gYmUgc3BsaXQgaW50byBzbWFsbGVyIGZpbGVzIGFuZCBjbGVhbmVkIHVwXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgUmFuZ2VUb3VjaCBmcm9tICdyYW5nZXRvdWNoJztcblxuaW1wb3J0IGNhcHRpb25zIGZyb20gJy4vY2FwdGlvbnMnO1xuaW1wb3J0IGh0bWw1IGZyb20gJy4vaHRtbDUnO1xuaW1wb3J0IHN1cHBvcnQgZnJvbSAnLi9zdXBwb3J0JztcbmltcG9ydCB7IHJlcGFpbnQsIHRyYW5zaXRpb25FbmRFdmVudCB9IGZyb20gJy4vdXRpbHMvYW5pbWF0aW9uJztcbmltcG9ydCB7IGRlZHVwZSB9IGZyb20gJy4vdXRpbHMvYXJyYXlzJztcbmltcG9ydCBicm93c2VyIGZyb20gJy4vdXRpbHMvYnJvd3Nlcic7XG5pbXBvcnQge1xuICBjcmVhdGVFbGVtZW50LFxuICBlbXB0eUVsZW1lbnQsXG4gIGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IsXG4gIGdldEVsZW1lbnQsXG4gIGdldEVsZW1lbnRzLFxuICBoYXNDbGFzcyxcbiAgbWF0Y2hlcyxcbiAgcmVtb3ZlRWxlbWVudCxcbiAgc2V0QXR0cmlidXRlcyxcbiAgc2V0Rm9jdXMsXG4gIHRvZ2dsZUNsYXNzLFxuICB0b2dnbGVIaWRkZW4sXG59IGZyb20gJy4vdXRpbHMvZWxlbWVudHMnO1xuaW1wb3J0IHsgb2ZmLCBvbiB9IGZyb20gJy4vdXRpbHMvZXZlbnRzJztcbmltcG9ydCBpMThuIGZyb20gJy4vdXRpbHMvaTE4bic7XG5pbXBvcnQgaXMgZnJvbSAnLi91dGlscy9pcyc7XG5pbXBvcnQgbG9hZFNwcml0ZSBmcm9tICcuL3V0aWxzL2xvYWQtc3ByaXRlJztcbmltcG9ydCB7IGV4dGVuZCB9IGZyb20gJy4vdXRpbHMvb2JqZWN0cyc7XG5pbXBvcnQgeyBnZXRQZXJjZW50YWdlLCByZXBsYWNlQWxsLCB0b0NhbWVsQ2FzZSwgdG9UaXRsZUNhc2UgfSBmcm9tICcuL3V0aWxzL3N0cmluZ3MnO1xuaW1wb3J0IHsgZm9ybWF0VGltZSwgZ2V0SG91cnMgfSBmcm9tICcuL3V0aWxzL3RpbWUnO1xuXG4vLyBUT0RPOiBEb24ndCBleHBvcnQgYSBtYXNzaXZlIG9iamVjdCAtIGJyZWFrIGRvd24gYW5kIGNyZWF0ZSBjbGFzc1xuY29uc3QgY29udHJvbHMgPSB7XG4gIC8vIEdldCBpY29uIFVSTFxuICBnZXRJY29uVXJsKCkge1xuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwodGhpcy5jb25maWcuaWNvblVybCwgd2luZG93LmxvY2F0aW9uKTtcbiAgICBjb25zdCBob3N0ID0gd2luZG93LmxvY2F0aW9uLmhvc3QgPyB3aW5kb3cubG9jYXRpb24uaG9zdCA6IHdpbmRvdy50b3AubG9jYXRpb24uaG9zdDtcbiAgICBjb25zdCBjb3JzID0gdXJsLmhvc3QgIT09IGhvc3QgfHwgKGJyb3dzZXIuaXNJRSAmJiAhd2luZG93LnN2ZzRldmVyeWJvZHkpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHVybDogdGhpcy5jb25maWcuaWNvblVybCxcbiAgICAgIGNvcnMsXG4gICAgfTtcbiAgfSxcblxuICAvLyBGaW5kIHRoZSBVSSBjb250cm9sc1xuICBmaW5kRWxlbWVudHMoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuZWxlbWVudHMuY29udHJvbHMgPSBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmNvbnRyb2xzLndyYXBwZXIpO1xuXG4gICAgICAvLyBCdXR0b25zXG4gICAgICB0aGlzLmVsZW1lbnRzLmJ1dHRvbnMgPSB7XG4gICAgICAgIHBsYXk6IGdldEVsZW1lbnRzLmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMucGxheSksXG4gICAgICAgIHBhdXNlOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMucGF1c2UpLFxuICAgICAgICByZXN0YXJ0OiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMucmVzdGFydCksXG4gICAgICAgIHJld2luZDogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnJld2luZCksXG4gICAgICAgIGZhc3RGb3J3YXJkOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMuZmFzdEZvcndhcmQpLFxuICAgICAgICBtdXRlOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMubXV0ZSksXG4gICAgICAgIHBpcDogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnBpcCksXG4gICAgICAgIGFpcnBsYXk6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5haXJwbGF5KSxcbiAgICAgICAgc2V0dGluZ3M6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5zZXR0aW5ncyksXG4gICAgICAgIGNhcHRpb25zOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMuY2FwdGlvbnMpLFxuICAgICAgICBmdWxsc2NyZWVuOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMuZnVsbHNjcmVlbiksXG4gICAgICB9O1xuXG4gICAgICAvLyBQcm9ncmVzc1xuICAgICAgdGhpcy5lbGVtZW50cy5wcm9ncmVzcyA9IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMucHJvZ3Jlc3MpO1xuXG4gICAgICAvLyBJbnB1dHNcbiAgICAgIHRoaXMuZWxlbWVudHMuaW5wdXRzID0ge1xuICAgICAgICBzZWVrOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmlucHV0cy5zZWVrKSxcbiAgICAgICAgdm9sdW1lOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmlucHV0cy52b2x1bWUpLFxuICAgICAgfTtcblxuICAgICAgLy8gRGlzcGxheVxuICAgICAgdGhpcy5lbGVtZW50cy5kaXNwbGF5ID0ge1xuICAgICAgICBidWZmZXI6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuZGlzcGxheS5idWZmZXIpLFxuICAgICAgICBjdXJyZW50VGltZTogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5kaXNwbGF5LmN1cnJlbnRUaW1lKSxcbiAgICAgICAgZHVyYXRpb246IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuZGlzcGxheS5kdXJhdGlvbiksXG4gICAgICB9O1xuXG4gICAgICAvLyBTZWVrIHRvb2x0aXBcbiAgICAgIGlmIChpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMucHJvZ3Jlc3MpKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudHMuZGlzcGxheS5zZWVrVG9vbHRpcCA9IHRoaXMuZWxlbWVudHMucHJvZ3Jlc3MucXVlcnlTZWxlY3RvcihgLiR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy50b29sdGlwfWApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gTG9nIGl0XG4gICAgICB0aGlzLmRlYnVnLndhcm4oJ0l0IGxvb2tzIGxpa2UgdGhlcmUgaXMgYSBwcm9ibGVtIHdpdGggeW91ciBjdXN0b20gY29udHJvbHMgSFRNTCcsIGVycm9yKTtcblxuICAgICAgLy8gUmVzdG9yZSBuYXRpdmUgdmlkZW8gY29udHJvbHNcbiAgICAgIHRoaXMudG9nZ2xlTmF0aXZlQ29udHJvbHModHJ1ZSk7XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gQ3JlYXRlIDxzdmc+IGljb25cbiAgY3JlYXRlSWNvbih0eXBlLCBhdHRyaWJ1dGVzKSB7XG4gICAgY29uc3QgbmFtZXNwYWNlID0gJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJztcbiAgICBjb25zdCBpY29uVXJsID0gY29udHJvbHMuZ2V0SWNvblVybC5jYWxsKHRoaXMpO1xuICAgIGNvbnN0IGljb25QYXRoID0gYCR7IWljb25VcmwuY29ycyA/IGljb25VcmwudXJsIDogJyd9IyR7dGhpcy5jb25maWcuaWNvblByZWZpeH1gO1xuICAgIC8vIENyZWF0ZSA8c3ZnPlxuICAgIGNvbnN0IGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMobmFtZXNwYWNlLCAnc3ZnJyk7XG4gICAgc2V0QXR0cmlidXRlcyhcbiAgICAgIGljb24sXG4gICAgICBleHRlbmQoYXR0cmlidXRlcywge1xuICAgICAgICAnYXJpYS1oaWRkZW4nOiAndHJ1ZScsXG4gICAgICAgIGZvY3VzYWJsZTogJ2ZhbHNlJyxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICAvLyBDcmVhdGUgdGhlIDx1c2U+IHRvIHJlZmVyZW5jZSBzcHJpdGVcbiAgICBjb25zdCB1c2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMobmFtZXNwYWNlLCAndXNlJyk7XG4gICAgY29uc3QgcGF0aCA9IGAke2ljb25QYXRofS0ke3R5cGV9YDtcblxuICAgIC8vIFNldCBgaHJlZmAgYXR0cmlidXRlc1xuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1wb3R0cy9wbHlyL2lzc3Vlcy80NjBcbiAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9TVkcvQXR0cmlidXRlL3hsaW5rOmhyZWZcbiAgICBpZiAoJ2hyZWYnIGluIHVzZSkge1xuICAgICAgdXNlLnNldEF0dHJpYnV0ZU5TKCdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJywgJ2hyZWYnLCBwYXRoKTtcbiAgICB9XG5cbiAgICAvLyBBbHdheXMgc2V0IHRoZSBvbGRlciBhdHRyaWJ1dGUgZXZlbiB0aG91Z2ggaXQncyBcImRlcHJlY2F0ZWRcIiAoaXQnbGwgYmUgYXJvdW5kIGZvciBhZ2VzKVxuICAgIHVzZS5zZXRBdHRyaWJ1dGVOUygnaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycsICd4bGluazpocmVmJywgcGF0aCk7XG5cbiAgICAvLyBBZGQgPHVzZT4gdG8gPHN2Zz5cbiAgICBpY29uLmFwcGVuZENoaWxkKHVzZSk7XG5cbiAgICByZXR1cm4gaWNvbjtcbiAgfSxcblxuICAvLyBDcmVhdGUgaGlkZGVuIHRleHQgbGFiZWxcbiAgY3JlYXRlTGFiZWwoa2V5LCBhdHRyID0ge30pIHtcbiAgICBjb25zdCB0ZXh0ID0gaTE4bi5nZXQoa2V5LCB0aGlzLmNvbmZpZyk7XG4gICAgY29uc3QgYXR0cmlidXRlcyA9IHsgLi4uYXR0ciwgY2xhc3M6IFthdHRyLmNsYXNzLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmhpZGRlbl0uZmlsdGVyKEJvb2xlYW4pLmpvaW4oJyAnKSB9O1xuXG4gICAgcmV0dXJuIGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCBhdHRyaWJ1dGVzLCB0ZXh0KTtcbiAgfSxcblxuICAvLyBDcmVhdGUgYSBiYWRnZVxuICBjcmVhdGVCYWRnZSh0ZXh0KSB7XG4gICAgaWYgKGlzLmVtcHR5KHRleHQpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBiYWRnZSA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7XG4gICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy5tZW51LnZhbHVlLFxuICAgIH0pO1xuXG4gICAgYmFkZ2UuYXBwZW5kQ2hpbGQoXG4gICAgICBjcmVhdGVFbGVtZW50KFxuICAgICAgICAnc3BhbicsXG4gICAgICAgIHtcbiAgICAgICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy5tZW51LmJhZGdlLFxuICAgICAgICB9LFxuICAgICAgICB0ZXh0LFxuICAgICAgKSxcbiAgICApO1xuXG4gICAgcmV0dXJuIGJhZGdlO1xuICB9LFxuXG4gIC8vIENyZWF0ZSBhIDxidXR0b24+XG4gIGNyZWF0ZUJ1dHRvbihidXR0b25UeXBlLCBhdHRyKSB7XG4gICAgY29uc3QgYXR0cmlidXRlcyA9IGV4dGVuZCh7fSwgYXR0cik7XG4gICAgbGV0IHR5cGUgPSB0b0NhbWVsQ2FzZShidXR0b25UeXBlKTtcblxuICAgIGNvbnN0IHByb3BzID0ge1xuICAgICAgZWxlbWVudDogJ2J1dHRvbicsXG4gICAgICB0b2dnbGU6IGZhbHNlLFxuICAgICAgbGFiZWw6IG51bGwsXG4gICAgICBpY29uOiBudWxsLFxuICAgICAgbGFiZWxQcmVzc2VkOiBudWxsLFxuICAgICAgaWNvblByZXNzZWQ6IG51bGwsXG4gICAgfTtcblxuICAgIFsnZWxlbWVudCcsICdpY29uJywgJ2xhYmVsJ10uZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICBpZiAoT2JqZWN0LmtleXMoYXR0cmlidXRlcykuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgICBwcm9wc1trZXldID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICBkZWxldGUgYXR0cmlidXRlc1trZXldO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gRGVmYXVsdCB0byAnYnV0dG9uJyB0eXBlIHRvIHByZXZlbnQgZm9ybSBzdWJtaXNzaW9uXG4gICAgaWYgKHByb3BzLmVsZW1lbnQgPT09ICdidXR0b24nICYmICFPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5pbmNsdWRlcygndHlwZScpKSB7XG4gICAgICBhdHRyaWJ1dGVzLnR5cGUgPSAnYnV0dG9uJztcbiAgICB9XG5cbiAgICAvLyBTZXQgY2xhc3MgbmFtZVxuICAgIGlmIChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5pbmNsdWRlcygnY2xhc3MnKSkge1xuICAgICAgaWYgKCFhdHRyaWJ1dGVzLmNsYXNzLnNwbGl0KCcgJykuc29tZSgoYykgPT4gYyA9PT0gdGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sKSkge1xuICAgICAgICBleHRlbmQoYXR0cmlidXRlcywge1xuICAgICAgICAgIGNsYXNzOiBgJHthdHRyaWJ1dGVzLmNsYXNzfSAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMuY29udHJvbH1gLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgYXR0cmlidXRlcy5jbGFzcyA9IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuY29udHJvbDtcbiAgICB9XG5cbiAgICAvLyBMYXJnZSBwbGF5IGJ1dHRvblxuICAgIHN3aXRjaCAoYnV0dG9uVHlwZSkge1xuICAgICAgY2FzZSAncGxheSc6XG4gICAgICAgIHByb3BzLnRvZ2dsZSA9IHRydWU7XG4gICAgICAgIHByb3BzLmxhYmVsID0gJ3BsYXknO1xuICAgICAgICBwcm9wcy5sYWJlbFByZXNzZWQgPSAncGF1c2UnO1xuICAgICAgICBwcm9wcy5pY29uID0gJ3BsYXknO1xuICAgICAgICBwcm9wcy5pY29uUHJlc3NlZCA9ICdwYXVzZSc7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdtdXRlJzpcbiAgICAgICAgcHJvcHMudG9nZ2xlID0gdHJ1ZTtcbiAgICAgICAgcHJvcHMubGFiZWwgPSAnbXV0ZSc7XG4gICAgICAgIHByb3BzLmxhYmVsUHJlc3NlZCA9ICd1bm11dGUnO1xuICAgICAgICBwcm9wcy5pY29uID0gJ3ZvbHVtZSc7XG4gICAgICAgIHByb3BzLmljb25QcmVzc2VkID0gJ211dGVkJztcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ2NhcHRpb25zJzpcbiAgICAgICAgcHJvcHMudG9nZ2xlID0gdHJ1ZTtcbiAgICAgICAgcHJvcHMubGFiZWwgPSAnZW5hYmxlQ2FwdGlvbnMnO1xuICAgICAgICBwcm9wcy5sYWJlbFByZXNzZWQgPSAnZGlzYWJsZUNhcHRpb25zJztcbiAgICAgICAgcHJvcHMuaWNvbiA9ICdjYXB0aW9ucy1vZmYnO1xuICAgICAgICBwcm9wcy5pY29uUHJlc3NlZCA9ICdjYXB0aW9ucy1vbic7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdmdWxsc2NyZWVuJzpcbiAgICAgICAgcHJvcHMudG9nZ2xlID0gdHJ1ZTtcbiAgICAgICAgcHJvcHMubGFiZWwgPSAnZW50ZXJGdWxsc2NyZWVuJztcbiAgICAgICAgcHJvcHMubGFiZWxQcmVzc2VkID0gJ2V4aXRGdWxsc2NyZWVuJztcbiAgICAgICAgcHJvcHMuaWNvbiA9ICdlbnRlci1mdWxsc2NyZWVuJztcbiAgICAgICAgcHJvcHMuaWNvblByZXNzZWQgPSAnZXhpdC1mdWxsc2NyZWVuJztcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ3BsYXktbGFyZ2UnOlxuICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzICs9IGAgJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2x9LS1vdmVybGFpZGA7XG4gICAgICAgIHR5cGUgPSAncGxheSc7XG4gICAgICAgIHByb3BzLmxhYmVsID0gJ3BsYXknO1xuICAgICAgICBwcm9wcy5pY29uID0gJ3BsYXknO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGlzLmVtcHR5KHByb3BzLmxhYmVsKSkge1xuICAgICAgICAgIHByb3BzLmxhYmVsID0gdHlwZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXMuZW1wdHkocHJvcHMuaWNvbikpIHtcbiAgICAgICAgICBwcm9wcy5pY29uID0gYnV0dG9uVHlwZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGJ1dHRvbiA9IGNyZWF0ZUVsZW1lbnQocHJvcHMuZWxlbWVudCk7XG5cbiAgICAvLyBTZXR1cCB0b2dnbGUgaWNvbiBhbmQgbGFiZWxzXG4gICAgaWYgKHByb3BzLnRvZ2dsZSkge1xuICAgICAgLy8gSWNvblxuICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKFxuICAgICAgICBjb250cm9scy5jcmVhdGVJY29uLmNhbGwodGhpcywgcHJvcHMuaWNvblByZXNzZWQsIHtcbiAgICAgICAgICBjbGFzczogJ2ljb24tLXByZXNzZWQnLFxuICAgICAgICB9KSxcbiAgICAgICk7XG4gICAgICBidXR0b24uYXBwZW5kQ2hpbGQoXG4gICAgICAgIGNvbnRyb2xzLmNyZWF0ZUljb24uY2FsbCh0aGlzLCBwcm9wcy5pY29uLCB7XG4gICAgICAgICAgY2xhc3M6ICdpY29uLS1ub3QtcHJlc3NlZCcsXG4gICAgICAgIH0pLFxuICAgICAgKTtcblxuICAgICAgLy8gTGFiZWwvVG9vbHRpcFxuICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKFxuICAgICAgICBjb250cm9scy5jcmVhdGVMYWJlbC5jYWxsKHRoaXMsIHByb3BzLmxhYmVsUHJlc3NlZCwge1xuICAgICAgICAgIGNsYXNzOiAnbGFiZWwtLXByZXNzZWQnLFxuICAgICAgICB9KSxcbiAgICAgICk7XG4gICAgICBidXR0b24uYXBwZW5kQ2hpbGQoXG4gICAgICAgIGNvbnRyb2xzLmNyZWF0ZUxhYmVsLmNhbGwodGhpcywgcHJvcHMubGFiZWwsIHtcbiAgICAgICAgICBjbGFzczogJ2xhYmVsLS1ub3QtcHJlc3NlZCcsXG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKGNvbnRyb2xzLmNyZWF0ZUljb24uY2FsbCh0aGlzLCBwcm9wcy5pY29uKSk7XG4gICAgICBidXR0b24uYXBwZW5kQ2hpbGQoY29udHJvbHMuY3JlYXRlTGFiZWwuY2FsbCh0aGlzLCBwcm9wcy5sYWJlbCkpO1xuICAgIH1cblxuICAgIC8vIE1lcmdlIGFuZCBzZXQgYXR0cmlidXRlc1xuICAgIGV4dGVuZChhdHRyaWJ1dGVzLCBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zW3R5cGVdLCBhdHRyaWJ1dGVzKSk7XG4gICAgc2V0QXR0cmlidXRlcyhidXR0b24sIGF0dHJpYnV0ZXMpO1xuXG4gICAgLy8gV2UgaGF2ZSBtdWx0aXBsZSBwbGF5IGJ1dHRvbnNcbiAgICBpZiAodHlwZSA9PT0gJ3BsYXknKSB7XG4gICAgICBpZiAoIWlzLmFycmF5KHRoaXMuZWxlbWVudHMuYnV0dG9uc1t0eXBlXSkpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50cy5idXR0b25zW3R5cGVdID0gW107XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZWxlbWVudHMuYnV0dG9uc1t0eXBlXS5wdXNoKGJ1dHRvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZWxlbWVudHMuYnV0dG9uc1t0eXBlXSA9IGJ1dHRvbjtcbiAgICB9XG5cbiAgICByZXR1cm4gYnV0dG9uO1xuICB9LFxuXG4gIC8vIENyZWF0ZSBhbiA8aW5wdXQgdHlwZT0ncmFuZ2UnPlxuICBjcmVhdGVSYW5nZSh0eXBlLCBhdHRyaWJ1dGVzKSB7XG4gICAgLy8gU2VlayBpbnB1dFxuICAgIGNvbnN0IGlucHV0ID0gY3JlYXRlRWxlbWVudChcbiAgICAgICdpbnB1dCcsXG4gICAgICBleHRlbmQoXG4gICAgICAgIGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLmlucHV0c1t0eXBlXSksXG4gICAgICAgIHtcbiAgICAgICAgICB0eXBlOiAncmFuZ2UnLFxuICAgICAgICAgIG1pbjogMCxcbiAgICAgICAgICBtYXg6IDEwMCxcbiAgICAgICAgICBzdGVwOiAwLjAxLFxuICAgICAgICAgIHZhbHVlOiAwLFxuICAgICAgICAgIGF1dG9jb21wbGV0ZTogJ29mZicsXG4gICAgICAgICAgLy8gQTExeSBmaXhlcyBmb3IgaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzkwNVxuICAgICAgICAgIHJvbGU6ICdzbGlkZXInLFxuICAgICAgICAgICdhcmlhLWxhYmVsJzogaTE4bi5nZXQodHlwZSwgdGhpcy5jb25maWcpLFxuICAgICAgICAgICdhcmlhLXZhbHVlbWluJzogMCxcbiAgICAgICAgICAnYXJpYS12YWx1ZW1heCc6IDEwMCxcbiAgICAgICAgICAnYXJpYS12YWx1ZW5vdyc6IDAsXG4gICAgICAgIH0sXG4gICAgICAgIGF0dHJpYnV0ZXMsXG4gICAgICApLFxuICAgICk7XG5cbiAgICB0aGlzLmVsZW1lbnRzLmlucHV0c1t0eXBlXSA9IGlucHV0O1xuXG4gICAgLy8gU2V0IHRoZSBmaWxsIGZvciB3ZWJraXQgbm93XG4gICAgY29udHJvbHMudXBkYXRlUmFuZ2VGaWxsLmNhbGwodGhpcywgaW5wdXQpO1xuXG4gICAgLy8gSW1wcm92ZSBzdXBwb3J0IG9uIHRvdWNoIGRldmljZXNcbiAgICBSYW5nZVRvdWNoLnNldHVwKGlucHV0KTtcblxuICAgIHJldHVybiBpbnB1dDtcbiAgfSxcblxuICAvLyBDcmVhdGUgYSA8cHJvZ3Jlc3M+XG4gIGNyZWF0ZVByb2dyZXNzKHR5cGUsIGF0dHJpYnV0ZXMpIHtcbiAgICBjb25zdCBwcm9ncmVzcyA9IGNyZWF0ZUVsZW1lbnQoXG4gICAgICAncHJvZ3Jlc3MnLFxuICAgICAgZXh0ZW5kKFxuICAgICAgICBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5kaXNwbGF5W3R5cGVdKSxcbiAgICAgICAge1xuICAgICAgICAgIG1pbjogMCxcbiAgICAgICAgICBtYXg6IDEwMCxcbiAgICAgICAgICB2YWx1ZTogMCxcbiAgICAgICAgICByb2xlOiAncHJvZ3Jlc3NiYXInLFxuICAgICAgICAgICdhcmlhLWhpZGRlbic6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIGF0dHJpYnV0ZXMsXG4gICAgICApLFxuICAgICk7XG5cbiAgICAvLyBDcmVhdGUgdGhlIGxhYmVsIGluc2lkZVxuICAgIGlmICh0eXBlICE9PSAndm9sdW1lJykge1xuICAgICAgcHJvZ3Jlc3MuYXBwZW5kQ2hpbGQoY3JlYXRlRWxlbWVudCgnc3BhbicsIG51bGwsICcwJykpO1xuXG4gICAgICBjb25zdCBzdWZmaXhLZXkgPSB7XG4gICAgICAgIHBsYXllZDogJ3BsYXllZCcsXG4gICAgICAgIGJ1ZmZlcjogJ2J1ZmZlcmVkJyxcbiAgICAgIH1bdHlwZV07XG4gICAgICBjb25zdCBzdWZmaXggPSBzdWZmaXhLZXkgPyBpMThuLmdldChzdWZmaXhLZXksIHRoaXMuY29uZmlnKSA6ICcnO1xuXG4gICAgICBwcm9ncmVzcy5pbm5lclRleHQgPSBgJSAke3N1ZmZpeC50b0xvd2VyQ2FzZSgpfWA7XG4gICAgfVxuXG4gICAgdGhpcy5lbGVtZW50cy5kaXNwbGF5W3R5cGVdID0gcHJvZ3Jlc3M7XG5cbiAgICByZXR1cm4gcHJvZ3Jlc3M7XG4gIH0sXG5cbiAgLy8gQ3JlYXRlIHRpbWUgZGlzcGxheVxuICBjcmVhdGVUaW1lKHR5cGUsIGF0dHJzKSB7XG4gICAgY29uc3QgYXR0cmlidXRlcyA9IGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLmRpc3BsYXlbdHlwZV0sIGF0dHJzKTtcblxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoXG4gICAgICAnZGl2JyxcbiAgICAgIGV4dGVuZChhdHRyaWJ1dGVzLCB7XG4gICAgICAgIGNsYXNzOiBgJHthdHRyaWJ1dGVzLmNsYXNzID8gYXR0cmlidXRlcy5jbGFzcyA6ICcnfSAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMuZGlzcGxheS50aW1lfSBgLnRyaW0oKSxcbiAgICAgICAgJ2FyaWEtbGFiZWwnOiBpMThuLmdldCh0eXBlLCB0aGlzLmNvbmZpZyksXG4gICAgICB9KSxcbiAgICAgICcwMDowMCcsXG4gICAgKTtcblxuICAgIC8vIFJlZmVyZW5jZSBmb3IgdXBkYXRlc1xuICAgIHRoaXMuZWxlbWVudHMuZGlzcGxheVt0eXBlXSA9IGNvbnRhaW5lcjtcblxuICAgIHJldHVybiBjb250YWluZXI7XG4gIH0sXG5cbiAgLy8gQmluZCBrZXlib2FyZCBzaG9ydGN1dHMgZm9yIGEgbWVudSBpdGVtXG4gIC8vIFdlIGhhdmUgdG8gYmluZCB0byBrZXl1cCBvdGhlcndpc2UgRmlyZWZveCB0cmlnZ2VycyBhIGNsaWNrIHdoZW4gYSBrZXlkb3duIGV2ZW50IGhhbmRsZXIgc2hpZnRzIGZvY3VzXG4gIC8vIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTEyMjAxNDNcbiAgYmluZE1lbnVJdGVtU2hvcnRjdXRzKG1lbnVJdGVtLCB0eXBlKSB7XG4gICAgLy8gTmF2aWdhdGUgdGhyb3VnaCBtZW51cyB2aWEgYXJyb3cga2V5cyBhbmQgc3BhY2VcbiAgICBvbi5jYWxsKFxuICAgICAgdGhpcyxcbiAgICAgIG1lbnVJdGVtLFxuICAgICAgJ2tleWRvd24ga2V5dXAnLFxuICAgICAgKGV2ZW50KSA9PiB7XG4gICAgICAgIC8vIFdlIG9ubHkgY2FyZSBhYm91dCBzcGFjZSBhbmQg4qyG77iPIOKsh++4j++4jyDinqHvuI9cbiAgICAgICAgaWYgKCFbJ1NwYWNlJywgJ0Fycm93VXAnLCAnQXJyb3dEb3duJywgJ0Fycm93UmlnaHQnXS5pbmNsdWRlcyhldmVudC5rZXkpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUHJldmVudCBwbGF5IC8gc2Vla1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAvLyBXZSdyZSBqdXN0IGhlcmUgdG8gcHJldmVudCB0aGUga2V5ZG93biBidWJibGluZ1xuICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ2tleWRvd24nKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaXNSYWRpb0J1dHRvbiA9IG1hdGNoZXMobWVudUl0ZW0sICdbcm9sZT1cIm1lbnVpdGVtcmFkaW9cIl0nKTtcblxuICAgICAgICAvLyBTaG93IHRoZSByZXNwZWN0aXZlIG1lbnVcbiAgICAgICAgaWYgKCFpc1JhZGlvQnV0dG9uICYmIFsnU3BhY2UnLCAnQXJyb3dSaWdodCddLmluY2x1ZGVzKGV2ZW50LmtleSkpIHtcbiAgICAgICAgICBjb250cm9scy5zaG93TWVudVBhbmVsLmNhbGwodGhpcywgdHlwZSwgdHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGV0IHRhcmdldDtcblxuICAgICAgICAgIGlmIChldmVudC5rZXkgIT09ICdTcGFjZScpIHtcbiAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09ICdBcnJvd0Rvd24nIHx8IChpc1JhZGlvQnV0dG9uICYmIGV2ZW50LmtleSA9PT0gJ0Fycm93UmlnaHQnKSkge1xuICAgICAgICAgICAgICB0YXJnZXQgPSBtZW51SXRlbS5uZXh0RWxlbWVudFNpYmxpbmc7XG5cbiAgICAgICAgICAgICAgaWYgKCFpcy5lbGVtZW50KHRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSBtZW51SXRlbS5wYXJlbnROb2RlLmZpcnN0RWxlbWVudENoaWxkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0YXJnZXQgPSBtZW51SXRlbS5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgIGlmICghaXMuZWxlbWVudCh0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gbWVudUl0ZW0ucGFyZW50Tm9kZS5sYXN0RWxlbWVudENoaWxkO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNldEZvY3VzLmNhbGwodGhpcywgdGFyZ2V0LCB0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBmYWxzZSxcbiAgICApO1xuXG4gICAgLy8gRW50ZXIgd2lsbCBmaXJlIGEgYGNsaWNrYCBldmVudCBidXQgd2Ugc3RpbGwgbmVlZCB0byBtYW5hZ2UgZm9jdXNcbiAgICAvLyBTbyB3ZSBiaW5kIHRvIGtleXVwIHdoaWNoIGZpcmVzIGFmdGVyIGFuZCBzZXQgZm9jdXMgaGVyZVxuICAgIG9uLmNhbGwodGhpcywgbWVudUl0ZW0sICdrZXl1cCcsIChldmVudCkgPT4ge1xuICAgICAgaWYgKGV2ZW50LmtleSAhPT0gJ1JldHVybicpIHJldHVybjtcblxuICAgICAgY29udHJvbHMuZm9jdXNGaXJzdE1lbnVJdGVtLmNhbGwodGhpcywgbnVsbCwgdHJ1ZSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgLy8gQ3JlYXRlIGEgc2V0dGluZ3MgbWVudSBpdGVtXG4gIGNyZWF0ZU1lbnVJdGVtKHsgdmFsdWUsIGxpc3QsIHR5cGUsIHRpdGxlLCBiYWRnZSA9IG51bGwsIGNoZWNrZWQgPSBmYWxzZSB9KSB7XG4gICAgY29uc3QgYXR0cmlidXRlcyA9IGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLmlucHV0c1t0eXBlXSk7XG5cbiAgICBjb25zdCBtZW51SXRlbSA9IGNyZWF0ZUVsZW1lbnQoXG4gICAgICAnYnV0dG9uJyxcbiAgICAgIGV4dGVuZChhdHRyaWJ1dGVzLCB7XG4gICAgICAgIHR5cGU6ICdidXR0b24nLFxuICAgICAgICByb2xlOiAnbWVudWl0ZW1yYWRpbycsXG4gICAgICAgIGNsYXNzOiBgJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2x9ICR7YXR0cmlidXRlcy5jbGFzcyA/IGF0dHJpYnV0ZXMuY2xhc3MgOiAnJ31gLnRyaW0oKSxcbiAgICAgICAgJ2FyaWEtY2hlY2tlZCc6IGNoZWNrZWQsXG4gICAgICAgIHZhbHVlLFxuICAgICAgfSksXG4gICAgKTtcblxuICAgIGNvbnN0IGZsZXggPSBjcmVhdGVFbGVtZW50KCdzcGFuJyk7XG5cbiAgICAvLyBXZSBoYXZlIHRvIHNldCBhcyBIVE1MIGluY2FzZSBvZiBzcGVjaWFsIGNoYXJhY3RlcnNcbiAgICBmbGV4LmlubmVySFRNTCA9IHRpdGxlO1xuXG4gICAgaWYgKGlzLmVsZW1lbnQoYmFkZ2UpKSB7XG4gICAgICBmbGV4LmFwcGVuZENoaWxkKGJhZGdlKTtcbiAgICB9XG5cbiAgICBtZW51SXRlbS5hcHBlbmRDaGlsZChmbGV4KTtcblxuICAgIC8vIFJlcGxpY2F0ZSByYWRpbyBidXR0b24gYmVoYXZpb3JcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobWVudUl0ZW0sICdjaGVja2VkJywge1xuICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgIGdldCgpIHtcbiAgICAgICAgcmV0dXJuIG1lbnVJdGVtLmdldEF0dHJpYnV0ZSgnYXJpYS1jaGVja2VkJykgPT09ICd0cnVlJztcbiAgICAgIH0sXG4gICAgICBzZXQoY2hlY2spIHtcbiAgICAgICAgLy8gRW5zdXJlIGV4Y2x1c2l2aXR5XG4gICAgICAgIGlmIChjaGVjaykge1xuICAgICAgICAgIEFycmF5LmZyb20obWVudUl0ZW0ucGFyZW50Tm9kZS5jaGlsZHJlbilcbiAgICAgICAgICAgIC5maWx0ZXIoKG5vZGUpID0+IG1hdGNoZXMobm9kZSwgJ1tyb2xlPVwibWVudWl0ZW1yYWRpb1wiXScpKVxuICAgICAgICAgICAgLmZvckVhY2goKG5vZGUpID0+IG5vZGUuc2V0QXR0cmlidXRlKCdhcmlhLWNoZWNrZWQnLCAnZmFsc2UnKSk7XG4gICAgICAgIH1cblxuICAgICAgICBtZW51SXRlbS5zZXRBdHRyaWJ1dGUoJ2FyaWEtY2hlY2tlZCcsIGNoZWNrID8gJ3RydWUnIDogJ2ZhbHNlJyk7XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgdGhpcy5saXN0ZW5lcnMuYmluZChcbiAgICAgIG1lbnVJdGVtLFxuICAgICAgJ2NsaWNrIGtleXVwJyxcbiAgICAgIChldmVudCkgPT4ge1xuICAgICAgICBpZiAoaXMua2V5Ym9hcmRFdmVudChldmVudCkgJiYgZXZlbnQua2V5ICE9PSAnU3BhY2UnKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgbWVudUl0ZW0uY2hlY2tlZCA9IHRydWU7XG5cbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgY2FzZSAnbGFuZ3VhZ2UnOlxuICAgICAgICAgICAgdGhpcy5jdXJyZW50VHJhY2sgPSBOdW1iZXIodmFsdWUpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlICdxdWFsaXR5JzpcbiAgICAgICAgICAgIHRoaXMucXVhbGl0eSA9IHZhbHVlO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlICdzcGVlZCc6XG4gICAgICAgICAgICB0aGlzLnNwZWVkID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnRyb2xzLnNob3dNZW51UGFuZWwuY2FsbCh0aGlzLCAnaG9tZScsIGlzLmtleWJvYXJkRXZlbnQoZXZlbnQpKTtcbiAgICAgIH0sXG4gICAgICB0eXBlLFxuICAgICAgZmFsc2UsXG4gICAgKTtcblxuICAgIGNvbnRyb2xzLmJpbmRNZW51SXRlbVNob3J0Y3V0cy5jYWxsKHRoaXMsIG1lbnVJdGVtLCB0eXBlKTtcblxuICAgIGxpc3QuYXBwZW5kQ2hpbGQobWVudUl0ZW0pO1xuICB9LFxuXG4gIC8vIEZvcm1hdCBhIHRpbWUgZm9yIGRpc3BsYXlcbiAgZm9ybWF0VGltZSh0aW1lID0gMCwgaW52ZXJ0ZWQgPSBmYWxzZSkge1xuICAgIC8vIEJhaWwgaWYgdGhlIHZhbHVlIGlzbid0IGEgbnVtYmVyXG4gICAgaWYgKCFpcy5udW1iZXIodGltZSkpIHtcbiAgICAgIHJldHVybiB0aW1lO1xuICAgIH1cblxuICAgIC8vIEFsd2F5cyBkaXNwbGF5IGhvdXJzIGlmIGR1cmF0aW9uIGlzIG92ZXIgYW4gaG91clxuICAgIGNvbnN0IGZvcmNlSG91cnMgPSBnZXRIb3Vycyh0aGlzLmR1cmF0aW9uKSA+IDA7XG5cbiAgICByZXR1cm4gZm9ybWF0VGltZSh0aW1lLCBmb3JjZUhvdXJzLCBpbnZlcnRlZCk7XG4gIH0sXG5cbiAgLy8gVXBkYXRlIHRoZSBkaXNwbGF5ZWQgdGltZVxuICB1cGRhdGVUaW1lRGlzcGxheSh0YXJnZXQgPSBudWxsLCB0aW1lID0gMCwgaW52ZXJ0ZWQgPSBmYWxzZSkge1xuICAgIC8vIEJhaWwgaWYgdGhlcmUncyBubyBlbGVtZW50IHRvIGRpc3BsYXkgb3IgdGhlIHZhbHVlIGlzbid0IGEgbnVtYmVyXG4gICAgaWYgKCFpcy5lbGVtZW50KHRhcmdldCkgfHwgIWlzLm51bWJlcih0aW1lKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgIHRhcmdldC5pbm5lclRleHQgPSBjb250cm9scy5mb3JtYXRUaW1lKHRpbWUsIGludmVydGVkKTtcbiAgfSxcblxuICAvLyBVcGRhdGUgdm9sdW1lIFVJIGFuZCBzdG9yYWdlXG4gIHVwZGF0ZVZvbHVtZSgpIHtcbiAgICBpZiAoIXRoaXMuc3VwcG9ydGVkLnVpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHJhbmdlXG4gICAgaWYgKGlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5pbnB1dHMudm9sdW1lKSkge1xuICAgICAgY29udHJvbHMuc2V0UmFuZ2UuY2FsbCh0aGlzLCB0aGlzLmVsZW1lbnRzLmlucHV0cy52b2x1bWUsIHRoaXMubXV0ZWQgPyAwIDogdGhpcy52b2x1bWUpO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBtdXRlIHN0YXRlXG4gICAgaWYgKGlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5idXR0b25zLm11dGUpKSB7XG4gICAgICB0aGlzLmVsZW1lbnRzLmJ1dHRvbnMubXV0ZS5wcmVzc2VkID0gdGhpcy5tdXRlZCB8fCB0aGlzLnZvbHVtZSA9PT0gMDtcbiAgICB9XG4gIH0sXG5cbiAgLy8gVXBkYXRlIHNlZWsgdmFsdWUgYW5kIGxvd2VyIGZpbGxcbiAgc2V0UmFuZ2UodGFyZ2V0LCB2YWx1ZSA9IDApIHtcbiAgICBpZiAoIWlzLmVsZW1lbnQodGFyZ2V0KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgIHRhcmdldC52YWx1ZSA9IHZhbHVlO1xuXG4gICAgLy8gV2Via2l0IHJhbmdlIGZpbGxcbiAgICBjb250cm9scy51cGRhdGVSYW5nZUZpbGwuY2FsbCh0aGlzLCB0YXJnZXQpO1xuICB9LFxuXG4gIC8vIFVwZGF0ZSA8cHJvZ3Jlc3M+IGVsZW1lbnRzXG4gIHVwZGF0ZVByb2dyZXNzKGV2ZW50KSB7XG4gICAgaWYgKCF0aGlzLnN1cHBvcnRlZC51aSB8fCAhaXMuZXZlbnQoZXZlbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IHZhbHVlID0gMDtcblxuICAgIGNvbnN0IHNldFByb2dyZXNzID0gKHRhcmdldCwgaW5wdXQpID0+IHtcbiAgICAgIGNvbnN0IHZhbCA9IGlzLm51bWJlcihpbnB1dCkgPyBpbnB1dCA6IDA7XG4gICAgICBjb25zdCBwcm9ncmVzcyA9IGlzLmVsZW1lbnQodGFyZ2V0KSA/IHRhcmdldCA6IHRoaXMuZWxlbWVudHMuZGlzcGxheS5idWZmZXI7XG5cbiAgICAgIC8vIFVwZGF0ZSB2YWx1ZSBhbmQgbGFiZWxcbiAgICAgIGlmIChpcy5lbGVtZW50KHByb2dyZXNzKSkge1xuICAgICAgICBwcm9ncmVzcy52YWx1ZSA9IHZhbDtcblxuICAgICAgICAvLyBVcGRhdGUgdGV4dCBsYWJlbCBpbnNpZGVcbiAgICAgICAgY29uc3QgbGFiZWwgPSBwcm9ncmVzcy5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc3BhbicpWzBdO1xuICAgICAgICBpZiAoaXMuZWxlbWVudChsYWJlbCkpIHtcbiAgICAgICAgICBsYWJlbC5jaGlsZE5vZGVzWzBdLm5vZGVWYWx1ZSA9IHZhbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAoZXZlbnQpIHtcbiAgICAgIHN3aXRjaCAoZXZlbnQudHlwZSkge1xuICAgICAgICAvLyBWaWRlbyBwbGF5aW5nXG4gICAgICAgIGNhc2UgJ3RpbWV1cGRhdGUnOlxuICAgICAgICBjYXNlICdzZWVraW5nJzpcbiAgICAgICAgY2FzZSAnc2Vla2VkJzpcbiAgICAgICAgICB2YWx1ZSA9IGdldFBlcmNlbnRhZ2UodGhpcy5jdXJyZW50VGltZSwgdGhpcy5kdXJhdGlvbik7XG5cbiAgICAgICAgICAvLyBTZXQgc2VlayByYW5nZSB2YWx1ZSBvbmx5IGlmIGl0J3MgYSAnbmF0dXJhbCcgdGltZSBldmVudFxuICAgICAgICAgIGlmIChldmVudC50eXBlID09PSAndGltZXVwZGF0ZScpIHtcbiAgICAgICAgICAgIGNvbnRyb2xzLnNldFJhbmdlLmNhbGwodGhpcywgdGhpcy5lbGVtZW50cy5pbnB1dHMuc2VlaywgdmFsdWUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIC8vIENoZWNrIGJ1ZmZlciBzdGF0dXNcbiAgICAgICAgY2FzZSAncGxheWluZyc6XG4gICAgICAgIGNhc2UgJ3Byb2dyZXNzJzpcbiAgICAgICAgICBzZXRQcm9ncmVzcyh0aGlzLmVsZW1lbnRzLmRpc3BsYXkuYnVmZmVyLCB0aGlzLmJ1ZmZlcmVkICogMTAwKTtcblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIC8vIFdlYmtpdCBwb2x5ZmlsbCBmb3IgbG93ZXIgZmlsbCByYW5nZVxuICB1cGRhdGVSYW5nZUZpbGwodGFyZ2V0KSB7XG4gICAgLy8gR2V0IHJhbmdlIGZyb20gZXZlbnQgaWYgZXZlbnQgcGFzc2VkXG4gICAgY29uc3QgcmFuZ2UgPSBpcy5ldmVudCh0YXJnZXQpID8gdGFyZ2V0LnRhcmdldCA6IHRhcmdldDtcblxuICAgIC8vIE5lZWRzIHRvIGJlIGEgdmFsaWQgPGlucHV0IHR5cGU9J3JhbmdlJz5cbiAgICBpZiAoIWlzLmVsZW1lbnQocmFuZ2UpIHx8IHJhbmdlLmdldEF0dHJpYnV0ZSgndHlwZScpICE9PSAncmFuZ2UnKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gU2V0IGFyaWEgdmFsdWVzIGZvciBodHRwczovL2dpdGh1Yi5jb20vc2FtcG90dHMvcGx5ci9pc3N1ZXMvOTA1XG4gICAgaWYgKG1hdGNoZXMocmFuZ2UsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5pbnB1dHMuc2VlaykpIHtcbiAgICAgIHJhbmdlLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycsIHRoaXMuY3VycmVudFRpbWUpO1xuICAgICAgY29uc3QgY3VycmVudFRpbWUgPSBjb250cm9scy5mb3JtYXRUaW1lKHRoaXMuY3VycmVudFRpbWUpO1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBjb250cm9scy5mb3JtYXRUaW1lKHRoaXMuZHVyYXRpb24pO1xuICAgICAgY29uc3QgZm9ybWF0ID0gaTE4bi5nZXQoJ3NlZWtMYWJlbCcsIHRoaXMuY29uZmlnKTtcbiAgICAgIHJhbmdlLnNldEF0dHJpYnV0ZShcbiAgICAgICAgJ2FyaWEtdmFsdWV0ZXh0JyxcbiAgICAgICAgZm9ybWF0LnJlcGxhY2UoJ3tjdXJyZW50VGltZX0nLCBjdXJyZW50VGltZSkucmVwbGFjZSgne2R1cmF0aW9ufScsIGR1cmF0aW9uKSxcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmIChtYXRjaGVzKHJhbmdlLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuaW5wdXRzLnZvbHVtZSkpIHtcbiAgICAgIGNvbnN0IHBlcmNlbnQgPSByYW5nZS52YWx1ZSAqIDEwMDtcbiAgICAgIHJhbmdlLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycsIHBlcmNlbnQpO1xuICAgICAgcmFuZ2Uuc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVldGV4dCcsIGAke3BlcmNlbnQudG9GaXhlZCgxKX0lYCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJhbmdlLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycsIHJhbmdlLnZhbHVlKTtcbiAgICB9XG5cbiAgICAvLyBXZWJLaXQgb25seVxuICAgIGlmICghYnJvd3Nlci5pc1dlYmtpdCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFNldCBDU1MgY3VzdG9tIHByb3BlcnR5XG4gICAgcmFuZ2Uuc3R5bGUuc2V0UHJvcGVydHkoJy0tdmFsdWUnLCBgJHsocmFuZ2UudmFsdWUgLyByYW5nZS5tYXgpICogMTAwfSVgKTtcbiAgfSxcblxuICAvLyBVcGRhdGUgaG92ZXIgdG9vbHRpcCBmb3Igc2Vla2luZ1xuICB1cGRhdGVTZWVrVG9vbHRpcChldmVudCkge1xuICAgIC8vIEJhaWwgaWYgc2V0dGluZyBub3QgdHJ1ZVxuICAgIGlmIChcbiAgICAgICF0aGlzLmNvbmZpZy50b29sdGlwcy5zZWVrIHx8XG4gICAgICAhaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmlucHV0cy5zZWVrKSB8fFxuICAgICAgIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5kaXNwbGF5LnNlZWtUb29sdGlwKSB8fFxuICAgICAgdGhpcy5kdXJhdGlvbiA9PT0gMFxuICAgICkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHRpcEVsZW1lbnQgPSB0aGlzLmVsZW1lbnRzLmRpc3BsYXkuc2Vla1Rvb2x0aXA7XG4gICAgY29uc3QgdmlzaWJsZSA9IGAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMudG9vbHRpcH0tLXZpc2libGVgO1xuICAgIGNvbnN0IHRvZ2dsZSA9IChzaG93KSA9PiB0b2dnbGVDbGFzcyh0aXBFbGVtZW50LCB2aXNpYmxlLCBzaG93KTtcblxuICAgIC8vIEhpZGUgb24gdG91Y2hcbiAgICBpZiAodGhpcy50b3VjaCkge1xuICAgICAgdG9nZ2xlKGZhbHNlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBEZXRlcm1pbmUgcGVyY2VudGFnZSwgaWYgYWxyZWFkeSB2aXNpYmxlXG4gICAgbGV0IHBlcmNlbnQgPSAwO1xuICAgIGNvbnN0IGNsaWVudFJlY3QgPSB0aGlzLmVsZW1lbnRzLnByb2dyZXNzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgaWYgKGlzLmV2ZW50KGV2ZW50KSkge1xuICAgICAgcGVyY2VudCA9ICgxMDAgLyBjbGllbnRSZWN0LndpZHRoKSAqIChldmVudC5wYWdlWCAtIGNsaWVudFJlY3QubGVmdCk7XG4gICAgfSBlbHNlIGlmIChoYXNDbGFzcyh0aXBFbGVtZW50LCB2aXNpYmxlKSkge1xuICAgICAgcGVyY2VudCA9IHBhcnNlRmxvYXQodGlwRWxlbWVudC5zdHlsZS5sZWZ0LCAxMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTZXQgYm91bmRzXG4gICAgaWYgKHBlcmNlbnQgPCAwKSB7XG4gICAgICBwZXJjZW50ID0gMDtcbiAgICB9IGVsc2UgaWYgKHBlcmNlbnQgPiAxMDApIHtcbiAgICAgIHBlcmNlbnQgPSAxMDA7XG4gICAgfVxuXG4gICAgY29uc3QgdGltZSA9ICh0aGlzLmR1cmF0aW9uIC8gMTAwKSAqIHBlcmNlbnQ7XG5cbiAgICAvLyBEaXNwbGF5IHRoZSB0aW1lIGEgY2xpY2sgd291bGQgc2VlayB0b1xuICAgIHRpcEVsZW1lbnQuaW5uZXJUZXh0ID0gY29udHJvbHMuZm9ybWF0VGltZSh0aW1lKTtcblxuICAgIC8vIEdldCBtYXJrZXIgcG9pbnQgZm9yIHRpbWVcbiAgICBjb25zdCBwb2ludCA9IHRoaXMuY29uZmlnLm1hcmtlcnM/LnBvaW50cz8uZmluZCgoeyB0aW1lOiB0IH0pID0+IHQgPT09IE1hdGgucm91bmQodGltZSkpO1xuXG4gICAgLy8gQXBwZW5kIHRoZSBwb2ludCBsYWJlbCB0byB0aGUgdG9vbHRpcFxuICAgIGlmIChwb2ludCkge1xuICAgICAgdGlwRWxlbWVudC5pbnNlcnRBZGphY2VudEhUTUwoJ2FmdGVyYmVnaW4nLCBgJHtwb2ludC5sYWJlbH08YnI+YCk7XG4gICAgfVxuXG4gICAgLy8gU2V0IHBvc2l0aW9uXG4gICAgdGlwRWxlbWVudC5zdHlsZS5sZWZ0ID0gYCR7cGVyY2VudH0lYDtcblxuICAgIC8vIFNob3cvaGlkZSB0aGUgdG9vbHRpcFxuICAgIC8vIElmIHRoZSBldmVudCBpcyBhIG1vdWVzIGluL291dCBhbmQgcGVyY2VudGFnZSBpcyBpbnNpZGUgYm91bmRzXG4gICAgaWYgKGlzLmV2ZW50KGV2ZW50KSAmJiBbJ21vdXNlZW50ZXInLCAnbW91c2VsZWF2ZSddLmluY2x1ZGVzKGV2ZW50LnR5cGUpKSB7XG4gICAgICB0b2dnbGUoZXZlbnQudHlwZSA9PT0gJ21vdXNlZW50ZXInKTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gSGFuZGxlIHRpbWUgY2hhbmdlIGV2ZW50XG4gIHRpbWVVcGRhdGUoZXZlbnQpIHtcbiAgICAvLyBPbmx5IGludmVydCBpZiBvbmx5IG9uZSB0aW1lIGVsZW1lbnQgaXMgZGlzcGxheWVkIGFuZCB1c2VkIGZvciBib3RoIGR1cmF0aW9uIGFuZCBjdXJyZW50VGltZVxuICAgIGNvbnN0IGludmVydCA9ICFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuZGlzcGxheS5kdXJhdGlvbikgJiYgdGhpcy5jb25maWcuaW52ZXJ0VGltZTtcblxuICAgIC8vIER1cmF0aW9uXG4gICAgY29udHJvbHMudXBkYXRlVGltZURpc3BsYXkuY2FsbChcbiAgICAgIHRoaXMsXG4gICAgICB0aGlzLmVsZW1lbnRzLmRpc3BsYXkuY3VycmVudFRpbWUsXG4gICAgICBpbnZlcnQgPyB0aGlzLmR1cmF0aW9uIC0gdGhpcy5jdXJyZW50VGltZSA6IHRoaXMuY3VycmVudFRpbWUsXG4gICAgICBpbnZlcnQsXG4gICAgKTtcblxuICAgIC8vIElnbm9yZSB1cGRhdGVzIHdoaWxlIHNlZWtpbmdcbiAgICBpZiAoZXZlbnQgJiYgZXZlbnQudHlwZSA9PT0gJ3RpbWV1cGRhdGUnICYmIHRoaXMubWVkaWEuc2Vla2luZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFBsYXlpbmcgcHJvZ3Jlc3NcbiAgICBjb250cm9scy51cGRhdGVQcm9ncmVzcy5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgfSxcblxuICAvLyBTaG93IHRoZSBkdXJhdGlvbiBvbiBtZXRhZGF0YWxvYWRlZCBvciBkdXJhdGlvbmNoYW5nZSBldmVudHNcbiAgZHVyYXRpb25VcGRhdGUoKSB7XG4gICAgLy8gQmFpbCBpZiBubyBVSSBvciBkdXJhdGlvbmNoYW5nZSBldmVudCB0cmlnZ2VyZWQgYWZ0ZXIgcGxheWluZy9zZWVrIHdoZW4gaW52ZXJ0VGltZSBpcyBmYWxzZVxuICAgIGlmICghdGhpcy5zdXBwb3J0ZWQudWkgfHwgKCF0aGlzLmNvbmZpZy5pbnZlcnRUaW1lICYmIHRoaXMuY3VycmVudFRpbWUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gSWYgZHVyYXRpb24gaXMgdGhlIDIqKjMyIChzaGFrYSksIEluZmluaXR5IChITFMpLCBEQVNILUlGIChOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiB8fCBOdW1iZXIuTUFYX1ZBTFVFKSBpbmRpY2F0aW5nIGxpdmUgd2UgaGlkZSB0aGUgY3VycmVudFRpbWUgYW5kIHByb2dyZXNzYmFyLlxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS92aWRlby1kZXYvaGxzLmpzL2Jsb2IvNTgyMGQyOWQzYzRjOGE0NmU4Yjc1ZjFlM2FmYTNlNjhjMWE5YTJkYi9zcmMvY29udHJvbGxlci9idWZmZXItY29udHJvbGxlci5qcyNMNDE1XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9zaGFrYS1wbGF5ZXIvYmxvYi80ZDg4OTA1NDYzMWY0ZTFjZjBmYmQ4MGRkZDJiNzE4ODdjMDJlMjMyL2xpYi9tZWRpYS9zdHJlYW1pbmdfZW5naW5lLmpzI0wxMDYyXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL0Rhc2gtSW5kdXN0cnktRm9ydW0vZGFzaC5qcy9ibG9iLzY5ODU5ZjUxYjk2OTY0NWIyMzQ2NjY4MDBkNGNiNTk2ZDg5YzYwMmQvc3JjL2Rhc2gvbW9kZWxzL0Rhc2hNYW5pZmVzdE1vZGVsLmpzI0wzMzhcbiAgICBpZiAodGhpcy5kdXJhdGlvbiA+PSAyICoqIDMyKSB7XG4gICAgICB0b2dnbGVIaWRkZW4odGhpcy5lbGVtZW50cy5kaXNwbGF5LmN1cnJlbnRUaW1lLCB0cnVlKTtcbiAgICAgIHRvZ2dsZUhpZGRlbih0aGlzLmVsZW1lbnRzLnByb2dyZXNzLCB0cnVlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgQVJJQSB2YWx1ZXNcbiAgICBpZiAoaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmlucHV0cy5zZWVrKSkge1xuICAgICAgdGhpcy5lbGVtZW50cy5pbnB1dHMuc2Vlay5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVtYXgnLCB0aGlzLmR1cmF0aW9uKTtcbiAgICB9XG5cbiAgICAvLyBJZiB0aGVyZSdzIGEgc3BvdCB0byBkaXNwbGF5IGR1cmF0aW9uXG4gICAgY29uc3QgaGFzRHVyYXRpb24gPSBpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuZGlzcGxheS5kdXJhdGlvbik7XG5cbiAgICAvLyBJZiB0aGVyZSdzIG9ubHkgb25lIHRpbWUgZGlzcGxheSwgZGlzcGxheSBkdXJhdGlvbiB0aGVyZVxuICAgIGlmICghaGFzRHVyYXRpb24gJiYgdGhpcy5jb25maWcuZGlzcGxheUR1cmF0aW9uICYmIHRoaXMucGF1c2VkKSB7XG4gICAgICBjb250cm9scy51cGRhdGVUaW1lRGlzcGxheS5jYWxsKHRoaXMsIHRoaXMuZWxlbWVudHMuZGlzcGxheS5jdXJyZW50VGltZSwgdGhpcy5kdXJhdGlvbik7XG4gICAgfVxuXG4gICAgLy8gSWYgdGhlcmUncyBhIGR1cmF0aW9uIGVsZW1lbnQsIHVwZGF0ZSBjb250ZW50XG4gICAgaWYgKGhhc0R1cmF0aW9uKSB7XG4gICAgICBjb250cm9scy51cGRhdGVUaW1lRGlzcGxheS5jYWxsKHRoaXMsIHRoaXMuZWxlbWVudHMuZGlzcGxheS5kdXJhdGlvbiwgdGhpcy5kdXJhdGlvbik7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY29uZmlnLm1hcmtlcnMuZW5hYmxlZCkge1xuICAgICAgY29udHJvbHMuc2V0TWFya2Vycy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSB0aGUgdG9vbHRpcCAoaWYgdmlzaWJsZSlcbiAgICBjb250cm9scy51cGRhdGVTZWVrVG9vbHRpcC5jYWxsKHRoaXMpO1xuICB9LFxuXG4gIC8vIEhpZGUvc2hvdyBhIHRhYlxuICB0b2dnbGVNZW51QnV0dG9uKHNldHRpbmcsIHRvZ2dsZSkge1xuICAgIHRvZ2dsZUhpZGRlbih0aGlzLmVsZW1lbnRzLnNldHRpbmdzLmJ1dHRvbnNbc2V0dGluZ10sICF0b2dnbGUpO1xuICB9LFxuXG4gIC8vIFVwZGF0ZSB0aGUgc2VsZWN0ZWQgc2V0dGluZ1xuICB1cGRhdGVTZXR0aW5nKHNldHRpbmcsIGNvbnRhaW5lciwgaW5wdXQpIHtcbiAgICBjb25zdCBwYW5lID0gdGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHNbc2V0dGluZ107XG4gICAgbGV0IHZhbHVlID0gbnVsbDtcbiAgICBsZXQgbGlzdCA9IGNvbnRhaW5lcjtcblxuICAgIGlmIChzZXR0aW5nID09PSAnY2FwdGlvbnMnKSB7XG4gICAgICB2YWx1ZSA9IHRoaXMuY3VycmVudFRyYWNrO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZSA9ICFpcy5lbXB0eShpbnB1dCkgPyBpbnB1dCA6IHRoaXNbc2V0dGluZ107XG5cbiAgICAgIC8vIEdldCBkZWZhdWx0XG4gICAgICBpZiAoaXMuZW1wdHkodmFsdWUpKSB7XG4gICAgICAgIHZhbHVlID0gdGhpcy5jb25maWdbc2V0dGluZ10uZGVmYXVsdDtcbiAgICAgIH1cblxuICAgICAgLy8gVW5zdXBwb3J0ZWQgdmFsdWVcbiAgICAgIGlmICghaXMuZW1wdHkodGhpcy5vcHRpb25zW3NldHRpbmddKSAmJiAhdGhpcy5vcHRpb25zW3NldHRpbmddLmluY2x1ZGVzKHZhbHVlKSkge1xuICAgICAgICB0aGlzLmRlYnVnLndhcm4oYFVuc3VwcG9ydGVkIHZhbHVlIG9mICcke3ZhbHVlfScgZm9yICR7c2V0dGluZ31gKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBEaXNhYmxlZCB2YWx1ZVxuICAgICAgaWYgKCF0aGlzLmNvbmZpZ1tzZXR0aW5nXS5vcHRpb25zLmluY2x1ZGVzKHZhbHVlKSkge1xuICAgICAgICB0aGlzLmRlYnVnLndhcm4oYERpc2FibGVkIHZhbHVlIG9mICcke3ZhbHVlfScgZm9yICR7c2V0dGluZ31gKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEdldCB0aGUgbGlzdCBpZiB3ZSBuZWVkIHRvXG4gICAgaWYgKCFpcy5lbGVtZW50KGxpc3QpKSB7XG4gICAgICBsaXN0ID0gcGFuZSAmJiBwYW5lLnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwibWVudVwiXScpO1xuICAgIH1cblxuICAgIC8vIElmIHRoZXJlJ3Mgbm8gbGlzdCBpdCBtZWFucyBpdCdzIG5vdCBiZWVuIHJlbmRlcmVkLi4uXG4gICAgaWYgKCFpcy5lbGVtZW50KGxpc3QpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHRoZSBsYWJlbFxuICAgIGNvbnN0IGxhYmVsID0gdGhpcy5lbGVtZW50cy5zZXR0aW5ncy5idXR0b25zW3NldHRpbmddLnF1ZXJ5U2VsZWN0b3IoYC4ke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMubWVudS52YWx1ZX1gKTtcbiAgICBsYWJlbC5pbm5lckhUTUwgPSBjb250cm9scy5nZXRMYWJlbC5jYWxsKHRoaXMsIHNldHRpbmcsIHZhbHVlKTtcblxuICAgIC8vIEZpbmQgdGhlIHJhZGlvIG9wdGlvbiBhbmQgY2hlY2sgaXRcbiAgICBjb25zdCB0YXJnZXQgPSBsaXN0ICYmIGxpc3QucXVlcnlTZWxlY3RvcihgW3ZhbHVlPVwiJHt2YWx1ZX1cIl1gKTtcblxuICAgIGlmIChpcy5lbGVtZW50KHRhcmdldCkpIHtcbiAgICAgIHRhcmdldC5jaGVja2VkID0gdHJ1ZTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gVHJhbnNsYXRlIGEgdmFsdWUgaW50byBhIG5pY2UgbGFiZWxcbiAgZ2V0TGFiZWwoc2V0dGluZywgdmFsdWUpIHtcbiAgICBzd2l0Y2ggKHNldHRpbmcpIHtcbiAgICAgIGNhc2UgJ3NwZWVkJzpcbiAgICAgICAgcmV0dXJuIHZhbHVlID09PSAxID8gaTE4bi5nZXQoJ25vcm1hbCcsIHRoaXMuY29uZmlnKSA6IGAke3ZhbHVlfSZ0aW1lcztgO1xuXG4gICAgICBjYXNlICdxdWFsaXR5JzpcbiAgICAgICAgaWYgKGlzLm51bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgICBjb25zdCBsYWJlbCA9IGkxOG4uZ2V0KGBxdWFsaXR5TGFiZWwuJHt2YWx1ZX1gLCB0aGlzLmNvbmZpZyk7XG5cbiAgICAgICAgICBpZiAoIWxhYmVsLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGAke3ZhbHVlfXBgO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0b1RpdGxlQ2FzZSh2YWx1ZSk7XG5cbiAgICAgIGNhc2UgJ2NhcHRpb25zJzpcbiAgICAgICAgcmV0dXJuIGNhcHRpb25zLmdldExhYmVsLmNhbGwodGhpcyk7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSxcblxuICAvLyBTZXQgdGhlIHF1YWxpdHkgbWVudVxuICBzZXRRdWFsaXR5TWVudShvcHRpb25zKSB7XG4gICAgLy8gTWVudSByZXF1aXJlZFxuICAgIGlmICghaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVscy5xdWFsaXR5KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHR5cGUgPSAncXVhbGl0eSc7XG4gICAgY29uc3QgbGlzdCA9IHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLnF1YWxpdHkucXVlcnlTZWxlY3RvcignW3JvbGU9XCJtZW51XCJdJyk7XG5cbiAgICAvLyBTZXQgb3B0aW9ucyBpZiBwYXNzZWQgYW5kIGZpbHRlciBiYXNlZCBvbiB1bmlxdWVuZXNzIGFuZCBjb25maWdcbiAgICBpZiAoaXMuYXJyYXkob3B0aW9ucykpIHtcbiAgICAgIHRoaXMub3B0aW9ucy5xdWFsaXR5ID0gZGVkdXBlKG9wdGlvbnMpLmZpbHRlcigocXVhbGl0eSkgPT4gdGhpcy5jb25maWcucXVhbGl0eS5vcHRpb25zLmluY2x1ZGVzKHF1YWxpdHkpKTtcbiAgICB9XG5cbiAgICAvLyBUb2dnbGUgdGhlIHBhbmUgYW5kIHRhYlxuICAgIGNvbnN0IHRvZ2dsZSA9ICFpcy5lbXB0eSh0aGlzLm9wdGlvbnMucXVhbGl0eSkgJiYgdGhpcy5vcHRpb25zLnF1YWxpdHkubGVuZ3RoID4gMTtcbiAgICBjb250cm9scy50b2dnbGVNZW51QnV0dG9uLmNhbGwodGhpcywgdHlwZSwgdG9nZ2xlKTtcblxuICAgIC8vIEVtcHR5IHRoZSBtZW51XG4gICAgZW1wdHlFbGVtZW50KGxpc3QpO1xuXG4gICAgLy8gQ2hlY2sgaWYgd2UgbmVlZCB0byB0b2dnbGUgdGhlIHBhcmVudFxuICAgIGNvbnRyb2xzLmNoZWNrTWVudS5jYWxsKHRoaXMpO1xuXG4gICAgLy8gSWYgd2UncmUgaGlkaW5nLCBub3RoaW5nIG1vcmUgdG8gZG9cbiAgICBpZiAoIXRvZ2dsZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEdldCB0aGUgYmFkZ2UgSFRNTCBmb3IgSEQsIDRLIGV0Y1xuICAgIGNvbnN0IGdldEJhZGdlID0gKHF1YWxpdHkpID0+IHtcbiAgICAgIGNvbnN0IGxhYmVsID0gaTE4bi5nZXQoYHF1YWxpdHlCYWRnZS4ke3F1YWxpdHl9YCwgdGhpcy5jb25maWcpO1xuXG4gICAgICBpZiAoIWxhYmVsLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNvbnRyb2xzLmNyZWF0ZUJhZGdlLmNhbGwodGhpcywgbGFiZWwpO1xuICAgIH07XG5cbiAgICAvLyBTb3J0IG9wdGlvbnMgYnkgdGhlIGNvbmZpZyBhbmQgdGhlbiByZW5kZXIgb3B0aW9uc1xuICAgIHRoaXMub3B0aW9ucy5xdWFsaXR5XG4gICAgICAuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICBjb25zdCBzb3J0aW5nID0gdGhpcy5jb25maWcucXVhbGl0eS5vcHRpb25zO1xuICAgICAgICByZXR1cm4gc29ydGluZy5pbmRleE9mKGEpID4gc29ydGluZy5pbmRleE9mKGIpID8gMSA6IC0xO1xuICAgICAgfSlcbiAgICAgIC5mb3JFYWNoKChxdWFsaXR5KSA9PiB7XG4gICAgICAgIGNvbnRyb2xzLmNyZWF0ZU1lbnVJdGVtLmNhbGwodGhpcywge1xuICAgICAgICAgIHZhbHVlOiBxdWFsaXR5LFxuICAgICAgICAgIGxpc3QsXG4gICAgICAgICAgdHlwZSxcbiAgICAgICAgICB0aXRsZTogY29udHJvbHMuZ2V0TGFiZWwuY2FsbCh0aGlzLCAncXVhbGl0eScsIHF1YWxpdHkpLFxuICAgICAgICAgIGJhZGdlOiBnZXRCYWRnZShxdWFsaXR5KSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgIGNvbnRyb2xzLnVwZGF0ZVNldHRpbmcuY2FsbCh0aGlzLCB0eXBlLCBsaXN0KTtcbiAgfSxcblxuICAvLyBTZXQgdGhlIGxvb3Bpbmcgb3B0aW9uc1xuICAvKiBzZXRMb29wTWVudSgpIHtcbiAgICAgICAgLy8gTWVudSByZXF1aXJlZFxuICAgICAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMubG9vcCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSBbJ3N0YXJ0JywgJ2VuZCcsICdhbGwnLCAncmVzZXQnXTtcbiAgICAgICAgY29uc3QgbGlzdCA9IHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLmxvb3AucXVlcnlTZWxlY3RvcignW3JvbGU9XCJtZW51XCJdJyk7XG5cbiAgICAgICAgLy8gU2hvdyB0aGUgcGFuZSBhbmQgdGFiXG4gICAgICAgIHRvZ2dsZUhpZGRlbih0aGlzLmVsZW1lbnRzLnNldHRpbmdzLmJ1dHRvbnMubG9vcCwgZmFsc2UpO1xuICAgICAgICB0b2dnbGVIaWRkZW4odGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMubG9vcCwgZmFsc2UpO1xuXG4gICAgICAgIC8vIFRvZ2dsZSB0aGUgcGFuZSBhbmQgdGFiXG4gICAgICAgIGNvbnN0IHRvZ2dsZSA9ICFpcy5lbXB0eSh0aGlzLmxvb3Aub3B0aW9ucyk7XG4gICAgICAgIGNvbnRyb2xzLnRvZ2dsZU1lbnVCdXR0b24uY2FsbCh0aGlzLCAnbG9vcCcsIHRvZ2dsZSk7XG5cbiAgICAgICAgLy8gRW1wdHkgdGhlIG1lbnVcbiAgICAgICAgZW1wdHlFbGVtZW50KGxpc3QpO1xuXG4gICAgICAgIG9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4ge1xuICAgICAgICAgICAgY29uc3QgaXRlbSA9IGNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG5cbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgJ2J1dHRvbicsXG4gICAgICAgICAgICAgICAgZXh0ZW5kKGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMubG9vcCksIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1dHRvbicsXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2wsXG4gICAgICAgICAgICAgICAgICAgICdkYXRhLXBseXItbG9vcC1hY3Rpb24nOiBvcHRpb24sXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgaTE4bi5nZXQob3B0aW9uLCB0aGlzLmNvbmZpZylcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGlmIChbJ3N0YXJ0JywgJ2VuZCddLmluY2x1ZGVzKG9wdGlvbikpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBiYWRnZSA9IGNvbnRyb2xzLmNyZWF0ZUJhZGdlLmNhbGwodGhpcywgJzAwOjAwJyk7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKGJhZGdlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaXRlbS5hcHBlbmRDaGlsZChidXR0b24pO1xuICAgICAgICAgICAgbGlzdC5hcHBlbmRDaGlsZChpdGVtKTtcbiAgICAgICAgfSk7XG4gICAgfSwgKi9cblxuICAvLyBHZXQgY3VycmVudCBzZWxlY3RlZCBjYXB0aW9uIGxhbmd1YWdlXG4gIC8vIFRPRE86IHJld29yayB0aGlzIHRvIHVzZXIgdGhlIGdldHRlciBpbiB0aGUgQVBJP1xuXG4gIC8vIFNldCBhIGxpc3Qgb2YgYXZhaWxhYmxlIGNhcHRpb25zIGxhbmd1YWdlc1xuICBzZXRDYXB0aW9uc01lbnUoKSB7XG4gICAgLy8gTWVudSByZXF1aXJlZFxuICAgIGlmICghaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVscy5jYXB0aW9ucykpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBUT0RPOiBDYXB0aW9ucyBvciBsYW5ndWFnZT8gQ3VycmVudGx5IGl0J3MgbWl4ZWRcbiAgICBjb25zdCB0eXBlID0gJ2NhcHRpb25zJztcbiAgICBjb25zdCBsaXN0ID0gdGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMuY2FwdGlvbnMucXVlcnlTZWxlY3RvcignW3JvbGU9XCJtZW51XCJdJyk7XG4gICAgY29uc3QgdHJhY2tzID0gY2FwdGlvbnMuZ2V0VHJhY2tzLmNhbGwodGhpcyk7XG4gICAgY29uc3QgdG9nZ2xlID0gQm9vbGVhbih0cmFja3MubGVuZ3RoKTtcblxuICAgIC8vIFRvZ2dsZSB0aGUgcGFuZSBhbmQgdGFiXG4gICAgY29udHJvbHMudG9nZ2xlTWVudUJ1dHRvbi5jYWxsKHRoaXMsIHR5cGUsIHRvZ2dsZSk7XG5cbiAgICAvLyBFbXB0eSB0aGUgbWVudVxuICAgIGVtcHR5RWxlbWVudChsaXN0KTtcblxuICAgIC8vIENoZWNrIGlmIHdlIG5lZWQgdG8gdG9nZ2xlIHRoZSBwYXJlbnRcbiAgICBjb250cm9scy5jaGVja01lbnUuY2FsbCh0aGlzKTtcblxuICAgIC8vIElmIHRoZXJlJ3Mgbm8gY2FwdGlvbnMsIGJhaWxcbiAgICBpZiAoIXRvZ2dsZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIG9wdGlvbnMgZGF0YVxuICAgIGNvbnN0IG9wdGlvbnMgPSB0cmFja3MubWFwKCh0cmFjaywgdmFsdWUpID0+ICh7XG4gICAgICB2YWx1ZSxcbiAgICAgIGNoZWNrZWQ6IHRoaXMuY2FwdGlvbnMudG9nZ2xlZCAmJiB0aGlzLmN1cnJlbnRUcmFjayA9PT0gdmFsdWUsXG4gICAgICB0aXRsZTogY2FwdGlvbnMuZ2V0TGFiZWwuY2FsbCh0aGlzLCB0cmFjayksXG4gICAgICBiYWRnZTogdHJhY2subGFuZ3VhZ2UgJiYgY29udHJvbHMuY3JlYXRlQmFkZ2UuY2FsbCh0aGlzLCB0cmFjay5sYW5ndWFnZS50b1VwcGVyQ2FzZSgpKSxcbiAgICAgIGxpc3QsXG4gICAgICB0eXBlOiAnbGFuZ3VhZ2UnLFxuICAgIH0pKTtcblxuICAgIC8vIEFkZCB0aGUgXCJEaXNhYmxlZFwiIG9wdGlvbiB0byB0dXJuIG9mZiBjYXB0aW9uc1xuICAgIG9wdGlvbnMudW5zaGlmdCh7XG4gICAgICB2YWx1ZTogLTEsXG4gICAgICBjaGVja2VkOiAhdGhpcy5jYXB0aW9ucy50b2dnbGVkLFxuICAgICAgdGl0bGU6IGkxOG4uZ2V0KCdkaXNhYmxlZCcsIHRoaXMuY29uZmlnKSxcbiAgICAgIGxpc3QsXG4gICAgICB0eXBlOiAnbGFuZ3VhZ2UnLFxuICAgIH0pO1xuXG4gICAgLy8gR2VuZXJhdGUgb3B0aW9uc1xuICAgIG9wdGlvbnMuZm9yRWFjaChjb250cm9scy5jcmVhdGVNZW51SXRlbS5iaW5kKHRoaXMpKTtcblxuICAgIGNvbnRyb2xzLnVwZGF0ZVNldHRpbmcuY2FsbCh0aGlzLCB0eXBlLCBsaXN0KTtcbiAgfSxcblxuICAvLyBTZXQgYSBsaXN0IG9mIGF2YWlsYWJsZSBjYXB0aW9ucyBsYW5ndWFnZXNcbiAgc2V0U3BlZWRNZW51KCkge1xuICAgIC8vIE1lbnUgcmVxdWlyZWRcbiAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMuc3BlZWQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgdHlwZSA9ICdzcGVlZCc7XG4gICAgY29uc3QgbGlzdCA9IHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLnNwZWVkLnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwibWVudVwiXScpO1xuXG4gICAgLy8gRmlsdGVyIG91dCBpbnZhbGlkIHNwZWVkc1xuICAgIHRoaXMub3B0aW9ucy5zcGVlZCA9IHRoaXMub3B0aW9ucy5zcGVlZC5maWx0ZXIoKG8pID0+IG8gPj0gdGhpcy5taW5pbXVtU3BlZWQgJiYgbyA8PSB0aGlzLm1heGltdW1TcGVlZCk7XG5cbiAgICAvLyBUb2dnbGUgdGhlIHBhbmUgYW5kIHRhYlxuICAgIGNvbnN0IHRvZ2dsZSA9ICFpcy5lbXB0eSh0aGlzLm9wdGlvbnMuc3BlZWQpICYmIHRoaXMub3B0aW9ucy5zcGVlZC5sZW5ndGggPiAxO1xuICAgIGNvbnRyb2xzLnRvZ2dsZU1lbnVCdXR0b24uY2FsbCh0aGlzLCB0eXBlLCB0b2dnbGUpO1xuXG4gICAgLy8gRW1wdHkgdGhlIG1lbnVcbiAgICBlbXB0eUVsZW1lbnQobGlzdCk7XG5cbiAgICAvLyBDaGVjayBpZiB3ZSBuZWVkIHRvIHRvZ2dsZSB0aGUgcGFyZW50XG4gICAgY29udHJvbHMuY2hlY2tNZW51LmNhbGwodGhpcyk7XG5cbiAgICAvLyBJZiB3ZSdyZSBoaWRpbmcsIG5vdGhpbmcgbW9yZSB0byBkb1xuICAgIGlmICghdG9nZ2xlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGl0ZW1zXG4gICAgdGhpcy5vcHRpb25zLnNwZWVkLmZvckVhY2goKHNwZWVkKSA9PiB7XG4gICAgICBjb250cm9scy5jcmVhdGVNZW51SXRlbS5jYWxsKHRoaXMsIHtcbiAgICAgICAgdmFsdWU6IHNwZWVkLFxuICAgICAgICBsaXN0LFxuICAgICAgICB0eXBlLFxuICAgICAgICB0aXRsZTogY29udHJvbHMuZ2V0TGFiZWwuY2FsbCh0aGlzLCAnc3BlZWQnLCBzcGVlZCksXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGNvbnRyb2xzLnVwZGF0ZVNldHRpbmcuY2FsbCh0aGlzLCB0eXBlLCBsaXN0KTtcbiAgfSxcblxuICAvLyBDaGVjayBpZiB3ZSBuZWVkIHRvIGhpZGUvc2hvdyB0aGUgc2V0dGluZ3MgbWVudVxuICBjaGVja01lbnUoKSB7XG4gICAgY29uc3QgeyBidXR0b25zIH0gPSB0aGlzLmVsZW1lbnRzLnNldHRpbmdzO1xuICAgIGNvbnN0IHZpc2libGUgPSAhaXMuZW1wdHkoYnV0dG9ucykgJiYgT2JqZWN0LnZhbHVlcyhidXR0b25zKS5zb21lKChidXR0b24pID0+ICFidXR0b24uaGlkZGVuKTtcblxuICAgIHRvZ2dsZUhpZGRlbih0aGlzLmVsZW1lbnRzLnNldHRpbmdzLm1lbnUsICF2aXNpYmxlKTtcbiAgfSxcblxuICAvLyBGb2N1cyB0aGUgZmlyc3QgbWVudSBpdGVtIGluIGEgZ2l2ZW4gKG9yIHZpc2libGUpIG1lbnVcbiAgZm9jdXNGaXJzdE1lbnVJdGVtKHBhbmUsIHRhYkZvY3VzID0gZmFsc2UpIHtcbiAgICBpZiAodGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wb3B1cC5oaWRkZW4pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsZXQgdGFyZ2V0ID0gcGFuZTtcblxuICAgIGlmICghaXMuZWxlbWVudCh0YXJnZXQpKSB7XG4gICAgICB0YXJnZXQgPSBPYmplY3QudmFsdWVzKHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzKS5maW5kKChwKSA9PiAhcC5oaWRkZW4pO1xuICAgIH1cblxuICAgIGNvbnN0IGZpcnN0SXRlbSA9IHRhcmdldC5xdWVyeVNlbGVjdG9yKCdbcm9sZV49XCJtZW51aXRlbVwiXScpO1xuXG4gICAgc2V0Rm9jdXMuY2FsbCh0aGlzLCBmaXJzdEl0ZW0sIHRhYkZvY3VzKTtcbiAgfSxcblxuICAvLyBTaG93L2hpZGUgbWVudVxuICB0b2dnbGVNZW51KGlucHV0KSB7XG4gICAgY29uc3QgeyBwb3B1cCB9ID0gdGhpcy5lbGVtZW50cy5zZXR0aW5ncztcbiAgICBjb25zdCBidXR0b24gPSB0aGlzLmVsZW1lbnRzLmJ1dHRvbnMuc2V0dGluZ3M7XG5cbiAgICAvLyBNZW51IGFuZCBidXR0b24gYXJlIHJlcXVpcmVkXG4gICAgaWYgKCFpcy5lbGVtZW50KHBvcHVwKSB8fCAhaXMuZWxlbWVudChidXR0b24pKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gVHJ1ZSB0b2dnbGUgYnkgZGVmYXVsdFxuICAgIGNvbnN0IHsgaGlkZGVuIH0gPSBwb3B1cDtcbiAgICBsZXQgc2hvdyA9IGhpZGRlbjtcblxuICAgIGlmIChpcy5ib29sZWFuKGlucHV0KSkge1xuICAgICAgc2hvdyA9IGlucHV0O1xuICAgIH0gZWxzZSBpZiAoaXMua2V5Ym9hcmRFdmVudChpbnB1dCkgJiYgaW5wdXQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgc2hvdyA9IGZhbHNlO1xuICAgIH0gZWxzZSBpZiAoaXMuZXZlbnQoaW5wdXQpKSB7XG4gICAgICAvLyBJZiBQbHlyIGlzIGluIGEgc2hhZG93RE9NLCB0aGUgZXZlbnQgdGFyZ2V0IGlzIHNldCB0byB0aGUgY29tcG9uZW50LCBpbnN0ZWFkIG9mIHRoZVxuICAgICAgLy8gRWxlbWVudCBpbiB0aGUgc2hhZG93RE9NLiBUaGUgcGF0aCwgaWYgYXZhaWxhYmxlLCBpcyBjb21wbGV0ZS5cbiAgICAgIGNvbnN0IHRhcmdldCA9IGlzLmZ1bmN0aW9uKGlucHV0LmNvbXBvc2VkUGF0aCkgPyBpbnB1dC5jb21wb3NlZFBhdGgoKVswXSA6IGlucHV0LnRhcmdldDtcbiAgICAgIGNvbnN0IGlzTWVudUl0ZW0gPSBwb3B1cC5jb250YWlucyh0YXJnZXQpO1xuXG4gICAgICAvLyBJZiB0aGUgY2xpY2sgd2FzIGluc2lkZSB0aGUgbWVudSBvciBpZiB0aGUgY2xpY2tcbiAgICAgIC8vIHdhc24ndCB0aGUgYnV0dG9uIG9yIG1lbnUgaXRlbSBhbmQgd2UncmUgdHJ5aW5nIHRvXG4gICAgICAvLyBzaG93IHRoZSBtZW51IChhIGRvYyBjbGljayBzaG91bGRuJ3Qgc2hvdyB0aGUgbWVudSlcbiAgICAgIGlmIChpc01lbnVJdGVtIHx8ICghaXNNZW51SXRlbSAmJiBpbnB1dC50YXJnZXQgIT09IGJ1dHRvbiAmJiBzaG93KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU2V0IGJ1dHRvbiBhdHRyaWJ1dGVzXG4gICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIHNob3cpO1xuXG4gICAgLy8gU2hvdyB0aGUgYWN0dWFsIHBvcHVwXG4gICAgdG9nZ2xlSGlkZGVuKHBvcHVwLCAhc2hvdyk7XG5cbiAgICAvLyBBZGQgY2xhc3MgaG9va1xuICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLm1lbnUub3Blbiwgc2hvdyk7XG5cbiAgICAvLyBGb2N1cyB0aGUgZmlyc3QgaXRlbSBpZiBrZXkgaW50ZXJhY3Rpb25cbiAgICBpZiAoc2hvdyAmJiBpcy5rZXlib2FyZEV2ZW50KGlucHV0KSkge1xuICAgICAgY29udHJvbHMuZm9jdXNGaXJzdE1lbnVJdGVtLmNhbGwodGhpcywgbnVsbCwgdHJ1ZSk7XG4gICAgfSBlbHNlIGlmICghc2hvdyAmJiAhaGlkZGVuKSB7XG4gICAgICAvLyBJZiBjbG9zaW5nLCByZS1mb2N1cyB0aGUgYnV0dG9uXG4gICAgICBzZXRGb2N1cy5jYWxsKHRoaXMsIGJ1dHRvbiwgaXMua2V5Ym9hcmRFdmVudChpbnB1dCkpO1xuICAgIH1cbiAgfSxcblxuICAvLyBHZXQgdGhlIG5hdHVyYWwgc2l6ZSBvZiBhIG1lbnUgcGFuZWxcbiAgZ2V0TWVudVNpemUodGFiKSB7XG4gICAgY29uc3QgY2xvbmUgPSB0YWIuY2xvbmVOb2RlKHRydWUpO1xuICAgIGNsb25lLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICBjbG9uZS5zdHlsZS5vcGFjaXR5ID0gMDtcbiAgICBjbG9uZS5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpO1xuXG4gICAgLy8gQXBwZW5kIHRvIHBhcmVudCBzbyB3ZSBnZXQgdGhlIFwicmVhbFwiIHNpemVcbiAgICB0YWIucGFyZW50Tm9kZS5hcHBlbmRDaGlsZChjbG9uZSk7XG5cbiAgICAvLyBHZXQgdGhlIHNpemVzIGJlZm9yZSB3ZSByZW1vdmVcbiAgICBjb25zdCB3aWR0aCA9IGNsb25lLnNjcm9sbFdpZHRoO1xuICAgIGNvbnN0IGhlaWdodCA9IGNsb25lLnNjcm9sbEhlaWdodDtcblxuICAgIC8vIFJlbW92ZSBmcm9tIHRoZSBET01cbiAgICByZW1vdmVFbGVtZW50KGNsb25lKTtcblxuICAgIHJldHVybiB7XG4gICAgICB3aWR0aCxcbiAgICAgIGhlaWdodCxcbiAgICB9O1xuICB9LFxuXG4gIC8vIFNob3cgYSBwYW5lbCBpbiB0aGUgbWVudVxuICBzaG93TWVudVBhbmVsKHR5cGUgPSAnJywgdGFiRm9jdXMgPSBmYWxzZSkge1xuICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZWxlbWVudHMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoYCNwbHlyLXNldHRpbmdzLSR7dGhpcy5pZH0tJHt0eXBlfWApO1xuXG4gICAgLy8gTm90aGluZyB0byBzaG93LCBiYWlsXG4gICAgaWYgKCFpcy5lbGVtZW50KHRhcmdldCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBIaWRlIGFsbCBvdGhlciBwYW5lbHNcbiAgICBjb25zdCBjb250YWluZXIgPSB0YXJnZXQucGFyZW50Tm9kZTtcbiAgICBjb25zdCBjdXJyZW50ID0gQXJyYXkuZnJvbShjb250YWluZXIuY2hpbGRyZW4pLmZpbmQoKG5vZGUpID0+ICFub2RlLmhpZGRlbik7XG5cbiAgICAvLyBJZiB3ZSBjYW4gZG8gZmFuY3kgYW5pbWF0aW9ucywgd2UnbGwgYW5pbWF0ZSB0aGUgaGVpZ2h0L3dpZHRoXG4gICAgaWYgKHN1cHBvcnQudHJhbnNpdGlvbnMgJiYgIXN1cHBvcnQucmVkdWNlZE1vdGlvbikge1xuICAgICAgLy8gU2V0IHRoZSBjdXJyZW50IHdpZHRoIGFzIGEgYmFzZVxuICAgICAgY29udGFpbmVyLnN0eWxlLndpZHRoID0gYCR7Y3VycmVudC5zY3JvbGxXaWR0aH1weGA7XG4gICAgICBjb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gYCR7Y3VycmVudC5zY3JvbGxIZWlnaHR9cHhgO1xuXG4gICAgICAvLyBHZXQgcG90ZW50aWFsIHNpemVzXG4gICAgICBjb25zdCBzaXplID0gY29udHJvbHMuZ2V0TWVudVNpemUuY2FsbCh0aGlzLCB0YXJnZXQpO1xuXG4gICAgICAvLyBSZXN0b3JlIGF1dG8gaGVpZ2h0L3dpZHRoXG4gICAgICBjb25zdCByZXN0b3JlID0gKGV2ZW50KSA9PiB7XG4gICAgICAgIC8vIFdlJ3JlIG9ubHkgYm90aGVyZWQgYWJvdXQgaGVpZ2h0IGFuZCB3aWR0aCBvbiB0aGUgY29udGFpbmVyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQgIT09IGNvbnRhaW5lciB8fCAhWyd3aWR0aCcsICdoZWlnaHQnXS5pbmNsdWRlcyhldmVudC5wcm9wZXJ0eU5hbWUpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmV2ZXJ0IGJhY2sgdG8gYXV0b1xuICAgICAgICBjb250YWluZXIuc3R5bGUud2lkdGggPSAnJztcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLmhlaWdodCA9ICcnO1xuXG4gICAgICAgIC8vIE9ubHkgbGlzdGVuIG9uY2VcbiAgICAgICAgb2ZmLmNhbGwodGhpcywgY29udGFpbmVyLCB0cmFuc2l0aW9uRW5kRXZlbnQsIHJlc3RvcmUpO1xuICAgICAgfTtcblxuICAgICAgLy8gTGlzdGVuIGZvciB0aGUgdHJhbnNpdGlvbiBmaW5pc2hpbmcgYW5kIHJlc3RvcmUgYXV0byBoZWlnaHQvd2lkdGhcbiAgICAgIG9uLmNhbGwodGhpcywgY29udGFpbmVyLCB0cmFuc2l0aW9uRW5kRXZlbnQsIHJlc3RvcmUpO1xuXG4gICAgICAvLyBTZXQgZGltZW5zaW9ucyB0byB0YXJnZXRcbiAgICAgIGNvbnRhaW5lci5zdHlsZS53aWR0aCA9IGAke3NpemUud2lkdGh9cHhgO1xuICAgICAgY29udGFpbmVyLnN0eWxlLmhlaWdodCA9IGAke3NpemUuaGVpZ2h0fXB4YDtcbiAgICB9XG5cbiAgICAvLyBTZXQgYXR0cmlidXRlcyBvbiBjdXJyZW50IHRhYlxuICAgIHRvZ2dsZUhpZGRlbihjdXJyZW50LCB0cnVlKTtcblxuICAgIC8vIFNldCBhdHRyaWJ1dGVzIG9uIHRhcmdldFxuICAgIHRvZ2dsZUhpZGRlbih0YXJnZXQsIGZhbHNlKTtcblxuICAgIC8vIEZvY3VzIHRoZSBmaXJzdCBpdGVtXG4gICAgY29udHJvbHMuZm9jdXNGaXJzdE1lbnVJdGVtLmNhbGwodGhpcywgdGFyZ2V0LCB0YWJGb2N1cyk7XG4gIH0sXG5cbiAgLy8gU2V0IHRoZSBkb3dubG9hZCBVUkxcbiAgc2V0RG93bmxvYWRVcmwoKSB7XG4gICAgY29uc3QgYnV0dG9uID0gdGhpcy5lbGVtZW50cy5idXR0b25zLmRvd25sb2FkO1xuXG4gICAgLy8gQmFpbCBpZiBubyBidXR0b25cbiAgICBpZiAoIWlzLmVsZW1lbnQoYnV0dG9uKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFNldCBhdHRyaWJ1dGVcbiAgICBidXR0b24uc2V0QXR0cmlidXRlKCdocmVmJywgdGhpcy5kb3dubG9hZCk7XG4gIH0sXG5cbiAgLy8gQnVpbGQgdGhlIGRlZmF1bHQgSFRNTFxuICBjcmVhdGUoZGF0YSkge1xuICAgIGNvbnN0IHtcbiAgICAgIGJpbmRNZW51SXRlbVNob3J0Y3V0cyxcbiAgICAgIGNyZWF0ZUJ1dHRvbixcbiAgICAgIGNyZWF0ZVByb2dyZXNzLFxuICAgICAgY3JlYXRlUmFuZ2UsXG4gICAgICBjcmVhdGVUaW1lLFxuICAgICAgc2V0UXVhbGl0eU1lbnUsXG4gICAgICBzZXRTcGVlZE1lbnUsXG4gICAgICBzaG93TWVudVBhbmVsLFxuICAgIH0gPSBjb250cm9scztcbiAgICB0aGlzLmVsZW1lbnRzLmNvbnRyb2xzID0gbnVsbDtcblxuICAgIC8vIExhcmdlciBvdmVybGFpZCBwbGF5IGJ1dHRvblxuICAgIGlmIChpcy5hcnJheSh0aGlzLmNvbmZpZy5jb250cm9scykgJiYgdGhpcy5jb25maWcuY29udHJvbHMuaW5jbHVkZXMoJ3BsYXktbGFyZ2UnKSkge1xuICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ3BsYXktbGFyZ2UnKSk7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIHRoZSBjb250YWluZXJcbiAgICBjb25zdCBjb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5jb250cm9scy53cmFwcGVyKSk7XG4gICAgdGhpcy5lbGVtZW50cy5jb250cm9scyA9IGNvbnRhaW5lcjtcblxuICAgIC8vIERlZmF1bHQgaXRlbSBhdHRyaWJ1dGVzXG4gICAgY29uc3QgZGVmYXVsdEF0dHJpYnV0ZXMgPSB7IGNsYXNzOiAncGx5cl9fY29udHJvbHNfX2l0ZW0nIH07XG5cbiAgICAvLyBMb29wIHRocm91Z2ggY29udHJvbHMgaW4gb3JkZXJcbiAgICBkZWR1cGUoaXMuYXJyYXkodGhpcy5jb25maWcuY29udHJvbHMpID8gdGhpcy5jb25maWcuY29udHJvbHMgOiBbXSkuZm9yRWFjaCgoY29udHJvbCkgPT4ge1xuICAgICAgLy8gUmVzdGFydCBidXR0b25cbiAgICAgIGlmIChjb250cm9sID09PSAncmVzdGFydCcpIHtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdyZXN0YXJ0JywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgIH1cblxuICAgICAgLy8gUmV3aW5kIGJ1dHRvblxuICAgICAgaWYgKGNvbnRyb2wgPT09ICdyZXdpbmQnKSB7XG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAncmV3aW5kJywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgIH1cblxuICAgICAgLy8gUGxheS9QYXVzZSBidXR0b25cbiAgICAgIGlmIChjb250cm9sID09PSAncGxheScpIHtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdwbGF5JywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgIH1cblxuICAgICAgLy8gRmFzdCBmb3J3YXJkIGJ1dHRvblxuICAgICAgaWYgKGNvbnRyb2wgPT09ICdmYXN0LWZvcndhcmQnKSB7XG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAnZmFzdC1mb3J3YXJkJywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgIH1cblxuICAgICAgLy8gUHJvZ3Jlc3NcbiAgICAgIGlmIChjb250cm9sID09PSAncHJvZ3Jlc3MnKSB7XG4gICAgICAgIGNvbnN0IHByb2dyZXNzQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgIGNsYXNzOiBgJHtkZWZhdWx0QXR0cmlidXRlcy5jbGFzc30gcGx5cl9fcHJvZ3Jlc3NfX2NvbnRhaW5lcmAsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHByb2dyZXNzID0gY3JlYXRlRWxlbWVudCgnZGl2JywgZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMucHJvZ3Jlc3MpKTtcblxuICAgICAgICAvLyBTZWVrIHJhbmdlIHNsaWRlclxuICAgICAgICBwcm9ncmVzcy5hcHBlbmRDaGlsZChcbiAgICAgICAgICBjcmVhdGVSYW5nZS5jYWxsKHRoaXMsICdzZWVrJywge1xuICAgICAgICAgICAgaWQ6IGBwbHlyLXNlZWstJHtkYXRhLmlkfWAsXG4gICAgICAgICAgfSksXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gQnVmZmVyIHByb2dyZXNzXG4gICAgICAgIHByb2dyZXNzLmFwcGVuZENoaWxkKGNyZWF0ZVByb2dyZXNzLmNhbGwodGhpcywgJ2J1ZmZlcicpKTtcblxuICAgICAgICAvLyBUT0RPOiBBZGQgbG9vcCBkaXNwbGF5IGluZGljYXRvclxuXG4gICAgICAgIC8vIFNlZWsgdG9vbHRpcFxuICAgICAgICBpZiAodGhpcy5jb25maWcudG9vbHRpcHMuc2Vlaykge1xuICAgICAgICAgIGNvbnN0IHRvb2x0aXAgPSBjcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgJ3NwYW4nLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy50b29sdGlwLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICcwMDowMCcsXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIHByb2dyZXNzLmFwcGVuZENoaWxkKHRvb2x0aXApO1xuICAgICAgICAgIHRoaXMuZWxlbWVudHMuZGlzcGxheS5zZWVrVG9vbHRpcCA9IHRvb2x0aXA7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVsZW1lbnRzLnByb2dyZXNzID0gcHJvZ3Jlc3M7XG4gICAgICAgIHByb2dyZXNzQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudHMucHJvZ3Jlc3MpO1xuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NDb250YWluZXIpO1xuICAgICAgfVxuXG4gICAgICAvLyBNZWRpYSBjdXJyZW50IHRpbWUgZGlzcGxheVxuICAgICAgaWYgKGNvbnRyb2wgPT09ICdjdXJyZW50LXRpbWUnKSB7XG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVUaW1lLmNhbGwodGhpcywgJ2N1cnJlbnRUaW1lJywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgIH1cblxuICAgICAgLy8gTWVkaWEgZHVyYXRpb24gZGlzcGxheVxuICAgICAgaWYgKGNvbnRyb2wgPT09ICdkdXJhdGlvbicpIHtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZVRpbWUuY2FsbCh0aGlzLCAnZHVyYXRpb24nLCBkZWZhdWx0QXR0cmlidXRlcykpO1xuICAgICAgfVxuXG4gICAgICAvLyBWb2x1bWUgY29udHJvbHNcbiAgICAgIGlmIChjb250cm9sID09PSAnbXV0ZScgfHwgY29udHJvbCA9PT0gJ3ZvbHVtZScpIHtcbiAgICAgICAgbGV0IHsgdm9sdW1lIH0gPSB0aGlzLmVsZW1lbnRzO1xuXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgdm9sdW1lIGNvbnRhaW5lciBpZiBuZWVkZWRcbiAgICAgICAgaWYgKCFpcy5lbGVtZW50KHZvbHVtZSkgfHwgIWNvbnRhaW5lci5jb250YWlucyh2b2x1bWUpKSB7XG4gICAgICAgICAgdm9sdW1lID0gY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgZXh0ZW5kKHt9LCBkZWZhdWx0QXR0cmlidXRlcywge1xuICAgICAgICAgICAgICBjbGFzczogYCR7ZGVmYXVsdEF0dHJpYnV0ZXMuY2xhc3N9IHBseXJfX3ZvbHVtZWAudHJpbSgpLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIHRoaXMuZWxlbWVudHMudm9sdW1lID0gdm9sdW1lO1xuXG4gICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHZvbHVtZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUb2dnbGUgbXV0ZSBidXR0b25cbiAgICAgICAgaWYgKGNvbnRyb2wgPT09ICdtdXRlJykge1xuICAgICAgICAgIHZvbHVtZS5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAnbXV0ZScpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZvbHVtZSByYW5nZSBjb250cm9sXG4gICAgICAgIC8vIElnbm9yZWQgb24gaU9TIGFzIGl0J3MgaGFuZGxlZCBnbG9iYWxseVxuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5hcHBsZS5jb20vbGlicmFyeS9zYWZhcmkvZG9jdW1lbnRhdGlvbi9BdWRpb1ZpZGVvL0NvbmNlcHR1YWwvVXNpbmdfSFRNTDVfQXVkaW9fVmlkZW8vRGV2aWNlLVNwZWNpZmljQ29uc2lkZXJhdGlvbnMvRGV2aWNlLVNwZWNpZmljQ29uc2lkZXJhdGlvbnMuaHRtbFxuICAgICAgICBpZiAoY29udHJvbCA9PT0gJ3ZvbHVtZScgJiYgIWJyb3dzZXIuaXNJb3MpIHtcbiAgICAgICAgICAvLyBTZXQgdGhlIGF0dHJpYnV0ZXNcbiAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0ge1xuICAgICAgICAgICAgbWF4OiAxLFxuICAgICAgICAgICAgc3RlcDogMC4wNSxcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLmNvbmZpZy52b2x1bWUsXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIC8vIENyZWF0ZSB0aGUgdm9sdW1lIHJhbmdlIHNsaWRlclxuICAgICAgICAgIHZvbHVtZS5hcHBlbmRDaGlsZChcbiAgICAgICAgICAgIGNyZWF0ZVJhbmdlLmNhbGwoXG4gICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICd2b2x1bWUnLFxuICAgICAgICAgICAgICBleHRlbmQoYXR0cmlidXRlcywge1xuICAgICAgICAgICAgICAgIGlkOiBgcGx5ci12b2x1bWUtJHtkYXRhLmlkfWAsXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFRvZ2dsZSBjYXB0aW9ucyBidXR0b25cbiAgICAgIGlmIChjb250cm9sID09PSAnY2FwdGlvbnMnKSB7XG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAnY2FwdGlvbnMnLCBkZWZhdWx0QXR0cmlidXRlcykpO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXR0aW5ncyBidXR0b24gLyBtZW51XG4gICAgICBpZiAoY29udHJvbCA9PT0gJ3NldHRpbmdzJyAmJiAhaXMuZW1wdHkodGhpcy5jb25maWcuc2V0dGluZ3MpKSB7XG4gICAgICAgIGNvbnN0IHdyYXBwZXIgPSBjcmVhdGVFbGVtZW50KFxuICAgICAgICAgICdkaXYnLFxuICAgICAgICAgIGV4dGVuZCh7fSwgZGVmYXVsdEF0dHJpYnV0ZXMsIHtcbiAgICAgICAgICAgIGNsYXNzOiBgJHtkZWZhdWx0QXR0cmlidXRlcy5jbGFzc30gcGx5cl9fbWVudWAudHJpbSgpLFxuICAgICAgICAgICAgaGlkZGVuOiAnJyxcbiAgICAgICAgICB9KSxcbiAgICAgICAgKTtcblxuICAgICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKFxuICAgICAgICAgIGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdzZXR0aW5ncycsIHtcbiAgICAgICAgICAgICdhcmlhLWhhc3BvcHVwJzogdHJ1ZSxcbiAgICAgICAgICAgICdhcmlhLWNvbnRyb2xzJzogYHBseXItc2V0dGluZ3MtJHtkYXRhLmlkfWAsXG4gICAgICAgICAgICAnYXJpYS1leHBhbmRlZCc6IGZhbHNlLFxuICAgICAgICAgIH0pLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHBvcHVwID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgIGNsYXNzOiAncGx5cl9fbWVudV9fY29udGFpbmVyJyxcbiAgICAgICAgICBpZDogYHBseXItc2V0dGluZ3MtJHtkYXRhLmlkfWAsXG4gICAgICAgICAgaGlkZGVuOiAnJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgaW5uZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnKTtcblxuICAgICAgICBjb25zdCBob21lID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgIGlkOiBgcGx5ci1zZXR0aW5ncy0ke2RhdGEuaWR9LWhvbWVgLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDcmVhdGUgdGhlIG1lbnVcbiAgICAgICAgY29uc3QgbWVudSA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICByb2xlOiAnbWVudScsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGhvbWUuYXBwZW5kQ2hpbGQobWVudSk7XG4gICAgICAgIGlubmVyLmFwcGVuZENoaWxkKGhvbWUpO1xuICAgICAgICB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVscy5ob21lID0gaG9tZTtcblxuICAgICAgICAvLyBCdWlsZCB0aGUgbWVudSBpdGVtc1xuICAgICAgICB0aGlzLmNvbmZpZy5zZXR0aW5ncy5mb3JFYWNoKCh0eXBlKSA9PiB7XG4gICAgICAgICAgLy8gVE9ETzogYnVuZGxlIHRoaXMgd2l0aCB0aGUgY3JlYXRlTWVudUl0ZW0gaGVscGVyIGFuZCBiaW5kaW5nc1xuICAgICAgICAgIGNvbnN0IG1lbnVJdGVtID0gY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICdidXR0b24nLFxuICAgICAgICAgICAgZXh0ZW5kKGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMuc2V0dGluZ3MpLCB7XG4gICAgICAgICAgICAgIHR5cGU6ICdidXR0b24nLFxuICAgICAgICAgICAgICBjbGFzczogYCR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sfSAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMuY29udHJvbH0tLWZvcndhcmRgLFxuICAgICAgICAgICAgICByb2xlOiAnbWVudWl0ZW0nLFxuICAgICAgICAgICAgICAnYXJpYS1oYXNwb3B1cCc6IHRydWUsXG4gICAgICAgICAgICAgIGhpZGRlbjogJycsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgLy8gQmluZCBtZW51IHNob3J0Y3V0cyBmb3Iga2V5Ym9hcmQgdXNlcnNcbiAgICAgICAgICBiaW5kTWVudUl0ZW1TaG9ydGN1dHMuY2FsbCh0aGlzLCBtZW51SXRlbSwgdHlwZSk7XG5cbiAgICAgICAgICAvLyBTaG93IG1lbnUgb24gY2xpY2tcbiAgICAgICAgICBvbi5jYWxsKHRoaXMsIG1lbnVJdGVtLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBzaG93TWVudVBhbmVsLmNhbGwodGhpcywgdHlwZSwgZmFsc2UpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY29uc3QgZmxleCA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCBudWxsLCBpMThuLmdldCh0eXBlLCB0aGlzLmNvbmZpZykpO1xuXG4gICAgICAgICAgY29uc3QgdmFsdWUgPSBjcmVhdGVFbGVtZW50KCdzcGFuJywge1xuICAgICAgICAgICAgY2xhc3M6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMubWVudS52YWx1ZSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIFNwZWVkIGNvbnRhaW5zIEhUTUwgZW50aXRpZXNcbiAgICAgICAgICB2YWx1ZS5pbm5lckhUTUwgPSBkYXRhW3R5cGVdO1xuXG4gICAgICAgICAgZmxleC5hcHBlbmRDaGlsZCh2YWx1ZSk7XG4gICAgICAgICAgbWVudUl0ZW0uYXBwZW5kQ2hpbGQoZmxleCk7XG4gICAgICAgICAgbWVudS5hcHBlbmRDaGlsZChtZW51SXRlbSk7XG5cbiAgICAgICAgICAvLyBCdWlsZCB0aGUgcGFuZXNcbiAgICAgICAgICBjb25zdCBwYW5lID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgaWQ6IGBwbHlyLXNldHRpbmdzLSR7ZGF0YS5pZH0tJHt0eXBlfWAsXG4gICAgICAgICAgICBoaWRkZW46ICcnLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gQmFjayBidXR0b25cbiAgICAgICAgICBjb25zdCBiYWNrQnV0dG9uID0gY3JlYXRlRWxlbWVudCgnYnV0dG9uJywge1xuICAgICAgICAgICAgdHlwZTogJ2J1dHRvbicsXG4gICAgICAgICAgICBjbGFzczogYCR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sfSAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMuY29udHJvbH0tLWJhY2tgLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gVmlzaWJsZSBsYWJlbFxuICAgICAgICAgIGJhY2tCdXR0b24uYXBwZW5kQ2hpbGQoXG4gICAgICAgICAgICBjcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAnc3BhbicsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAnYXJpYS1oaWRkZW4nOiB0cnVlLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBpMThuLmdldCh0eXBlLCB0aGlzLmNvbmZpZyksXG4gICAgICAgICAgICApLFxuICAgICAgICAgICk7XG5cbiAgICAgICAgICAvLyBTY3JlZW4gcmVhZGVyIGxhYmVsXG4gICAgICAgICAgYmFja0J1dHRvbi5hcHBlbmRDaGlsZChcbiAgICAgICAgICAgIGNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICdzcGFuJyxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmhpZGRlbixcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaTE4bi5nZXQoJ21lbnVCYWNrJywgdGhpcy5jb25maWcpLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgLy8gR28gYmFjayB2aWEga2V5Ym9hcmRcbiAgICAgICAgICBvbi5jYWxsKFxuICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgIHBhbmUsXG4gICAgICAgICAgICAna2V5ZG93bicsXG4gICAgICAgICAgICAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleSAhPT0gJ0Fycm93TGVmdCcpIHJldHVybjtcblxuICAgICAgICAgICAgICAvLyBQcmV2ZW50IHNlZWtcbiAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgICAgICAgLy8gU2hvdyB0aGUgcmVzcGVjdGl2ZSBtZW51XG4gICAgICAgICAgICAgIHNob3dNZW51UGFuZWwuY2FsbCh0aGlzLCAnaG9tZScsIHRydWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICk7XG5cbiAgICAgICAgICAvLyBHbyBiYWNrIHZpYSBidXR0b24gY2xpY2tcbiAgICAgICAgICBvbi5jYWxsKHRoaXMsIGJhY2tCdXR0b24sICdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHNob3dNZW51UGFuZWwuY2FsbCh0aGlzLCAnaG9tZScsIGZhbHNlKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIEFkZCB0byBwYW5lXG4gICAgICAgICAgcGFuZS5hcHBlbmRDaGlsZChiYWNrQnV0dG9uKTtcblxuICAgICAgICAgIC8vIE1lbnVcbiAgICAgICAgICBwYW5lLmFwcGVuZENoaWxkKFxuICAgICAgICAgICAgY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgICByb2xlOiAnbWVudScsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgaW5uZXIuYXBwZW5kQ2hpbGQocGFuZSk7XG5cbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLmJ1dHRvbnNbdHlwZV0gPSBtZW51SXRlbTtcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVsc1t0eXBlXSA9IHBhbmU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHBvcHVwLmFwcGVuZENoaWxkKGlubmVyKTtcbiAgICAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChwb3B1cCk7XG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh3cmFwcGVyKTtcblxuICAgICAgICB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBvcHVwID0gcG9wdXA7XG4gICAgICAgIHRoaXMuZWxlbWVudHMuc2V0dGluZ3MubWVudSA9IHdyYXBwZXI7XG4gICAgICB9XG5cbiAgICAgIC8vIFBpY3R1cmUgaW4gcGljdHVyZSBidXR0b25cbiAgICAgIGlmIChjb250cm9sID09PSAncGlwJyAmJiBzdXBwb3J0LnBpcCkge1xuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ3BpcCcsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFpcnBsYXkgYnV0dG9uXG4gICAgICBpZiAoY29udHJvbCA9PT0gJ2FpcnBsYXknICYmIHN1cHBvcnQuYWlycGxheSkge1xuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ2FpcnBsYXknLCBkZWZhdWx0QXR0cmlidXRlcykpO1xuICAgICAgfVxuXG4gICAgICAvLyBEb3dubG9hZCBidXR0b25cbiAgICAgIGlmIChjb250cm9sID09PSAnZG93bmxvYWQnKSB7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBleHRlbmQoe30sIGRlZmF1bHRBdHRyaWJ1dGVzLCB7XG4gICAgICAgICAgZWxlbWVudDogJ2EnLFxuICAgICAgICAgIGhyZWY6IHRoaXMuZG93bmxvYWQsXG4gICAgICAgICAgdGFyZ2V0OiAnX2JsYW5rJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU2V0IGRvd25sb2FkIGF0dHJpYnV0ZSBmb3IgSFRNTDUgb25seVxuICAgICAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICAgICAgYXR0cmlidXRlcy5kb3dubG9hZCA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgeyBkb3dubG9hZCB9ID0gdGhpcy5jb25maWcudXJscztcblxuICAgICAgICBpZiAoIWlzLnVybChkb3dubG9hZCkgJiYgdGhpcy5pc0VtYmVkKSB7XG4gICAgICAgICAgZXh0ZW5kKGF0dHJpYnV0ZXMsIHtcbiAgICAgICAgICAgIGljb246IGBsb2dvLSR7dGhpcy5wcm92aWRlcn1gLFxuICAgICAgICAgICAgbGFiZWw6IHRoaXMucHJvdmlkZXIsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ2Rvd25sb2FkJywgYXR0cmlidXRlcykpO1xuICAgICAgfVxuXG4gICAgICAvLyBUb2dnbGUgZnVsbHNjcmVlbiBidXR0b25cbiAgICAgIGlmIChjb250cm9sID09PSAnZnVsbHNjcmVlbicpIHtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdmdWxsc2NyZWVuJywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFNldCBhdmFpbGFibGUgcXVhbGl0eSBsZXZlbHNcbiAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICBzZXRRdWFsaXR5TWVudS5jYWxsKHRoaXMsIGh0bWw1LmdldFF1YWxpdHlPcHRpb25zLmNhbGwodGhpcykpO1xuICAgIH1cblxuICAgIHNldFNwZWVkTWVudS5jYWxsKHRoaXMpO1xuXG4gICAgcmV0dXJuIGNvbnRhaW5lcjtcbiAgfSxcblxuICAvLyBJbnNlcnQgY29udHJvbHNcbiAgaW5qZWN0KCkge1xuICAgIC8vIFNwcml0ZVxuICAgIGlmICh0aGlzLmNvbmZpZy5sb2FkU3ByaXRlKSB7XG4gICAgICBjb25zdCBpY29uID0gY29udHJvbHMuZ2V0SWNvblVybC5jYWxsKHRoaXMpO1xuXG4gICAgICAvLyBPbmx5IGxvYWQgZXh0ZXJuYWwgc3ByaXRlIHVzaW5nIEFKQVhcbiAgICAgIGlmIChpY29uLmNvcnMpIHtcbiAgICAgICAgbG9hZFNwcml0ZShpY29uLnVybCwgJ3Nwcml0ZS1wbHlyJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGEgdW5pcXVlIElEXG4gICAgdGhpcy5pZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKTtcblxuICAgIC8vIE51bGwgYnkgZGVmYXVsdFxuICAgIGxldCBjb250YWluZXIgPSBudWxsO1xuICAgIHRoaXMuZWxlbWVudHMuY29udHJvbHMgPSBudWxsO1xuXG4gICAgLy8gU2V0IHRlbXBsYXRlIHByb3BlcnRpZXNcbiAgICBjb25zdCBwcm9wcyA9IHtcbiAgICAgIGlkOiB0aGlzLmlkLFxuICAgICAgc2Vla3RpbWU6IHRoaXMuY29uZmlnLnNlZWtUaW1lLFxuICAgICAgdGl0bGU6IHRoaXMuY29uZmlnLnRpdGxlLFxuICAgIH07XG4gICAgbGV0IHVwZGF0ZSA9IHRydWU7XG5cbiAgICAvLyBJZiBmdW5jdGlvbiwgcnVuIGl0IGFuZCB1c2Ugb3V0cHV0XG4gICAgaWYgKGlzLmZ1bmN0aW9uKHRoaXMuY29uZmlnLmNvbnRyb2xzKSkge1xuICAgICAgdGhpcy5jb25maWcuY29udHJvbHMgPSB0aGlzLmNvbmZpZy5jb250cm9scy5jYWxsKHRoaXMsIHByb3BzKTtcbiAgICB9XG5cbiAgICAvLyBDb252ZXJ0IGZhbHN5IGNvbnRyb2xzIHRvIGVtcHR5IGFycmF5IChwcmltYXJpbHkgZm9yIGVtcHR5IHN0cmluZ3MpXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5jb250cm9scykge1xuICAgICAgdGhpcy5jb25maWcuY29udHJvbHMgPSBbXTtcbiAgICB9XG5cbiAgICBpZiAoaXMuZWxlbWVudCh0aGlzLmNvbmZpZy5jb250cm9scykgfHwgaXMuc3RyaW5nKHRoaXMuY29uZmlnLmNvbnRyb2xzKSkge1xuICAgICAgLy8gSFRNTEVsZW1lbnQgb3IgTm9uLWVtcHR5IHN0cmluZyBwYXNzZWQgYXMgdGhlIG9wdGlvblxuICAgICAgY29udGFpbmVyID0gdGhpcy5jb25maWcuY29udHJvbHM7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIENyZWF0ZSBjb250cm9sc1xuICAgICAgY29udGFpbmVyID0gY29udHJvbHMuY3JlYXRlLmNhbGwodGhpcywge1xuICAgICAgICBpZDogdGhpcy5pZCxcbiAgICAgICAgc2Vla3RpbWU6IHRoaXMuY29uZmlnLnNlZWtUaW1lLFxuICAgICAgICBzcGVlZDogdGhpcy5zcGVlZCxcbiAgICAgICAgcXVhbGl0eTogdGhpcy5xdWFsaXR5LFxuICAgICAgICBjYXB0aW9uczogY2FwdGlvbnMuZ2V0TGFiZWwuY2FsbCh0aGlzKSxcbiAgICAgICAgLy8gVE9ETzogTG9vcGluZ1xuICAgICAgICAvLyBsb29wOiAnTm9uZScsXG4gICAgICB9KTtcbiAgICAgIHVwZGF0ZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFJlcGxhY2UgcHJvcHMgd2l0aCB0aGVpciB2YWx1ZVxuICAgIGNvbnN0IHJlcGxhY2UgPSAoaW5wdXQpID0+IHtcbiAgICAgIGxldCByZXN1bHQgPSBpbnB1dDtcblxuICAgICAgT2JqZWN0LmVudHJpZXMocHJvcHMpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICByZXN1bHQgPSByZXBsYWNlQWxsKHJlc3VsdCwgYHske2tleX19YCwgdmFsdWUpO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIC8vIFVwZGF0ZSBtYXJrdXBcbiAgICBpZiAodXBkYXRlKSB7XG4gICAgICBpZiAoaXMuc3RyaW5nKHRoaXMuY29uZmlnLmNvbnRyb2xzKSkge1xuICAgICAgICBjb250YWluZXIgPSByZXBsYWNlKGNvbnRhaW5lcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ29udHJvbHMgY29udGFpbmVyXG4gICAgbGV0IHRhcmdldDtcblxuICAgIC8vIEluamVjdCB0byBjdXN0b20gbG9jYXRpb25cbiAgICBpZiAoaXMuc3RyaW5nKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5jb250cm9scy5jb250YWluZXIpKSB7XG4gICAgICB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5jb250cm9scy5jb250YWluZXIpO1xuICAgIH1cblxuICAgIC8vIEluamVjdCBpbnRvIHRoZSBjb250YWluZXIgYnkgZGVmYXVsdFxuICAgIGlmICghaXMuZWxlbWVudCh0YXJnZXQpKSB7XG4gICAgICB0YXJnZXQgPSB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lcjtcbiAgICB9XG5cbiAgICAvLyBJbmplY3QgY29udHJvbHMgSFRNTCAobmVlZHMgdG8gYmUgYmVmb3JlIGNhcHRpb25zLCBoZW5jZSBcImFmdGVyYmVnaW5cIilcbiAgICBjb25zdCBpbnNlcnRNZXRob2QgPSBpcy5lbGVtZW50KGNvbnRhaW5lcikgPyAnaW5zZXJ0QWRqYWNlbnRFbGVtZW50JyA6ICdpbnNlcnRBZGphY2VudEhUTUwnO1xuICAgIHRhcmdldFtpbnNlcnRNZXRob2RdKCdhZnRlcmJlZ2luJywgY29udGFpbmVyKTtcblxuICAgIC8vIEZpbmQgdGhlIGVsZW1lbnRzIGlmIG5lZWQgYmVcbiAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5jb250cm9scykpIHtcbiAgICAgIGNvbnRyb2xzLmZpbmRFbGVtZW50cy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIC8vIEFkZCBwcmVzc2VkIHByb3BlcnR5IHRvIGJ1dHRvbnNcbiAgICBpZiAoIWlzLmVtcHR5KHRoaXMuZWxlbWVudHMuYnV0dG9ucykpIHtcbiAgICAgIGNvbnN0IGFkZFByb3BlcnR5ID0gKGJ1dHRvbikgPT4ge1xuICAgICAgICBjb25zdCBjbGFzc05hbWUgPSB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2xQcmVzc2VkO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYnV0dG9uLCAncHJlc3NlZCcsIHtcbiAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiBoYXNDbGFzcyhidXR0b24sIGNsYXNzTmFtZSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBzZXQocHJlc3NlZCA9IGZhbHNlKSB7XG4gICAgICAgICAgICB0b2dnbGVDbGFzcyhidXR0b24sIGNsYXNzTmFtZSwgcHJlc3NlZCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICAvLyBUb2dnbGUgY2xhc3NuYW1lIHdoZW4gcHJlc3NlZCBwcm9wZXJ0eSBpcyBzZXRcbiAgICAgIE9iamVjdC52YWx1ZXModGhpcy5lbGVtZW50cy5idXR0b25zKVxuICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAgIC5mb3JFYWNoKChidXR0b24pID0+IHtcbiAgICAgICAgICBpZiAoaXMuYXJyYXkoYnV0dG9uKSB8fCBpcy5ub2RlTGlzdChidXR0b24pKSB7XG4gICAgICAgICAgICBBcnJheS5mcm9tKGJ1dHRvbikuZmlsdGVyKEJvb2xlYW4pLmZvckVhY2goYWRkUHJvcGVydHkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhZGRQcm9wZXJ0eShidXR0b24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gRWRnZSBzb21ldGltZXMgZG9lc24ndCBmaW5pc2ggdGhlIHBhaW50IHNvIGZvcmNlIGEgcmVwYWludFxuICAgIGlmIChicm93c2VyLmlzRWRnZSkge1xuICAgICAgcmVwYWludCh0YXJnZXQpO1xuICAgIH1cblxuICAgIC8vIFNldHVwIHRvb2x0aXBzXG4gICAgaWYgKHRoaXMuY29uZmlnLnRvb2x0aXBzLmNvbnRyb2xzKSB7XG4gICAgICBjb25zdCB7IGNsYXNzTmFtZXMsIHNlbGVjdG9ycyB9ID0gdGhpcy5jb25maWc7XG4gICAgICBjb25zdCBzZWxlY3RvciA9IGAke3NlbGVjdG9ycy5jb250cm9scy53cmFwcGVyfSAke3NlbGVjdG9ycy5sYWJlbHN9IC4ke2NsYXNzTmFtZXMuaGlkZGVufWA7XG4gICAgICBjb25zdCBsYWJlbHMgPSBnZXRFbGVtZW50cy5jYWxsKHRoaXMsIHNlbGVjdG9yKTtcblxuICAgICAgQXJyYXkuZnJvbShsYWJlbHMpLmZvckVhY2goKGxhYmVsKSA9PiB7XG4gICAgICAgIHRvZ2dsZUNsYXNzKGxhYmVsLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmhpZGRlbiwgZmFsc2UpO1xuICAgICAgICB0b2dnbGVDbGFzcyhsYWJlbCwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy50b29sdGlwLCB0cnVlKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSxcblxuICAvLyBTZXQgbWVkaWEgbWV0YWRhdGFcbiAgc2V0TWVkaWFNZXRhZGF0YSgpIHtcbiAgICB0cnkge1xuICAgICAgaWYgKCdtZWRpYVNlc3Npb24nIGluIG5hdmlnYXRvcikge1xuICAgICAgICBuYXZpZ2F0b3IubWVkaWFTZXNzaW9uLm1ldGFkYXRhID0gbmV3IHdpbmRvdy5NZWRpYU1ldGFkYXRhKHtcbiAgICAgICAgICB0aXRsZTogdGhpcy5jb25maWcubWVkaWFNZXRhZGF0YS50aXRsZSxcbiAgICAgICAgICBhcnRpc3Q6IHRoaXMuY29uZmlnLm1lZGlhTWV0YWRhdGEuYXJ0aXN0LFxuICAgICAgICAgIGFsYnVtOiB0aGlzLmNvbmZpZy5tZWRpYU1ldGFkYXRhLmFsYnVtLFxuICAgICAgICAgIGFydHdvcms6IHRoaXMuY29uZmlnLm1lZGlhTWV0YWRhdGEuYXJ0d29yayxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoXykge1xuICAgICAgLy8gRG8gbm90aGluZ1xuICAgIH1cbiAgfSxcblxuICAvLyBBZGQgbWFya2Vyc1xuICBzZXRNYXJrZXJzKCkge1xuICAgIGlmICghdGhpcy5kdXJhdGlvbiB8fCB0aGlzLmVsZW1lbnRzLm1hcmtlcnMpIHJldHVybjtcblxuICAgIC8vIEdldCB2YWxpZCBwb2ludHNcbiAgICBjb25zdCBwb2ludHMgPSB0aGlzLmNvbmZpZy5tYXJrZXJzPy5wb2ludHM/LmZpbHRlcigoeyB0aW1lIH0pID0+IHRpbWUgPiAwICYmIHRpbWUgPCB0aGlzLmR1cmF0aW9uKTtcbiAgICBpZiAoIXBvaW50cz8ubGVuZ3RoKSByZXR1cm47XG5cbiAgICBjb25zdCBjb250YWluZXJGcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICBjb25zdCBwb2ludHNGcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICBsZXQgdGlwRWxlbWVudCA9IG51bGw7XG4gICAgY29uc3QgdGlwVmlzaWJsZSA9IGAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMudG9vbHRpcH0tLXZpc2libGVgO1xuICAgIGNvbnN0IHRvZ2dsZVRpcCA9IChzaG93KSA9PiB0b2dnbGVDbGFzcyh0aXBFbGVtZW50LCB0aXBWaXNpYmxlLCBzaG93KTtcblxuICAgIC8vIEluamVjdCBtYXJrZXJzIHRvIHByb2dyZXNzIGNvbnRhaW5lclxuICAgIHBvaW50cy5mb3JFYWNoKChwb2ludCkgPT4ge1xuICAgICAgY29uc3QgbWFya2VyRWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICdzcGFuJyxcbiAgICAgICAge1xuICAgICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLm1hcmtlcixcbiAgICAgICAgfSxcbiAgICAgICAgJycsXG4gICAgICApO1xuXG4gICAgICBjb25zdCBsZWZ0ID0gYCR7KHBvaW50LnRpbWUgLyB0aGlzLmR1cmF0aW9uKSAqIDEwMH0lYDtcblxuICAgICAgaWYgKHRpcEVsZW1lbnQpIHtcbiAgICAgICAgLy8gU2hvdyBvbiBob3ZlclxuICAgICAgICBtYXJrZXJFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG4gICAgICAgICAgaWYgKHBvaW50LmxhYmVsKSByZXR1cm47XG4gICAgICAgICAgdGlwRWxlbWVudC5zdHlsZS5sZWZ0ID0gbGVmdDtcbiAgICAgICAgICB0aXBFbGVtZW50LmlubmVySFRNTCA9IHBvaW50LmxhYmVsO1xuICAgICAgICAgIHRvZ2dsZVRpcCh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSGlkZSBvbiBsZWF2ZVxuICAgICAgICBtYXJrZXJFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG4gICAgICAgICAgdG9nZ2xlVGlwKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIG1hcmtlckVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuY3VycmVudFRpbWUgPSBwb2ludC50aW1lO1xuICAgICAgfSk7XG5cbiAgICAgIG1hcmtlckVsZW1lbnQuc3R5bGUubGVmdCA9IGxlZnQ7XG4gICAgICBwb2ludHNGcmFnbWVudC5hcHBlbmRDaGlsZChtYXJrZXJFbGVtZW50KTtcbiAgICB9KTtcblxuICAgIGNvbnRhaW5lckZyYWdtZW50LmFwcGVuZENoaWxkKHBvaW50c0ZyYWdtZW50KTtcblxuICAgIC8vIEluamVjdCBhIHRvb2x0aXAgaWYgbmVlZGVkXG4gICAgaWYgKCF0aGlzLmNvbmZpZy50b29sdGlwcy5zZWVrKSB7XG4gICAgICB0aXBFbGVtZW50ID0gY3JlYXRlRWxlbWVudChcbiAgICAgICAgJ3NwYW4nLFxuICAgICAgICB7XG4gICAgICAgICAgY2xhc3M6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMudG9vbHRpcCxcbiAgICAgICAgfSxcbiAgICAgICAgJycsXG4gICAgICApO1xuXG4gICAgICBjb250YWluZXJGcmFnbWVudC5hcHBlbmRDaGlsZCh0aXBFbGVtZW50KTtcbiAgICB9XG5cbiAgICB0aGlzLmVsZW1lbnRzLm1hcmtlcnMgPSB7XG4gICAgICBwb2ludHM6IHBvaW50c0ZyYWdtZW50LFxuICAgICAgdGlwOiB0aXBFbGVtZW50LFxuICAgIH07XG5cbiAgICB0aGlzLmVsZW1lbnRzLnByb2dyZXNzLmFwcGVuZENoaWxkKGNvbnRhaW5lckZyYWdtZW50KTtcbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNvbnRyb2xzO1xuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFVSTCB1dGlsc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IGlzIGZyb20gJy4vaXMnO1xuXG4vKipcbiAqIFBhcnNlIGEgc3RyaW5nIHRvIGEgVVJMIG9iamVjdFxuICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IC0gdGhlIFVSTCB0byBiZSBwYXJzZWRcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gc2FmZSAtIGZhaWxzYWZlIHBhcnNpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlVXJsKGlucHV0LCBzYWZlID0gdHJ1ZSkge1xuICBsZXQgdXJsID0gaW5wdXQ7XG5cbiAgaWYgKHNhZmUpIHtcbiAgICBjb25zdCBwYXJzZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgcGFyc2VyLmhyZWYgPSB1cmw7XG4gICAgdXJsID0gcGFyc2VyLmhyZWY7XG4gIH1cblxuICB0cnkge1xuICAgIHJldHVybiBuZXcgVVJMKHVybCk7XG4gIH0gY2F0Y2ggKF8pIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vLyBDb252ZXJ0IG9iamVjdCB0byBVUkxTZWFyY2hQYXJhbXNcbmV4cG9ydCBmdW5jdGlvbiBidWlsZFVybFBhcmFtcyhpbnB1dCkge1xuICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG5cbiAgaWYgKGlzLm9iamVjdChpbnB1dCkpIHtcbiAgICBPYmplY3QuZW50cmllcyhpbnB1dCkuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICBwYXJhbXMuc2V0KGtleSwgdmFsdWUpO1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHBhcmFtcztcbn1cbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQbHlyIENhcHRpb25zXG4vLyBUT0RPOiBDcmVhdGUgYXMgY2xhc3Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBjb250cm9scyBmcm9tICcuL2NvbnRyb2xzJztcbmltcG9ydCBzdXBwb3J0IGZyb20gJy4vc3VwcG9ydCc7XG5pbXBvcnQgeyBkZWR1cGUgfSBmcm9tICcuL3V0aWxzL2FycmF5cyc7XG5pbXBvcnQgYnJvd3NlciBmcm9tICcuL3V0aWxzL2Jyb3dzZXInO1xuaW1wb3J0IHtcbiAgY3JlYXRlRWxlbWVudCxcbiAgZW1wdHlFbGVtZW50LFxuICBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yLFxuICBpbnNlcnRBZnRlcixcbiAgcmVtb3ZlRWxlbWVudCxcbiAgdG9nZ2xlQ2xhc3MsXG59IGZyb20gJy4vdXRpbHMvZWxlbWVudHMnO1xuaW1wb3J0IHsgb24sIHRyaWdnZXJFdmVudCB9IGZyb20gJy4vdXRpbHMvZXZlbnRzJztcbmltcG9ydCBmZXRjaCBmcm9tICcuL3V0aWxzL2ZldGNoJztcbmltcG9ydCBpMThuIGZyb20gJy4vdXRpbHMvaTE4bic7XG5pbXBvcnQgaXMgZnJvbSAnLi91dGlscy9pcyc7XG5pbXBvcnQgeyBnZXRIVE1MIH0gZnJvbSAnLi91dGlscy9zdHJpbmdzJztcbmltcG9ydCB7IHBhcnNlVXJsIH0gZnJvbSAnLi91dGlscy91cmxzJztcblxuY29uc3QgY2FwdGlvbnMgPSB7XG4gIC8vIFNldHVwIGNhcHRpb25zXG4gIHNldHVwKCkge1xuICAgIC8vIFJlcXVpcmVzIFVJIHN1cHBvcnRcbiAgICBpZiAoIXRoaXMuc3VwcG9ydGVkLnVpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gT25seSBWaW1lbyBhbmQgSFRNTDUgdmlkZW8gc3VwcG9ydGVkIGF0IHRoaXMgcG9pbnRcbiAgICBpZiAoIXRoaXMuaXNWaWRlbyB8fCB0aGlzLmlzWW91VHViZSB8fCAodGhpcy5pc0hUTUw1ICYmICFzdXBwb3J0LnRleHRUcmFja3MpKSB7XG4gICAgICAvLyBDbGVhciBtZW51IGFuZCBoaWRlXG4gICAgICBpZiAoXG4gICAgICAgIGlzLmFycmF5KHRoaXMuY29uZmlnLmNvbnRyb2xzKSAmJlxuICAgICAgICB0aGlzLmNvbmZpZy5jb250cm9scy5pbmNsdWRlcygnc2V0dGluZ3MnKSAmJlxuICAgICAgICB0aGlzLmNvbmZpZy5zZXR0aW5ncy5pbmNsdWRlcygnY2FwdGlvbnMnKVxuICAgICAgKSB7XG4gICAgICAgIGNvbnRyb2xzLnNldENhcHRpb25zTWVudS5jYWxsKHRoaXMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gSW5qZWN0IHRoZSBjb250YWluZXJcbiAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5jYXB0aW9ucykpIHtcbiAgICAgIHRoaXMuZWxlbWVudHMuY2FwdGlvbnMgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5jYXB0aW9ucykpO1xuXG4gICAgICBpbnNlcnRBZnRlcih0aGlzLmVsZW1lbnRzLmNhcHRpb25zLCB0aGlzLmVsZW1lbnRzLndyYXBwZXIpO1xuICAgIH1cblxuICAgIC8vIEZpeCBJRSBjYXB0aW9ucyBpZiBDT1JTIGlzIHVzZWRcbiAgICAvLyBGZXRjaCBjYXB0aW9ucyBhbmQgaW5qZWN0IGFzIGJsb2JzIGluc3RlYWQgKGRhdGEgVVJJcyBub3Qgc3VwcG9ydGVkISlcbiAgICBpZiAoYnJvd3Nlci5pc0lFICYmIHdpbmRvdy5VUkwpIHtcbiAgICAgIGNvbnN0IGVsZW1lbnRzID0gdGhpcy5tZWRpYS5xdWVyeVNlbGVjdG9yQWxsKCd0cmFjaycpO1xuXG4gICAgICBBcnJheS5mcm9tKGVsZW1lbnRzKS5mb3JFYWNoKCh0cmFjaykgPT4ge1xuICAgICAgICBjb25zdCBzcmMgPSB0cmFjay5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xuICAgICAgICBjb25zdCB1cmwgPSBwYXJzZVVybChzcmMpO1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICB1cmwgIT09IG51bGwgJiZcbiAgICAgICAgICB1cmwuaG9zdG5hbWUgIT09IHdpbmRvdy5sb2NhdGlvbi5ocmVmLmhvc3RuYW1lICYmXG4gICAgICAgICAgWydodHRwOicsICdodHRwczonXS5pbmNsdWRlcyh1cmwucHJvdG9jb2wpXG4gICAgICAgICkge1xuICAgICAgICAgIGZldGNoKHNyYywgJ2Jsb2InKVxuICAgICAgICAgICAgLnRoZW4oKGJsb2IpID0+IHtcbiAgICAgICAgICAgICAgdHJhY2suc2V0QXR0cmlidXRlKCdzcmMnLCB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgICAgcmVtb3ZlRWxlbWVudCh0cmFjayk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR2V0IGFuZCBzZXQgaW5pdGlhbCBkYXRhXG4gICAgLy8gVGhlIFwicHJlZmVycmVkXCIgb3B0aW9ucyBhcmUgbm90IHJlYWxpemVkIHVubGVzcyAvIHVudGlsIHRoZSB3YW50ZWQgbGFuZ3VhZ2UgaGFzIGEgbWF0Y2hcbiAgICAvLyAqIGxhbmd1YWdlczogQXJyYXkgb2YgdXNlcidzIGJyb3dzZXIgbGFuZ3VhZ2VzLlxuICAgIC8vICogbGFuZ3VhZ2U6ICBUaGUgbGFuZ3VhZ2UgcHJlZmVycmVkIGJ5IHVzZXIgc2V0dGluZ3Mgb3IgY29uZmlnXG4gICAgLy8gKiBhY3RpdmU6ICAgIFRoZSBzdGF0ZSBwcmVmZXJyZWQgYnkgdXNlciBzZXR0aW5ncyBvciBjb25maWdcbiAgICAvLyAqIHRvZ2dsZWQ6ICAgVGhlIHJlYWwgY2FwdGlvbnMgc3RhdGVcblxuICAgIGNvbnN0IGJyb3dzZXJMYW5ndWFnZXMgPSBuYXZpZ2F0b3IubGFuZ3VhZ2VzIHx8IFtuYXZpZ2F0b3IubGFuZ3VhZ2UgfHwgbmF2aWdhdG9yLnVzZXJMYW5ndWFnZSB8fCAnZW4nXTtcbiAgICBjb25zdCBsYW5ndWFnZXMgPSBkZWR1cGUoYnJvd3Nlckxhbmd1YWdlcy5tYXAoKGxhbmd1YWdlKSA9PiBsYW5ndWFnZS5zcGxpdCgnLScpWzBdKSk7XG4gICAgbGV0IGxhbmd1YWdlID0gKHRoaXMuc3RvcmFnZS5nZXQoJ2xhbmd1YWdlJykgfHwgdGhpcy5jb25maWcuY2FwdGlvbnMubGFuZ3VhZ2UgfHwgJ2F1dG8nKS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgLy8gVXNlIGZpcnN0IGJyb3dzZXIgbGFuZ3VhZ2Ugd2hlbiBsYW5ndWFnZSBpcyAnYXV0bydcbiAgICBpZiAobGFuZ3VhZ2UgPT09ICdhdXRvJykge1xuICAgICAgW2xhbmd1YWdlXSA9IGxhbmd1YWdlcztcbiAgICB9XG5cbiAgICBsZXQgYWN0aXZlID0gdGhpcy5zdG9yYWdlLmdldCgnY2FwdGlvbnMnKTtcbiAgICBpZiAoIWlzLmJvb2xlYW4oYWN0aXZlKSkge1xuICAgICAgKHsgYWN0aXZlIH0gPSB0aGlzLmNvbmZpZy5jYXB0aW9ucyk7XG4gICAgfVxuXG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLmNhcHRpb25zLCB7XG4gICAgICB0b2dnbGVkOiBmYWxzZSxcbiAgICAgIGFjdGl2ZSxcbiAgICAgIGxhbmd1YWdlLFxuICAgICAgbGFuZ3VhZ2VzLFxuICAgIH0pO1xuXG4gICAgLy8gV2F0Y2ggY2hhbmdlcyB0byB0ZXh0VHJhY2tzIGFuZCB1cGRhdGUgY2FwdGlvbnMgbWVudVxuICAgIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgIGNvbnN0IHRyYWNrRXZlbnRzID0gdGhpcy5jb25maWcuY2FwdGlvbnMudXBkYXRlID8gJ2FkZHRyYWNrIHJlbW92ZXRyYWNrJyA6ICdyZW1vdmV0cmFjayc7XG4gICAgICBvbi5jYWxsKHRoaXMsIHRoaXMubWVkaWEudGV4dFRyYWNrcywgdHJhY2tFdmVudHMsIGNhcHRpb25zLnVwZGF0ZS5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgYXZhaWxhYmxlIGxhbmd1YWdlcyBpbiBsaXN0IG5leHQgdGljayAodGhlIGV2ZW50IG11c3Qgbm90IGJlIHRyaWdnZXJlZCBiZWZvcmUgdGhlIGxpc3RlbmVycylcbiAgICBzZXRUaW1lb3V0KGNhcHRpb25zLnVwZGF0ZS5iaW5kKHRoaXMpLCAwKTtcbiAgfSxcblxuICAvLyBVcGRhdGUgYXZhaWxhYmxlIGxhbmd1YWdlIG9wdGlvbnMgaW4gc2V0dGluZ3MgYmFzZWQgb24gdHJhY2tzXG4gIHVwZGF0ZSgpIHtcbiAgICBjb25zdCB0cmFja3MgPSBjYXB0aW9ucy5nZXRUcmFja3MuY2FsbCh0aGlzLCB0cnVlKTtcbiAgICAvLyBHZXQgdGhlIHdhbnRlZCBsYW5ndWFnZVxuICAgIGNvbnN0IHsgYWN0aXZlLCBsYW5ndWFnZSwgbWV0YSwgY3VycmVudFRyYWNrTm9kZSB9ID0gdGhpcy5jYXB0aW9ucztcbiAgICBjb25zdCBsYW5ndWFnZUV4aXN0cyA9IEJvb2xlYW4odHJhY2tzLmZpbmQoKHRyYWNrKSA9PiB0cmFjay5sYW5ndWFnZSA9PT0gbGFuZ3VhZ2UpKTtcblxuICAgIC8vIEhhbmRsZSB0cmFja3MgKGFkZCBldmVudCBsaXN0ZW5lciBhbmQgXCJwc2V1ZG9cIi1kZWZhdWx0KVxuICAgIGlmICh0aGlzLmlzSFRNTDUgJiYgdGhpcy5pc1ZpZGVvKSB7XG4gICAgICB0cmFja3NcbiAgICAgICAgLmZpbHRlcigodHJhY2spID0+ICFtZXRhLmdldCh0cmFjaykpXG4gICAgICAgIC5mb3JFYWNoKCh0cmFjaykgPT4ge1xuICAgICAgICAgIHRoaXMuZGVidWcubG9nKCdUcmFjayBhZGRlZCcsIHRyYWNrKTtcblxuICAgICAgICAgIC8vIEF0dGVtcHQgdG8gc3RvcmUgaWYgdGhlIG9yaWdpbmFsIGRvbSBlbGVtZW50IHdhcyBcImRlZmF1bHRcIlxuICAgICAgICAgIG1ldGEuc2V0KHRyYWNrLCB7XG4gICAgICAgICAgICBkZWZhdWx0OiB0cmFjay5tb2RlID09PSAnc2hvd2luZycsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBUdXJuIG9mZiBuYXRpdmUgY2FwdGlvbiByZW5kZXJpbmcgdG8gYXZvaWQgZG91YmxlIGNhcHRpb25zXG4gICAgICAgICAgLy8gTm90ZTogbW9kZT0naGlkZGVuJyBmb3JjZXMgYSB0cmFjayB0byBkb3dubG9hZC4gVG8gZW5zdXJlIGV2ZXJ5IHRyYWNrXG4gICAgICAgICAgLy8gaXNuJ3QgZG93bmxvYWRlZCBhdCBvbmNlLCBvbmx5ICdzaG93aW5nJyB0cmFja3Mgc2hvdWxkIGJlIHJlYXNzaWduZWRcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgICAgICBpZiAodHJhY2subW9kZSA9PT0gJ3Nob3dpbmcnKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgICAgICAgIHRyYWNrLm1vZGUgPSAnaGlkZGVuJztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXIgZm9yIGN1ZSBjaGFuZ2VzXG4gICAgICAgICAgb24uY2FsbCh0aGlzLCB0cmFjaywgJ2N1ZWNoYW5nZScsICgpID0+IGNhcHRpb25zLnVwZGF0ZUN1ZXMuY2FsbCh0aGlzKSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBsYW5ndWFnZSBmaXJzdCB0aW1lIGl0IG1hdGNoZXMsIG9yIGlmIHRoZSBwcmV2aW91cyBtYXRjaGluZyB0cmFjayB3YXMgcmVtb3ZlZFxuICAgIGlmICgobGFuZ3VhZ2VFeGlzdHMgJiYgdGhpcy5sYW5ndWFnZSAhPT0gbGFuZ3VhZ2UpIHx8ICF0cmFja3MuaW5jbHVkZXMoY3VycmVudFRyYWNrTm9kZSkpIHtcbiAgICAgIGNhcHRpb25zLnNldExhbmd1YWdlLmNhbGwodGhpcywgbGFuZ3VhZ2UpO1xuICAgICAgY2FwdGlvbnMudG9nZ2xlLmNhbGwodGhpcywgYWN0aXZlICYmIGxhbmd1YWdlRXhpc3RzKTtcbiAgICB9XG5cbiAgICAvLyBFbmFibGUgb3IgZGlzYWJsZSBjYXB0aW9ucyBiYXNlZCBvbiB0cmFjayBsZW5ndGhcbiAgICBpZiAodGhpcy5lbGVtZW50cykge1xuICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuY2FwdGlvbnMuZW5hYmxlZCwgIWlzLmVtcHR5KHRyYWNrcykpO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBhdmFpbGFibGUgbGFuZ3VhZ2VzIGluIGxpc3RcbiAgICBpZiAoXG4gICAgICBpcy5hcnJheSh0aGlzLmNvbmZpZy5jb250cm9scykgJiZcbiAgICAgIHRoaXMuY29uZmlnLmNvbnRyb2xzLmluY2x1ZGVzKCdzZXR0aW5ncycpICYmXG4gICAgICB0aGlzLmNvbmZpZy5zZXR0aW5ncy5pbmNsdWRlcygnY2FwdGlvbnMnKVxuICAgICkge1xuICAgICAgY29udHJvbHMuc2V0Q2FwdGlvbnNNZW51LmNhbGwodGhpcyk7XG4gICAgfVxuICB9LFxuXG4gIC8vIFRvZ2dsZSBjYXB0aW9ucyBkaXNwbGF5XG4gIC8vIFVzZWQgaW50ZXJuYWxseSBmb3IgdGhlIHRvZ2dsZUNhcHRpb25zIG1ldGhvZCwgd2l0aCB0aGUgcGFzc2l2ZSBvcHRpb24gZm9yY2VkIHRvIGZhbHNlXG4gIHRvZ2dsZShpbnB1dCwgcGFzc2l2ZSA9IHRydWUpIHtcbiAgICAvLyBJZiB0aGVyZSdzIG5vIGZ1bGwgc3VwcG9ydFxuICAgIGlmICghdGhpcy5zdXBwb3J0ZWQudWkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB7IHRvZ2dsZWQgfSA9IHRoaXMuY2FwdGlvbnM7IC8vIEN1cnJlbnQgc3RhdGVcbiAgICBjb25zdCBhY3RpdmVDbGFzcyA9IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuY2FwdGlvbnMuYWN0aXZlO1xuICAgIC8vIEdldCB0aGUgbmV4dCBzdGF0ZVxuICAgIC8vIElmIHRoZSBtZXRob2QgaXMgY2FsbGVkIHdpdGhvdXQgcGFyYW1ldGVyLCB0b2dnbGUgYmFzZWQgb24gY3VycmVudCB2YWx1ZVxuICAgIGNvbnN0IGFjdGl2ZSA9IGlzLm51bGxPclVuZGVmaW5lZChpbnB1dCkgPyAhdG9nZ2xlZCA6IGlucHV0O1xuXG4gICAgLy8gVXBkYXRlIHN0YXRlIGFuZCB0cmlnZ2VyIGV2ZW50XG4gICAgaWYgKGFjdGl2ZSAhPT0gdG9nZ2xlZCkge1xuICAgICAgLy8gV2hlbiBwYXNzaXZlLCBkb24ndCBvdmVycmlkZSB1c2VyIHByZWZlcmVuY2VzXG4gICAgICBpZiAoIXBhc3NpdmUpIHtcbiAgICAgICAgdGhpcy5jYXB0aW9ucy5hY3RpdmUgPSBhY3RpdmU7XG4gICAgICAgIHRoaXMuc3RvcmFnZS5zZXQoeyBjYXB0aW9uczogYWN0aXZlIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBGb3JjZSBsYW5ndWFnZSBpZiB0aGUgY2FsbCBpc24ndCBwYXNzaXZlIGFuZCB0aGVyZSBpcyBubyBtYXRjaGluZyBsYW5ndWFnZSB0byB0b2dnbGUgdG9cbiAgICAgIGlmICghdGhpcy5sYW5ndWFnZSAmJiBhY3RpdmUgJiYgIXBhc3NpdmUpIHtcbiAgICAgICAgY29uc3QgdHJhY2tzID0gY2FwdGlvbnMuZ2V0VHJhY2tzLmNhbGwodGhpcyk7XG4gICAgICAgIGNvbnN0IHRyYWNrID0gY2FwdGlvbnMuZmluZFRyYWNrLmNhbGwodGhpcywgW3RoaXMuY2FwdGlvbnMubGFuZ3VhZ2UsIC4uLnRoaXMuY2FwdGlvbnMubGFuZ3VhZ2VzXSwgdHJ1ZSk7XG5cbiAgICAgICAgLy8gT3ZlcnJpZGUgdXNlciBwcmVmZXJlbmNlcyB0byBhdm9pZCBzd2l0Y2hpbmcgbGFuZ3VhZ2VzIGlmIGEgbWF0Y2hpbmcgdHJhY2sgaXMgYWRkZWRcbiAgICAgICAgdGhpcy5jYXB0aW9ucy5sYW5ndWFnZSA9IHRyYWNrLmxhbmd1YWdlO1xuXG4gICAgICAgIC8vIFNldCBjYXB0aW9uLCBidXQgZG9uJ3Qgc3RvcmUgaW4gbG9jYWxTdG9yYWdlIGFzIHVzZXIgcHJlZmVyZW5jZVxuICAgICAgICBjYXB0aW9ucy5zZXQuY2FsbCh0aGlzLCB0cmFja3MuaW5kZXhPZih0cmFjaykpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIFRvZ2dsZSBidXR0b24gaWYgaXQncyBlbmFibGVkXG4gICAgICBpZiAodGhpcy5lbGVtZW50cy5idXR0b25zLmNhcHRpb25zKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudHMuYnV0dG9ucy5jYXB0aW9ucy5wcmVzc2VkID0gYWN0aXZlO1xuICAgICAgfVxuXG4gICAgICAvLyBBZGQgY2xhc3MgaG9va1xuICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIGFjdGl2ZUNsYXNzLCBhY3RpdmUpO1xuXG4gICAgICB0aGlzLmNhcHRpb25zLnRvZ2dsZWQgPSBhY3RpdmU7XG5cbiAgICAgIC8vIFVwZGF0ZSBzZXR0aW5ncyBtZW51XG4gICAgICBjb250cm9scy51cGRhdGVTZXR0aW5nLmNhbGwodGhpcywgJ2NhcHRpb25zJyk7XG5cbiAgICAgIC8vIFRyaWdnZXIgZXZlbnQgKG5vdCB1c2VkIGludGVybmFsbHkpXG4gICAgICB0cmlnZ2VyRXZlbnQuY2FsbCh0aGlzLCB0aGlzLm1lZGlhLCBhY3RpdmUgPyAnY2FwdGlvbnNlbmFibGVkJyA6ICdjYXB0aW9uc2Rpc2FibGVkJyk7XG4gICAgfVxuXG4gICAgLy8gV2FpdCBmb3IgdGhlIGNhbGwgc3RhY2sgdG8gY2xlYXIgYmVmb3JlIHNldHRpbmcgbW9kZT0naGlkZGVuJ1xuICAgIC8vIG9uIHRoZSBhY3RpdmUgdHJhY2sgLSBmb3JjaW5nIHRoZSBicm93c2VyIHRvIGRvd25sb2FkIGl0XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAoYWN0aXZlICYmIHRoaXMuY2FwdGlvbnMudG9nZ2xlZCkge1xuICAgICAgICB0aGlzLmNhcHRpb25zLmN1cnJlbnRUcmFja05vZGUubW9kZSA9ICdoaWRkZW4nO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuXG4gIC8vIFNldCBjYXB0aW9ucyBieSB0cmFjayBpbmRleFxuICAvLyBVc2VkIGludGVybmFsbHkgZm9yIHRoZSBjdXJyZW50VHJhY2sgc2V0dGVyIHdpdGggdGhlIHBhc3NpdmUgb3B0aW9uIGZvcmNlZCB0byBmYWxzZVxuICBzZXQoaW5kZXgsIHBhc3NpdmUgPSB0cnVlKSB7XG4gICAgY29uc3QgdHJhY2tzID0gY2FwdGlvbnMuZ2V0VHJhY2tzLmNhbGwodGhpcyk7XG5cbiAgICAvLyBEaXNhYmxlIGNhcHRpb25zIGlmIHNldHRpbmcgdG8gLTFcbiAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICBjYXB0aW9ucy50b2dnbGUuY2FsbCh0aGlzLCBmYWxzZSwgcGFzc2l2ZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCFpcy5udW1iZXIoaW5kZXgpKSB7XG4gICAgICB0aGlzLmRlYnVnLndhcm4oJ0ludmFsaWQgY2FwdGlvbiBhcmd1bWVudCcsIGluZGV4KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIShpbmRleCBpbiB0cmFja3MpKSB7XG4gICAgICB0aGlzLmRlYnVnLndhcm4oJ1RyYWNrIG5vdCBmb3VuZCcsIGluZGV4KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5jYXB0aW9ucy5jdXJyZW50VHJhY2sgIT09IGluZGV4KSB7XG4gICAgICB0aGlzLmNhcHRpb25zLmN1cnJlbnRUcmFjayA9IGluZGV4O1xuICAgICAgY29uc3QgdHJhY2sgPSB0cmFja3NbaW5kZXhdO1xuICAgICAgY29uc3QgeyBsYW5ndWFnZSB9ID0gdHJhY2sgfHwge307XG5cbiAgICAgIC8vIFN0b3JlIHJlZmVyZW5jZSB0byBub2RlIGZvciBpbnZhbGlkYXRpb24gb24gcmVtb3ZlXG4gICAgICB0aGlzLmNhcHRpb25zLmN1cnJlbnRUcmFja05vZGUgPSB0cmFjaztcblxuICAgICAgLy8gVXBkYXRlIHNldHRpbmdzIG1lbnVcbiAgICAgIGNvbnRyb2xzLnVwZGF0ZVNldHRpbmcuY2FsbCh0aGlzLCAnY2FwdGlvbnMnKTtcblxuICAgICAgLy8gV2hlbiBwYXNzaXZlLCBkb24ndCBvdmVycmlkZSB1c2VyIHByZWZlcmVuY2VzXG4gICAgICBpZiAoIXBhc3NpdmUpIHtcbiAgICAgICAgdGhpcy5jYXB0aW9ucy5sYW5ndWFnZSA9IGxhbmd1YWdlO1xuICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0KHsgbGFuZ3VhZ2UgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEhhbmRsZSBWaW1lbyBjYXB0aW9uc1xuICAgICAgaWYgKHRoaXMuaXNWaW1lbykge1xuICAgICAgICB0aGlzLmVtYmVkLmVuYWJsZVRleHRUcmFjayhsYW5ndWFnZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFRyaWdnZXIgZXZlbnRcbiAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMsIHRoaXMubWVkaWEsICdsYW5ndWFnZWNoYW5nZScpO1xuICAgIH1cblxuICAgIC8vIFNob3cgY2FwdGlvbnNcbiAgICBjYXB0aW9ucy50b2dnbGUuY2FsbCh0aGlzLCB0cnVlLCBwYXNzaXZlKTtcblxuICAgIGlmICh0aGlzLmlzSFRNTDUgJiYgdGhpcy5pc1ZpZGVvKSB7XG4gICAgICAvLyBJZiB3ZSBjaGFuZ2UgdGhlIGFjdGl2ZSB0cmFjayB3aGlsZSBhIGN1ZSBpcyBhbHJlYWR5IGRpc3BsYXllZCB3ZSBuZWVkIHRvIHVwZGF0ZSBpdFxuICAgICAgY2FwdGlvbnMudXBkYXRlQ3Vlcy5jYWxsKHRoaXMpO1xuICAgIH1cbiAgfSxcblxuICAvLyBTZXQgY2FwdGlvbnMgYnkgbGFuZ3VhZ2VcbiAgLy8gVXNlZCBpbnRlcm5hbGx5IGZvciB0aGUgbGFuZ3VhZ2Ugc2V0dGVyIHdpdGggdGhlIHBhc3NpdmUgb3B0aW9uIGZvcmNlZCB0byBmYWxzZVxuICBzZXRMYW5ndWFnZShpbnB1dCwgcGFzc2l2ZSA9IHRydWUpIHtcbiAgICBpZiAoIWlzLnN0cmluZyhpbnB1dCkpIHtcbiAgICAgIHRoaXMuZGVidWcud2FybignSW52YWxpZCBsYW5ndWFnZSBhcmd1bWVudCcsIGlucHV0KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gTm9ybWFsaXplXG4gICAgY29uc3QgbGFuZ3VhZ2UgPSBpbnB1dC50b0xvd2VyQ2FzZSgpO1xuICAgIHRoaXMuY2FwdGlvbnMubGFuZ3VhZ2UgPSBsYW5ndWFnZTtcblxuICAgIC8vIFNldCBjdXJyZW50VHJhY2tcbiAgICBjb25zdCB0cmFja3MgPSBjYXB0aW9ucy5nZXRUcmFja3MuY2FsbCh0aGlzKTtcbiAgICBjb25zdCB0cmFjayA9IGNhcHRpb25zLmZpbmRUcmFjay5jYWxsKHRoaXMsIFtsYW5ndWFnZV0pO1xuICAgIGNhcHRpb25zLnNldC5jYWxsKHRoaXMsIHRyYWNrcy5pbmRleE9mKHRyYWNrKSwgcGFzc2l2ZSk7XG4gIH0sXG5cbiAgLy8gR2V0IGN1cnJlbnQgdmFsaWQgY2FwdGlvbiB0cmFja3NcbiAgLy8gSWYgdXBkYXRlIGlzIGZhbHNlIGl0IHdpbGwgYWxzbyBpZ25vcmUgdHJhY2tzIHdpdGhvdXQgbWV0YWRhdGFcbiAgLy8gVGhpcyBpcyB1c2VkIHRvIFwiZnJlZXplXCIgdGhlIGxhbmd1YWdlIG9wdGlvbnMgd2hlbiBjYXB0aW9ucy51cGRhdGUgaXMgZmFsc2VcbiAgZ2V0VHJhY2tzKHVwZGF0ZSA9IGZhbHNlKSB7XG4gICAgLy8gSGFuZGxlIG1lZGlhIG9yIHRleHRUcmFja3MgbWlzc2luZyBvciBudWxsXG4gICAgY29uc3QgdHJhY2tzID0gQXJyYXkuZnJvbSgodGhpcy5tZWRpYSB8fCB7fSkudGV4dFRyYWNrcyB8fCBbXSk7XG4gICAgLy8gRm9yIEhUTUw1LCB1c2UgY2FjaGUgaW5zdGVhZCBvZiBjdXJyZW50IHRyYWNrcyB3aGVuIGl0IGV4aXN0cyAoaWYgY2FwdGlvbnMudXBkYXRlIGlzIGZhbHNlKVxuICAgIC8vIEZpbHRlciBvdXQgcmVtb3ZlZCB0cmFja3MgYW5kIHRyYWNrcyB0aGF0IGFyZW4ndCBjYXB0aW9ucy9zdWJ0aXRsZXMgKGZvciBleGFtcGxlIG1ldGFkYXRhKVxuICAgIHJldHVybiB0cmFja3NcbiAgICAgIC5maWx0ZXIoKHRyYWNrKSA9PiAhdGhpcy5pc0hUTUw1IHx8IHVwZGF0ZSB8fCB0aGlzLmNhcHRpb25zLm1ldGEuaGFzKHRyYWNrKSlcbiAgICAgIC5maWx0ZXIoKHRyYWNrKSA9PiBbJ2NhcHRpb25zJywgJ3N1YnRpdGxlcyddLmluY2x1ZGVzKHRyYWNrLmtpbmQpKTtcbiAgfSxcblxuICAvLyBNYXRjaCB0cmFja3MgYmFzZWQgb24gbGFuZ3VhZ2VzIGFuZCBnZXQgdGhlIGZpcnN0XG4gIGZpbmRUcmFjayhsYW5ndWFnZXMsIGZvcmNlID0gZmFsc2UpIHtcbiAgICBjb25zdCB0cmFja3MgPSBjYXB0aW9ucy5nZXRUcmFja3MuY2FsbCh0aGlzKTtcbiAgICBjb25zdCBzb3J0SXNEZWZhdWx0ID0gKHRyYWNrKSA9PiBOdW1iZXIoKHRoaXMuY2FwdGlvbnMubWV0YS5nZXQodHJhY2spIHx8IHt9KS5kZWZhdWx0KTtcbiAgICBjb25zdCBzb3J0ZWQgPSBBcnJheS5mcm9tKHRyYWNrcykuc29ydCgoYSwgYikgPT4gc29ydElzRGVmYXVsdChiKSAtIHNvcnRJc0RlZmF1bHQoYSkpO1xuICAgIGxldCB0cmFjaztcblxuICAgIGxhbmd1YWdlcy5ldmVyeSgobGFuZ3VhZ2UpID0+IHtcbiAgICAgIHRyYWNrID0gc29ydGVkLmZpbmQoKHQpID0+IHQubGFuZ3VhZ2UgPT09IGxhbmd1YWdlKTtcbiAgICAgIHJldHVybiAhdHJhY2s7IC8vIEJyZWFrIGl0ZXJhdGlvbiBpZiB0aGVyZSBpcyBhIG1hdGNoXG4gICAgfSk7XG5cbiAgICAvLyBJZiBubyBtYXRjaCBpcyBmb3VuZCBidXQgaXMgcmVxdWlyZWQsIGdldCBmaXJzdFxuICAgIHJldHVybiB0cmFjayB8fCAoZm9yY2UgPyBzb3J0ZWRbMF0gOiB1bmRlZmluZWQpO1xuICB9LFxuXG4gIC8vIEdldCB0aGUgY3VycmVudCB0cmFja1xuICBnZXRDdXJyZW50VHJhY2soKSB7XG4gICAgcmV0dXJuIGNhcHRpb25zLmdldFRyYWNrcy5jYWxsKHRoaXMpW3RoaXMuY3VycmVudFRyYWNrXTtcbiAgfSxcblxuICAvLyBHZXQgVUkgbGFiZWwgZm9yIHRyYWNrXG4gIGdldExhYmVsKHRyYWNrKSB7XG4gICAgbGV0IGN1cnJlbnRUcmFjayA9IHRyYWNrO1xuXG4gICAgaWYgKCFpcy50cmFjayhjdXJyZW50VHJhY2spICYmIHN1cHBvcnQudGV4dFRyYWNrcyAmJiB0aGlzLmNhcHRpb25zLnRvZ2dsZWQpIHtcbiAgICAgIGN1cnJlbnRUcmFjayA9IGNhcHRpb25zLmdldEN1cnJlbnRUcmFjay5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIGlmIChpcy50cmFjayhjdXJyZW50VHJhY2spKSB7XG4gICAgICBpZiAoIWlzLmVtcHR5KGN1cnJlbnRUcmFjay5sYWJlbCkpIHtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRUcmFjay5sYWJlbDtcbiAgICAgIH1cblxuICAgICAgaWYgKCFpcy5lbXB0eShjdXJyZW50VHJhY2subGFuZ3VhZ2UpKSB7XG4gICAgICAgIHJldHVybiB0cmFjay5sYW5ndWFnZS50b1VwcGVyQ2FzZSgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gaTE4bi5nZXQoJ2VuYWJsZWQnLCB0aGlzLmNvbmZpZyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGkxOG4uZ2V0KCdkaXNhYmxlZCcsIHRoaXMuY29uZmlnKTtcbiAgfSxcblxuICAvLyBVcGRhdGUgY2FwdGlvbnMgdXNpbmcgY3VycmVudCB0cmFjaydzIGFjdGl2ZSBjdWVzXG4gIC8vIEFsc28gb3B0aW9uYWwgYXJyYXkgYXJndW1lbnQgaW4gY2FzZSB0aGVyZSBpc24ndCBhbnkgdHJhY2sgKGV4OiB2aW1lbylcbiAgdXBkYXRlQ3VlcyhpbnB1dCkge1xuICAgIC8vIFJlcXVpcmVzIFVJXG4gICAgaWYgKCF0aGlzLnN1cHBvcnRlZC51aSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmNhcHRpb25zKSkge1xuICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdObyBjYXB0aW9ucyBlbGVtZW50IHRvIHJlbmRlciB0bycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIE9ubHkgYWNjZXB0IGFycmF5IG9yIGVtcHR5IGlucHV0XG4gICAgaWYgKCFpcy5udWxsT3JVbmRlZmluZWQoaW5wdXQpICYmICFBcnJheS5pc0FycmF5KGlucHV0KSkge1xuICAgICAgdGhpcy5kZWJ1Zy53YXJuKCd1cGRhdGVDdWVzOiBJbnZhbGlkIGlucHV0JywgaW5wdXQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBjdWVzID0gaW5wdXQ7XG5cbiAgICAvLyBHZXQgY3VlcyBmcm9tIHRyYWNrXG4gICAgaWYgKCFjdWVzKSB7XG4gICAgICBjb25zdCB0cmFjayA9IGNhcHRpb25zLmdldEN1cnJlbnRUcmFjay5jYWxsKHRoaXMpO1xuXG4gICAgICBjdWVzID0gQXJyYXkuZnJvbSgodHJhY2sgfHwge30pLmFjdGl2ZUN1ZXMgfHwgW10pXG4gICAgICAgIC5tYXAoKGN1ZSkgPT4gY3VlLmdldEN1ZUFzSFRNTCgpKVxuICAgICAgICAubWFwKGdldEhUTUwpO1xuICAgIH1cblxuICAgIC8vIFNldCBuZXcgY2FwdGlvbiB0ZXh0XG4gICAgY29uc3QgY29udGVudCA9IGN1ZXMubWFwKChjdWVUZXh0KSA9PiBjdWVUZXh0LnRyaW0oKSkuam9pbignXFxuJyk7XG4gICAgY29uc3QgY2hhbmdlZCA9IGNvbnRlbnQgIT09IHRoaXMuZWxlbWVudHMuY2FwdGlvbnMuaW5uZXJIVE1MO1xuXG4gICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgIC8vIEVtcHR5IHRoZSBjb250YWluZXIgYW5kIGNyZWF0ZSBhIG5ldyBjaGlsZCBlbGVtZW50XG4gICAgICBlbXB0eUVsZW1lbnQodGhpcy5lbGVtZW50cy5jYXB0aW9ucyk7XG4gICAgICBjb25zdCBjYXB0aW9uID0gY3JlYXRlRWxlbWVudCgnc3BhbicsIGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLmNhcHRpb24pKTtcbiAgICAgIGNhcHRpb24uaW5uZXJIVE1MID0gY29udGVudDtcbiAgICAgIHRoaXMuZWxlbWVudHMuY2FwdGlvbnMuYXBwZW5kQ2hpbGQoY2FwdGlvbik7XG5cbiAgICAgIC8vIFRyaWdnZXIgZXZlbnRcbiAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMsIHRoaXMubWVkaWEsICdjdWVjaGFuZ2UnKTtcbiAgICB9XG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjYXB0aW9ucztcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQbHlyIGRlZmF1bHQgY29uZmlnXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBkZWZhdWx0cyA9IHtcbiAgLy8gRGlzYWJsZVxuICBlbmFibGVkOiB0cnVlLFxuXG4gIC8vIEN1c3RvbSBtZWRpYSB0aXRsZVxuICB0aXRsZTogJycsXG5cbiAgLy8gTG9nZ2luZyB0byBjb25zb2xlXG4gIGRlYnVnOiBmYWxzZSxcblxuICAvLyBBdXRvIHBsYXkgKGlmIHN1cHBvcnRlZClcbiAgYXV0b3BsYXk6IGZhbHNlLFxuXG4gIC8vIE9ubHkgYWxsb3cgb25lIG1lZGlhIHBsYXlpbmcgYXQgb25jZSAodmltZW8gb25seSlcbiAgYXV0b3BhdXNlOiB0cnVlLFxuXG4gIC8vIEFsbG93IGlubGluZSBwbGF5YmFjayBvbiBpT1MgKHRoaXMgZWZmZWN0cyBZb3VUdWJlL1ZpbWVvIC0gSFRNTDUgcmVxdWlyZXMgdGhlIGF0dHJpYnV0ZSBwcmVzZW50KVxuICAvLyBUT0RPOiBSZW1vdmUgaW9zTmF0aXZlIGZ1bGxzY3JlZW4gb3B0aW9uIGluIGZhdm91ciBvZiB0aGlzIChsb2dpYyBuZWVkcyB3b3JrKVxuICBwbGF5c2lubGluZTogdHJ1ZSxcblxuICAvLyBEZWZhdWx0IHRpbWUgdG8gc2tpcCB3aGVuIHJld2luZC9mYXN0IGZvcndhcmRcbiAgc2Vla1RpbWU6IDEwLFxuXG4gIC8vIERlZmF1bHQgdm9sdW1lXG4gIHZvbHVtZTogMSxcbiAgbXV0ZWQ6IGZhbHNlLFxuXG4gIC8vIFBhc3MgYSBjdXN0b20gZHVyYXRpb25cbiAgZHVyYXRpb246IG51bGwsXG5cbiAgLy8gRGlzcGxheSB0aGUgbWVkaWEgZHVyYXRpb24gb24gbG9hZCBpbiB0aGUgY3VycmVudCB0aW1lIHBvc2l0aW9uXG4gIC8vIElmIHlvdSBoYXZlIG9wdGVkIHRvIGRpc3BsYXkgYm90aCBkdXJhdGlvbiBhbmQgY3VycmVudFRpbWUsIHRoaXMgaXMgaWdub3JlZFxuICBkaXNwbGF5RHVyYXRpb246IHRydWUsXG5cbiAgLy8gSW52ZXJ0IHRoZSBjdXJyZW50IHRpbWUgdG8gYmUgYSBjb3VudGRvd25cbiAgaW52ZXJ0VGltZTogdHJ1ZSxcblxuICAvLyBDbGlja2luZyB0aGUgY3VycmVudFRpbWUgaW52ZXJ0cyBpdCdzIHZhbHVlIHRvIHNob3cgdGltZSBsZWZ0IHJhdGhlciB0aGFuIGVsYXBzZWRcbiAgdG9nZ2xlSW52ZXJ0OiB0cnVlLFxuXG4gIC8vIEZvcmNlIGFuIGFzcGVjdCByYXRpb1xuICAvLyBUaGUgZm9ybWF0IG11c3QgYmUgYCd3OmgnYCAoZS5nLiBgJzE2OjknYClcbiAgcmF0aW86IG51bGwsXG5cbiAgLy8gQ2xpY2sgdmlkZW8gY29udGFpbmVyIHRvIHBsYXkvcGF1c2VcbiAgY2xpY2tUb1BsYXk6IHRydWUsXG5cbiAgLy8gQXV0byBoaWRlIHRoZSBjb250cm9sc1xuICBoaWRlQ29udHJvbHM6IHRydWUsXG5cbiAgLy8gUmVzZXQgdG8gc3RhcnQgd2hlbiBwbGF5YmFjayBlbmRlZFxuICByZXNldE9uRW5kOiBmYWxzZSxcblxuICAvLyBEaXNhYmxlIHRoZSBzdGFuZGFyZCBjb250ZXh0IG1lbnVcbiAgZGlzYWJsZUNvbnRleHRNZW51OiB0cnVlLFxuXG4gIC8vIFNwcml0ZSAoZm9yIGljb25zKVxuICBsb2FkU3ByaXRlOiB0cnVlLFxuICBpY29uUHJlZml4OiAncGx5cicsXG4gIGljb25Vcmw6ICdodHRwczovL2Nkbi5wbHlyLmlvLzMuNy4yL3BseXIuc3ZnJyxcblxuICAvLyBCbGFuayB2aWRlbyAodXNlZCB0byBwcmV2ZW50IGVycm9ycyBvbiBzb3VyY2UgY2hhbmdlKVxuICBibGFua1ZpZGVvOiAnaHR0cHM6Ly9jZG4ucGx5ci5pby9zdGF0aWMvYmxhbmsubXA0JyxcblxuICAvLyBRdWFsaXR5IGRlZmF1bHRcbiAgcXVhbGl0eToge1xuICAgIGRlZmF1bHQ6IDU3NixcbiAgICAvLyBUaGUgb3B0aW9ucyB0byBkaXNwbGF5IGluIHRoZSBVSSwgaWYgYXZhaWxhYmxlIGZvciB0aGUgc291cmNlIG1lZGlhXG4gICAgb3B0aW9uczogWzQzMjAsIDI4ODAsIDIxNjAsIDE0NDAsIDEwODAsIDcyMCwgNTc2LCA0ODAsIDM2MCwgMjQwXSxcbiAgICBmb3JjZWQ6IGZhbHNlLFxuICAgIG9uQ2hhbmdlOiBudWxsLFxuICB9LFxuXG4gIC8vIFNldCBsb29wc1xuICBsb29wOiB7XG4gICAgYWN0aXZlOiBmYWxzZSxcbiAgICAvLyBzdGFydDogbnVsbCxcbiAgICAvLyBlbmQ6IG51bGwsXG4gIH0sXG5cbiAgLy8gU3BlZWQgZGVmYXVsdCBhbmQgb3B0aW9ucyB0byBkaXNwbGF5XG4gIHNwZWVkOiB7XG4gICAgc2VsZWN0ZWQ6IDEsXG4gICAgLy8gVGhlIG9wdGlvbnMgdG8gZGlzcGxheSBpbiB0aGUgVUksIGlmIGF2YWlsYWJsZSBmb3IgdGhlIHNvdXJjZSBtZWRpYSAoZS5nLiBWaW1lbyBhbmQgWW91VHViZSBvbmx5IHN1cHBvcnQgMC41eC00eClcbiAgICBvcHRpb25zOiBbMC41LCAwLjc1LCAxLCAxLjI1LCAxLjUsIDEuNzUsIDIsIDRdLFxuICB9LFxuXG4gIC8vIEtleWJvYXJkIHNob3J0Y3V0IHNldHRpbmdzXG4gIGtleWJvYXJkOiB7XG4gICAgZm9jdXNlZDogdHJ1ZSxcbiAgICBnbG9iYWw6IGZhbHNlLFxuICB9LFxuXG4gIC8vIERpc3BsYXkgdG9vbHRpcHNcbiAgdG9vbHRpcHM6IHtcbiAgICBjb250cm9sczogZmFsc2UsXG4gICAgc2VlazogdHJ1ZSxcbiAgfSxcblxuICAvLyBDYXB0aW9ucyBzZXR0aW5nc1xuICBjYXB0aW9uczoge1xuICAgIGFjdGl2ZTogZmFsc2UsXG4gICAgbGFuZ3VhZ2U6ICdhdXRvJyxcbiAgICAvLyBMaXN0ZW4gdG8gbmV3IHRyYWNrcyBhZGRlZCBhZnRlciBQbHlyIGlzIGluaXRpYWxpemVkLlxuICAgIC8vIFRoaXMgaXMgbmVlZGVkIGZvciBzdHJlYW1pbmcgY2FwdGlvbnMsIGJ1dCBtYXkgcmVzdWx0IGluIHVuc2VsZWN0YWJsZSBvcHRpb25zXG4gICAgdXBkYXRlOiBmYWxzZSxcbiAgfSxcblxuICAvLyBGdWxsc2NyZWVuIHNldHRpbmdzXG4gIGZ1bGxzY3JlZW46IHtcbiAgICBlbmFibGVkOiB0cnVlLCAvLyBBbGxvdyBmdWxsc2NyZWVuP1xuICAgIGZhbGxiYWNrOiB0cnVlLCAvLyBGYWxsYmFjayB1c2luZyBmdWxsIHZpZXdwb3J0L3dpbmRvd1xuICAgIGlvc05hdGl2ZTogZmFsc2UsIC8vIFVzZSB0aGUgbmF0aXZlIGZ1bGxzY3JlZW4gaW4gaU9TIChkaXNhYmxlcyBjdXN0b20gY29udHJvbHMpXG4gICAgLy8gU2VsZWN0b3IgZm9yIHRoZSBmdWxsc2NyZWVuIGNvbnRhaW5lciBzbyBjb250ZXh0dWFsIC8gbm9uLXBsYXllciBjb250ZW50IGNhbiByZW1haW4gdmlzaWJsZSBpbiBmdWxsc2NyZWVuIG1vZGVcbiAgICAvLyBOb24tYW5jZXN0b3JzIG9mIHRoZSBwbGF5ZXIgZWxlbWVudCB3aWxsIGJlIGlnbm9yZWRcbiAgICAvLyBjb250YWluZXI6IG51bGwsIC8vIGRlZmF1bHRzIHRvIHRoZSBwbGF5ZXIgZWxlbWVudFxuICB9LFxuXG4gIC8vIExvY2FsIHN0b3JhZ2VcbiAgc3RvcmFnZToge1xuICAgIGVuYWJsZWQ6IHRydWUsXG4gICAga2V5OiAncGx5cicsXG4gIH0sXG5cbiAgLy8gRGVmYXVsdCBjb250cm9sc1xuICBjb250cm9sczogW1xuICAgICdwbGF5LWxhcmdlJyxcbiAgICAvLyAncmVzdGFydCcsXG4gICAgLy8gJ3Jld2luZCcsXG4gICAgJ3BsYXknLFxuICAgIC8vICdmYXN0LWZvcndhcmQnLFxuICAgICdwcm9ncmVzcycsXG4gICAgJ2N1cnJlbnQtdGltZScsXG4gICAgLy8gJ2R1cmF0aW9uJyxcbiAgICAnbXV0ZScsXG4gICAgJ3ZvbHVtZScsXG4gICAgJ2NhcHRpb25zJyxcbiAgICAnc2V0dGluZ3MnLFxuICAgICdwaXAnLFxuICAgICdhaXJwbGF5JyxcbiAgICAvLyAnZG93bmxvYWQnLFxuICAgICdmdWxsc2NyZWVuJyxcbiAgXSxcbiAgc2V0dGluZ3M6IFsnY2FwdGlvbnMnLCAncXVhbGl0eScsICdzcGVlZCddLFxuXG4gIC8vIExvY2FsaXNhdGlvblxuICBpMThuOiB7XG4gICAgcmVzdGFydDogJ1Jlc3RhcnQnLFxuICAgIHJld2luZDogJ1Jld2luZCB7c2Vla3RpbWV9cycsXG4gICAgcGxheTogJ1BsYXknLFxuICAgIHBhdXNlOiAnUGF1c2UnLFxuICAgIGZhc3RGb3J3YXJkOiAnRm9yd2FyZCB7c2Vla3RpbWV9cycsXG4gICAgc2VlazogJ1NlZWsnLFxuICAgIHNlZWtMYWJlbDogJ3tjdXJyZW50VGltZX0gb2Yge2R1cmF0aW9ufScsXG4gICAgcGxheWVkOiAnUGxheWVkJyxcbiAgICBidWZmZXJlZDogJ0J1ZmZlcmVkJyxcbiAgICBjdXJyZW50VGltZTogJ0N1cnJlbnQgdGltZScsXG4gICAgZHVyYXRpb246ICdEdXJhdGlvbicsXG4gICAgdm9sdW1lOiAnVm9sdW1lJyxcbiAgICBtdXRlOiAnTXV0ZScsXG4gICAgdW5tdXRlOiAnVW5tdXRlJyxcbiAgICBlbmFibGVDYXB0aW9uczogJ0VuYWJsZSBjYXB0aW9ucycsXG4gICAgZGlzYWJsZUNhcHRpb25zOiAnRGlzYWJsZSBjYXB0aW9ucycsXG4gICAgZG93bmxvYWQ6ICdEb3dubG9hZCcsXG4gICAgZW50ZXJGdWxsc2NyZWVuOiAnRW50ZXIgZnVsbHNjcmVlbicsXG4gICAgZXhpdEZ1bGxzY3JlZW46ICdFeGl0IGZ1bGxzY3JlZW4nLFxuICAgIGZyYW1lVGl0bGU6ICdQbGF5ZXIgZm9yIHt0aXRsZX0nLFxuICAgIGNhcHRpb25zOiAnQ2FwdGlvbnMnLFxuICAgIHNldHRpbmdzOiAnU2V0dGluZ3MnLFxuICAgIHBpcDogJ1BJUCcsXG4gICAgbWVudUJhY2s6ICdHbyBiYWNrIHRvIHByZXZpb3VzIG1lbnUnLFxuICAgIHNwZWVkOiAnU3BlZWQnLFxuICAgIG5vcm1hbDogJ05vcm1hbCcsXG4gICAgcXVhbGl0eTogJ1F1YWxpdHknLFxuICAgIGxvb3A6ICdMb29wJyxcbiAgICBzdGFydDogJ1N0YXJ0JyxcbiAgICBlbmQ6ICdFbmQnLFxuICAgIGFsbDogJ0FsbCcsXG4gICAgcmVzZXQ6ICdSZXNldCcsXG4gICAgZGlzYWJsZWQ6ICdEaXNhYmxlZCcsXG4gICAgZW5hYmxlZDogJ0VuYWJsZWQnLFxuICAgIGFkdmVydGlzZW1lbnQ6ICdBZCcsXG4gICAgcXVhbGl0eUJhZGdlOiB7XG4gICAgICAyMTYwOiAnNEsnLFxuICAgICAgMTQ0MDogJ0hEJyxcbiAgICAgIDEwODA6ICdIRCcsXG4gICAgICA3MjA6ICdIRCcsXG4gICAgICA1NzY6ICdTRCcsXG4gICAgICA0ODA6ICdTRCcsXG4gICAgfSxcbiAgfSxcblxuICAvLyBVUkxzXG4gIHVybHM6IHtcbiAgICBkb3dubG9hZDogbnVsbCxcbiAgICB2aW1lbzoge1xuICAgICAgc2RrOiAnaHR0cHM6Ly9wbGF5ZXIudmltZW8uY29tL2FwaS9wbGF5ZXIuanMnLFxuICAgICAgaWZyYW1lOiAnaHR0cHM6Ly9wbGF5ZXIudmltZW8uY29tL3ZpZGVvL3swfT97MX0nLFxuICAgICAgYXBpOiAnaHR0cHM6Ly92aW1lby5jb20vYXBpL29lbWJlZC5qc29uP3VybD17MH0nLFxuICAgIH0sXG4gICAgeW91dHViZToge1xuICAgICAgc2RrOiAnaHR0cHM6Ly93d3cueW91dHViZS5jb20vaWZyYW1lX2FwaScsXG4gICAgICBhcGk6ICdodHRwczovL25vZW1iZWQuY29tL2VtYmVkP3VybD1odHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PXswfScsXG4gICAgfSxcbiAgICBnb29nbGVJTUE6IHtcbiAgICAgIHNkazogJ2h0dHBzOi8vaW1hc2RrLmdvb2dsZWFwaXMuY29tL2pzL3Nka2xvYWRlci9pbWEzLmpzJyxcbiAgICB9LFxuICB9LFxuXG4gIC8vIEN1c3RvbSBjb250cm9sIGxpc3RlbmVyc1xuICBsaXN0ZW5lcnM6IHtcbiAgICBzZWVrOiBudWxsLFxuICAgIHBsYXk6IG51bGwsXG4gICAgcGF1c2U6IG51bGwsXG4gICAgcmVzdGFydDogbnVsbCxcbiAgICByZXdpbmQ6IG51bGwsXG4gICAgZmFzdEZvcndhcmQ6IG51bGwsXG4gICAgbXV0ZTogbnVsbCxcbiAgICB2b2x1bWU6IG51bGwsXG4gICAgY2FwdGlvbnM6IG51bGwsXG4gICAgZG93bmxvYWQ6IG51bGwsXG4gICAgZnVsbHNjcmVlbjogbnVsbCxcbiAgICBwaXA6IG51bGwsXG4gICAgYWlycGxheTogbnVsbCxcbiAgICBzcGVlZDogbnVsbCxcbiAgICBxdWFsaXR5OiBudWxsLFxuICAgIGxvb3A6IG51bGwsXG4gICAgbGFuZ3VhZ2U6IG51bGwsXG4gIH0sXG5cbiAgLy8gRXZlbnRzIHRvIHdhdGNoIGFuZCBidWJibGVcbiAgZXZlbnRzOiBbXG4gICAgLy8gRXZlbnRzIHRvIHdhdGNoIG9uIEhUTUw1IG1lZGlhIGVsZW1lbnRzIGFuZCBidWJibGVcbiAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9kb2NzL1dlYi9HdWlkZS9FdmVudHMvTWVkaWFfZXZlbnRzXG4gICAgJ2VuZGVkJyxcbiAgICAncHJvZ3Jlc3MnLFxuICAgICdzdGFsbGVkJyxcbiAgICAncGxheWluZycsXG4gICAgJ3dhaXRpbmcnLFxuICAgICdjYW5wbGF5JyxcbiAgICAnY2FucGxheXRocm91Z2gnLFxuICAgICdsb2Fkc3RhcnQnLFxuICAgICdsb2FkZWRkYXRhJyxcbiAgICAnbG9hZGVkbWV0YWRhdGEnLFxuICAgICd0aW1ldXBkYXRlJyxcbiAgICAndm9sdW1lY2hhbmdlJyxcbiAgICAncGxheScsXG4gICAgJ3BhdXNlJyxcbiAgICAnZXJyb3InLFxuICAgICdzZWVraW5nJyxcbiAgICAnc2Vla2VkJyxcbiAgICAnZW1wdGllZCcsXG4gICAgJ3JhdGVjaGFuZ2UnLFxuICAgICdjdWVjaGFuZ2UnLFxuXG4gICAgLy8gQ3VzdG9tIGV2ZW50c1xuICAgICdkb3dubG9hZCcsXG4gICAgJ2VudGVyZnVsbHNjcmVlbicsXG4gICAgJ2V4aXRmdWxsc2NyZWVuJyxcbiAgICAnY2FwdGlvbnNlbmFibGVkJyxcbiAgICAnY2FwdGlvbnNkaXNhYmxlZCcsXG4gICAgJ2xhbmd1YWdlY2hhbmdlJyxcbiAgICAnY29udHJvbHNoaWRkZW4nLFxuICAgICdjb250cm9sc3Nob3duJyxcbiAgICAncmVhZHknLFxuXG4gICAgLy8gWW91VHViZVxuICAgICdzdGF0ZWNoYW5nZScsXG5cbiAgICAvLyBRdWFsaXR5XG4gICAgJ3F1YWxpdHljaGFuZ2UnLFxuXG4gICAgLy8gQWRzXG4gICAgJ2Fkc2xvYWRlZCcsXG4gICAgJ2Fkc2NvbnRlbnRwYXVzZScsXG4gICAgJ2Fkc2NvbnRlbnRyZXN1bWUnLFxuICAgICdhZHN0YXJ0ZWQnLFxuICAgICdhZHNtaWRwb2ludCcsXG4gICAgJ2Fkc2NvbXBsZXRlJyxcbiAgICAnYWRzYWxsY29tcGxldGUnLFxuICAgICdhZHNpbXByZXNzaW9uJyxcbiAgICAnYWRzY2xpY2snLFxuICBdLFxuXG4gIC8vIFNlbGVjdG9yc1xuICAvLyBDaGFuZ2UgdGhlc2UgdG8gbWF0Y2ggeW91ciB0ZW1wbGF0ZSBpZiB1c2luZyBjdXN0b20gSFRNTFxuICBzZWxlY3RvcnM6IHtcbiAgICBlZGl0YWJsZTogJ2lucHV0LCB0ZXh0YXJlYSwgc2VsZWN0LCBbY29udGVudGVkaXRhYmxlXScsXG4gICAgY29udGFpbmVyOiAnLnBseXInLFxuICAgIGNvbnRyb2xzOiB7XG4gICAgICBjb250YWluZXI6IG51bGwsXG4gICAgICB3cmFwcGVyOiAnLnBseXJfX2NvbnRyb2xzJyxcbiAgICB9LFxuICAgIGxhYmVsczogJ1tkYXRhLXBseXJdJyxcbiAgICBidXR0b25zOiB7XG4gICAgICBwbGF5OiAnW2RhdGEtcGx5cj1cInBsYXlcIl0nLFxuICAgICAgcGF1c2U6ICdbZGF0YS1wbHlyPVwicGF1c2VcIl0nLFxuICAgICAgcmVzdGFydDogJ1tkYXRhLXBseXI9XCJyZXN0YXJ0XCJdJyxcbiAgICAgIHJld2luZDogJ1tkYXRhLXBseXI9XCJyZXdpbmRcIl0nLFxuICAgICAgZmFzdEZvcndhcmQ6ICdbZGF0YS1wbHlyPVwiZmFzdC1mb3J3YXJkXCJdJyxcbiAgICAgIG11dGU6ICdbZGF0YS1wbHlyPVwibXV0ZVwiXScsXG4gICAgICBjYXB0aW9uczogJ1tkYXRhLXBseXI9XCJjYXB0aW9uc1wiXScsXG4gICAgICBkb3dubG9hZDogJ1tkYXRhLXBseXI9XCJkb3dubG9hZFwiXScsXG4gICAgICBmdWxsc2NyZWVuOiAnW2RhdGEtcGx5cj1cImZ1bGxzY3JlZW5cIl0nLFxuICAgICAgcGlwOiAnW2RhdGEtcGx5cj1cInBpcFwiXScsXG4gICAgICBhaXJwbGF5OiAnW2RhdGEtcGx5cj1cImFpcnBsYXlcIl0nLFxuICAgICAgc2V0dGluZ3M6ICdbZGF0YS1wbHlyPVwic2V0dGluZ3NcIl0nLFxuICAgICAgbG9vcDogJ1tkYXRhLXBseXI9XCJsb29wXCJdJyxcbiAgICB9LFxuICAgIGlucHV0czoge1xuICAgICAgc2VlazogJ1tkYXRhLXBseXI9XCJzZWVrXCJdJyxcbiAgICAgIHZvbHVtZTogJ1tkYXRhLXBseXI9XCJ2b2x1bWVcIl0nLFxuICAgICAgc3BlZWQ6ICdbZGF0YS1wbHlyPVwic3BlZWRcIl0nLFxuICAgICAgbGFuZ3VhZ2U6ICdbZGF0YS1wbHlyPVwibGFuZ3VhZ2VcIl0nLFxuICAgICAgcXVhbGl0eTogJ1tkYXRhLXBseXI9XCJxdWFsaXR5XCJdJyxcbiAgICB9LFxuICAgIGRpc3BsYXk6IHtcbiAgICAgIGN1cnJlbnRUaW1lOiAnLnBseXJfX3RpbWUtLWN1cnJlbnQnLFxuICAgICAgZHVyYXRpb246ICcucGx5cl9fdGltZS0tZHVyYXRpb24nLFxuICAgICAgYnVmZmVyOiAnLnBseXJfX3Byb2dyZXNzX19idWZmZXInLFxuICAgICAgbG9vcDogJy5wbHlyX19wcm9ncmVzc19fbG9vcCcsIC8vIFVzZWQgbGF0ZXJcbiAgICAgIHZvbHVtZTogJy5wbHlyX192b2x1bWUtLWRpc3BsYXknLFxuICAgIH0sXG4gICAgcHJvZ3Jlc3M6ICcucGx5cl9fcHJvZ3Jlc3MnLFxuICAgIGNhcHRpb25zOiAnLnBseXJfX2NhcHRpb25zJyxcbiAgICBjYXB0aW9uOiAnLnBseXJfX2NhcHRpb24nLFxuICB9LFxuXG4gIC8vIENsYXNzIGhvb2tzIGFkZGVkIHRvIHRoZSBwbGF5ZXIgaW4gZGlmZmVyZW50IHN0YXRlc1xuICBjbGFzc05hbWVzOiB7XG4gICAgdHlwZTogJ3BseXItLXswfScsXG4gICAgcHJvdmlkZXI6ICdwbHlyLS17MH0nLFxuICAgIHZpZGVvOiAncGx5cl9fdmlkZW8td3JhcHBlcicsXG4gICAgZW1iZWQ6ICdwbHlyX192aWRlby1lbWJlZCcsXG4gICAgdmlkZW9GaXhlZFJhdGlvOiAncGx5cl9fdmlkZW8td3JhcHBlci0tZml4ZWQtcmF0aW8nLFxuICAgIGVtYmVkQ29udGFpbmVyOiAncGx5cl9fdmlkZW8tZW1iZWRfX2NvbnRhaW5lcicsXG4gICAgcG9zdGVyOiAncGx5cl9fcG9zdGVyJyxcbiAgICBwb3N0ZXJFbmFibGVkOiAncGx5cl9fcG9zdGVyLWVuYWJsZWQnLFxuICAgIGFkczogJ3BseXJfX2FkcycsXG4gICAgY29udHJvbDogJ3BseXJfX2NvbnRyb2wnLFxuICAgIGNvbnRyb2xQcmVzc2VkOiAncGx5cl9fY29udHJvbC0tcHJlc3NlZCcsXG4gICAgcGxheWluZzogJ3BseXItLXBsYXlpbmcnLFxuICAgIHBhdXNlZDogJ3BseXItLXBhdXNlZCcsXG4gICAgc3RvcHBlZDogJ3BseXItLXN0b3BwZWQnLFxuICAgIGxvYWRpbmc6ICdwbHlyLS1sb2FkaW5nJyxcbiAgICBob3ZlcjogJ3BseXItLWhvdmVyJyxcbiAgICB0b29sdGlwOiAncGx5cl9fdG9vbHRpcCcsXG4gICAgY3VlczogJ3BseXJfX2N1ZXMnLFxuICAgIG1hcmtlcjogJ3BseXJfX3Byb2dyZXNzX19tYXJrZXInLFxuICAgIGhpZGRlbjogJ3BseXJfX3NyLW9ubHknLFxuICAgIGhpZGVDb250cm9sczogJ3BseXItLWhpZGUtY29udHJvbHMnLFxuICAgIGlzSW9zOiAncGx5ci0taXMtaW9zJyxcbiAgICBpc1RvdWNoOiAncGx5ci0taXMtdG91Y2gnLFxuICAgIHVpU3VwcG9ydGVkOiAncGx5ci0tZnVsbC11aScsXG4gICAgbm9UcmFuc2l0aW9uOiAncGx5ci0tbm8tdHJhbnNpdGlvbicsXG4gICAgZGlzcGxheToge1xuICAgICAgdGltZTogJ3BseXJfX3RpbWUnLFxuICAgIH0sXG4gICAgbWVudToge1xuICAgICAgdmFsdWU6ICdwbHlyX19tZW51X192YWx1ZScsXG4gICAgICBiYWRnZTogJ3BseXJfX2JhZGdlJyxcbiAgICAgIG9wZW46ICdwbHlyLS1tZW51LW9wZW4nLFxuICAgIH0sXG4gICAgY2FwdGlvbnM6IHtcbiAgICAgIGVuYWJsZWQ6ICdwbHlyLS1jYXB0aW9ucy1lbmFibGVkJyxcbiAgICAgIGFjdGl2ZTogJ3BseXItLWNhcHRpb25zLWFjdGl2ZScsXG4gICAgfSxcbiAgICBmdWxsc2NyZWVuOiB7XG4gICAgICBlbmFibGVkOiAncGx5ci0tZnVsbHNjcmVlbi1lbmFibGVkJyxcbiAgICAgIGZhbGxiYWNrOiAncGx5ci0tZnVsbHNjcmVlbi1mYWxsYmFjaycsXG4gICAgfSxcbiAgICBwaXA6IHtcbiAgICAgIHN1cHBvcnRlZDogJ3BseXItLXBpcC1zdXBwb3J0ZWQnLFxuICAgICAgYWN0aXZlOiAncGx5ci0tcGlwLWFjdGl2ZScsXG4gICAgfSxcbiAgICBhaXJwbGF5OiB7XG4gICAgICBzdXBwb3J0ZWQ6ICdwbHlyLS1haXJwbGF5LXN1cHBvcnRlZCcsXG4gICAgICBhY3RpdmU6ICdwbHlyLS1haXJwbGF5LWFjdGl2ZScsXG4gICAgfSxcbiAgICB0YWJGb2N1czogJ3BseXJfX3RhYi1mb2N1cycsXG4gICAgcHJldmlld1RodW1ibmFpbHM6IHtcbiAgICAgIC8vIFRvb2x0aXAgdGh1bWJzXG4gICAgICB0aHVtYkNvbnRhaW5lcjogJ3BseXJfX3ByZXZpZXctdGh1bWInLFxuICAgICAgdGh1bWJDb250YWluZXJTaG93bjogJ3BseXJfX3ByZXZpZXctdGh1bWItLWlzLXNob3duJyxcbiAgICAgIGltYWdlQ29udGFpbmVyOiAncGx5cl9fcHJldmlldy10aHVtYl9faW1hZ2UtY29udGFpbmVyJyxcbiAgICAgIHRpbWVDb250YWluZXI6ICdwbHlyX19wcmV2aWV3LXRodW1iX190aW1lLWNvbnRhaW5lcicsXG4gICAgICAvLyBTY3J1YmJpbmdcbiAgICAgIHNjcnViYmluZ0NvbnRhaW5lcjogJ3BseXJfX3ByZXZpZXctc2NydWJiaW5nJyxcbiAgICAgIHNjcnViYmluZ0NvbnRhaW5lclNob3duOiAncGx5cl9fcHJldmlldy1zY3J1YmJpbmctLWlzLXNob3duJyxcbiAgICB9LFxuICB9LFxuXG4gIC8vIEVtYmVkIGF0dHJpYnV0ZXNcbiAgYXR0cmlidXRlczoge1xuICAgIGVtYmVkOiB7XG4gICAgICBwcm92aWRlcjogJ2RhdGEtcGx5ci1wcm92aWRlcicsXG4gICAgICBpZDogJ2RhdGEtcGx5ci1lbWJlZC1pZCcsXG4gICAgICBoYXNoOiAnZGF0YS1wbHlyLWVtYmVkLWhhc2gnLFxuICAgIH0sXG4gIH0sXG5cbiAgLy8gQWR2ZXJ0aXNlbWVudHMgcGx1Z2luXG4gIC8vIFJlZ2lzdGVyIGZvciBhbiBhY2NvdW50IGhlcmU6IGh0dHA6Ly92aS5haS9wdWJsaXNoZXItdmlkZW8tbW9uZXRpemF0aW9uLz9haWQ9cGx5cmlvXG4gIGFkczoge1xuICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgIHB1Ymxpc2hlcklkOiAnJyxcbiAgICB0YWdVcmw6ICcnLFxuICB9LFxuXG4gIC8vIFByZXZpZXcgVGh1bWJuYWlscyBwbHVnaW5cbiAgcHJldmlld1RodW1ibmFpbHM6IHtcbiAgICBlbmFibGVkOiBmYWxzZSxcbiAgICBzcmM6ICcnLFxuICB9LFxuXG4gIC8vIFZpbWVvIHBsdWdpblxuICB2aW1lbzoge1xuICAgIGJ5bGluZTogZmFsc2UsXG4gICAgcG9ydHJhaXQ6IGZhbHNlLFxuICAgIHRpdGxlOiBmYWxzZSxcbiAgICBzcGVlZDogdHJ1ZSxcbiAgICB0cmFuc3BhcmVudDogZmFsc2UsXG4gICAgLy8gQ3VzdG9tIHNldHRpbmdzIGZyb20gUGx5clxuICAgIGN1c3RvbUNvbnRyb2xzOiB0cnVlLFxuICAgIHJlZmVycmVyUG9saWN5OiBudWxsLCAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSFRNTElGcmFtZUVsZW1lbnQvcmVmZXJyZXJQb2xpY3lcbiAgICAvLyBXaGV0aGVyIHRoZSBvd25lciBvZiB0aGUgdmlkZW8gaGFzIGEgUHJvIG9yIEJ1c2luZXNzIGFjY291bnRcbiAgICAvLyAod2hpY2ggYWxsb3dzIHVzIHRvIHByb3Blcmx5IGhpZGUgY29udHJvbHMgd2l0aG91dCBDU1MgaGFja3MsIGV0YylcbiAgICBwcmVtaXVtOiBmYWxzZSxcbiAgfSxcblxuICAvLyBZb3VUdWJlIHBsdWdpblxuICB5b3V0dWJlOiB7XG4gICAgcmVsOiAwLCAvLyBObyByZWxhdGVkIHZpZHNcbiAgICBzaG93aW5mbzogMCwgLy8gSGlkZSBpbmZvXG4gICAgaXZfbG9hZF9wb2xpY3k6IDMsIC8vIEhpZGUgYW5ub3RhdGlvbnNcbiAgICBtb2Rlc3RicmFuZGluZzogMSwgLy8gSGlkZSBsb2dvcyBhcyBtdWNoIGFzIHBvc3NpYmxlICh0aGV5IHN0aWxsIHNob3cgb25lIGluIHRoZSBjb3JuZXIgd2hlbiBwYXVzZWQpXG4gICAgLy8gQ3VzdG9tIHNldHRpbmdzIGZyb20gUGx5clxuICAgIGN1c3RvbUNvbnRyb2xzOiB0cnVlLFxuICAgIG5vQ29va2llOiBmYWxzZSwgLy8gV2hldGhlciB0byB1c2UgYW4gYWx0ZXJuYXRpdmUgdmVyc2lvbiBvZiBZb3VUdWJlIHdpdGhvdXQgY29va2llc1xuICB9LFxuXG4gIC8vIE1lZGlhIE1ldGFkYXRhXG4gIG1lZGlhTWV0YWRhdGE6IHtcbiAgICB0aXRsZTogJycsXG4gICAgYXJ0aXN0OiAnJyxcbiAgICBhbGJ1bTogJycsXG4gICAgYXJ0d29yazogW10sXG4gIH0sXG5cbiAgLy8gTWFya2Vyc1xuICBtYXJrZXJzOiB7XG4gICAgZW5hYmxlZDogZmFsc2UsXG4gICAgcG9pbnRzOiBbXSxcbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGRlZmF1bHRzO1xuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBseXIgc3RhdGVzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgcGlwID0ge1xuICBhY3RpdmU6ICdwaWN0dXJlLWluLXBpY3R1cmUnLFxuICBpbmFjdGl2ZTogJ2lubGluZScsXG59O1xuXG5leHBvcnQgZGVmYXVsdCB7IHBpcCB9O1xuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBseXIgc3VwcG9ydGVkIHR5cGVzIGFuZCBwcm92aWRlcnNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjb25zdCBwcm92aWRlcnMgPSB7XG4gIGh0bWw1OiAnaHRtbDUnLFxuICB5b3V0dWJlOiAneW91dHViZScsXG4gIHZpbWVvOiAndmltZW8nLFxufTtcblxuZXhwb3J0IGNvbnN0IHR5cGVzID0ge1xuICBhdWRpbzogJ2F1ZGlvJyxcbiAgdmlkZW86ICd2aWRlbycsXG59O1xuXG4vKipcbiAqIEdldCBwcm92aWRlciBieSBVUkxcbiAqIEBwYXJhbSB7U3RyaW5nfSB1cmxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFByb3ZpZGVyQnlVcmwodXJsKSB7XG4gIC8vIFlvdVR1YmVcbiAgaWYgKC9eKGh0dHBzPzpcXC9cXC8pPyh3d3dcXC4pPyh5b3V0dWJlXFwuY29tfHlvdXR1YmUtbm9jb29raWVcXC5jb218eW91dHVcXC4/YmUpXFwvLiskLy50ZXN0KHVybCkpIHtcbiAgICByZXR1cm4gcHJvdmlkZXJzLnlvdXR1YmU7XG4gIH1cblxuICAvLyBWaW1lb1xuICBpZiAoL15odHRwcz86XFwvXFwvcGxheWVyLnZpbWVvLmNvbVxcL3ZpZGVvXFwvXFxkezAsOX0oPz1cXGJ8XFwvKS8udGVzdCh1cmwpKSB7XG4gICAgcmV0dXJuIHByb3ZpZGVycy52aW1lbztcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgZGVmYXVsdCB7IHByb3ZpZGVycywgdHlwZXMgfTtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDb25zb2xlIHdyYXBwZXJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmNvbnN0IG5vb3AgPSAoKSA9PiB7fTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29uc29sZSB7XG4gIGNvbnN0cnVjdG9yKGVuYWJsZWQgPSBmYWxzZSkge1xuICAgIHRoaXMuZW5hYmxlZCA9IHdpbmRvdy5jb25zb2xlICYmIGVuYWJsZWQ7XG5cbiAgICBpZiAodGhpcy5lbmFibGVkKSB7XG4gICAgICB0aGlzLmxvZygnRGVidWdnaW5nIGVuYWJsZWQnKTtcbiAgICB9XG4gIH1cblxuICBnZXQgbG9nKCkge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgcmV0dXJuIHRoaXMuZW5hYmxlZCA/IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwoY29uc29sZS5sb2csIGNvbnNvbGUpIDogbm9vcDtcbiAgfVxuXG4gIGdldCB3YXJuKCkge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgcmV0dXJuIHRoaXMuZW5hYmxlZCA/IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwoY29uc29sZS53YXJuLCBjb25zb2xlKSA6IG5vb3A7XG4gIH1cblxuICBnZXQgZXJyb3IoKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICByZXR1cm4gdGhpcy5lbmFibGVkID8gRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQuY2FsbChjb25zb2xlLmVycm9yLCBjb25zb2xlKSA6IG5vb3A7XG4gIH1cbn1cbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBGdWxsc2NyZWVuIHdyYXBwZXJcbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9GdWxsc2NyZWVuX0FQSSNwcmVmaXhpbmdcbi8vIGh0dHBzOi8vd2Via2l0Lm9yZy9ibG9nLzc5MjkvZGVzaWduaW5nLXdlYnNpdGVzLWZvci1pcGhvbmUteC9cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBicm93c2VyIGZyb20gJy4vdXRpbHMvYnJvd3Nlcic7XG5pbXBvcnQgeyBjbG9zZXN0LCBnZXRFbGVtZW50cywgaGFzQ2xhc3MsIHRvZ2dsZUNsYXNzIH0gZnJvbSAnLi91dGlscy9lbGVtZW50cyc7XG5pbXBvcnQgeyBvbiwgdHJpZ2dlckV2ZW50IH0gZnJvbSAnLi91dGlscy9ldmVudHMnO1xuaW1wb3J0IGlzIGZyb20gJy4vdXRpbHMvaXMnO1xuaW1wb3J0IHsgc2lsZW5jZVByb21pc2UgfSBmcm9tICcuL3V0aWxzL3Byb21pc2UnO1xuXG5jbGFzcyBGdWxsc2NyZWVuIHtcbiAgY29uc3RydWN0b3IocGxheWVyKSB7XG4gICAgLy8gS2VlcCByZWZlcmVuY2UgdG8gcGFyZW50XG4gICAgdGhpcy5wbGF5ZXIgPSBwbGF5ZXI7XG5cbiAgICAvLyBHZXQgcHJlZml4XG4gICAgdGhpcy5wcmVmaXggPSBGdWxsc2NyZWVuLnByZWZpeDtcbiAgICB0aGlzLnByb3BlcnR5ID0gRnVsbHNjcmVlbi5wcm9wZXJ0eTtcblxuICAgIC8vIFNjcm9sbCBwb3NpdGlvblxuICAgIHRoaXMuc2Nyb2xsUG9zaXRpb24gPSB7IHg6IDAsIHk6IDAgfTtcblxuICAgIC8vIEZvcmNlIHRoZSB1c2Ugb2YgJ2Z1bGwgd2luZG93L2Jyb3dzZXInIHJhdGhlciB0aGFuIGZ1bGxzY3JlZW5cbiAgICB0aGlzLmZvcmNlRmFsbGJhY2sgPSBwbGF5ZXIuY29uZmlnLmZ1bGxzY3JlZW4uZmFsbGJhY2sgPT09ICdmb3JjZSc7XG5cbiAgICAvLyBHZXQgdGhlIGZ1bGxzY3JlZW4gZWxlbWVudFxuICAgIC8vIENoZWNrcyBjb250YWluZXIgaXMgYW4gYW5jZXN0b3IsIGRlZmF1bHRzIHRvIG51bGxcbiAgICB0aGlzLnBsYXllci5lbGVtZW50cy5mdWxsc2NyZWVuID1cbiAgICAgIHBsYXllci5jb25maWcuZnVsbHNjcmVlbi5jb250YWluZXIgJiYgY2xvc2VzdCh0aGlzLnBsYXllci5lbGVtZW50cy5jb250YWluZXIsIHBsYXllci5jb25maWcuZnVsbHNjcmVlbi5jb250YWluZXIpO1xuXG4gICAgLy8gUmVnaXN0ZXIgZXZlbnQgbGlzdGVuZXJzXG4gICAgLy8gSGFuZGxlIGV2ZW50IChpbmNhc2UgdXNlciBwcmVzc2VzIGVzY2FwZSBldGMpXG4gICAgb24uY2FsbChcbiAgICAgIHRoaXMucGxheWVyLFxuICAgICAgZG9jdW1lbnQsXG4gICAgICB0aGlzLnByZWZpeCA9PT0gJ21zJyA/ICdNU0Z1bGxzY3JlZW5DaGFuZ2UnIDogYCR7dGhpcy5wcmVmaXh9ZnVsbHNjcmVlbmNoYW5nZWAsXG4gICAgICAoKSA9PiB7XG4gICAgICAgIC8vIFRPRE86IEZpbHRlciBmb3IgdGFyZ2V0Pz9cbiAgICAgICAgdGhpcy5vbkNoYW5nZSgpO1xuICAgICAgfSxcbiAgICApO1xuXG4gICAgLy8gRnVsbHNjcmVlbiB0b2dnbGUgb24gZG91YmxlIGNsaWNrXG4gICAgb24uY2FsbCh0aGlzLnBsYXllciwgdGhpcy5wbGF5ZXIuZWxlbWVudHMuY29udGFpbmVyLCAnZGJsY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgIC8vIElnbm9yZSBkb3VibGUgY2xpY2sgaW4gY29udHJvbHNcbiAgICAgIGlmIChpcy5lbGVtZW50KHRoaXMucGxheWVyLmVsZW1lbnRzLmNvbnRyb2xzKSAmJiB0aGlzLnBsYXllci5lbGVtZW50cy5jb250cm9scy5jb250YWlucyhldmVudC50YXJnZXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5wbGF5ZXIubGlzdGVuZXJzLnByb3h5KGV2ZW50LCB0aGlzLnRvZ2dsZSwgJ2Z1bGxzY3JlZW4nKTtcbiAgICB9KTtcblxuICAgIC8vIFRhcCBmb2N1cyB3aGVuIGluIGZ1bGxzY3JlZW5cbiAgICBvbi5jYWxsKHRoaXMsIHRoaXMucGxheWVyLmVsZW1lbnRzLmNvbnRhaW5lciwgJ2tleWRvd24nLCAoZXZlbnQpID0+IHRoaXMudHJhcEZvY3VzKGV2ZW50KSk7XG5cbiAgICAvLyBVcGRhdGUgdGhlIFVJXG4gICAgdGhpcy51cGRhdGUoKTtcblxuICAgIC8vIHRoaXMudG9nZ2xlID0gdGhpcy50b2dnbGUuYmluZCh0aGlzKTtcbiAgfVxuXG4gIC8vIERldGVybWluZSBpZiBuYXRpdmUgc3VwcG9ydGVkXG4gIHN0YXRpYyBnZXQgbmF0aXZlKCkge1xuICAgIHJldHVybiAhIShcbiAgICAgIGRvY3VtZW50LmZ1bGxzY3JlZW5FbmFibGVkIHx8XG4gICAgICBkb2N1bWVudC53ZWJraXRGdWxsc2NyZWVuRW5hYmxlZCB8fFxuICAgICAgZG9jdW1lbnQubW96RnVsbFNjcmVlbkVuYWJsZWQgfHxcbiAgICAgIGRvY3VtZW50Lm1zRnVsbHNjcmVlbkVuYWJsZWRcbiAgICApO1xuICB9XG5cbiAgLy8gSWYgd2UncmUgYWN0dWFsbHkgdXNpbmcgbmF0aXZlXG4gIGdldCB1c2luZ05hdGl2ZSgpIHtcbiAgICByZXR1cm4gRnVsbHNjcmVlbi5uYXRpdmUgJiYgIXRoaXMuZm9yY2VGYWxsYmFjaztcbiAgfVxuXG4gIC8vIEdldCB0aGUgcHJlZml4IGZvciBoYW5kbGVyc1xuICBzdGF0aWMgZ2V0IHByZWZpeCgpIHtcbiAgICAvLyBObyBwcmVmaXhcbiAgICBpZiAoaXMuZnVuY3Rpb24oZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4pKSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIGZ1bGxzY3JlZW4gc3VwcG9ydCBieSB2ZW5kb3IgcHJlZml4XG4gICAgbGV0IHZhbHVlID0gJyc7XG4gICAgY29uc3QgcHJlZml4ZXMgPSBbJ3dlYmtpdCcsICdtb3onLCAnbXMnXTtcblxuICAgIHByZWZpeGVzLnNvbWUoKHByZSkgPT4ge1xuICAgICAgaWYgKGlzLmZ1bmN0aW9uKGRvY3VtZW50W2Ake3ByZX1FeGl0RnVsbHNjcmVlbmBdKSB8fCBpcy5mdW5jdGlvbihkb2N1bWVudFtgJHtwcmV9Q2FuY2VsRnVsbFNjcmVlbmBdKSkge1xuICAgICAgICB2YWx1ZSA9IHByZTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcblxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIHN0YXRpYyBnZXQgcHJvcGVydHkoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJlZml4ID09PSAnbW96JyA/ICdGdWxsU2NyZWVuJyA6ICdGdWxsc2NyZWVuJztcbiAgfVxuXG4gIC8vIERldGVybWluZSBpZiBmdWxsc2NyZWVuIGlzIGVuYWJsZWRcbiAgZ2V0IGVuYWJsZWQoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIChGdWxsc2NyZWVuLm5hdGl2ZSB8fCB0aGlzLnBsYXllci5jb25maWcuZnVsbHNjcmVlbi5mYWxsYmFjaykgJiZcbiAgICAgIHRoaXMucGxheWVyLmNvbmZpZy5mdWxsc2NyZWVuLmVuYWJsZWQgJiZcbiAgICAgIHRoaXMucGxheWVyLnN1cHBvcnRlZC51aSAmJlxuICAgICAgdGhpcy5wbGF5ZXIuaXNWaWRlb1xuICAgICk7XG4gIH1cblxuICAvLyBHZXQgYWN0aXZlIHN0YXRlXG4gIGdldCBhY3RpdmUoKSB7XG4gICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBGYWxsYmFjayB1c2luZyBjbGFzc25hbWVcbiAgICBpZiAoIUZ1bGxzY3JlZW4ubmF0aXZlIHx8IHRoaXMuZm9yY2VGYWxsYmFjaykge1xuICAgICAgcmV0dXJuIGhhc0NsYXNzKHRoaXMudGFyZ2V0LCB0aGlzLnBsYXllci5jb25maWcuY2xhc3NOYW1lcy5mdWxsc2NyZWVuLmZhbGxiYWNrKTtcbiAgICB9XG5cbiAgICBjb25zdCBlbGVtZW50ID0gIXRoaXMucHJlZml4XG4gICAgICA/IHRoaXMudGFyZ2V0LmdldFJvb3ROb2RlKCkuZnVsbHNjcmVlbkVsZW1lbnRcbiAgICAgIDogdGhpcy50YXJnZXQuZ2V0Um9vdE5vZGUoKVtgJHt0aGlzLnByZWZpeH0ke3RoaXMucHJvcGVydHl9RWxlbWVudGBdO1xuXG4gICAgcmV0dXJuIGVsZW1lbnQgJiYgZWxlbWVudC5zaGFkb3dSb290ID8gZWxlbWVudCA9PT0gdGhpcy50YXJnZXQuZ2V0Um9vdE5vZGUoKS5ob3N0IDogZWxlbWVudCA9PT0gdGhpcy50YXJnZXQ7XG4gIH1cblxuICAvLyBHZXQgdGFyZ2V0IGVsZW1lbnRcbiAgZ2V0IHRhcmdldCgpIHtcbiAgICByZXR1cm4gYnJvd3Nlci5pc0lvcyAmJiB0aGlzLnBsYXllci5jb25maWcuZnVsbHNjcmVlbi5pb3NOYXRpdmVcbiAgICAgID8gdGhpcy5wbGF5ZXIubWVkaWFcbiAgICAgIDogdGhpcy5wbGF5ZXIuZWxlbWVudHMuZnVsbHNjcmVlbiB8fCB0aGlzLnBsYXllci5lbGVtZW50cy5jb250YWluZXI7XG4gIH1cblxuICBvbkNoYW5nZSA9ICgpID0+IHtcbiAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSB0b2dnbGUgYnV0dG9uXG4gICAgY29uc3QgYnV0dG9uID0gdGhpcy5wbGF5ZXIuZWxlbWVudHMuYnV0dG9ucy5mdWxsc2NyZWVuO1xuICAgIGlmIChpcy5lbGVtZW50KGJ1dHRvbikpIHtcbiAgICAgIGJ1dHRvbi5wcmVzc2VkID0gdGhpcy5hY3RpdmU7XG4gICAgfVxuXG4gICAgLy8gQWx3YXlzIHRyaWdnZXIgZXZlbnRzIG9uIHRoZSBwbHlyIC8gbWVkaWEgZWxlbWVudCAobm90IGEgZnVsbHNjcmVlbiBjb250YWluZXIpIGFuZCBsZXQgdGhlbSBidWJibGUgdXBcbiAgICBjb25zdCB0YXJnZXQgPSB0aGlzLnRhcmdldCA9PT0gdGhpcy5wbGF5ZXIubWVkaWEgPyB0aGlzLnRhcmdldCA6IHRoaXMucGxheWVyLmVsZW1lbnRzLmNvbnRhaW5lcjtcbiAgICAvLyBUcmlnZ2VyIGFuIGV2ZW50XG4gICAgdHJpZ2dlckV2ZW50LmNhbGwodGhpcy5wbGF5ZXIsIHRhcmdldCwgdGhpcy5hY3RpdmUgPyAnZW50ZXJmdWxsc2NyZWVuJyA6ICdleGl0ZnVsbHNjcmVlbicsIHRydWUpO1xuICB9O1xuXG4gIHRvZ2dsZUZhbGxiYWNrID0gKHRvZ2dsZSA9IGZhbHNlKSA9PiB7XG4gICAgLy8gU3RvcmUgb3IgcmVzdG9yZSBzY3JvbGwgcG9zaXRpb25cbiAgICBpZiAodG9nZ2xlKSB7XG4gICAgICB0aGlzLnNjcm9sbFBvc2l0aW9uID0ge1xuICAgICAgICB4OiB3aW5kb3cuc2Nyb2xsWCB8fCAwLFxuICAgICAgICB5OiB3aW5kb3cuc2Nyb2xsWSB8fCAwLFxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2luZG93LnNjcm9sbFRvKHRoaXMuc2Nyb2xsUG9zaXRpb24ueCwgdGhpcy5zY3JvbGxQb3NpdGlvbi55KTtcbiAgICB9XG5cbiAgICAvLyBUb2dnbGUgc2Nyb2xsXG4gICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IHRvZ2dsZSA/ICdoaWRkZW4nIDogJyc7XG5cbiAgICAvLyBUb2dnbGUgY2xhc3MgaG9va1xuICAgIHRvZ2dsZUNsYXNzKHRoaXMudGFyZ2V0LCB0aGlzLnBsYXllci5jb25maWcuY2xhc3NOYW1lcy5mdWxsc2NyZWVuLmZhbGxiYWNrLCB0b2dnbGUpO1xuXG4gICAgLy8gRm9yY2UgZnVsbCB2aWV3cG9ydCBvbiBpUGhvbmUgWCtcbiAgICBpZiAoYnJvd3Nlci5pc0lvcykge1xuICAgICAgbGV0IHZpZXdwb3J0ID0gZG9jdW1lbnQuaGVhZC5xdWVyeVNlbGVjdG9yKCdtZXRhW25hbWU9XCJ2aWV3cG9ydFwiXScpO1xuICAgICAgY29uc3QgcHJvcGVydHkgPSAndmlld3BvcnQtZml0PWNvdmVyJztcblxuICAgICAgLy8gSW5qZWN0IHRoZSB2aWV3cG9ydCBtZXRhIGlmIHJlcXVpcmVkXG4gICAgICBpZiAoIXZpZXdwb3J0KSB7XG4gICAgICAgIHZpZXdwb3J0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWV0YScpO1xuICAgICAgICB2aWV3cG9ydC5zZXRBdHRyaWJ1dGUoJ25hbWUnLCAndmlld3BvcnQnKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdGhlIHByb3BlcnR5IGFscmVhZHkgZXhpc3RzXG4gICAgICBjb25zdCBoYXNQcm9wZXJ0eSA9IGlzLnN0cmluZyh2aWV3cG9ydC5jb250ZW50KSAmJiB2aWV3cG9ydC5jb250ZW50LmluY2x1ZGVzKHByb3BlcnR5KTtcblxuICAgICAgaWYgKHRvZ2dsZSkge1xuICAgICAgICB0aGlzLmNsZWFudXBWaWV3cG9ydCA9ICFoYXNQcm9wZXJ0eTtcblxuICAgICAgICBpZiAoIWhhc1Byb3BlcnR5KSB7XG4gICAgICAgICAgdmlld3BvcnQuY29udGVudCArPSBgLCR7cHJvcGVydHl9YDtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICh0aGlzLmNsZWFudXBWaWV3cG9ydCkge1xuICAgICAgICB2aWV3cG9ydC5jb250ZW50ID0gdmlld3BvcnQuY29udGVudFxuICAgICAgICAgIC5zcGxpdCgnLCcpXG4gICAgICAgICAgLmZpbHRlcigocGFydCkgPT4gcGFydC50cmltKCkgIT09IHByb3BlcnR5KVxuICAgICAgICAgIC5qb2luKCcsJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gVG9nZ2xlIGJ1dHRvbiBhbmQgZmlyZSBldmVudHNcbiAgICB0aGlzLm9uQ2hhbmdlKCk7XG4gIH07XG5cbiAgLy8gVHJhcCBmb2N1cyBpbnNpZGUgY29udGFpbmVyXG4gIHRyYXBGb2N1cyA9IChldmVudCkgPT4ge1xuICAgIC8vIEJhaWwgaWYgaU9TLCBub3QgYWN0aXZlLCBub3QgdGhlIHRhYiBrZXlcbiAgICBpZiAoYnJvd3Nlci5pc0lvcyB8fCAhdGhpcy5hY3RpdmUgfHwgZXZlbnQua2V5ICE9PSAnVGFiJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEdldCB0aGUgY3VycmVudCBmb2N1c2VkIGVsZW1lbnRcbiAgICBjb25zdCBmb2N1c2VkID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICBjb25zdCBmb2N1c2FibGUgPSBnZXRFbGVtZW50cy5jYWxsKHRoaXMucGxheWVyLCAnYVtocmVmXSwgYnV0dG9uOm5vdCg6ZGlzYWJsZWQpLCBpbnB1dDpub3QoOmRpc2FibGVkKSwgW3RhYmluZGV4XScpO1xuICAgIGNvbnN0IFtmaXJzdF0gPSBmb2N1c2FibGU7XG4gICAgY29uc3QgbGFzdCA9IGZvY3VzYWJsZVtmb2N1c2FibGUubGVuZ3RoIC0gMV07XG5cbiAgICBpZiAoZm9jdXNlZCA9PT0gbGFzdCAmJiAhZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgIC8vIE1vdmUgZm9jdXMgdG8gZmlyc3QgZWxlbWVudCB0aGF0IGNhbiBiZSB0YWJiZWQgaWYgU2hpZnQgaXNuJ3QgdXNlZFxuICAgICAgZmlyc3QuZm9jdXMoKTtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSBlbHNlIGlmIChmb2N1c2VkID09PSBmaXJzdCAmJiBldmVudC5zaGlmdEtleSkge1xuICAgICAgLy8gTW92ZSBmb2N1cyB0byBsYXN0IGVsZW1lbnQgdGhhdCBjYW4gYmUgdGFiYmVkIGlmIFNoaWZ0IGlzIHVzZWRcbiAgICAgIGxhc3QuZm9jdXMoKTtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIFVwZGF0ZSBVSVxuICB1cGRhdGUgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgbGV0IG1vZGU7XG5cbiAgICAgIGlmICh0aGlzLmZvcmNlRmFsbGJhY2spIHtcbiAgICAgICAgbW9kZSA9ICdGYWxsYmFjayAoZm9yY2VkKSc7XG4gICAgICB9IGVsc2UgaWYgKEZ1bGxzY3JlZW4ubmF0aXZlKSB7XG4gICAgICAgIG1vZGUgPSAnTmF0aXZlJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1vZGUgPSAnRmFsbGJhY2snO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coYCR7bW9kZX0gZnVsbHNjcmVlbiBlbmFibGVkYCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZygnRnVsbHNjcmVlbiBub3Qgc3VwcG9ydGVkIGFuZCBmYWxsYmFjayBkaXNhYmxlZCcpO1xuICAgIH1cblxuICAgIC8vIEFkZCBzdHlsaW5nIGhvb2sgdG8gc2hvdyBidXR0b25cbiAgICB0b2dnbGVDbGFzcyh0aGlzLnBsYXllci5lbGVtZW50cy5jb250YWluZXIsIHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLmZ1bGxzY3JlZW4uZW5hYmxlZCwgdGhpcy5lbmFibGVkKTtcbiAgfTtcblxuICAvLyBNYWtlIGFuIGVsZW1lbnQgZnVsbHNjcmVlblxuICBlbnRlciA9ICgpID0+IHtcbiAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIGlPUyBuYXRpdmUgZnVsbHNjcmVlbiBkb2Vzbid0IG5lZWQgdGhlIHJlcXVlc3Qgc3RlcFxuICAgIGlmIChicm93c2VyLmlzSW9zICYmIHRoaXMucGxheWVyLmNvbmZpZy5mdWxsc2NyZWVuLmlvc05hdGl2ZSkge1xuICAgICAgaWYgKHRoaXMucGxheWVyLmlzVmltZW8pIHtcbiAgICAgICAgdGhpcy5wbGF5ZXIuZW1iZWQucmVxdWVzdEZ1bGxzY3JlZW4oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMudGFyZ2V0LndlYmtpdEVudGVyRnVsbHNjcmVlbigpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoIUZ1bGxzY3JlZW4ubmF0aXZlIHx8IHRoaXMuZm9yY2VGYWxsYmFjaykge1xuICAgICAgdGhpcy50b2dnbGVGYWxsYmFjayh0cnVlKTtcbiAgICB9IGVsc2UgaWYgKCF0aGlzLnByZWZpeCkge1xuICAgICAgdGhpcy50YXJnZXQucmVxdWVzdEZ1bGxzY3JlZW4oeyBuYXZpZ2F0aW9uVUk6ICdoaWRlJyB9KTtcbiAgICB9IGVsc2UgaWYgKCFpcy5lbXB0eSh0aGlzLnByZWZpeCkpIHtcbiAgICAgIHRoaXMudGFyZ2V0W2Ake3RoaXMucHJlZml4fVJlcXVlc3Qke3RoaXMucHJvcGVydHl9YF0oKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gQmFpbCBmcm9tIGZ1bGxzY3JlZW5cbiAgZXhpdCA9ICgpID0+IHtcbiAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIGlPUyBuYXRpdmUgZnVsbHNjcmVlblxuICAgIGlmIChicm93c2VyLmlzSW9zICYmIHRoaXMucGxheWVyLmNvbmZpZy5mdWxsc2NyZWVuLmlvc05hdGl2ZSkge1xuICAgICAgdGhpcy50YXJnZXQud2Via2l0RXhpdEZ1bGxzY3JlZW4oKTtcbiAgICAgIHNpbGVuY2VQcm9taXNlKHRoaXMucGxheWVyLnBsYXkoKSk7XG4gICAgfSBlbHNlIGlmICghRnVsbHNjcmVlbi5uYXRpdmUgfHwgdGhpcy5mb3JjZUZhbGxiYWNrKSB7XG4gICAgICB0aGlzLnRvZ2dsZUZhbGxiYWNrKGZhbHNlKTtcbiAgICB9IGVsc2UgaWYgKCF0aGlzLnByZWZpeCkge1xuICAgICAgKGRvY3VtZW50LmNhbmNlbEZ1bGxTY3JlZW4gfHwgZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4pLmNhbGwoZG9jdW1lbnQpO1xuICAgIH0gZWxzZSBpZiAoIWlzLmVtcHR5KHRoaXMucHJlZml4KSkge1xuICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy5wcmVmaXggPT09ICdtb3onID8gJ0NhbmNlbCcgOiAnRXhpdCc7XG4gICAgICBkb2N1bWVudFtgJHt0aGlzLnByZWZpeH0ke2FjdGlvbn0ke3RoaXMucHJvcGVydHl9YF0oKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gVG9nZ2xlIHN0YXRlXG4gIHRvZ2dsZSA9ICgpID0+IHtcbiAgICBpZiAoIXRoaXMuYWN0aXZlKSB7XG4gICAgICB0aGlzLmVudGVyKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZXhpdCgpO1xuICAgIH1cbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgRnVsbHNjcmVlbjtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBMb2FkIGltYWdlIGF2b2lkaW5nIHhoci9mZXRjaCBDT1JTIGlzc3Vlc1xuLy8gU2VydmVyIHN0YXR1cyBjYW4ndCBiZSBvYnRhaW5lZCB0aGlzIHdheSB1bmZvcnR1bmF0ZWx5LCBzbyB0aGlzIHVzZXMgXCJuYXR1cmFsV2lkdGhcIiB0byBkZXRlcm1pbmUgaWYgdGhlIGltYWdlIGhhcyBsb2FkZWRcbi8vIEJ5IGRlZmF1bHQgaXQgY2hlY2tzIGlmIGl0IGlzIGF0IGxlYXN0IDFweCwgYnV0IHlvdSBjYW4gYWRkIGEgc2Vjb25kIGFyZ3VtZW50IHRvIGNoYW5nZSB0aGlzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBsb2FkSW1hZ2Uoc3JjLCBtaW5XaWR0aCA9IDEpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBpbWFnZSA9IG5ldyBJbWFnZSgpO1xuXG4gICAgY29uc3QgaGFuZGxlciA9ICgpID0+IHtcbiAgICAgIGRlbGV0ZSBpbWFnZS5vbmxvYWQ7XG4gICAgICBkZWxldGUgaW1hZ2Uub25lcnJvcjtcbiAgICAgIChpbWFnZS5uYXR1cmFsV2lkdGggPj0gbWluV2lkdGggPyByZXNvbHZlIDogcmVqZWN0KShpbWFnZSk7XG4gICAgfTtcblxuICAgIE9iamVjdC5hc3NpZ24oaW1hZ2UsIHsgb25sb2FkOiBoYW5kbGVyLCBvbmVycm9yOiBoYW5kbGVyLCBzcmMgfSk7XG4gIH0pO1xufVxuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBseXIgVUlcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBjYXB0aW9ucyBmcm9tICcuL2NhcHRpb25zJztcbmltcG9ydCBjb250cm9scyBmcm9tICcuL2NvbnRyb2xzJztcbmltcG9ydCBzdXBwb3J0IGZyb20gJy4vc3VwcG9ydCc7XG5pbXBvcnQgYnJvd3NlciBmcm9tICcuL3V0aWxzL2Jyb3dzZXInO1xuaW1wb3J0IHsgZ2V0RWxlbWVudCwgdG9nZ2xlQ2xhc3MgfSBmcm9tICcuL3V0aWxzL2VsZW1lbnRzJztcbmltcG9ydCB7IHJlYWR5LCB0cmlnZ2VyRXZlbnQgfSBmcm9tICcuL3V0aWxzL2V2ZW50cyc7XG5pbXBvcnQgaTE4biBmcm9tICcuL3V0aWxzL2kxOG4nO1xuaW1wb3J0IGlzIGZyb20gJy4vdXRpbHMvaXMnO1xuaW1wb3J0IGxvYWRJbWFnZSBmcm9tICcuL3V0aWxzL2xvYWQtaW1hZ2UnO1xuXG5jb25zdCB1aSA9IHtcbiAgYWRkU3R5bGVIb29rKCkge1xuICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuY29udGFpbmVyLnJlcGxhY2UoJy4nLCAnJyksIHRydWUpO1xuICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnVpU3VwcG9ydGVkLCB0aGlzLnN1cHBvcnRlZC51aSk7XG4gIH0sXG5cbiAgLy8gVG9nZ2xlIG5hdGl2ZSBIVE1MNSBtZWRpYSBjb250cm9sc1xuICB0b2dnbGVOYXRpdmVDb250cm9scyh0b2dnbGUgPSBmYWxzZSkge1xuICAgIGlmICh0b2dnbGUgJiYgdGhpcy5pc0hUTUw1KSB7XG4gICAgICB0aGlzLm1lZGlhLnNldEF0dHJpYnV0ZSgnY29udHJvbHMnLCAnJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubWVkaWEucmVtb3ZlQXR0cmlidXRlKCdjb250cm9scycpO1xuICAgIH1cbiAgfSxcblxuICAvLyBTZXR1cCB0aGUgVUlcbiAgYnVpbGQoKSB7XG4gICAgLy8gUmUtYXR0YWNoIG1lZGlhIGVsZW1lbnQgbGlzdGVuZXJzXG4gICAgLy8gVE9ETzogVXNlIGV2ZW50IGJ1YmJsaW5nP1xuICAgIHRoaXMubGlzdGVuZXJzLm1lZGlhKCk7XG5cbiAgICAvLyBEb24ndCBzZXR1cCBpbnRlcmZhY2UgaWYgbm8gc3VwcG9ydFxuICAgIGlmICghdGhpcy5zdXBwb3J0ZWQudWkpIHtcbiAgICAgIHRoaXMuZGVidWcud2FybihgQmFzaWMgc3VwcG9ydCBvbmx5IGZvciAke3RoaXMucHJvdmlkZXJ9ICR7dGhpcy50eXBlfWApO1xuXG4gICAgICAvLyBSZXN0b3JlIG5hdGl2ZSBjb250cm9sc1xuICAgICAgdWkudG9nZ2xlTmF0aXZlQ29udHJvbHMuY2FsbCh0aGlzLCB0cnVlKTtcblxuICAgICAgLy8gQmFpbFxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEluamVjdCBjdXN0b20gY29udHJvbHMgaWYgbm90IHByZXNlbnRcbiAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5jb250cm9scykpIHtcbiAgICAgIC8vIEluamVjdCBjdXN0b20gY29udHJvbHNcbiAgICAgIGNvbnRyb2xzLmluamVjdC5jYWxsKHRoaXMpO1xuXG4gICAgICAvLyBSZS1hdHRhY2ggY29udHJvbCBsaXN0ZW5lcnNcbiAgICAgIHRoaXMubGlzdGVuZXJzLmNvbnRyb2xzKCk7XG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlIG5hdGl2ZSBjb250cm9sc1xuICAgIHVpLnRvZ2dsZU5hdGl2ZUNvbnRyb2xzLmNhbGwodGhpcyk7XG5cbiAgICAvLyBTZXR1cCBjYXB0aW9ucyBmb3IgSFRNTDVcbiAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICBjYXB0aW9ucy5zZXR1cC5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIC8vIFJlc2V0IHZvbHVtZVxuICAgIHRoaXMudm9sdW1lID0gbnVsbDtcblxuICAgIC8vIFJlc2V0IG11dGUgc3RhdGVcbiAgICB0aGlzLm11dGVkID0gbnVsbDtcblxuICAgIC8vIFJlc2V0IGxvb3Agc3RhdGVcbiAgICB0aGlzLmxvb3AgPSBudWxsO1xuXG4gICAgLy8gUmVzZXQgcXVhbGl0eSBzZXR0aW5nXG4gICAgdGhpcy5xdWFsaXR5ID0gbnVsbDtcblxuICAgIC8vIFJlc2V0IHNwZWVkXG4gICAgdGhpcy5zcGVlZCA9IG51bGw7XG5cbiAgICAvLyBSZXNldCB2b2x1bWUgZGlzcGxheVxuICAgIGNvbnRyb2xzLnVwZGF0ZVZvbHVtZS5jYWxsKHRoaXMpO1xuXG4gICAgLy8gUmVzZXQgdGltZSBkaXNwbGF5XG4gICAgY29udHJvbHMudGltZVVwZGF0ZS5jYWxsKHRoaXMpO1xuXG4gICAgLy8gUmVzZXQgZHVyYXRpb24gZGlzcGxheVxuICAgIGNvbnRyb2xzLmR1cmF0aW9uVXBkYXRlLmNhbGwodGhpcyk7XG5cbiAgICAvLyBVcGRhdGUgdGhlIFVJXG4gICAgdWkuY2hlY2tQbGF5aW5nLmNhbGwodGhpcyk7XG5cbiAgICAvLyBDaGVjayBmb3IgcGljdHVyZS1pbi1waWN0dXJlIHN1cHBvcnRcbiAgICB0b2dnbGVDbGFzcyhcbiAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLFxuICAgICAgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5waXAuc3VwcG9ydGVkLFxuICAgICAgc3VwcG9ydC5waXAgJiYgdGhpcy5pc0hUTUw1ICYmIHRoaXMuaXNWaWRlbyxcbiAgICApO1xuXG4gICAgLy8gQ2hlY2sgZm9yIGFpcnBsYXkgc3VwcG9ydFxuICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmFpcnBsYXkuc3VwcG9ydGVkLCBzdXBwb3J0LmFpcnBsYXkgJiYgdGhpcy5pc0hUTUw1KTtcblxuICAgIC8vIEFkZCBpT1MgY2xhc3NcbiAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5pc0lvcywgYnJvd3Nlci5pc0lvcyk7XG5cbiAgICAvLyBBZGQgdG91Y2ggY2xhc3NcbiAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5pc1RvdWNoLCB0aGlzLnRvdWNoKTtcblxuICAgIC8vIFJlYWR5IGZvciBBUEkgY2FsbHNcbiAgICB0aGlzLnJlYWR5ID0gdHJ1ZTtcblxuICAgIC8vIFJlYWR5IGV2ZW50IGF0IGVuZCBvZiBleGVjdXRpb24gc3RhY2tcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMsIHRoaXMubWVkaWEsICdyZWFkeScpO1xuICAgIH0sIDApO1xuXG4gICAgLy8gU2V0IHRoZSB0aXRsZVxuICAgIHVpLnNldFRpdGxlLmNhbGwodGhpcyk7XG5cbiAgICAvLyBBc3N1cmUgdGhlIHBvc3RlciBpbWFnZSBpcyBzZXQsIGlmIHRoZSBwcm9wZXJ0eSB3YXMgYWRkZWQgYmVmb3JlIHRoZSBlbGVtZW50IHdhcyBjcmVhdGVkXG4gICAgaWYgKHRoaXMucG9zdGVyKSB7XG4gICAgICB1aS5zZXRQb3N0ZXIuY2FsbCh0aGlzLCB0aGlzLnBvc3RlciwgZmFsc2UpLmNhdGNoKCgpID0+IHt9KTtcbiAgICB9XG5cbiAgICAvLyBNYW51YWxseSBzZXQgdGhlIGR1cmF0aW9uIGlmIHVzZXIgaGFzIG92ZXJyaWRkZW4gaXQuXG4gICAgLy8gVGhlIGV2ZW50IGxpc3RlbmVycyBmb3IgaXQgZG9lc24ndCBnZXQgY2FsbGVkIGlmIHByZWxvYWQgaXMgZGlzYWJsZWQgKCM3MDEpXG4gICAgaWYgKHRoaXMuY29uZmlnLmR1cmF0aW9uKSB7XG4gICAgICBjb250cm9scy5kdXJhdGlvblVwZGF0ZS5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIC8vIE1lZGlhIG1ldGFkYXRhXG4gICAgaWYgKHRoaXMuY29uZmlnLm1lZGlhTWV0YWRhdGEpIHtcbiAgICAgIGNvbnRyb2xzLnNldE1lZGlhTWV0YWRhdGEuY2FsbCh0aGlzKTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gU2V0dXAgYXJpYSBhdHRyaWJ1dGUgZm9yIHBsYXkgYW5kIGlmcmFtZSB0aXRsZVxuICBzZXRUaXRsZSgpIHtcbiAgICAvLyBGaW5kIHRoZSBjdXJyZW50IHRleHRcbiAgICBsZXQgbGFiZWwgPSBpMThuLmdldCgncGxheScsIHRoaXMuY29uZmlnKTtcblxuICAgIC8vIElmIHRoZXJlJ3MgYSBtZWRpYSB0aXRsZSBzZXQsIHVzZSB0aGF0IGZvciB0aGUgbGFiZWxcbiAgICBpZiAoaXMuc3RyaW5nKHRoaXMuY29uZmlnLnRpdGxlKSAmJiAhaXMuZW1wdHkodGhpcy5jb25maWcudGl0bGUpKSB7XG4gICAgICBsYWJlbCArPSBgLCAke3RoaXMuY29uZmlnLnRpdGxlfWA7XG4gICAgfVxuXG4gICAgLy8gSWYgdGhlcmUncyBhIHBsYXkgYnV0dG9uLCBzZXQgbGFiZWxcbiAgICBBcnJheS5mcm9tKHRoaXMuZWxlbWVudHMuYnV0dG9ucy5wbGF5IHx8IFtdKS5mb3JFYWNoKChidXR0b24pID0+IHtcbiAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBsYWJlbCk7XG4gICAgfSk7XG5cbiAgICAvLyBTZXQgaWZyYW1lIHRpdGxlXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzEyNFxuICAgIGlmICh0aGlzLmlzRW1iZWQpIHtcbiAgICAgIGNvbnN0IGlmcmFtZSA9IGdldEVsZW1lbnQuY2FsbCh0aGlzLCAnaWZyYW1lJyk7XG5cbiAgICAgIGlmICghaXMuZWxlbWVudChpZnJhbWUpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gRGVmYXVsdCB0byBtZWRpYSB0eXBlXG4gICAgICBjb25zdCB0aXRsZSA9ICFpcy5lbXB0eSh0aGlzLmNvbmZpZy50aXRsZSkgPyB0aGlzLmNvbmZpZy50aXRsZSA6ICd2aWRlbyc7XG4gICAgICBjb25zdCBmb3JtYXQgPSBpMThuLmdldCgnZnJhbWVUaXRsZScsIHRoaXMuY29uZmlnKTtcblxuICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBmb3JtYXQucmVwbGFjZSgne3RpdGxlfScsIHRpdGxlKSk7XG4gICAgfVxuICB9LFxuXG4gIC8vIFRvZ2dsZSBwb3N0ZXJcbiAgdG9nZ2xlUG9zdGVyKGVuYWJsZSkge1xuICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnBvc3RlckVuYWJsZWQsIGVuYWJsZSk7XG4gIH0sXG5cbiAgLy8gU2V0IHRoZSBwb3N0ZXIgaW1hZ2UgKGFzeW5jKVxuICAvLyBVc2VkIGludGVybmFsbHkgZm9yIHRoZSBwb3N0ZXIgc2V0dGVyLCB3aXRoIHRoZSBwYXNzaXZlIG9wdGlvbiBmb3JjZWQgdG8gZmFsc2VcbiAgc2V0UG9zdGVyKHBvc3RlciwgcGFzc2l2ZSA9IHRydWUpIHtcbiAgICAvLyBEb24ndCBvdmVycmlkZSBpZiBjYWxsIGlzIHBhc3NpdmVcbiAgICBpZiAocGFzc2l2ZSAmJiB0aGlzLnBvc3Rlcikge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignUG9zdGVyIGFscmVhZHkgc2V0JykpO1xuICAgIH1cblxuICAgIC8vIFNldCBwcm9wZXJ0eSBzeW5jaHJvbm91c2x5IHRvIHJlc3BlY3QgdGhlIGNhbGwgb3JkZXJcbiAgICB0aGlzLm1lZGlhLnNldEF0dHJpYnV0ZSgnZGF0YS1wb3N0ZXInLCBwb3N0ZXIpO1xuXG4gICAgLy8gU2hvdyB0aGUgcG9zdGVyXG4gICAgdGhpcy5lbGVtZW50cy5wb3N0ZXIucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcblxuICAgIC8vIFdhaXQgdW50aWwgdWkgaXMgcmVhZHlcbiAgICByZXR1cm4gKFxuICAgICAgcmVhZHlcbiAgICAgICAgLmNhbGwodGhpcylcbiAgICAgICAgLy8gTG9hZCBpbWFnZVxuICAgICAgICAudGhlbigoKSA9PiBsb2FkSW1hZ2UocG9zdGVyKSlcbiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgIC8vIEhpZGUgcG9zdGVyIG9uIGVycm9yIHVubGVzcyBpdCdzIGJlZW4gc2V0IGJ5IGFub3RoZXIgY2FsbFxuICAgICAgICAgIGlmIChwb3N0ZXIgPT09IHRoaXMucG9zdGVyKSB7XG4gICAgICAgICAgICB1aS50b2dnbGVQb3N0ZXIuY2FsbCh0aGlzLCBmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIFJldGhyb3dcbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIC8vIFByZXZlbnQgcmFjZSBjb25kaXRpb25zXG4gICAgICAgICAgaWYgKHBvc3RlciAhPT0gdGhpcy5wb3N0ZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignc2V0UG9zdGVyIGNhbmNlbGxlZCBieSBsYXRlciBjYWxsIHRvIHNldFBvc3RlcicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5lbGVtZW50cy5wb3N0ZXIuc3R5bGUsIHtcbiAgICAgICAgICAgIGJhY2tncm91bmRJbWFnZTogYHVybCgnJHtwb3N0ZXJ9JylgLFxuICAgICAgICAgICAgLy8gUmVzZXQgYmFja2dyb3VuZFNpemUgYXMgd2VsbCAoc2luY2UgaXQgY2FuIGJlIHNldCB0byBcImNvdmVyXCIgZm9yIHBhZGRlZCB0aHVtYm5haWxzIGZvciB5b3V0dWJlKVxuICAgICAgICAgICAgYmFja2dyb3VuZFNpemU6ICcnLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdWkudG9nZ2xlUG9zdGVyLmNhbGwodGhpcywgdHJ1ZSk7XG5cbiAgICAgICAgICByZXR1cm4gcG9zdGVyO1xuICAgICAgICB9KVxuICAgICk7XG4gIH0sXG5cbiAgLy8gQ2hlY2sgcGxheWluZyBzdGF0ZVxuICBjaGVja1BsYXlpbmcoZXZlbnQpIHtcbiAgICAvLyBDbGFzcyBob29rc1xuICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnBsYXlpbmcsIHRoaXMucGxheWluZyk7XG4gICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMucGF1c2VkLCB0aGlzLnBhdXNlZCk7XG4gICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuc3RvcHBlZCwgdGhpcy5zdG9wcGVkKTtcblxuICAgIC8vIFNldCBzdGF0ZVxuICAgIEFycmF5LmZyb20odGhpcy5lbGVtZW50cy5idXR0b25zLnBsYXkgfHwgW10pLmZvckVhY2goKHRhcmdldCkgPT4ge1xuICAgICAgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHsgcHJlc3NlZDogdGhpcy5wbGF5aW5nIH0pO1xuICAgICAgdGFyZ2V0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGkxOG4uZ2V0KHRoaXMucGxheWluZyA/ICdwYXVzZScgOiAncGxheScsIHRoaXMuY29uZmlnKSk7XG4gICAgfSk7XG5cbiAgICAvLyBPbmx5IHVwZGF0ZSBjb250cm9scyBvbiBub24gdGltZXVwZGF0ZSBldmVudHNcbiAgICBpZiAoaXMuZXZlbnQoZXZlbnQpICYmIGV2ZW50LnR5cGUgPT09ICd0aW1ldXBkYXRlJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFRvZ2dsZSBjb250cm9sc1xuICAgIHVpLnRvZ2dsZUNvbnRyb2xzLmNhbGwodGhpcyk7XG4gIH0sXG5cbiAgLy8gQ2hlY2sgaWYgbWVkaWEgaXMgbG9hZGluZ1xuICBjaGVja0xvYWRpbmcoZXZlbnQpIHtcbiAgICB0aGlzLmxvYWRpbmcgPSBbJ3N0YWxsZWQnLCAnd2FpdGluZyddLmluY2x1ZGVzKGV2ZW50LnR5cGUpO1xuXG4gICAgLy8gQ2xlYXIgdGltZXJcbiAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcnMubG9hZGluZyk7XG5cbiAgICAvLyBUaW1lciB0byBwcmV2ZW50IGZsaWNrZXIgd2hlbiBzZWVraW5nXG4gICAgdGhpcy50aW1lcnMubG9hZGluZyA9IHNldFRpbWVvdXQoXG4gICAgICAoKSA9PiB7XG4gICAgICAgIC8vIFVwZGF0ZSBwcm9ncmVzcyBiYXIgbG9hZGluZyBjbGFzcyBzdGF0ZVxuICAgICAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5sb2FkaW5nLCB0aGlzLmxvYWRpbmcpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSBjb250cm9scyB2aXNpYmlsaXR5XG4gICAgICAgIHVpLnRvZ2dsZUNvbnRyb2xzLmNhbGwodGhpcyk7XG4gICAgICB9LFxuICAgICAgdGhpcy5sb2FkaW5nID8gMjUwIDogMCxcbiAgICApO1xuICB9LFxuXG4gIC8vIFRvZ2dsZSBjb250cm9scyBiYXNlZCBvbiBzdGF0ZSBhbmQgYGZvcmNlYCBhcmd1bWVudFxuICB0b2dnbGVDb250cm9scyhmb3JjZSkge1xuICAgIGNvbnN0IHsgY29udHJvbHM6IGNvbnRyb2xzRWxlbWVudCB9ID0gdGhpcy5lbGVtZW50cztcblxuICAgIGlmIChjb250cm9sc0VsZW1lbnQgJiYgdGhpcy5jb25maWcuaGlkZUNvbnRyb2xzKSB7XG4gICAgICAvLyBEb24ndCBoaWRlIGNvbnRyb2xzIGlmIGEgdG91Y2gtZGV2aWNlIHVzZXIgcmVjZW50bHkgc2Vla2VkLiAoTXVzdCBiZSBsaW1pdGVkIHRvIHRvdWNoIGRldmljZXMsIG9yIGl0IG9jY2FzaW9uYWxseSBwcmV2ZW50cyBkZXNrdG9wIGNvbnRyb2xzIGZyb20gaGlkaW5nLilcbiAgICAgIGNvbnN0IHJlY2VudFRvdWNoU2VlayA9IHRoaXMudG91Y2ggJiYgdGhpcy5sYXN0U2Vla1RpbWUgKyAyMDAwID4gRGF0ZS5ub3coKTtcblxuICAgICAgLy8gU2hvdyBjb250cm9scyBpZiBmb3JjZSwgbG9hZGluZywgcGF1c2VkLCBidXR0b24gaW50ZXJhY3Rpb24sIG9yIHJlY2VudCBzZWVrLCBvdGhlcndpc2UgaGlkZVxuICAgICAgdGhpcy50b2dnbGVDb250cm9scyhcbiAgICAgICAgQm9vbGVhbihcbiAgICAgICAgICBmb3JjZSB8fCB0aGlzLmxvYWRpbmcgfHwgdGhpcy5wYXVzZWQgfHwgY29udHJvbHNFbGVtZW50LnByZXNzZWQgfHwgY29udHJvbHNFbGVtZW50LmhvdmVyIHx8IHJlY2VudFRvdWNoU2VlayxcbiAgICAgICAgKSxcbiAgICAgICk7XG4gICAgfVxuICB9LFxuXG4gIC8vIE1pZ3JhdGUgYW55IGN1c3RvbSBwcm9wZXJ0aWVzIGZyb20gdGhlIG1lZGlhIHRvIHRoZSBwYXJlbnRcbiAgbWlncmF0ZVN0eWxlcygpIHtcbiAgICAvLyBMb29wIHRocm91Z2ggdmFsdWVzIChhcyB0aGV5IGFyZSB0aGUga2V5cyB3aGVuIHRoZSBvYmplY3QgaXMgc3ByZWFkIPCfpJQpXG4gICAgT2JqZWN0LnZhbHVlcyh7IC4uLnRoaXMubWVkaWEuc3R5bGUgfSlcbiAgICAgIC8vIFdlJ3JlIG9ubHkgZnVzc2VkIGFib3V0IFBseXIgc3BlY2lmaWMgcHJvcGVydGllc1xuICAgICAgLmZpbHRlcigoa2V5KSA9PiAhaXMuZW1wdHkoa2V5KSAmJiBpcy5zdHJpbmcoa2V5KSAmJiBrZXkuc3RhcnRzV2l0aCgnLS1wbHlyJykpXG4gICAgICAuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgIC8vIFNldCBvbiB0aGUgY29udGFpbmVyXG4gICAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLnN0eWxlLnNldFByb3BlcnR5KGtleSwgdGhpcy5tZWRpYS5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKGtleSkpO1xuXG4gICAgICAgIC8vIENsZWFuIHVwIGZyb20gbWVkaWEgZWxlbWVudFxuICAgICAgICB0aGlzLm1lZGlhLnN0eWxlLnJlbW92ZVByb3BlcnR5KGtleSk7XG4gICAgICB9KTtcblxuICAgIC8vIFJlbW92ZSBhdHRyaWJ1dGUgaWYgZW1wdHlcbiAgICBpZiAoaXMuZW1wdHkodGhpcy5tZWRpYS5zdHlsZSkpIHtcbiAgICAgIHRoaXMubWVkaWEucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpO1xuICAgIH1cbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHVpO1xuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBseXIgRXZlbnQgTGlzdGVuZXJzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgY29udHJvbHMgZnJvbSAnLi9jb250cm9scyc7XG5pbXBvcnQgdWkgZnJvbSAnLi91aSc7XG5pbXBvcnQgeyByZXBhaW50IH0gZnJvbSAnLi91dGlscy9hbmltYXRpb24nO1xuaW1wb3J0IGJyb3dzZXIgZnJvbSAnLi91dGlscy9icm93c2VyJztcbmltcG9ydCB7IGdldEVsZW1lbnQsIGdldEVsZW1lbnRzLCBtYXRjaGVzLCB0b2dnbGVDbGFzcyB9IGZyb20gJy4vdXRpbHMvZWxlbWVudHMnO1xuaW1wb3J0IHsgb2ZmLCBvbiwgb25jZSwgdG9nZ2xlTGlzdGVuZXIsIHRyaWdnZXJFdmVudCB9IGZyb20gJy4vdXRpbHMvZXZlbnRzJztcbmltcG9ydCBpcyBmcm9tICcuL3V0aWxzL2lzJztcbmltcG9ydCB7IHNpbGVuY2VQcm9taXNlIH0gZnJvbSAnLi91dGlscy9wcm9taXNlJztcbmltcG9ydCB7IGdldEFzcGVjdFJhdGlvLCBnZXRWaWV3cG9ydFNpemUsIHN1cHBvcnRzQ1NTIH0gZnJvbSAnLi91dGlscy9zdHlsZSc7XG5cbmNsYXNzIExpc3RlbmVycyB7XG4gIGNvbnN0cnVjdG9yKHBsYXllcikge1xuICAgIHRoaXMucGxheWVyID0gcGxheWVyO1xuICAgIHRoaXMubGFzdEtleSA9IG51bGw7XG4gICAgdGhpcy5mb2N1c1RpbWVyID0gbnVsbDtcbiAgICB0aGlzLmxhc3RLZXlEb3duID0gbnVsbDtcblxuICAgIHRoaXMuaGFuZGxlS2V5ID0gdGhpcy5oYW5kbGVLZXkuYmluZCh0aGlzKTtcbiAgICB0aGlzLnRvZ2dsZU1lbnUgPSB0aGlzLnRvZ2dsZU1lbnUuYmluZCh0aGlzKTtcbiAgICB0aGlzLnNldFRhYkZvY3VzID0gdGhpcy5zZXRUYWJGb2N1cy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuZmlyc3RUb3VjaCA9IHRoaXMuZmlyc3RUb3VjaC5iaW5kKHRoaXMpO1xuICB9XG5cbiAgLy8gSGFuZGxlIGtleSBwcmVzc2VzXG4gIGhhbmRsZUtleShldmVudCkge1xuICAgIGNvbnN0IHsgcGxheWVyIH0gPSB0aGlzO1xuICAgIGNvbnN0IHsgZWxlbWVudHMgfSA9IHBsYXllcjtcbiAgICBjb25zdCB7IGtleSwgdHlwZSwgYWx0S2V5LCBjdHJsS2V5LCBtZXRhS2V5LCBzaGlmdEtleSB9ID0gZXZlbnQ7XG4gICAgY29uc3QgcHJlc3NlZCA9IHR5cGUgPT09ICdrZXlkb3duJztcbiAgICBjb25zdCByZXBlYXQgPSBwcmVzc2VkICYmIGtleSA9PT0gdGhpcy5sYXN0S2V5O1xuXG4gICAgLy8gQmFpbCBpZiBhIG1vZGlmaWVyIGtleSBpcyBzZXRcbiAgICBpZiAoYWx0S2V5IHx8IGN0cmxLZXkgfHwgbWV0YUtleSB8fCBzaGlmdEtleSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIElmIHRoZSBldmVudCBpcyBidWJibGVkIGZyb20gdGhlIG1lZGlhIGVsZW1lbnRcbiAgICAvLyBGaXJlZm94IGRvZXNuJ3QgZ2V0IHRoZSBrZXkgZm9yIHdoYXRldmVyIHJlYXNvblxuICAgIGlmICgha2V5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gU2VlayBieSBpbmNyZW1lbnRcbiAgICBjb25zdCBzZWVrQnlJbmNyZW1lbnQgPSAoaW5jcmVtZW50KSA9PiB7XG4gICAgICAvLyBEaXZpZGUgdGhlIG1heCBkdXJhdGlvbiBpbnRvIDEwdGgncyBhbmQgdGltZXMgYnkgdGhlIG51bWJlciB2YWx1ZVxuICAgICAgcGxheWVyLmN1cnJlbnRUaW1lID0gKHBsYXllci5kdXJhdGlvbiAvIDEwKSAqIGluY3JlbWVudDtcbiAgICB9O1xuXG4gICAgLy8gSGFuZGxlIHRoZSBrZXkgb24ga2V5ZG93blxuICAgIC8vIFJlc2V0IG9uIGtleXVwXG4gICAgaWYgKHByZXNzZWQpIHtcbiAgICAgIC8vIENoZWNrIGZvY3VzZWQgZWxlbWVudFxuICAgICAgLy8gYW5kIGlmIHRoZSBmb2N1c2VkIGVsZW1lbnQgaXMgbm90IGVkaXRhYmxlIChlLmcuIHRleHQgaW5wdXQpXG4gICAgICAvLyBhbmQgYW55IHRoYXQgYWNjZXB0IGtleSBpbnB1dCBodHRwOi8vd2ViYWltLm9yZy90ZWNobmlxdWVzL2tleWJvYXJkL1xuICAgICAgY29uc3QgZm9jdXNlZCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG4gICAgICBpZiAoaXMuZWxlbWVudChmb2N1c2VkKSkge1xuICAgICAgICBjb25zdCB7IGVkaXRhYmxlIH0gPSBwbGF5ZXIuY29uZmlnLnNlbGVjdG9ycztcbiAgICAgICAgY29uc3QgeyBzZWVrIH0gPSBlbGVtZW50cy5pbnB1dHM7XG5cbiAgICAgICAgaWYgKGZvY3VzZWQgIT09IHNlZWsgJiYgbWF0Y2hlcyhmb2N1c2VkLCBlZGl0YWJsZSkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnU3BhY2UnICYmIG1hdGNoZXMoZm9jdXNlZCwgJ2J1dHRvbiwgW3JvbGVePVwibWVudWl0ZW1cIl0nKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBXaGljaCBrZXlzIHNob3VsZCB3ZSBwcmV2ZW50IGRlZmF1bHRcbiAgICAgIGNvbnN0IHByZXZlbnREZWZhdWx0ID0gW1xuICAgICAgICAnU3BhY2UnLFxuICAgICAgICAnQXJyb3dMZWZ0JyxcbiAgICAgICAgJ0Fycm93VXAnLFxuICAgICAgICAnQXJyb3dSaWdodCcsXG4gICAgICAgICdBcnJvd0Rvd24nLFxuXG4gICAgICAgICcwJyxcbiAgICAgICAgJzEnLFxuICAgICAgICAnMicsXG4gICAgICAgICczJyxcbiAgICAgICAgJzQnLFxuICAgICAgICAnNScsXG4gICAgICAgICc2JyxcbiAgICAgICAgJzcnLFxuICAgICAgICAnOCcsXG4gICAgICAgICc5JyxcblxuICAgICAgICAnYycsXG4gICAgICAgICdmJyxcbiAgICAgICAgJ2snLFxuICAgICAgICAnbCcsXG4gICAgICAgICdtJyxcbiAgICAgIF07XG5cbiAgICAgIC8vIElmIHRoZSBrZXkgaXMgZm91bmQgcHJldmVudCBkZWZhdWx0IChlLmcuIHByZXZlbnQgc2Nyb2xsaW5nIGZvciBhcnJvd3MpXG4gICAgICBpZiAocHJldmVudERlZmF1bHQuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIH1cblxuICAgICAgc3dpdGNoIChrZXkpIHtcbiAgICAgICAgY2FzZSAnMCc6XG4gICAgICAgIGNhc2UgJzEnOlxuICAgICAgICBjYXNlICcyJzpcbiAgICAgICAgY2FzZSAnMyc6XG4gICAgICAgIGNhc2UgJzQnOlxuICAgICAgICBjYXNlICc1JzpcbiAgICAgICAgY2FzZSAnNic6XG4gICAgICAgIGNhc2UgJzcnOlxuICAgICAgICBjYXNlICc4JzpcbiAgICAgICAgY2FzZSAnOSc6XG4gICAgICAgICAgaWYgKCFyZXBlYXQpIHtcbiAgICAgICAgICAgIHNlZWtCeUluY3JlbWVudChwYXJzZUludChrZXksIDEwKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ1NwYWNlJzpcbiAgICAgICAgY2FzZSAnayc6XG4gICAgICAgICAgaWYgKCFyZXBlYXQpIHtcbiAgICAgICAgICAgIHNpbGVuY2VQcm9taXNlKHBsYXllci50b2dnbGVQbGF5KCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdBcnJvd1VwJzpcbiAgICAgICAgICBwbGF5ZXIuaW5jcmVhc2VWb2x1bWUoMC4xKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdBcnJvd0Rvd24nOlxuICAgICAgICAgIHBsYXllci5kZWNyZWFzZVZvbHVtZSgwLjEpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ20nOlxuICAgICAgICAgIGlmICghcmVwZWF0KSB7XG4gICAgICAgICAgICBwbGF5ZXIubXV0ZWQgPSAhcGxheWVyLm11dGVkO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdBcnJvd1JpZ2h0JzpcbiAgICAgICAgICBwbGF5ZXIuZm9yd2FyZCgpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ0Fycm93TGVmdCc6XG4gICAgICAgICAgcGxheWVyLnJld2luZCgpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2YnOlxuICAgICAgICAgIHBsYXllci5mdWxsc2NyZWVuLnRvZ2dsZSgpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2MnOlxuICAgICAgICAgIGlmICghcmVwZWF0KSB7XG4gICAgICAgICAgICBwbGF5ZXIudG9nZ2xlQ2FwdGlvbnMoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnbCc6XG4gICAgICAgICAgcGxheWVyLmxvb3AgPSAhcGxheWVyLmxvb3A7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgLy8gRXNjYXBlIGlzIGhhbmRsZSBuYXRpdmVseSB3aGVuIGluIGZ1bGwgc2NyZWVuXG4gICAgICAvLyBTbyB3ZSBvbmx5IG5lZWQgdG8gd29ycnkgYWJvdXQgbm9uIG5hdGl2ZVxuICAgICAgaWYgKGtleSA9PT0gJ0VzY2FwZScgJiYgIXBsYXllci5mdWxsc2NyZWVuLnVzaW5nTmF0aXZlICYmIHBsYXllci5mdWxsc2NyZWVuLmFjdGl2ZSkge1xuICAgICAgICBwbGF5ZXIuZnVsbHNjcmVlbi50b2dnbGUoKTtcbiAgICAgIH1cblxuICAgICAgLy8gU3RvcmUgbGFzdCBrZXkgZm9yIG5leHQgY3ljbGVcbiAgICAgIHRoaXMubGFzdEtleSA9IGtleTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5sYXN0S2V5ID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvLyBUb2dnbGUgbWVudVxuICB0b2dnbGVNZW51KGV2ZW50KSB7XG4gICAgY29udHJvbHMudG9nZ2xlTWVudS5jYWxsKHRoaXMucGxheWVyLCBldmVudCk7XG4gIH1cblxuICAvLyBEZXZpY2UgaXMgdG91Y2ggZW5hYmxlZFxuICBmaXJzdFRvdWNoID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgcGxheWVyIH0gPSB0aGlzO1xuICAgIGNvbnN0IHsgZWxlbWVudHMgfSA9IHBsYXllcjtcblxuICAgIHBsYXllci50b3VjaCA9IHRydWU7XG5cbiAgICAvLyBBZGQgdG91Y2ggY2xhc3NcbiAgICB0b2dnbGVDbGFzcyhlbGVtZW50cy5jb250YWluZXIsIHBsYXllci5jb25maWcuY2xhc3NOYW1lcy5pc1RvdWNoLCB0cnVlKTtcbiAgfTtcblxuICBzZXRUYWJGb2N1cyA9IChldmVudCkgPT4ge1xuICAgIGNvbnN0IHsgcGxheWVyIH0gPSB0aGlzO1xuICAgIGNvbnN0IHsgZWxlbWVudHMgfSA9IHBsYXllcjtcbiAgICBjb25zdCB7IGtleSwgdHlwZSwgdGltZVN0YW1wIH0gPSBldmVudDtcblxuICAgIGNsZWFyVGltZW91dCh0aGlzLmZvY3VzVGltZXIpO1xuXG4gICAgLy8gSWdub3JlIGFueSBrZXkgb3RoZXIgdGhhbiB0YWJcbiAgICBpZiAodHlwZSA9PT0gJ2tleWRvd24nICYmIGtleSAhPT0gJ1RhYicpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTdG9yZSByZWZlcmVuY2UgdG8gZXZlbnQgdGltZVN0YW1wXG4gICAgaWYgKHR5cGUgPT09ICdrZXlkb3duJykge1xuICAgICAgdGhpcy5sYXN0S2V5RG93biA9IHRpbWVTdGFtcDtcbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgY3VycmVudCBjbGFzc2VzXG4gICAgY29uc3QgcmVtb3ZlQ3VycmVudCA9ICgpID0+IHtcbiAgICAgIGNvbnN0IGNsYXNzTmFtZSA9IHBsYXllci5jb25maWcuY2xhc3NOYW1lcy50YWJGb2N1cztcbiAgICAgIGNvbnN0IGN1cnJlbnQgPSBnZXRFbGVtZW50cy5jYWxsKHBsYXllciwgYC4ke2NsYXNzTmFtZX1gKTtcbiAgICAgIHRvZ2dsZUNsYXNzKGN1cnJlbnQsIGNsYXNzTmFtZSwgZmFsc2UpO1xuICAgIH07XG5cbiAgICAvLyBEZXRlcm1pbmUgaWYgYSBrZXkgd2FzIHByZXNzZWQgdG8gdHJpZ2dlciB0aGlzIGV2ZW50XG4gICAgY29uc3Qgd2FzS2V5RG93biA9IHRpbWVTdGFtcCAtIHRoaXMubGFzdEtleURvd24gPD0gMjA7XG5cbiAgICAvLyBJZ25vcmUgZm9jdXMgZXZlbnRzIGlmIGEga2V5IHdhcyBwcmVzc2VkIHByaW9yXG4gICAgaWYgKHR5cGUgPT09ICdmb2N1cycgJiYgIXdhc0tleURvd24pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgYWxsIGN1cnJlbnRcbiAgICByZW1vdmVDdXJyZW50KCk7XG5cbiAgICAvLyBEZWxheSB0aGUgYWRkaW5nIG9mIGNsYXNzbmFtZSB1bnRpbCB0aGUgZm9jdXMgaGFzIGNoYW5nZWRcbiAgICAvLyBUaGlzIGV2ZW50IGZpcmVzIGJlZm9yZSB0aGUgZm9jdXNpbiBldmVudFxuICAgIGlmICh0eXBlICE9PSAnZm9jdXNvdXQnKSB7XG4gICAgICB0aGlzLmZvY3VzVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY29uc3QgZm9jdXNlZCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG5cbiAgICAgICAgLy8gSWdub3JlIGlmIGN1cnJlbnQgZm9jdXMgZWxlbWVudCBpc24ndCBpbnNpZGUgdGhlIHBsYXllclxuICAgICAgICBpZiAoIWVsZW1lbnRzLmNvbnRhaW5lci5jb250YWlucyhmb2N1c2VkKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRvZ2dsZUNsYXNzKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQsIHBsYXllci5jb25maWcuY2xhc3NOYW1lcy50YWJGb2N1cywgdHJ1ZSk7XG4gICAgICB9LCAxMCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIEdsb2JhbCB3aW5kb3cgJiBkb2N1bWVudCBsaXN0ZW5lcnNcbiAgZ2xvYmFsID0gKHRvZ2dsZSA9IHRydWUpID0+IHtcbiAgICBjb25zdCB7IHBsYXllciB9ID0gdGhpcztcblxuICAgIC8vIEtleWJvYXJkIHNob3J0Y3V0c1xuICAgIGlmIChwbGF5ZXIuY29uZmlnLmtleWJvYXJkLmdsb2JhbCkge1xuICAgICAgdG9nZ2xlTGlzdGVuZXIuY2FsbChwbGF5ZXIsIHdpbmRvdywgJ2tleWRvd24ga2V5dXAnLCB0aGlzLmhhbmRsZUtleSwgdG9nZ2xlLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgLy8gQ2xpY2sgYW55d2hlcmUgY2xvc2VzIG1lbnVcbiAgICB0b2dnbGVMaXN0ZW5lci5jYWxsKHBsYXllciwgZG9jdW1lbnQuYm9keSwgJ2NsaWNrJywgdGhpcy50b2dnbGVNZW51LCB0b2dnbGUpO1xuXG4gICAgLy8gRGV0ZWN0IHRvdWNoIGJ5IGV2ZW50c1xuICAgIG9uY2UuY2FsbChwbGF5ZXIsIGRvY3VtZW50LmJvZHksICd0b3VjaHN0YXJ0JywgdGhpcy5maXJzdFRvdWNoKTtcblxuICAgIC8vIFRhYiBmb2N1cyBkZXRlY3Rpb25cbiAgICB0b2dnbGVMaXN0ZW5lci5jYWxsKHBsYXllciwgZG9jdW1lbnQuYm9keSwgJ2tleWRvd24gZm9jdXMgYmx1ciBmb2N1c291dCcsIHRoaXMuc2V0VGFiRm9jdXMsIHRvZ2dsZSwgZmFsc2UsIHRydWUpO1xuICB9O1xuXG4gIC8vIENvbnRhaW5lciBsaXN0ZW5lcnNcbiAgY29udGFpbmVyID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgcGxheWVyIH0gPSB0aGlzO1xuICAgIGNvbnN0IHsgY29uZmlnLCBlbGVtZW50cywgdGltZXJzIH0gPSBwbGF5ZXI7XG5cbiAgICAvLyBLZXlib2FyZCBzaG9ydGN1dHNcbiAgICBpZiAoIWNvbmZpZy5rZXlib2FyZC5nbG9iYWwgJiYgY29uZmlnLmtleWJvYXJkLmZvY3VzZWQpIHtcbiAgICAgIG9uLmNhbGwocGxheWVyLCBlbGVtZW50cy5jb250YWluZXIsICdrZXlkb3duIGtleXVwJywgdGhpcy5oYW5kbGVLZXksIGZhbHNlKTtcbiAgICB9XG5cbiAgICAvLyBUb2dnbGUgY29udHJvbHMgb24gbW91c2UgZXZlbnRzIGFuZCBlbnRlcmluZyBmdWxsc2NyZWVuXG4gICAgb24uY2FsbChcbiAgICAgIHBsYXllcixcbiAgICAgIGVsZW1lbnRzLmNvbnRhaW5lcixcbiAgICAgICdtb3VzZW1vdmUgbW91c2VsZWF2ZSB0b3VjaHN0YXJ0IHRvdWNobW92ZSBlbnRlcmZ1bGxzY3JlZW4gZXhpdGZ1bGxzY3JlZW4nLFxuICAgICAgKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IHsgY29udHJvbHM6IGNvbnRyb2xzRWxlbWVudCB9ID0gZWxlbWVudHM7XG5cbiAgICAgICAgLy8gUmVtb3ZlIGJ1dHRvbiBzdGF0ZXMgZm9yIGZ1bGxzY3JlZW5cbiAgICAgICAgaWYgKGNvbnRyb2xzRWxlbWVudCAmJiBldmVudC50eXBlID09PSAnZW50ZXJmdWxsc2NyZWVuJykge1xuICAgICAgICAgIGNvbnRyb2xzRWxlbWVudC5wcmVzc2VkID0gZmFsc2U7XG4gICAgICAgICAgY29udHJvbHNFbGVtZW50LmhvdmVyID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTaG93LCB0aGVuIGhpZGUgYWZ0ZXIgYSB0aW1lb3V0IHVubGVzcyBhbm90aGVyIGNvbnRyb2wgZXZlbnQgb2NjdXJzXG4gICAgICAgIGNvbnN0IHNob3cgPSBbJ3RvdWNoc3RhcnQnLCAndG91Y2htb3ZlJywgJ21vdXNlbW92ZSddLmluY2x1ZGVzKGV2ZW50LnR5cGUpO1xuICAgICAgICBsZXQgZGVsYXkgPSAwO1xuXG4gICAgICAgIGlmIChzaG93KSB7XG4gICAgICAgICAgdWkudG9nZ2xlQ29udHJvbHMuY2FsbChwbGF5ZXIsIHRydWUpO1xuICAgICAgICAgIC8vIFVzZSBsb25nZXIgdGltZW91dCBmb3IgdG91Y2ggZGV2aWNlc1xuICAgICAgICAgIGRlbGF5ID0gcGxheWVyLnRvdWNoID8gMzAwMCA6IDIwMDA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDbGVhciB0aW1lclxuICAgICAgICBjbGVhclRpbWVvdXQodGltZXJzLmNvbnRyb2xzKTtcblxuICAgICAgICAvLyBTZXQgbmV3IHRpbWVyIHRvIHByZXZlbnQgZmxpY2tlciB3aGVuIHNlZWtpbmdcbiAgICAgICAgdGltZXJzLmNvbnRyb2xzID0gc2V0VGltZW91dCgoKSA9PiB1aS50b2dnbGVDb250cm9scy5jYWxsKHBsYXllciwgZmFsc2UpLCBkZWxheSk7XG4gICAgICB9LFxuICAgICk7XG5cbiAgICAvLyBTZXQgYSBndXR0ZXIgZm9yIFZpbWVvXG4gICAgY29uc3Qgc2V0R3V0dGVyID0gKCkgPT4ge1xuICAgICAgaWYgKCFwbGF5ZXIuaXNWaW1lbyB8fCBwbGF5ZXIuY29uZmlnLnZpbWVvLnByZW1pdW0pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0YXJnZXQgPSBlbGVtZW50cy53cmFwcGVyO1xuICAgICAgY29uc3QgeyBhY3RpdmUgfSA9IHBsYXllci5mdWxsc2NyZWVuO1xuICAgICAgY29uc3QgW3ZpZGVvV2lkdGgsIHZpZGVvSGVpZ2h0XSA9IGdldEFzcGVjdFJhdGlvLmNhbGwocGxheWVyKTtcbiAgICAgIGNvbnN0IHVzZU5hdGl2ZUFzcGVjdFJhdGlvID0gc3VwcG9ydHNDU1MoYGFzcGVjdC1yYXRpbzogJHt2aWRlb1dpZHRofSAvICR7dmlkZW9IZWlnaHR9YCk7XG5cbiAgICAgIC8vIElmIG5vdCBhY3RpdmUsIHJlbW92ZSBzdHlsZXNcbiAgICAgIGlmICghYWN0aXZlKSB7XG4gICAgICAgIGlmICh1c2VOYXRpdmVBc3BlY3RSYXRpbykge1xuICAgICAgICAgIHRhcmdldC5zdHlsZS53aWR0aCA9IG51bGw7XG4gICAgICAgICAgdGFyZ2V0LnN0eWxlLmhlaWdodCA9IG51bGw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGFyZ2V0LnN0eWxlLm1heFdpZHRoID0gbnVsbDtcbiAgICAgICAgICB0YXJnZXQuc3R5bGUubWFyZ2luID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIERldGVybWluZSB3aGljaCBkaW1lbnNpb24gd2lsbCBvdmVyZmxvdyBhbmQgY29uc3RyYWluIHZpZXdcbiAgICAgIGNvbnN0IFt2aWV3cG9ydFdpZHRoLCB2aWV3cG9ydEhlaWdodF0gPSBnZXRWaWV3cG9ydFNpemUoKTtcbiAgICAgIGNvbnN0IG92ZXJmbG93ID0gdmlld3BvcnRXaWR0aCAvIHZpZXdwb3J0SGVpZ2h0ID4gdmlkZW9XaWR0aCAvIHZpZGVvSGVpZ2h0O1xuXG4gICAgICBpZiAodXNlTmF0aXZlQXNwZWN0UmF0aW8pIHtcbiAgICAgICAgdGFyZ2V0LnN0eWxlLndpZHRoID0gb3ZlcmZsb3cgPyAnYXV0bycgOiAnMTAwJSc7XG4gICAgICAgIHRhcmdldC5zdHlsZS5oZWlnaHQgPSBvdmVyZmxvdyA/ICcxMDAlJyA6ICdhdXRvJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRhcmdldC5zdHlsZS5tYXhXaWR0aCA9IG92ZXJmbG93ID8gYCR7KHZpZXdwb3J0SGVpZ2h0IC8gdmlkZW9IZWlnaHQpICogdmlkZW9XaWR0aH1weGAgOiBudWxsO1xuICAgICAgICB0YXJnZXQuc3R5bGUubWFyZ2luID0gb3ZlcmZsb3cgPyAnMCBhdXRvJyA6IG51bGw7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIEhhbmRsZSByZXNpemluZ1xuICAgIGNvbnN0IHJlc2l6ZWQgPSAoKSA9PiB7XG4gICAgICBjbGVhclRpbWVvdXQodGltZXJzLnJlc2l6ZWQpO1xuICAgICAgdGltZXJzLnJlc2l6ZWQgPSBzZXRUaW1lb3V0KHNldEd1dHRlciwgNTApO1xuICAgIH07XG5cbiAgICBvbi5jYWxsKHBsYXllciwgZWxlbWVudHMuY29udGFpbmVyLCAnZW50ZXJmdWxsc2NyZWVuIGV4aXRmdWxsc2NyZWVuJywgKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCB7IHRhcmdldCB9ID0gcGxheWVyLmZ1bGxzY3JlZW47XG5cbiAgICAgIC8vIElnbm9yZSBldmVudHMgbm90IGZyb20gdGFyZ2V0XG4gICAgICBpZiAodGFyZ2V0ICE9PSBlbGVtZW50cy5jb250YWluZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBJZiBpdCdzIG5vdCBhbiBlbWJlZCBhbmQgbm8gcmF0aW8gc3BlY2lmaWVkXG4gICAgICBpZiAoIXBsYXllci5pc0VtYmVkICYmIGlzLmVtcHR5KHBsYXllci5jb25maWcucmF0aW8pKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gU2V0IFZpbWVvIGd1dHRlclxuICAgICAgc2V0R3V0dGVyKCk7XG5cbiAgICAgIC8vIFdhdGNoIGZvciByZXNpemVzXG4gICAgICBjb25zdCBtZXRob2QgPSBldmVudC50eXBlID09PSAnZW50ZXJmdWxsc2NyZWVuJyA/IG9uIDogb2ZmO1xuICAgICAgbWV0aG9kLmNhbGwocGxheWVyLCB3aW5kb3csICdyZXNpemUnLCByZXNpemVkKTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBMaXN0ZW4gZm9yIG1lZGlhIGV2ZW50c1xuICBtZWRpYSA9ICgpID0+IHtcbiAgICBjb25zdCB7IHBsYXllciB9ID0gdGhpcztcbiAgICBjb25zdCB7IGVsZW1lbnRzIH0gPSBwbGF5ZXI7XG5cbiAgICAvLyBUaW1lIGNoYW5nZSBvbiBtZWRpYVxuICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd0aW1ldXBkYXRlIHNlZWtpbmcgc2Vla2VkJywgKGV2ZW50KSA9PiBjb250cm9scy50aW1lVXBkYXRlLmNhbGwocGxheWVyLCBldmVudCkpO1xuXG4gICAgLy8gRGlzcGxheSBkdXJhdGlvblxuICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdkdXJhdGlvbmNoYW5nZSBsb2FkZWRkYXRhIGxvYWRlZG1ldGFkYXRhJywgKGV2ZW50KSA9PlxuICAgICAgY29udHJvbHMuZHVyYXRpb25VcGRhdGUuY2FsbChwbGF5ZXIsIGV2ZW50KSxcbiAgICApO1xuXG4gICAgLy8gSGFuZGxlIHRoZSBtZWRpYSBmaW5pc2hpbmdcbiAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZW5kZWQnLCAoKSA9PiB7XG4gICAgICAvLyBTaG93IHBvc3RlciBvbiBlbmRcbiAgICAgIGlmIChwbGF5ZXIuaXNIVE1MNSAmJiBwbGF5ZXIuaXNWaWRlbyAmJiBwbGF5ZXIuY29uZmlnLnJlc2V0T25FbmQpIHtcbiAgICAgICAgLy8gUmVzdGFydFxuICAgICAgICBwbGF5ZXIucmVzdGFydCgpO1xuXG4gICAgICAgIC8vIENhbGwgcGF1c2Ugb3RoZXJ3aXNlIElFMTEgd2lsbCBzdGFydCBwbGF5aW5nIHRoZSB2aWRlbyBhZ2FpblxuICAgICAgICBwbGF5ZXIucGF1c2UoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIENoZWNrIGZvciBidWZmZXIgcHJvZ3Jlc3NcbiAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncHJvZ3Jlc3MgcGxheWluZyBzZWVraW5nIHNlZWtlZCcsIChldmVudCkgPT5cbiAgICAgIGNvbnRyb2xzLnVwZGF0ZVByb2dyZXNzLmNhbGwocGxheWVyLCBldmVudCksXG4gICAgKTtcblxuICAgIC8vIEhhbmRsZSB2b2x1bWUgY2hhbmdlc1xuICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd2b2x1bWVjaGFuZ2UnLCAoZXZlbnQpID0+IGNvbnRyb2xzLnVwZGF0ZVZvbHVtZS5jYWxsKHBsYXllciwgZXZlbnQpKTtcblxuICAgIC8vIEhhbmRsZSBwbGF5L3BhdXNlXG4gICAgb24uY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3BsYXlpbmcgcGxheSBwYXVzZSBlbmRlZCBlbXB0aWVkIHRpbWV1cGRhdGUnLCAoZXZlbnQpID0+XG4gICAgICB1aS5jaGVja1BsYXlpbmcuY2FsbChwbGF5ZXIsIGV2ZW50KSxcbiAgICApO1xuXG4gICAgLy8gTG9hZGluZyBzdGF0ZVxuICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd3YWl0aW5nIGNhbnBsYXkgc2Vla2VkIHBsYXlpbmcnLCAoZXZlbnQpID0+IHVpLmNoZWNrTG9hZGluZy5jYWxsKHBsYXllciwgZXZlbnQpKTtcblxuICAgIC8vIENsaWNrIHZpZGVvXG4gICAgaWYgKHBsYXllci5zdXBwb3J0ZWQudWkgJiYgcGxheWVyLmNvbmZpZy5jbGlja1RvUGxheSAmJiAhcGxheWVyLmlzQXVkaW8pIHtcbiAgICAgIC8vIFJlLWZldGNoIHRoZSB3cmFwcGVyXG4gICAgICBjb25zdCB3cmFwcGVyID0gZ2V0RWxlbWVudC5jYWxsKHBsYXllciwgYC4ke3BsYXllci5jb25maWcuY2xhc3NOYW1lcy52aWRlb31gKTtcblxuICAgICAgLy8gQmFpbCBpZiB0aGVyZSdzIG5vIHdyYXBwZXIgKHRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbilcbiAgICAgIGlmICghaXMuZWxlbWVudCh3cmFwcGVyKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIE9uIGNsaWNrIHBsYXksIHBhdXNlIG9yIHJlc3RhcnRcbiAgICAgIG9uLmNhbGwocGxheWVyLCBlbGVtZW50cy5jb250YWluZXIsICdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCB0YXJnZXRzID0gW2VsZW1lbnRzLmNvbnRhaW5lciwgd3JhcHBlcl07XG5cbiAgICAgICAgLy8gSWdub3JlIGlmIGNsaWNrIGlmIG5vdCBjb250YWluZXIgb3IgaW4gdmlkZW8gd3JhcHBlclxuICAgICAgICBpZiAoIXRhcmdldHMuaW5jbHVkZXMoZXZlbnQudGFyZ2V0KSAmJiAhd3JhcHBlci5jb250YWlucyhldmVudC50YXJnZXQpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVG91Y2ggZGV2aWNlcyB3aWxsIGp1c3Qgc2hvdyBjb250cm9scyAoaWYgaGlkZGVuKVxuICAgICAgICBpZiAocGxheWVyLnRvdWNoICYmIHBsYXllci5jb25maWcuaGlkZUNvbnRyb2xzKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBsYXllci5lbmRlZCkge1xuICAgICAgICAgIHRoaXMucHJveHkoZXZlbnQsIHBsYXllci5yZXN0YXJ0LCAncmVzdGFydCcpO1xuICAgICAgICAgIHRoaXMucHJveHkoXG4gICAgICAgICAgICBldmVudCxcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgc2lsZW5jZVByb21pc2UocGxheWVyLnBsYXkoKSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ3BsYXknLFxuICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5wcm94eShcbiAgICAgICAgICAgIGV2ZW50LFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICBzaWxlbmNlUHJvbWlzZShwbGF5ZXIudG9nZ2xlUGxheSgpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAncGxheScsXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gRGlzYWJsZSByaWdodCBjbGlja1xuICAgIGlmIChwbGF5ZXIuc3VwcG9ydGVkLnVpICYmIHBsYXllci5jb25maWcuZGlzYWJsZUNvbnRleHRNZW51KSB7XG4gICAgICBvbi5jYWxsKFxuICAgICAgICBwbGF5ZXIsXG4gICAgICAgIGVsZW1lbnRzLndyYXBwZXIsXG4gICAgICAgICdjb250ZXh0bWVudScsXG4gICAgICAgIChldmVudCkgPT4ge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0sXG4gICAgICAgIGZhbHNlLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBWb2x1bWUgY2hhbmdlXG4gICAgb24uY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3ZvbHVtZWNoYW5nZScsICgpID0+IHtcbiAgICAgIC8vIFNhdmUgdG8gc3RvcmFnZVxuICAgICAgcGxheWVyLnN0b3JhZ2Uuc2V0KHtcbiAgICAgICAgdm9sdW1lOiBwbGF5ZXIudm9sdW1lLFxuICAgICAgICBtdXRlZDogcGxheWVyLm11dGVkLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBTcGVlZCBjaGFuZ2VcbiAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncmF0ZWNoYW5nZScsICgpID0+IHtcbiAgICAgIC8vIFVwZGF0ZSBVSVxuICAgICAgY29udHJvbHMudXBkYXRlU2V0dGluZy5jYWxsKHBsYXllciwgJ3NwZWVkJyk7XG5cbiAgICAgIC8vIFNhdmUgdG8gc3RvcmFnZVxuICAgICAgcGxheWVyLnN0b3JhZ2Uuc2V0KHsgc3BlZWQ6IHBsYXllci5zcGVlZCB9KTtcbiAgICB9KTtcblxuICAgIC8vIFF1YWxpdHkgY2hhbmdlXG4gICAgb24uY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3F1YWxpdHljaGFuZ2UnLCAoZXZlbnQpID0+IHtcbiAgICAgIC8vIFVwZGF0ZSBVSVxuICAgICAgY29udHJvbHMudXBkYXRlU2V0dGluZy5jYWxsKHBsYXllciwgJ3F1YWxpdHknLCBudWxsLCBldmVudC5kZXRhaWwucXVhbGl0eSk7XG4gICAgfSk7XG5cbiAgICAvLyBVcGRhdGUgZG93bmxvYWQgbGluayB3aGVuIHJlYWR5IGFuZCBpZiBxdWFsaXR5IGNoYW5nZXNcbiAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncmVhZHkgcXVhbGl0eWNoYW5nZScsICgpID0+IHtcbiAgICAgIGNvbnRyb2xzLnNldERvd25sb2FkVXJsLmNhbGwocGxheWVyKTtcbiAgICB9KTtcblxuICAgIC8vIFByb3h5IGV2ZW50cyB0byBjb250YWluZXJcbiAgICAvLyBCdWJibGUgdXAga2V5IGV2ZW50cyBmb3IgRWRnZVxuICAgIGNvbnN0IHByb3h5RXZlbnRzID0gcGxheWVyLmNvbmZpZy5ldmVudHMuY29uY2F0KFsna2V5dXAnLCAna2V5ZG93biddKS5qb2luKCcgJyk7XG5cbiAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCBwcm94eUV2ZW50cywgKGV2ZW50KSA9PiB7XG4gICAgICBsZXQgeyBkZXRhaWwgPSB7fSB9ID0gZXZlbnQ7XG5cbiAgICAgIC8vIEdldCBlcnJvciBkZXRhaWxzIGZyb20gbWVkaWFcbiAgICAgIGlmIChldmVudC50eXBlID09PSAnZXJyb3InKSB7XG4gICAgICAgIGRldGFpbCA9IHBsYXllci5tZWRpYS5lcnJvcjtcbiAgICAgIH1cblxuICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBlbGVtZW50cy5jb250YWluZXIsIGV2ZW50LnR5cGUsIHRydWUsIGRldGFpbCk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gUnVuIGRlZmF1bHQgYW5kIGN1c3RvbSBoYW5kbGVyc1xuICBwcm94eSA9IChldmVudCwgZGVmYXVsdEhhbmRsZXIsIGN1c3RvbUhhbmRsZXJLZXkpID0+IHtcbiAgICBjb25zdCB7IHBsYXllciB9ID0gdGhpcztcbiAgICBjb25zdCBjdXN0b21IYW5kbGVyID0gcGxheWVyLmNvbmZpZy5saXN0ZW5lcnNbY3VzdG9tSGFuZGxlcktleV07XG4gICAgY29uc3QgaGFzQ3VzdG9tSGFuZGxlciA9IGlzLmZ1bmN0aW9uKGN1c3RvbUhhbmRsZXIpO1xuICAgIGxldCByZXR1cm5lZCA9IHRydWU7XG5cbiAgICAvLyBFeGVjdXRlIGN1c3RvbSBoYW5kbGVyXG4gICAgaWYgKGhhc0N1c3RvbUhhbmRsZXIpIHtcbiAgICAgIHJldHVybmVkID0gY3VzdG9tSGFuZGxlci5jYWxsKHBsYXllciwgZXZlbnQpO1xuICAgIH1cblxuICAgIC8vIE9ubHkgY2FsbCBkZWZhdWx0IGhhbmRsZXIgaWYgbm90IHByZXZlbnRlZCBpbiBjdXN0b20gaGFuZGxlclxuICAgIGlmIChyZXR1cm5lZCAhPT0gZmFsc2UgJiYgaXMuZnVuY3Rpb24oZGVmYXVsdEhhbmRsZXIpKSB7XG4gICAgICBkZWZhdWx0SGFuZGxlci5jYWxsKHBsYXllciwgZXZlbnQpO1xuICAgIH1cbiAgfTtcblxuICAvLyBUcmlnZ2VyIGN1c3RvbSBhbmQgZGVmYXVsdCBoYW5kbGVyc1xuICBiaW5kID0gKGVsZW1lbnQsIHR5cGUsIGRlZmF1bHRIYW5kbGVyLCBjdXN0b21IYW5kbGVyS2V5LCBwYXNzaXZlID0gdHJ1ZSkgPT4ge1xuICAgIGNvbnN0IHsgcGxheWVyIH0gPSB0aGlzO1xuICAgIGNvbnN0IGN1c3RvbUhhbmRsZXIgPSBwbGF5ZXIuY29uZmlnLmxpc3RlbmVyc1tjdXN0b21IYW5kbGVyS2V5XTtcbiAgICBjb25zdCBoYXNDdXN0b21IYW5kbGVyID0gaXMuZnVuY3Rpb24oY3VzdG9tSGFuZGxlcik7XG5cbiAgICBvbi5jYWxsKFxuICAgICAgcGxheWVyLFxuICAgICAgZWxlbWVudCxcbiAgICAgIHR5cGUsXG4gICAgICAoZXZlbnQpID0+IHRoaXMucHJveHkoZXZlbnQsIGRlZmF1bHRIYW5kbGVyLCBjdXN0b21IYW5kbGVyS2V5KSxcbiAgICAgIHBhc3NpdmUgJiYgIWhhc0N1c3RvbUhhbmRsZXIsXG4gICAgKTtcbiAgfTtcblxuICAvLyBMaXN0ZW4gZm9yIGNvbnRyb2wgZXZlbnRzXG4gIGNvbnRyb2xzID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgcGxheWVyIH0gPSB0aGlzO1xuICAgIGNvbnN0IHsgZWxlbWVudHMgfSA9IHBsYXllcjtcbiAgICAvLyBJRSBkb2Vzbid0IHN1cHBvcnQgaW5wdXQgZXZlbnQsIHNvIHdlIGZhbGxiYWNrIHRvIGNoYW5nZVxuICAgIGNvbnN0IGlucHV0RXZlbnQgPSBicm93c2VyLmlzSUUgPyAnY2hhbmdlJyA6ICdpbnB1dCc7XG5cbiAgICAvLyBQbGF5L3BhdXNlIHRvZ2dsZVxuICAgIGlmIChlbGVtZW50cy5idXR0b25zLnBsYXkpIHtcbiAgICAgIEFycmF5LmZyb20oZWxlbWVudHMuYnV0dG9ucy5wbGF5KS5mb3JFYWNoKChidXR0b24pID0+IHtcbiAgICAgICAgdGhpcy5iaW5kKFxuICAgICAgICAgIGJ1dHRvbixcbiAgICAgICAgICAnY2xpY2snLFxuICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgIHNpbGVuY2VQcm9taXNlKHBsYXllci50b2dnbGVQbGF5KCkpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ3BsYXknLFxuICAgICAgICApO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUGF1c2VcbiAgICB0aGlzLmJpbmQoZWxlbWVudHMuYnV0dG9ucy5yZXN0YXJ0LCAnY2xpY2snLCBwbGF5ZXIucmVzdGFydCwgJ3Jlc3RhcnQnKTtcblxuICAgIC8vIFJld2luZFxuICAgIHRoaXMuYmluZChcbiAgICAgIGVsZW1lbnRzLmJ1dHRvbnMucmV3aW5kLFxuICAgICAgJ2NsaWNrJyxcbiAgICAgICgpID0+IHtcbiAgICAgICAgLy8gUmVjb3JkIHNlZWsgdGltZSBzbyB3ZSBjYW4gcHJldmVudCBoaWRpbmcgY29udHJvbHMgZm9yIGEgZmV3IHNlY29uZHMgYWZ0ZXIgcmV3aW5kXG4gICAgICAgIHBsYXllci5sYXN0U2Vla1RpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICBwbGF5ZXIucmV3aW5kKCk7XG4gICAgICB9LFxuICAgICAgJ3Jld2luZCcsXG4gICAgKTtcblxuICAgIC8vIFJld2luZFxuICAgIHRoaXMuYmluZChcbiAgICAgIGVsZW1lbnRzLmJ1dHRvbnMuZmFzdEZvcndhcmQsXG4gICAgICAnY2xpY2snLFxuICAgICAgKCkgPT4ge1xuICAgICAgICAvLyBSZWNvcmQgc2VlayB0aW1lIHNvIHdlIGNhbiBwcmV2ZW50IGhpZGluZyBjb250cm9scyBmb3IgYSBmZXcgc2Vjb25kcyBhZnRlciBmYXN0IGZvcndhcmRcbiAgICAgICAgcGxheWVyLmxhc3RTZWVrVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgIHBsYXllci5mb3J3YXJkKCk7XG4gICAgICB9LFxuICAgICAgJ2Zhc3RGb3J3YXJkJyxcbiAgICApO1xuXG4gICAgLy8gTXV0ZSB0b2dnbGVcbiAgICB0aGlzLmJpbmQoXG4gICAgICBlbGVtZW50cy5idXR0b25zLm11dGUsXG4gICAgICAnY2xpY2snLFxuICAgICAgKCkgPT4ge1xuICAgICAgICBwbGF5ZXIubXV0ZWQgPSAhcGxheWVyLm11dGVkO1xuICAgICAgfSxcbiAgICAgICdtdXRlJyxcbiAgICApO1xuXG4gICAgLy8gQ2FwdGlvbnMgdG9nZ2xlXG4gICAgdGhpcy5iaW5kKGVsZW1lbnRzLmJ1dHRvbnMuY2FwdGlvbnMsICdjbGljaycsICgpID0+IHBsYXllci50b2dnbGVDYXB0aW9ucygpKTtcblxuICAgIC8vIERvd25sb2FkXG4gICAgdGhpcy5iaW5kKFxuICAgICAgZWxlbWVudHMuYnV0dG9ucy5kb3dubG9hZCxcbiAgICAgICdjbGljaycsXG4gICAgICAoKSA9PiB7XG4gICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZG93bmxvYWQnKTtcbiAgICAgIH0sXG4gICAgICAnZG93bmxvYWQnLFxuICAgICk7XG5cbiAgICAvLyBGdWxsc2NyZWVuIHRvZ2dsZVxuICAgIHRoaXMuYmluZChcbiAgICAgIGVsZW1lbnRzLmJ1dHRvbnMuZnVsbHNjcmVlbixcbiAgICAgICdjbGljaycsXG4gICAgICAoKSA9PiB7XG4gICAgICAgIHBsYXllci5mdWxsc2NyZWVuLnRvZ2dsZSgpO1xuICAgICAgfSxcbiAgICAgICdmdWxsc2NyZWVuJyxcbiAgICApO1xuXG4gICAgLy8gUGljdHVyZS1pbi1QaWN0dXJlXG4gICAgdGhpcy5iaW5kKFxuICAgICAgZWxlbWVudHMuYnV0dG9ucy5waXAsXG4gICAgICAnY2xpY2snLFxuICAgICAgKCkgPT4ge1xuICAgICAgICBwbGF5ZXIucGlwID0gJ3RvZ2dsZSc7XG4gICAgICB9LFxuICAgICAgJ3BpcCcsXG4gICAgKTtcblxuICAgIC8vIEFpcnBsYXlcbiAgICB0aGlzLmJpbmQoZWxlbWVudHMuYnV0dG9ucy5haXJwbGF5LCAnY2xpY2snLCBwbGF5ZXIuYWlycGxheSwgJ2FpcnBsYXknKTtcblxuICAgIC8vIFNldHRpbmdzIG1lbnUgLSBjbGljayB0b2dnbGVcbiAgICB0aGlzLmJpbmQoXG4gICAgICBlbGVtZW50cy5idXR0b25zLnNldHRpbmdzLFxuICAgICAgJ2NsaWNrJyxcbiAgICAgIChldmVudCkgPT4ge1xuICAgICAgICAvLyBQcmV2ZW50IHRoZSBkb2N1bWVudCBjbGljayBsaXN0ZW5lciBjbG9zaW5nIHRoZSBtZW51XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGNvbnRyb2xzLnRvZ2dsZU1lbnUuY2FsbChwbGF5ZXIsIGV2ZW50KTtcbiAgICAgIH0sXG4gICAgICBudWxsLFxuICAgICAgZmFsc2UsXG4gICAgKTsgLy8gQ2FuJ3QgYmUgcGFzc2l2ZSBhcyB3ZSdyZSBwcmV2ZW50aW5nIGRlZmF1bHRcblxuICAgIC8vIFNldHRpbmdzIG1lbnUgLSBrZXlib2FyZCB0b2dnbGVcbiAgICAvLyBXZSBoYXZlIHRvIGJpbmQgdG8ga2V5dXAgb3RoZXJ3aXNlIEZpcmVmb3ggdHJpZ2dlcnMgYSBjbGljayB3aGVuIGEga2V5ZG93biBldmVudCBoYW5kbGVyIHNoaWZ0cyBmb2N1c1xuICAgIC8vIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTEyMjAxNDNcbiAgICB0aGlzLmJpbmQoXG4gICAgICBlbGVtZW50cy5idXR0b25zLnNldHRpbmdzLFxuICAgICAgJ2tleXVwJyxcbiAgICAgIChldmVudCkgPT4ge1xuICAgICAgICBpZiAoIVsnU3BhY2UnLCAnRW50ZXInXS5pbmNsdWRlcyhldmVudC5rZXkpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQmVjYXVzZSByZXR1cm4gdHJpZ2dlcnMgYSBjbGljayBhbnl3YXksIGFsbCB3ZSBuZWVkIHRvIGRvIGlzIHNldCBmb2N1c1xuICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICAgICAgY29udHJvbHMuZm9jdXNGaXJzdE1lbnVJdGVtLmNhbGwocGxheWVyLCBudWxsLCB0cnVlKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQcmV2ZW50IHNjcm9sbFxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIC8vIFByZXZlbnQgcGxheWluZyB2aWRlbyAoRmlyZWZveClcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgLy8gVG9nZ2xlIG1lbnVcbiAgICAgICAgY29udHJvbHMudG9nZ2xlTWVudS5jYWxsKHBsYXllciwgZXZlbnQpO1xuICAgICAgfSxcbiAgICAgIG51bGwsXG4gICAgICBmYWxzZSwgLy8gQ2FuJ3QgYmUgcGFzc2l2ZSBhcyB3ZSdyZSBwcmV2ZW50aW5nIGRlZmF1bHRcbiAgICApO1xuXG4gICAgLy8gRXNjYXBlIGNsb3NlcyBtZW51XG4gICAgdGhpcy5iaW5kKGVsZW1lbnRzLnNldHRpbmdzLm1lbnUsICdrZXlkb3duJywgKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICBjb250cm9scy50b2dnbGVNZW51LmNhbGwocGxheWVyLCBldmVudCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBTZXQgcmFuZ2UgaW5wdXQgYWx0ZXJuYXRpdmUgXCJ2YWx1ZVwiLCB3aGljaCBtYXRjaGVzIHRoZSB0b29sdGlwIHRpbWUgKCM5NTQpXG4gICAgdGhpcy5iaW5kKGVsZW1lbnRzLmlucHV0cy5zZWVrLCAnbW91c2Vkb3duIG1vdXNlbW92ZScsIChldmVudCkgPT4ge1xuICAgICAgY29uc3QgcmVjdCA9IGVsZW1lbnRzLnByb2dyZXNzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgY29uc3QgcGVyY2VudCA9ICgxMDAgLyByZWN0LndpZHRoKSAqIChldmVudC5wYWdlWCAtIHJlY3QubGVmdCk7XG4gICAgICBldmVudC5jdXJyZW50VGFyZ2V0LnNldEF0dHJpYnV0ZSgnc2Vlay12YWx1ZScsIHBlcmNlbnQpO1xuICAgIH0pO1xuXG4gICAgLy8gUGF1c2Ugd2hpbGUgc2Vla2luZ1xuICAgIHRoaXMuYmluZChlbGVtZW50cy5pbnB1dHMuc2VlaywgJ21vdXNlZG93biBtb3VzZXVwIGtleWRvd24ga2V5dXAgdG91Y2hzdGFydCB0b3VjaGVuZCcsIChldmVudCkgPT4ge1xuICAgICAgY29uc3Qgc2VlayA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7XG4gICAgICBjb25zdCBhdHRyaWJ1dGUgPSAncGxheS1vbi1zZWVrZWQnO1xuXG4gICAgICBpZiAoaXMua2V5Ym9hcmRFdmVudChldmVudCkgJiYgIVsnQXJyb3dMZWZ0JywgJ0Fycm93UmlnaHQnXS5pbmNsdWRlcyhldmVudC5rZXkpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gUmVjb3JkIHNlZWsgdGltZSBzbyB3ZSBjYW4gcHJldmVudCBoaWRpbmcgY29udHJvbHMgZm9yIGEgZmV3IHNlY29uZHMgYWZ0ZXIgc2Vla1xuICAgICAgcGxheWVyLmxhc3RTZWVrVGltZSA9IERhdGUubm93KCk7XG5cbiAgICAgIC8vIFdhcyBwbGF5aW5nIGJlZm9yZT9cbiAgICAgIGNvbnN0IHBsYXkgPSBzZWVrLmhhc0F0dHJpYnV0ZShhdHRyaWJ1dGUpO1xuICAgICAgLy8gRG9uZSBzZWVraW5nXG4gICAgICBjb25zdCBkb25lID0gWydtb3VzZXVwJywgJ3RvdWNoZW5kJywgJ2tleXVwJ10uaW5jbHVkZXMoZXZlbnQudHlwZSk7XG5cbiAgICAgIC8vIElmIHdlJ3JlIGRvbmUgc2Vla2luZyBhbmQgaXQgd2FzIHBsYXlpbmcsIHJlc3VtZSBwbGF5YmFja1xuICAgICAgaWYgKHBsYXkgJiYgZG9uZSkge1xuICAgICAgICBzZWVrLnJlbW92ZUF0dHJpYnV0ZShhdHRyaWJ1dGUpO1xuICAgICAgICBzaWxlbmNlUHJvbWlzZShwbGF5ZXIucGxheSgpKTtcbiAgICAgIH0gZWxzZSBpZiAoIWRvbmUgJiYgcGxheWVyLnBsYXlpbmcpIHtcbiAgICAgICAgc2Vlay5zZXRBdHRyaWJ1dGUoYXR0cmlidXRlLCAnJyk7XG4gICAgICAgIHBsYXllci5wYXVzZSgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gRml4IHJhbmdlIGlucHV0cyBvbiBpT1NcbiAgICAvLyBTdXBlciB3ZWlyZCBpT1MgYnVnIHdoZXJlIGFmdGVyIHlvdSBpbnRlcmFjdCB3aXRoIGFuIDxpbnB1dCB0eXBlPVwicmFuZ2VcIj4sXG4gICAgLy8gaXQgdGFrZXMgb3ZlciBmdXJ0aGVyIGludGVyYWN0aW9ucyBvbiB0aGUgcGFnZS4gVGhpcyBpcyBhIGhhY2tcbiAgICBpZiAoYnJvd3Nlci5pc0lvcykge1xuICAgICAgY29uc3QgaW5wdXRzID0gZ2V0RWxlbWVudHMuY2FsbChwbGF5ZXIsICdpbnB1dFt0eXBlPVwicmFuZ2VcIl0nKTtcbiAgICAgIEFycmF5LmZyb20oaW5wdXRzKS5mb3JFYWNoKChpbnB1dCkgPT4gdGhpcy5iaW5kKGlucHV0LCBpbnB1dEV2ZW50LCAoZXZlbnQpID0+IHJlcGFpbnQoZXZlbnQudGFyZ2V0KSkpO1xuICAgIH1cblxuICAgIC8vIFNlZWtcbiAgICB0aGlzLmJpbmQoXG4gICAgICBlbGVtZW50cy5pbnB1dHMuc2VlayxcbiAgICAgIGlucHV0RXZlbnQsXG4gICAgICAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3Qgc2VlayA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7XG4gICAgICAgIC8vIElmIGl0IGV4aXN0cywgdXNlIHNlZWstdmFsdWUgaW5zdGVhZCBvZiBcInZhbHVlXCIgZm9yIGNvbnNpc3RlbmN5IHdpdGggdG9vbHRpcCB0aW1lICgjOTU0KVxuICAgICAgICBsZXQgc2Vla1RvID0gc2Vlay5nZXRBdHRyaWJ1dGUoJ3NlZWstdmFsdWUnKTtcblxuICAgICAgICBpZiAoaXMuZW1wdHkoc2Vla1RvKSkge1xuICAgICAgICAgIHNlZWtUbyA9IHNlZWsudmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICBzZWVrLnJlbW92ZUF0dHJpYnV0ZSgnc2Vlay12YWx1ZScpO1xuXG4gICAgICAgIHBsYXllci5jdXJyZW50VGltZSA9IChzZWVrVG8gLyBzZWVrLm1heCkgKiBwbGF5ZXIuZHVyYXRpb247XG4gICAgICB9LFxuICAgICAgJ3NlZWsnLFxuICAgICk7XG5cbiAgICAvLyBTZWVrIHRvb2x0aXBcbiAgICB0aGlzLmJpbmQoZWxlbWVudHMucHJvZ3Jlc3MsICdtb3VzZWVudGVyIG1vdXNlbGVhdmUgbW91c2Vtb3ZlJywgKGV2ZW50KSA9PlxuICAgICAgY29udHJvbHMudXBkYXRlU2Vla1Rvb2x0aXAuY2FsbChwbGF5ZXIsIGV2ZW50KSxcbiAgICApO1xuXG4gICAgLy8gUHJldmlldyB0aHVtYm5haWxzIHBsdWdpblxuICAgIC8vIFRPRE86IFJlYWxseSBuZWVkIHRvIHdvcmsgb24gc29tZSBzb3J0IG9mIHBsdWctaW4gd2lkZSBldmVudCBidXMgb3IgcHViLXN1YiBmb3IgdGhpc1xuICAgIHRoaXMuYmluZChlbGVtZW50cy5wcm9ncmVzcywgJ21vdXNlbW92ZSB0b3VjaG1vdmUnLCAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHsgcHJldmlld1RodW1ibmFpbHMgfSA9IHBsYXllcjtcblxuICAgICAgaWYgKHByZXZpZXdUaHVtYm5haWxzICYmIHByZXZpZXdUaHVtYm5haWxzLmxvYWRlZCkge1xuICAgICAgICBwcmV2aWV3VGh1bWJuYWlscy5zdGFydE1vdmUoZXZlbnQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gSGlkZSB0aHVtYm5haWwgcHJldmlldyAtIG9uIG1vdXNlIGNsaWNrLCBtb3VzZSBsZWF2ZSwgYW5kIHZpZGVvIHBsYXkvc2Vlay4gQWxsIGZvdXIgYXJlIHJlcXVpcmVkLCBlLmcuLCBmb3IgYnVmZmVyaW5nXG4gICAgdGhpcy5iaW5kKGVsZW1lbnRzLnByb2dyZXNzLCAnbW91c2VsZWF2ZSB0b3VjaGVuZCBjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcHJldmlld1RodW1ibmFpbHMgfSA9IHBsYXllcjtcblxuICAgICAgaWYgKHByZXZpZXdUaHVtYm5haWxzICYmIHByZXZpZXdUaHVtYm5haWxzLmxvYWRlZCkge1xuICAgICAgICBwcmV2aWV3VGh1bWJuYWlscy5lbmRNb3ZlKGZhbHNlLCB0cnVlKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFNob3cgc2NydWJiaW5nIHByZXZpZXdcbiAgICB0aGlzLmJpbmQoZWxlbWVudHMucHJvZ3Jlc3MsICdtb3VzZWRvd24gdG91Y2hzdGFydCcsIChldmVudCkgPT4ge1xuICAgICAgY29uc3QgeyBwcmV2aWV3VGh1bWJuYWlscyB9ID0gcGxheWVyO1xuXG4gICAgICBpZiAocHJldmlld1RodW1ibmFpbHMgJiYgcHJldmlld1RodW1ibmFpbHMubG9hZGVkKSB7XG4gICAgICAgIHByZXZpZXdUaHVtYm5haWxzLnN0YXJ0U2NydWJiaW5nKGV2ZW50KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuYmluZChlbGVtZW50cy5wcm9ncmVzcywgJ21vdXNldXAgdG91Y2hlbmQnLCAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHsgcHJldmlld1RodW1ibmFpbHMgfSA9IHBsYXllcjtcblxuICAgICAgaWYgKHByZXZpZXdUaHVtYm5haWxzICYmIHByZXZpZXdUaHVtYm5haWxzLmxvYWRlZCkge1xuICAgICAgICBwcmV2aWV3VGh1bWJuYWlscy5lbmRTY3J1YmJpbmcoZXZlbnQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gUG9seWZpbGwgZm9yIGxvd2VyIGZpbGwgaW4gPGlucHV0IHR5cGU9XCJyYW5nZVwiPiBmb3Igd2Via2l0XG4gICAgaWYgKGJyb3dzZXIuaXNXZWJraXQpIHtcbiAgICAgIEFycmF5LmZyb20oZ2V0RWxlbWVudHMuY2FsbChwbGF5ZXIsICdpbnB1dFt0eXBlPVwicmFuZ2VcIl0nKSkuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudCwgJ2lucHV0JywgKGV2ZW50KSA9PiBjb250cm9scy51cGRhdGVSYW5nZUZpbGwuY2FsbChwbGF5ZXIsIGV2ZW50LnRhcmdldCkpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQ3VycmVudCB0aW1lIGludmVydFxuICAgIC8vIE9ubHkgaWYgb25lIHRpbWUgZWxlbWVudCBpcyB1c2VkIGZvciBib3RoIGN1cnJlbnRUaW1lIGFuZCBkdXJhdGlvblxuICAgIGlmIChwbGF5ZXIuY29uZmlnLnRvZ2dsZUludmVydCAmJiAhaXMuZWxlbWVudChlbGVtZW50cy5kaXNwbGF5LmR1cmF0aW9uKSkge1xuICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmRpc3BsYXkuY3VycmVudFRpbWUsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgLy8gRG8gbm90aGluZyBpZiB3ZSdyZSBhdCB0aGUgc3RhcnRcbiAgICAgICAgaWYgKHBsYXllci5jdXJyZW50VGltZSA9PT0gMCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHBsYXllci5jb25maWcuaW52ZXJ0VGltZSA9ICFwbGF5ZXIuY29uZmlnLmludmVydFRpbWU7XG5cbiAgICAgICAgY29udHJvbHMudGltZVVwZGF0ZS5jYWxsKHBsYXllcik7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBWb2x1bWVcbiAgICB0aGlzLmJpbmQoXG4gICAgICBlbGVtZW50cy5pbnB1dHMudm9sdW1lLFxuICAgICAgaW5wdXRFdmVudCxcbiAgICAgIChldmVudCkgPT4ge1xuICAgICAgICBwbGF5ZXIudm9sdW1lID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgICAgfSxcbiAgICAgICd2b2x1bWUnLFxuICAgICk7XG5cbiAgICAvLyBVcGRhdGUgY29udHJvbHMuaG92ZXIgc3RhdGUgKHVzZWQgZm9yIHVpLnRvZ2dsZUNvbnRyb2xzIHRvIGF2b2lkIGhpZGluZyB3aGVuIGludGVyYWN0aW5nKVxuICAgIHRoaXMuYmluZChlbGVtZW50cy5jb250cm9scywgJ21vdXNlZW50ZXIgbW91c2VsZWF2ZScsIChldmVudCkgPT4ge1xuICAgICAgZWxlbWVudHMuY29udHJvbHMuaG92ZXIgPSAhcGxheWVyLnRvdWNoICYmIGV2ZW50LnR5cGUgPT09ICdtb3VzZWVudGVyJztcbiAgICB9KTtcblxuICAgIC8vIEFsc28gdXBkYXRlIGNvbnRyb2xzLmhvdmVyIHN0YXRlIGZvciBhbnkgbm9uLXBsYXllciBjaGlsZHJlbiBvZiBmdWxsc2NyZWVuIGVsZW1lbnQgKGFzIGFib3ZlKVxuICAgIGlmIChlbGVtZW50cy5mdWxsc2NyZWVuKSB7XG4gICAgICBBcnJheS5mcm9tKGVsZW1lbnRzLmZ1bGxzY3JlZW4uY2hpbGRyZW4pXG4gICAgICAgIC5maWx0ZXIoKGMpID0+ICFjLmNvbnRhaW5zKGVsZW1lbnRzLmNvbnRhaW5lcikpXG4gICAgICAgIC5mb3JFYWNoKChjaGlsZCkgPT4ge1xuICAgICAgICAgIHRoaXMuYmluZChjaGlsZCwgJ21vdXNlZW50ZXIgbW91c2VsZWF2ZScsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKGVsZW1lbnRzLmNvbnRyb2xzKSB7XG4gICAgICAgICAgICAgIGVsZW1lbnRzLmNvbnRyb2xzLmhvdmVyID0gIXBsYXllci50b3VjaCAmJiBldmVudC50eXBlID09PSAnbW91c2VlbnRlcic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjb250cm9scy5wcmVzc2VkIHN0YXRlICh1c2VkIGZvciB1aS50b2dnbGVDb250cm9scyB0byBhdm9pZCBoaWRpbmcgd2hlbiBpbnRlcmFjdGluZylcbiAgICB0aGlzLmJpbmQoZWxlbWVudHMuY29udHJvbHMsICdtb3VzZWRvd24gbW91c2V1cCB0b3VjaHN0YXJ0IHRvdWNoZW5kIHRvdWNoY2FuY2VsJywgKGV2ZW50KSA9PiB7XG4gICAgICBlbGVtZW50cy5jb250cm9scy5wcmVzc2VkID0gWydtb3VzZWRvd24nLCAndG91Y2hzdGFydCddLmluY2x1ZGVzKGV2ZW50LnR5cGUpO1xuICAgIH0pO1xuXG4gICAgLy8gU2hvdyBjb250cm9scyB3aGVuIHRoZXkgcmVjZWl2ZSBmb2N1cyAoZS5nLiwgd2hlbiB1c2luZyBrZXlib2FyZCB0YWIga2V5KVxuICAgIHRoaXMuYmluZChlbGVtZW50cy5jb250cm9scywgJ2ZvY3VzaW4nLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IGNvbmZpZywgdGltZXJzIH0gPSBwbGF5ZXI7XG5cbiAgICAgIC8vIFNraXAgdHJhbnNpdGlvbiB0byBwcmV2ZW50IGZvY3VzIGZyb20gc2Nyb2xsaW5nIHRoZSBwYXJlbnQgZWxlbWVudFxuICAgICAgdG9nZ2xlQ2xhc3MoZWxlbWVudHMuY29udHJvbHMsIGNvbmZpZy5jbGFzc05hbWVzLm5vVHJhbnNpdGlvbiwgdHJ1ZSk7XG5cbiAgICAgIC8vIFRvZ2dsZVxuICAgICAgdWkudG9nZ2xlQ29udHJvbHMuY2FsbChwbGF5ZXIsIHRydWUpO1xuXG4gICAgICAvLyBSZXN0b3JlIHRyYW5zaXRpb25cbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0b2dnbGVDbGFzcyhlbGVtZW50cy5jb250cm9scywgY29uZmlnLmNsYXNzTmFtZXMubm9UcmFuc2l0aW9uLCBmYWxzZSk7XG4gICAgICB9LCAwKTtcblxuICAgICAgLy8gRGVsYXkgYSBsaXR0bGUgbW9yZSBmb3IgbW91c2UgdXNlcnNcbiAgICAgIGNvbnN0IGRlbGF5ID0gdGhpcy50b3VjaCA/IDMwMDAgOiA0MDAwO1xuXG4gICAgICAvLyBDbGVhciB0aW1lclxuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVycy5jb250cm9scyk7XG5cbiAgICAgIC8vIEhpZGUgYWdhaW4gYWZ0ZXIgZGVsYXlcbiAgICAgIHRpbWVycy5jb250cm9scyA9IHNldFRpbWVvdXQoKCkgPT4gdWkudG9nZ2xlQ29udHJvbHMuY2FsbChwbGF5ZXIsIGZhbHNlKSwgZGVsYXkpO1xuICAgIH0pO1xuXG4gICAgLy8gTW91c2Ugd2hlZWwgZm9yIHZvbHVtZVxuICAgIHRoaXMuYmluZChcbiAgICAgIGVsZW1lbnRzLmlucHV0cy52b2x1bWUsXG4gICAgICAnd2hlZWwnLFxuICAgICAgKGV2ZW50KSA9PiB7XG4gICAgICAgIC8vIERldGVjdCBcIm5hdHVyYWxcIiBzY3JvbGwgLSBzdXBwb3J0ZWQgb24gT1MgWCBTYWZhcmkgb25seVxuICAgICAgICAvLyBPdGhlciBicm93c2VycyBvbiBPUyBYIHdpbGwgYmUgaW52ZXJ0ZWQgdW50aWwgc3VwcG9ydCBpbXByb3Zlc1xuICAgICAgICBjb25zdCBpbnZlcnRlZCA9IGV2ZW50LndlYmtpdERpcmVjdGlvbkludmVydGVkRnJvbURldmljZTtcbiAgICAgICAgLy8gR2V0IGRlbHRhIGZyb20gZXZlbnQuIEludmVydCBpZiBgaW52ZXJ0ZWRgIGlzIHRydWVcbiAgICAgICAgY29uc3QgW3gsIHldID0gW2V2ZW50LmRlbHRhWCwgLWV2ZW50LmRlbHRhWV0ubWFwKCh2YWx1ZSkgPT4gKGludmVydGVkID8gLXZhbHVlIDogdmFsdWUpKTtcbiAgICAgICAgLy8gVXNpbmcgdGhlIGJpZ2dlc3QgZGVsdGEsIG5vcm1hbGl6ZSB0byAxIG9yIC0xIChvciAwIGlmIG5vIGRlbHRhKVxuICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBNYXRoLnNpZ24oTWF0aC5hYnMoeCkgPiBNYXRoLmFicyh5KSA/IHggOiB5KTtcblxuICAgICAgICAvLyBDaGFuZ2UgdGhlIHZvbHVtZSBieSAyJVxuICAgICAgICBwbGF5ZXIuaW5jcmVhc2VWb2x1bWUoZGlyZWN0aW9uIC8gNTApO1xuXG4gICAgICAgIC8vIERvbid0IGJyZWFrIHBhZ2Ugc2Nyb2xsaW5nIGF0IG1heCBhbmQgbWluXG4gICAgICAgIGNvbnN0IHsgdm9sdW1lIH0gPSBwbGF5ZXIubWVkaWE7XG4gICAgICAgIGlmICgoZGlyZWN0aW9uID09PSAxICYmIHZvbHVtZSA8IDEpIHx8IChkaXJlY3Rpb24gPT09IC0xICYmIHZvbHVtZSA+IDApKSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgICd2b2x1bWUnLFxuICAgICAgZmFsc2UsXG4gICAgKTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgTGlzdGVuZXJzO1xuIiwiKGZ1bmN0aW9uKHJvb3QsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShbXSwgZmFjdG9yeSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG4gIH0gZWxzZSB7XG4gICAgcm9vdC5sb2FkanMgPSBmYWN0b3J5KCk7XG4gIH1cbn0odGhpcywgZnVuY3Rpb24oKSB7XG4vKipcbiAqIEdsb2JhbCBkZXBlbmRlbmNpZXMuXG4gKiBAZ2xvYmFsIHtPYmplY3R9IGRvY3VtZW50IC0gRE9NXG4gKi9cblxudmFyIGRldm51bGwgPSBmdW5jdGlvbigpIHt9LFxuICAgIGJ1bmRsZUlkQ2FjaGUgPSB7fSxcbiAgICBidW5kbGVSZXN1bHRDYWNoZSA9IHt9LFxuICAgIGJ1bmRsZUNhbGxiYWNrUXVldWUgPSB7fTtcblxuXG4vKipcbiAqIFN1YnNjcmliZSB0byBidW5kbGUgbG9hZCBldmVudC5cbiAqIEBwYXJhbSB7c3RyaW5nW119IGJ1bmRsZUlkcyAtIEJ1bmRsZSBpZHNcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrRm4gLSBUaGUgY2FsbGJhY2sgZnVuY3Rpb25cbiAqL1xuZnVuY3Rpb24gc3Vic2NyaWJlKGJ1bmRsZUlkcywgY2FsbGJhY2tGbikge1xuICAvLyBsaXN0aWZ5XG4gIGJ1bmRsZUlkcyA9IGJ1bmRsZUlkcy5wdXNoID8gYnVuZGxlSWRzIDogW2J1bmRsZUlkc107XG5cbiAgdmFyIGRlcHNOb3RGb3VuZCA9IFtdLFxuICAgICAgaSA9IGJ1bmRsZUlkcy5sZW5ndGgsXG4gICAgICBudW1XYWl0aW5nID0gaSxcbiAgICAgIGZuLFxuICAgICAgYnVuZGxlSWQsXG4gICAgICByLFxuICAgICAgcTtcblxuICAvLyBkZWZpbmUgY2FsbGJhY2sgZnVuY3Rpb25cbiAgZm4gPSBmdW5jdGlvbiAoYnVuZGxlSWQsIHBhdGhzTm90Rm91bmQpIHtcbiAgICBpZiAocGF0aHNOb3RGb3VuZC5sZW5ndGgpIGRlcHNOb3RGb3VuZC5wdXNoKGJ1bmRsZUlkKTtcblxuICAgIG51bVdhaXRpbmctLTtcbiAgICBpZiAoIW51bVdhaXRpbmcpIGNhbGxiYWNrRm4oZGVwc05vdEZvdW5kKTtcbiAgfTtcblxuICAvLyByZWdpc3RlciBjYWxsYmFja1xuICB3aGlsZSAoaS0tKSB7XG4gICAgYnVuZGxlSWQgPSBidW5kbGVJZHNbaV07XG5cbiAgICAvLyBleGVjdXRlIGNhbGxiYWNrIGlmIGluIHJlc3VsdCBjYWNoZVxuICAgIHIgPSBidW5kbGVSZXN1bHRDYWNoZVtidW5kbGVJZF07XG4gICAgaWYgKHIpIHtcbiAgICAgIGZuKGJ1bmRsZUlkLCByKTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIC8vIGFkZCB0byBjYWxsYmFjayBxdWV1ZVxuICAgIHEgPSBidW5kbGVDYWxsYmFja1F1ZXVlW2J1bmRsZUlkXSA9IGJ1bmRsZUNhbGxiYWNrUXVldWVbYnVuZGxlSWRdIHx8IFtdO1xuICAgIHEucHVzaChmbik7XG4gIH1cbn1cblxuXG4vKipcbiAqIFB1Ymxpc2ggYnVuZGxlIGxvYWQgZXZlbnQuXG4gKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgLSBCdW5kbGUgaWRcbiAqIEBwYXJhbSB7c3RyaW5nW119IHBhdGhzTm90Rm91bmQgLSBMaXN0IG9mIGZpbGVzIG5vdCBmb3VuZFxuICovXG5mdW5jdGlvbiBwdWJsaXNoKGJ1bmRsZUlkLCBwYXRoc05vdEZvdW5kKSB7XG4gIC8vIGV4aXQgaWYgaWQgaXNuJ3QgZGVmaW5lZFxuICBpZiAoIWJ1bmRsZUlkKSByZXR1cm47XG5cbiAgdmFyIHEgPSBidW5kbGVDYWxsYmFja1F1ZXVlW2J1bmRsZUlkXTtcblxuICAvLyBjYWNoZSByZXN1bHRcbiAgYnVuZGxlUmVzdWx0Q2FjaGVbYnVuZGxlSWRdID0gcGF0aHNOb3RGb3VuZDtcblxuICAvLyBleGl0IGlmIHF1ZXVlIGlzIGVtcHR5XG4gIGlmICghcSkgcmV0dXJuO1xuXG4gIC8vIGVtcHR5IGNhbGxiYWNrIHF1ZXVlXG4gIHdoaWxlIChxLmxlbmd0aCkge1xuICAgIHFbMF0oYnVuZGxlSWQsIHBhdGhzTm90Rm91bmQpO1xuICAgIHEuc3BsaWNlKDAsIDEpO1xuICB9XG59XG5cblxuLyoqXG4gKiBFeGVjdXRlIGNhbGxiYWNrcy5cbiAqIEBwYXJhbSB7T2JqZWN0IG9yIEZ1bmN0aW9ufSBhcmdzIC0gVGhlIGNhbGxiYWNrIGFyZ3NcbiAqIEBwYXJhbSB7c3RyaW5nW119IGRlcHNOb3RGb3VuZCAtIExpc3Qgb2YgZGVwZW5kZW5jaWVzIG5vdCBmb3VuZFxuICovXG5mdW5jdGlvbiBleGVjdXRlQ2FsbGJhY2tzKGFyZ3MsIGRlcHNOb3RGb3VuZCkge1xuICAvLyBhY2NlcHQgZnVuY3Rpb24gYXMgYXJndW1lbnRcbiAgaWYgKGFyZ3MuY2FsbCkgYXJncyA9IHtzdWNjZXNzOiBhcmdzfTtcblxuICAvLyBzdWNjZXNzIGFuZCBlcnJvciBjYWxsYmFja3NcbiAgaWYgKGRlcHNOb3RGb3VuZC5sZW5ndGgpIChhcmdzLmVycm9yIHx8IGRldm51bGwpKGRlcHNOb3RGb3VuZCk7XG4gIGVsc2UgKGFyZ3Muc3VjY2VzcyB8fCBkZXZudWxsKShhcmdzKTtcbn1cblxuXG4vKipcbiAqIExvYWQgaW5kaXZpZHVhbCBmaWxlLlxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGggLSBUaGUgZmlsZSBwYXRoXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja0ZuIC0gVGhlIGNhbGxiYWNrIGZ1bmN0aW9uXG4gKi9cbmZ1bmN0aW9uIGxvYWRGaWxlKHBhdGgsIGNhbGxiYWNrRm4sIGFyZ3MsIG51bVRyaWVzKSB7XG4gIHZhciBkb2MgPSBkb2N1bWVudCxcbiAgICAgIGFzeW5jID0gYXJncy5hc3luYyxcbiAgICAgIG1heFRyaWVzID0gKGFyZ3MubnVtUmV0cmllcyB8fCAwKSArIDEsXG4gICAgICBiZWZvcmVDYWxsYmFja0ZuID0gYXJncy5iZWZvcmUgfHwgZGV2bnVsbCxcbiAgICAgIHBhdGhuYW1lID0gcGF0aC5yZXBsYWNlKC9bXFw/fCNdLiokLywgJycpLFxuICAgICAgcGF0aFN0cmlwcGVkID0gcGF0aC5yZXBsYWNlKC9eKGNzc3xpbWcpIS8sICcnKSxcbiAgICAgIGlzTGVnYWN5SUVDc3MsXG4gICAgICBlO1xuXG4gIG51bVRyaWVzID0gbnVtVHJpZXMgfHwgMDtcblxuICBpZiAoLyheY3NzIXxcXC5jc3MkKS8udGVzdChwYXRobmFtZSkpIHtcbiAgICAvLyBjc3NcbiAgICBlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcbiAgICBlLnJlbCA9ICdzdHlsZXNoZWV0JztcbiAgICBlLmhyZWYgPSBwYXRoU3RyaXBwZWQ7XG5cbiAgICAvLyB0YWcgSUU5K1xuICAgIGlzTGVnYWN5SUVDc3MgPSAnaGlkZUZvY3VzJyBpbiBlO1xuXG4gICAgLy8gdXNlIHByZWxvYWQgaW4gSUUgRWRnZSAodG8gZGV0ZWN0IGxvYWQgZXJyb3JzKVxuICAgIGlmIChpc0xlZ2FjeUlFQ3NzICYmIGUucmVsTGlzdCkge1xuICAgICAgaXNMZWdhY3lJRUNzcyA9IDA7XG4gICAgICBlLnJlbCA9ICdwcmVsb2FkJztcbiAgICAgIGUuYXMgPSAnc3R5bGUnO1xuICAgIH1cbiAgfSBlbHNlIGlmICgvKF5pbWchfFxcLihwbmd8Z2lmfGpwZ3xzdmd8d2VicCkkKS8udGVzdChwYXRobmFtZSkpIHtcbiAgICAvLyBpbWFnZVxuICAgIGUgPSBkb2MuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgZS5zcmMgPSBwYXRoU3RyaXBwZWQ7ICAgIFxuICB9IGVsc2Uge1xuICAgIC8vIGphdmFzY3JpcHRcbiAgICBlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgIGUuc3JjID0gcGF0aDtcbiAgICBlLmFzeW5jID0gYXN5bmMgPT09IHVuZGVmaW5lZCA/IHRydWUgOiBhc3luYztcbiAgfVxuXG4gIGUub25sb2FkID0gZS5vbmVycm9yID0gZS5vbmJlZm9yZWxvYWQgPSBmdW5jdGlvbiAoZXYpIHtcbiAgICB2YXIgcmVzdWx0ID0gZXYudHlwZVswXTtcblxuICAgIC8vIHRyZWF0IGVtcHR5IHN0eWxlc2hlZXRzIGFzIGZhaWx1cmVzIHRvIGdldCBhcm91bmQgbGFjayBvZiBvbmVycm9yXG4gICAgLy8gc3VwcG9ydCBpbiBJRTktMTFcbiAgICBpZiAoaXNMZWdhY3lJRUNzcykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKCFlLnNoZWV0LmNzc1RleHQubGVuZ3RoKSByZXN1bHQgPSAnZSc7XG4gICAgICB9IGNhdGNoICh4KSB7XG4gICAgICAgIC8vIHNoZWV0cyBvYmplY3RzIGNyZWF0ZWQgZnJvbSBsb2FkIGVycm9ycyBkb24ndCBhbGxvdyBhY2Nlc3MgdG9cbiAgICAgICAgLy8gYGNzc1RleHRgICh1bmxlc3MgZXJyb3IgaXMgQ29kZToxOCBTZWN1cml0eUVycm9yKVxuICAgICAgICBpZiAoeC5jb2RlICE9IDE4KSByZXN1bHQgPSAnZSc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gaGFuZGxlIHJldHJpZXMgaW4gY2FzZSBvZiBsb2FkIGZhaWx1cmVcbiAgICBpZiAocmVzdWx0ID09ICdlJykge1xuICAgICAgLy8gaW5jcmVtZW50IGNvdW50ZXJcbiAgICAgIG51bVRyaWVzICs9IDE7XG5cbiAgICAgIC8vIGV4aXQgZnVuY3Rpb24gYW5kIHRyeSBhZ2FpblxuICAgICAgaWYgKG51bVRyaWVzIDwgbWF4VHJpZXMpIHtcbiAgICAgICAgcmV0dXJuIGxvYWRGaWxlKHBhdGgsIGNhbGxiYWNrRm4sIGFyZ3MsIG51bVRyaWVzKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGUucmVsID09ICdwcmVsb2FkJyAmJiBlLmFzID09ICdzdHlsZScpIHtcbiAgICAgIC8vIGFjdGl2YXRlIHByZWxvYWRlZCBzdHlsZXNoZWV0c1xuICAgICAgcmV0dXJuIGUucmVsID0gJ3N0eWxlc2hlZXQnOyAvLyBqc2hpbnQgaWdub3JlOmxpbmVcbiAgICB9XG4gICAgXG4gICAgLy8gZXhlY3V0ZSBjYWxsYmFja1xuICAgIGNhbGxiYWNrRm4ocGF0aCwgcmVzdWx0LCBldi5kZWZhdWx0UHJldmVudGVkKTtcbiAgfTtcblxuICAvLyBhZGQgdG8gZG9jdW1lbnQgKHVubGVzcyBjYWxsYmFjayByZXR1cm5zIGBmYWxzZWApXG4gIGlmIChiZWZvcmVDYWxsYmFja0ZuKHBhdGgsIGUpICE9PSBmYWxzZSkgZG9jLmhlYWQuYXBwZW5kQ2hpbGQoZSk7XG59XG5cblxuLyoqXG4gKiBMb2FkIG11bHRpcGxlIGZpbGVzLlxuICogQHBhcmFtIHtzdHJpbmdbXX0gcGF0aHMgLSBUaGUgZmlsZSBwYXRoc1xuICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tGbiAtIFRoZSBjYWxsYmFjayBmdW5jdGlvblxuICovXG5mdW5jdGlvbiBsb2FkRmlsZXMocGF0aHMsIGNhbGxiYWNrRm4sIGFyZ3MpIHtcbiAgLy8gbGlzdGlmeSBwYXRoc1xuICBwYXRocyA9IHBhdGhzLnB1c2ggPyBwYXRocyA6IFtwYXRoc107XG5cbiAgdmFyIG51bVdhaXRpbmcgPSBwYXRocy5sZW5ndGgsXG4gICAgICB4ID0gbnVtV2FpdGluZyxcbiAgICAgIHBhdGhzTm90Rm91bmQgPSBbXSxcbiAgICAgIGZuLFxuICAgICAgaTtcblxuICAvLyBkZWZpbmUgY2FsbGJhY2sgZnVuY3Rpb25cbiAgZm4gPSBmdW5jdGlvbihwYXRoLCByZXN1bHQsIGRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAvLyBoYW5kbGUgZXJyb3JcbiAgICBpZiAocmVzdWx0ID09ICdlJykgcGF0aHNOb3RGb3VuZC5wdXNoKHBhdGgpO1xuXG4gICAgLy8gaGFuZGxlIGJlZm9yZWxvYWQgZXZlbnQuIElmIGRlZmF1bHRQcmV2ZW50ZWQgdGhlbiB0aGF0IG1lYW5zIHRoZSBsb2FkXG4gICAgLy8gd2lsbCBiZSBibG9ja2VkIChleC4gR2hvc3RlcnkvQUJQIG9uIFNhZmFyaSlcbiAgICBpZiAocmVzdWx0ID09ICdiJykge1xuICAgICAgaWYgKGRlZmF1bHRQcmV2ZW50ZWQpIHBhdGhzTm90Rm91bmQucHVzaChwYXRoKTtcbiAgICAgIGVsc2UgcmV0dXJuO1xuICAgIH1cblxuICAgIG51bVdhaXRpbmctLTtcbiAgICBpZiAoIW51bVdhaXRpbmcpIGNhbGxiYWNrRm4ocGF0aHNOb3RGb3VuZCk7XG4gIH07XG5cbiAgLy8gbG9hZCBzY3JpcHRzXG4gIGZvciAoaT0wOyBpIDwgeDsgaSsrKSBsb2FkRmlsZShwYXRoc1tpXSwgZm4sIGFyZ3MpO1xufVxuXG5cbi8qKlxuICogSW5pdGlhdGUgc2NyaXB0IGxvYWQgYW5kIHJlZ2lzdGVyIGJ1bmRsZS5cbiAqIEBwYXJhbSB7KHN0cmluZ3xzdHJpbmdbXSl9IHBhdGhzIC0gVGhlIGZpbGUgcGF0aHNcbiAqIEBwYXJhbSB7KHN0cmluZ3xGdW5jdGlvbnxPYmplY3QpfSBbYXJnMV0gLSBUaGUgKDEpIGJ1bmRsZUlkIG9yICgyKSBzdWNjZXNzXG4gKiAgIGNhbGxiYWNrIG9yICgzKSBvYmplY3QgbGl0ZXJhbCB3aXRoIHN1Y2Nlc3MvZXJyb3IgYXJndW1lbnRzLCBudW1SZXRyaWVzLFxuICogICBldGMuXG4gKiBAcGFyYW0geyhGdW5jdGlvbnxPYmplY3QpfSBbYXJnMl0gLSBUaGUgKDEpIHN1Y2Nlc3MgY2FsbGJhY2sgb3IgKDIpIG9iamVjdFxuICogICBsaXRlcmFsIHdpdGggc3VjY2Vzcy9lcnJvciBhcmd1bWVudHMsIG51bVJldHJpZXMsIGV0Yy5cbiAqL1xuZnVuY3Rpb24gbG9hZGpzKHBhdGhzLCBhcmcxLCBhcmcyKSB7XG4gIHZhciBidW5kbGVJZCxcbiAgICAgIGFyZ3M7XG5cbiAgLy8gYnVuZGxlSWQgKGlmIHN0cmluZylcbiAgaWYgKGFyZzEgJiYgYXJnMS50cmltKSBidW5kbGVJZCA9IGFyZzE7XG5cbiAgLy8gYXJncyAoZGVmYXVsdCBpcyB7fSlcbiAgYXJncyA9IChidW5kbGVJZCA/IGFyZzIgOiBhcmcxKSB8fCB7fTtcblxuICAvLyB0aHJvdyBlcnJvciBpZiBidW5kbGUgaXMgYWxyZWFkeSBkZWZpbmVkXG4gIGlmIChidW5kbGVJZCkge1xuICAgIGlmIChidW5kbGVJZCBpbiBidW5kbGVJZENhY2hlKSB7XG4gICAgICB0aHJvdyBcIkxvYWRKU1wiO1xuICAgIH0gZWxzZSB7XG4gICAgICBidW5kbGVJZENhY2hlW2J1bmRsZUlkXSA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gbG9hZEZuKHJlc29sdmUsIHJlamVjdCkge1xuICAgIGxvYWRGaWxlcyhwYXRocywgZnVuY3Rpb24gKHBhdGhzTm90Rm91bmQpIHtcbiAgICAgIC8vIGV4ZWN1dGUgY2FsbGJhY2tzXG4gICAgICBleGVjdXRlQ2FsbGJhY2tzKGFyZ3MsIHBhdGhzTm90Rm91bmQpO1xuICAgICAgXG4gICAgICAvLyByZXNvbHZlIFByb21pc2VcbiAgICAgIGlmIChyZXNvbHZlKSB7XG4gICAgICAgIGV4ZWN1dGVDYWxsYmFja3Moe3N1Y2Nlc3M6IHJlc29sdmUsIGVycm9yOiByZWplY3R9LCBwYXRoc05vdEZvdW5kKTtcbiAgICAgIH1cblxuICAgICAgLy8gcHVibGlzaCBidW5kbGUgbG9hZCBldmVudFxuICAgICAgcHVibGlzaChidW5kbGVJZCwgcGF0aHNOb3RGb3VuZCk7XG4gICAgfSwgYXJncyk7XG4gIH1cbiAgXG4gIGlmIChhcmdzLnJldHVyblByb21pc2UpIHJldHVybiBuZXcgUHJvbWlzZShsb2FkRm4pO1xuICBlbHNlIGxvYWRGbigpO1xufVxuXG5cbi8qKlxuICogRXhlY3V0ZSBjYWxsYmFja3Mgd2hlbiBkZXBlbmRlbmNpZXMgaGF2ZSBiZWVuIHNhdGlzZmllZC5cbiAqIEBwYXJhbSB7KHN0cmluZ3xzdHJpbmdbXSl9IGRlcHMgLSBMaXN0IG9mIGJ1bmRsZSBpZHNcbiAqIEBwYXJhbSB7T2JqZWN0fSBhcmdzIC0gc3VjY2Vzcy9lcnJvciBhcmd1bWVudHNcbiAqL1xubG9hZGpzLnJlYWR5ID0gZnVuY3Rpb24gcmVhZHkoZGVwcywgYXJncykge1xuICAvLyBzdWJzY3JpYmUgdG8gYnVuZGxlIGxvYWQgZXZlbnRcbiAgc3Vic2NyaWJlKGRlcHMsIGZ1bmN0aW9uIChkZXBzTm90Rm91bmQpIHtcbiAgICAvLyBleGVjdXRlIGNhbGxiYWNrc1xuICAgIGV4ZWN1dGVDYWxsYmFja3MoYXJncywgZGVwc05vdEZvdW5kKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGxvYWRqcztcbn07XG5cblxuLyoqXG4gKiBNYW51YWxseSBzYXRpc2Z5IGJ1bmRsZSBkZXBlbmRlbmNpZXMuXG4gKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgLSBUaGUgYnVuZGxlIGlkXG4gKi9cbmxvYWRqcy5kb25lID0gZnVuY3Rpb24gZG9uZShidW5kbGVJZCkge1xuICBwdWJsaXNoKGJ1bmRsZUlkLCBbXSk7XG59O1xuXG5cbi8qKlxuICogUmVzZXQgbG9hZGpzIGRlcGVuZGVuY2llcyBzdGF0dXNlc1xuICovXG5sb2FkanMucmVzZXQgPSBmdW5jdGlvbiByZXNldCgpIHtcbiAgYnVuZGxlSWRDYWNoZSA9IHt9O1xuICBidW5kbGVSZXN1bHRDYWNoZSA9IHt9O1xuICBidW5kbGVDYWxsYmFja1F1ZXVlID0ge307XG59O1xuXG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGJ1bmRsZSBoYXMgYWxyZWFkeSBiZWVuIGRlZmluZWRcbiAqIEBwYXJhbSBTdHJpbmd9IGJ1bmRsZUlkIC0gVGhlIGJ1bmRsZSBpZFxuICovXG5sb2FkanMuaXNEZWZpbmVkID0gZnVuY3Rpb24gaXNEZWZpbmVkKGJ1bmRsZUlkKSB7XG4gIHJldHVybiBidW5kbGVJZCBpbiBidW5kbGVJZENhY2hlO1xufTtcblxuXG4vLyBleHBvcnRcbnJldHVybiBsb2FkanM7XG5cbn0pKTtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBMb2FkIGFuIGV4dGVybmFsIHNjcmlwdFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IGxvYWRqcyBmcm9tICdsb2FkanMnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBsb2FkU2NyaXB0KHVybCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGxvYWRqcyh1cmwsIHtcbiAgICAgIHN1Y2Nlc3M6IHJlc29sdmUsXG4gICAgICBlcnJvcjogcmVqZWN0LFxuICAgIH0pO1xuICB9KTtcbn1cbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBWaW1lbyBwbHVnaW5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBjYXB0aW9ucyBmcm9tICcuLi9jYXB0aW9ucyc7XG5pbXBvcnQgY29udHJvbHMgZnJvbSAnLi4vY29udHJvbHMnO1xuaW1wb3J0IHVpIGZyb20gJy4uL3VpJztcbmltcG9ydCB7IGNyZWF0ZUVsZW1lbnQsIHJlcGxhY2VFbGVtZW50LCB0b2dnbGVDbGFzcyB9IGZyb20gJy4uL3V0aWxzL2VsZW1lbnRzJztcbmltcG9ydCB7IHRyaWdnZXJFdmVudCB9IGZyb20gJy4uL3V0aWxzL2V2ZW50cyc7XG5pbXBvcnQgZmV0Y2ggZnJvbSAnLi4vdXRpbHMvZmV0Y2gnO1xuaW1wb3J0IGlzIGZyb20gJy4uL3V0aWxzL2lzJztcbmltcG9ydCBsb2FkU2NyaXB0IGZyb20gJy4uL3V0aWxzL2xvYWQtc2NyaXB0JztcbmltcG9ydCB7IGZvcm1hdCwgc3RyaXBIVE1MIH0gZnJvbSAnLi4vdXRpbHMvc3RyaW5ncyc7XG5pbXBvcnQgeyByb3VuZEFzcGVjdFJhdGlvLCBzZXRBc3BlY3RSYXRpbyB9IGZyb20gJy4uL3V0aWxzL3N0eWxlJztcbmltcG9ydCB7IGJ1aWxkVXJsUGFyYW1zIH0gZnJvbSAnLi4vdXRpbHMvdXJscyc7XG5cbi8vIFBhcnNlIFZpbWVvIElEIGZyb20gVVJMXG5mdW5jdGlvbiBwYXJzZUlkKHVybCkge1xuICBpZiAoaXMuZW1wdHkodXJsKSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgaWYgKGlzLm51bWJlcihOdW1iZXIodXJsKSkpIHtcbiAgICByZXR1cm4gdXJsO1xuICB9XG5cbiAgY29uc3QgcmVnZXggPSAvXi4qKHZpbWVvLmNvbVxcL3x2aWRlb1xcLykoXFxkKykuKi87XG4gIHJldHVybiB1cmwubWF0Y2gocmVnZXgpID8gUmVnRXhwLiQyIDogdXJsO1xufVxuXG4vLyBUcnkgdG8gZXh0cmFjdCBhIGhhc2ggZm9yIHByaXZhdGUgdmlkZW9zIGZyb20gdGhlIFVSTFxuZnVuY3Rpb24gcGFyc2VIYXNoKHVybCkge1xuICAvKiBUaGlzIHJlZ2V4IG1hdGNoZXMgYSBoZXhhZGVjaW1hbCBoYXNoIGlmIGdpdmVuIGluIGFueSBvZiB0aGVzZSBmb3JtczpcbiAgICogIC0gW2h0dHBzOi8vcGxheWVyLl12aW1lby5jb20vdmlkZW8ve2lkfS97aGFzaH1bP3BhcmFtc11cbiAgICogIC0gW2h0dHBzOi8vcGxheWVyLl12aW1lby5jb20vdmlkZW8ve2lkfT9oPXtoYXNofVsmcGFyYW1zXVxuICAgKiAgLSBbaHR0cHM6Ly9wbGF5ZXIuXXZpbWVvLmNvbS92aWRlby97aWR9P1twYXJhbXNdJmg9e2hhc2h9XG4gICAqICAtIHZpZGVvL3tpZH0ve2hhc2h9XG4gICAqIElmIG1hdGNoZWQsIHRoZSBoYXNoIGlzIGF2YWlsYWJsZSBpbiBjYXB0dXJlIGdyb3VwIDRcbiAgICovXG4gIGNvbnN0IHJlZ2V4ID0gL14uKih2aW1lby5jb21cXC98dmlkZW9cXC8pKFxcZCspKFxcPy4qJipoPXxcXC8pKyhbXFxkLGEtZl0rKS87XG4gIGNvbnN0IGZvdW5kID0gdXJsLm1hdGNoKHJlZ2V4KTtcblxuICByZXR1cm4gZm91bmQgJiYgZm91bmQubGVuZ3RoID09PSA1ID8gZm91bmRbNF0gOiBudWxsO1xufVxuXG4vLyBTZXQgcGxheWJhY2sgc3RhdGUgYW5kIHRyaWdnZXIgY2hhbmdlIChvbmx5IG9uIGFjdHVhbCBjaGFuZ2UpXG5mdW5jdGlvbiBhc3N1cmVQbGF5YmFja1N0YXRlKHBsYXkpIHtcbiAgaWYgKHBsYXkgJiYgIXRoaXMuZW1iZWQuaGFzUGxheWVkKSB7XG4gICAgdGhpcy5lbWJlZC5oYXNQbGF5ZWQgPSB0cnVlO1xuICB9XG4gIGlmICh0aGlzLm1lZGlhLnBhdXNlZCA9PT0gcGxheSkge1xuICAgIHRoaXMubWVkaWEucGF1c2VkID0gIXBsYXk7XG4gICAgdHJpZ2dlckV2ZW50LmNhbGwodGhpcywgdGhpcy5tZWRpYSwgcGxheSA/ICdwbGF5JyA6ICdwYXVzZScpO1xuICB9XG59XG5cbmNvbnN0IHZpbWVvID0ge1xuICBzZXR1cCgpIHtcbiAgICBjb25zdCBwbGF5ZXIgPSB0aGlzO1xuXG4gICAgLy8gQWRkIGVtYmVkIGNsYXNzIGZvciByZXNwb25zaXZlXG4gICAgdG9nZ2xlQ2xhc3MocGxheWVyLmVsZW1lbnRzLndyYXBwZXIsIHBsYXllci5jb25maWcuY2xhc3NOYW1lcy5lbWJlZCwgdHJ1ZSk7XG5cbiAgICAvLyBTZXQgc3BlZWQgb3B0aW9ucyBmcm9tIGNvbmZpZ1xuICAgIHBsYXllci5vcHRpb25zLnNwZWVkID0gcGxheWVyLmNvbmZpZy5zcGVlZC5vcHRpb25zO1xuXG4gICAgLy8gU2V0IGludGlhbCByYXRpb1xuICAgIHNldEFzcGVjdFJhdGlvLmNhbGwocGxheWVyKTtcblxuICAgIC8vIExvYWQgdGhlIFNESyBpZiBub3QgYWxyZWFkeVxuICAgIGlmICghaXMub2JqZWN0KHdpbmRvdy5WaW1lbykpIHtcbiAgICAgIGxvYWRTY3JpcHQocGxheWVyLmNvbmZpZy51cmxzLnZpbWVvLnNkaylcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHZpbWVvLnJlYWR5LmNhbGwocGxheWVyKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgIHBsYXllci5kZWJ1Zy53YXJuKCdWaW1lbyBTREsgKHBsYXllci5qcykgZmFpbGVkIHRvIGxvYWQnLCBlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB2aW1lby5yZWFkeS5jYWxsKHBsYXllcik7XG4gICAgfVxuICB9LFxuXG4gIC8vIEFQSSBSZWFkeVxuICByZWFkeSgpIHtcbiAgICBjb25zdCBwbGF5ZXIgPSB0aGlzO1xuICAgIGNvbnN0IGNvbmZpZyA9IHBsYXllci5jb25maWcudmltZW87XG4gICAgY29uc3QgeyBwcmVtaXVtLCByZWZlcnJlclBvbGljeSwgLi4uZnJhbWVQYXJhbXMgfSA9IGNvbmZpZztcbiAgICAvLyBHZXQgdGhlIHNvdXJjZSBVUkwgb3IgSURcbiAgICBsZXQgc291cmNlID0gcGxheWVyLm1lZGlhLmdldEF0dHJpYnV0ZSgnc3JjJyk7XG4gICAgbGV0IGhhc2ggPSAnJztcbiAgICAvLyBHZXQgZnJvbSA8ZGl2PiBpZiBuZWVkZWRcbiAgICBpZiAoaXMuZW1wdHkoc291cmNlKSkge1xuICAgICAgc291cmNlID0gcGxheWVyLm1lZGlhLmdldEF0dHJpYnV0ZShwbGF5ZXIuY29uZmlnLmF0dHJpYnV0ZXMuZW1iZWQuaWQpO1xuICAgICAgLy8gaGFzaCBjYW4gYWxzbyBiZSBzZXQgYXMgYXR0cmlidXRlIG9uIHRoZSA8ZGl2PlxuICAgICAgaGFzaCA9IHBsYXllci5tZWRpYS5nZXRBdHRyaWJ1dGUocGxheWVyLmNvbmZpZy5hdHRyaWJ1dGVzLmVtYmVkLmhhc2gpO1xuICAgIH0gZWxzZSB7XG4gICAgICBoYXNoID0gcGFyc2VIYXNoKHNvdXJjZSk7XG4gICAgfVxuICAgIGNvbnN0IGhhc2hQYXJhbSA9IGhhc2ggPyB7IGg6IGhhc2ggfSA6IHt9O1xuXG4gICAgLy8gSWYgdGhlIG93bmVyIGhhcyBhIHBybyBvciBwcmVtaXVtIGFjY291bnQgdGhlbiB3ZSBjYW4gaGlkZSBjb250cm9scyBldGNcbiAgICBpZiAocHJlbWl1bSkge1xuICAgICAgT2JqZWN0LmFzc2lnbihmcmFtZVBhcmFtcywge1xuICAgICAgICBjb250cm9sczogZmFsc2UsXG4gICAgICAgIHNpZGVkb2NrOiBmYWxzZSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEdldCBWaW1lbyBwYXJhbXMgZm9yIHRoZSBpZnJhbWVcbiAgICBjb25zdCBwYXJhbXMgPSBidWlsZFVybFBhcmFtcyh7XG4gICAgICBsb29wOiBwbGF5ZXIuY29uZmlnLmxvb3AuYWN0aXZlLFxuICAgICAgYXV0b3BsYXk6IHBsYXllci5hdXRvcGxheSxcbiAgICAgIG11dGVkOiBwbGF5ZXIubXV0ZWQsXG4gICAgICBnZXN0dXJlOiAnbWVkaWEnLFxuICAgICAgcGxheXNpbmxpbmU6ICF0aGlzLmNvbmZpZy5mdWxsc2NyZWVuLmlvc05hdGl2ZSxcbiAgICAgIC8vIGhhc2ggaGFzIHRvIGJlIGFkZGVkIHRvIGlmcmFtZS1VUkxcbiAgICAgIC4uLmhhc2hQYXJhbSxcbiAgICAgIC4uLmZyYW1lUGFyYW1zLFxuICAgIH0pO1xuXG4gICAgY29uc3QgaWQgPSBwYXJzZUlkKHNvdXJjZSk7XG4gICAgLy8gQnVpbGQgYW4gaWZyYW1lXG4gICAgY29uc3QgaWZyYW1lID0gY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7XG4gICAgY29uc3Qgc3JjID0gZm9ybWF0KHBsYXllci5jb25maWcudXJscy52aW1lby5pZnJhbWUsIGlkLCBwYXJhbXMpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ3NyYycsIHNyYyk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnYWxsb3dmdWxsc2NyZWVuJywgJycpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXG4gICAgICAnYWxsb3cnLFxuICAgICAgWydhdXRvcGxheScsICdmdWxsc2NyZWVuJywgJ3BpY3R1cmUtaW4tcGljdHVyZScsICdlbmNyeXB0ZWQtbWVkaWEnLCAnYWNjZWxlcm9tZXRlcicsICdneXJvc2NvcGUnXS5qb2luKCc7ICcpLFxuICAgICk7XG5cbiAgICAvLyBTZXQgdGhlIHJlZmVycmVyIHBvbGljeSBpZiByZXF1aXJlZFxuICAgIGlmICghaXMuZW1wdHkocmVmZXJyZXJQb2xpY3kpKSB7XG4gICAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdyZWZlcnJlclBvbGljeScsIHJlZmVycmVyUG9saWN5KTtcbiAgICB9XG5cbiAgICAvLyBJbmplY3QgdGhlIHBhY2thZ2VcbiAgICBpZiAocHJlbWl1bSB8fCAhY29uZmlnLmN1c3RvbUNvbnRyb2xzKSB7XG4gICAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdkYXRhLXBvc3RlcicsIHBsYXllci5wb3N0ZXIpO1xuICAgICAgcGxheWVyLm1lZGlhID0gcmVwbGFjZUVsZW1lbnQoaWZyYW1lLCBwbGF5ZXIubWVkaWEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB3cmFwcGVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICBjbGFzczogcGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLmVtYmVkQ29udGFpbmVyLFxuICAgICAgICAnZGF0YS1wb3N0ZXInOiBwbGF5ZXIucG9zdGVyLFxuICAgICAgfSk7XG4gICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKGlmcmFtZSk7XG4gICAgICBwbGF5ZXIubWVkaWEgPSByZXBsYWNlRWxlbWVudCh3cmFwcGVyLCBwbGF5ZXIubWVkaWEpO1xuICAgIH1cblxuICAgIC8vIEdldCBwb3N0ZXIgaW1hZ2VcbiAgICBpZiAoIWNvbmZpZy5jdXN0b21Db250cm9scykge1xuICAgICAgZmV0Y2goZm9ybWF0KHBsYXllci5jb25maWcudXJscy52aW1lby5hcGksIHNyYykpLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIGlmIChpcy5lbXB0eShyZXNwb25zZSkgfHwgIXJlc3BvbnNlLnRodW1ibmFpbF91cmwpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXQgYW5kIHNob3cgcG9zdGVyXG4gICAgICAgIHVpLnNldFBvc3Rlci5jYWxsKHBsYXllciwgcmVzcG9uc2UudGh1bWJuYWlsX3VybCkuY2F0Y2goKCkgPT4ge30pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gU2V0dXAgaW5zdGFuY2VcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vdmltZW8vcGxheWVyLmpzXG4gICAgcGxheWVyLmVtYmVkID0gbmV3IHdpbmRvdy5WaW1lby5QbGF5ZXIoaWZyYW1lLCB7XG4gICAgICBhdXRvcGF1c2U6IHBsYXllci5jb25maWcuYXV0b3BhdXNlLFxuICAgICAgbXV0ZWQ6IHBsYXllci5tdXRlZCxcbiAgICB9KTtcblxuICAgIHBsYXllci5tZWRpYS5wYXVzZWQgPSB0cnVlO1xuICAgIHBsYXllci5tZWRpYS5jdXJyZW50VGltZSA9IDA7XG5cbiAgICAvLyBEaXNhYmxlIG5hdGl2ZSB0ZXh0IHRyYWNrIHJlbmRlcmluZ1xuICAgIGlmIChwbGF5ZXIuc3VwcG9ydGVkLnVpKSB7XG4gICAgICBwbGF5ZXIuZW1iZWQuZGlzYWJsZVRleHRUcmFjaygpO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBhIGZhdXggSFRNTDUgQVBJIHVzaW5nIHRoZSBWaW1lbyBBUElcbiAgICBwbGF5ZXIubWVkaWEucGxheSA9ICgpID0+IHtcbiAgICAgIGFzc3VyZVBsYXliYWNrU3RhdGUuY2FsbChwbGF5ZXIsIHRydWUpO1xuICAgICAgcmV0dXJuIHBsYXllci5lbWJlZC5wbGF5KCk7XG4gICAgfTtcblxuICAgIHBsYXllci5tZWRpYS5wYXVzZSA9ICgpID0+IHtcbiAgICAgIGFzc3VyZVBsYXliYWNrU3RhdGUuY2FsbChwbGF5ZXIsIGZhbHNlKTtcbiAgICAgIHJldHVybiBwbGF5ZXIuZW1iZWQucGF1c2UoKTtcbiAgICB9O1xuXG4gICAgcGxheWVyLm1lZGlhLnN0b3AgPSAoKSA9PiB7XG4gICAgICBwbGF5ZXIucGF1c2UoKTtcbiAgICAgIHBsYXllci5jdXJyZW50VGltZSA9IDA7XG4gICAgfTtcblxuICAgIC8vIFNlZWtpbmdcbiAgICBsZXQgeyBjdXJyZW50VGltZSB9ID0gcGxheWVyLm1lZGlhO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwbGF5ZXIubWVkaWEsICdjdXJyZW50VGltZScsIHtcbiAgICAgIGdldCgpIHtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRUaW1lO1xuICAgICAgfSxcbiAgICAgIHNldCh0aW1lKSB7XG4gICAgICAgIC8vIFZpbWVvIHdpbGwgYXV0b21hdGljYWxseSBwbGF5IG9uIHNlZWsgaWYgdGhlIHZpZGVvIGhhc24ndCBiZWVuIHBsYXllZCBiZWZvcmVcblxuICAgICAgICAvLyBHZXQgY3VycmVudCBwYXVzZWQgc3RhdGUgYW5kIHZvbHVtZSBldGNcbiAgICAgICAgY29uc3QgeyBlbWJlZCwgbWVkaWEsIHBhdXNlZCwgdm9sdW1lIH0gPSBwbGF5ZXI7XG4gICAgICAgIGNvbnN0IHJlc3RvcmVQYXVzZSA9IHBhdXNlZCAmJiAhZW1iZWQuaGFzUGxheWVkO1xuXG4gICAgICAgIC8vIFNldCBzZWVraW5nIHN0YXRlIGFuZCB0cmlnZ2VyIGV2ZW50XG4gICAgICAgIG1lZGlhLnNlZWtpbmcgPSB0cnVlO1xuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIG1lZGlhLCAnc2Vla2luZycpO1xuXG4gICAgICAgIC8vIElmIHBhdXNlZCwgbXV0ZSB1bnRpbCBzZWVrIGlzIGNvbXBsZXRlXG4gICAgICAgIFByb21pc2UucmVzb2x2ZShyZXN0b3JlUGF1c2UgJiYgZW1iZWQuc2V0Vm9sdW1lKDApKVxuICAgICAgICAgIC8vIFNlZWtcbiAgICAgICAgICAudGhlbigoKSA9PiBlbWJlZC5zZXRDdXJyZW50VGltZSh0aW1lKSlcbiAgICAgICAgICAvLyBSZXN0b3JlIHBhdXNlZFxuICAgICAgICAgIC50aGVuKCgpID0+IHJlc3RvcmVQYXVzZSAmJiBlbWJlZC5wYXVzZSgpKVxuICAgICAgICAgIC8vIFJlc3RvcmUgdm9sdW1lXG4gICAgICAgICAgLnRoZW4oKCkgPT4gcmVzdG9yZVBhdXNlICYmIGVtYmVkLnNldFZvbHVtZSh2b2x1bWUpKVxuICAgICAgICAgIC5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBEbyBub3RoaW5nXG4gICAgICAgICAgfSk7XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gUGxheWJhY2sgc3BlZWRcbiAgICBsZXQgc3BlZWQgPSBwbGF5ZXIuY29uZmlnLnNwZWVkLnNlbGVjdGVkO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwbGF5ZXIubWVkaWEsICdwbGF5YmFja1JhdGUnLCB7XG4gICAgICBnZXQoKSB7XG4gICAgICAgIHJldHVybiBzcGVlZDtcbiAgICAgIH0sXG4gICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgcGxheWVyLmVtYmVkXG4gICAgICAgICAgLnNldFBsYXliYWNrUmF0ZShpbnB1dClcbiAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBzcGVlZCA9IGlucHV0O1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdyYXRlY2hhbmdlJyk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgLy8gQ2Fubm90IHNldCBQbGF5YmFjayBSYXRlLCBWaWRlbyBpcyBwcm9iYWJseSBub3Qgb24gUHJvIGFjY291bnRcbiAgICAgICAgICAgIHBsYXllci5vcHRpb25zLnNwZWVkID0gWzFdO1xuICAgICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIFZvbHVtZVxuICAgIGxldCB7IHZvbHVtZSB9ID0gcGxheWVyLmNvbmZpZztcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAndm9sdW1lJywge1xuICAgICAgZ2V0KCkge1xuICAgICAgICByZXR1cm4gdm9sdW1lO1xuICAgICAgfSxcbiAgICAgIHNldChpbnB1dCkge1xuICAgICAgICBwbGF5ZXIuZW1iZWQuc2V0Vm9sdW1lKGlucHV0KS50aGVuKCgpID0+IHtcbiAgICAgICAgICB2b2x1bWUgPSBpbnB1dDtcbiAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3ZvbHVtZWNoYW5nZScpO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBNdXRlZFxuICAgIGxldCB7IG11dGVkIH0gPSBwbGF5ZXIuY29uZmlnO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwbGF5ZXIubWVkaWEsICdtdXRlZCcsIHtcbiAgICAgIGdldCgpIHtcbiAgICAgICAgcmV0dXJuIG11dGVkO1xuICAgICAgfSxcbiAgICAgIHNldChpbnB1dCkge1xuICAgICAgICBjb25zdCB0b2dnbGUgPSBpcy5ib29sZWFuKGlucHV0KSA/IGlucHV0IDogZmFsc2U7XG5cbiAgICAgICAgcGxheWVyLmVtYmVkLnNldFZvbHVtZSh0b2dnbGUgPyAwIDogcGxheWVyLmNvbmZpZy52b2x1bWUpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIG11dGVkID0gdG9nZ2xlO1xuICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndm9sdW1lY2hhbmdlJyk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIExvb3BcbiAgICBsZXQgeyBsb29wIH0gPSBwbGF5ZXIuY29uZmlnO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwbGF5ZXIubWVkaWEsICdsb29wJywge1xuICAgICAgZ2V0KCkge1xuICAgICAgICByZXR1cm4gbG9vcDtcbiAgICAgIH0sXG4gICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgY29uc3QgdG9nZ2xlID0gaXMuYm9vbGVhbihpbnB1dCkgPyBpbnB1dCA6IHBsYXllci5jb25maWcubG9vcC5hY3RpdmU7XG5cbiAgICAgICAgcGxheWVyLmVtYmVkLnNldExvb3AodG9nZ2xlKS50aGVuKCgpID0+IHtcbiAgICAgICAgICBsb29wID0gdG9nZ2xlO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBTb3VyY2VcbiAgICBsZXQgY3VycmVudFNyYztcbiAgICBwbGF5ZXIuZW1iZWRcbiAgICAgIC5nZXRWaWRlb1VybCgpXG4gICAgICAudGhlbigodmFsdWUpID0+IHtcbiAgICAgICAgY3VycmVudFNyYyA9IHZhbHVlO1xuICAgICAgICBjb250cm9scy5zZXREb3dubG9hZFVybC5jYWxsKHBsYXllcik7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICB0aGlzLmRlYnVnLndhcm4oZXJyb3IpO1xuICAgICAgfSk7XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnY3VycmVudFNyYycsIHtcbiAgICAgIGdldCgpIHtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRTcmM7XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gRW5kZWRcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnZW5kZWQnLCB7XG4gICAgICBnZXQoKSB7XG4gICAgICAgIHJldHVybiBwbGF5ZXIuY3VycmVudFRpbWUgPT09IHBsYXllci5kdXJhdGlvbjtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBTZXQgYXNwZWN0IHJhdGlvIGJhc2VkIG9uIHZpZGVvIHNpemVcbiAgICBQcm9taXNlLmFsbChbcGxheWVyLmVtYmVkLmdldFZpZGVvV2lkdGgoKSwgcGxheWVyLmVtYmVkLmdldFZpZGVvSGVpZ2h0KCldKS50aGVuKChkaW1lbnNpb25zKSA9PiB7XG4gICAgICBjb25zdCBbd2lkdGgsIGhlaWdodF0gPSBkaW1lbnNpb25zO1xuICAgICAgcGxheWVyLmVtYmVkLnJhdGlvID0gcm91bmRBc3BlY3RSYXRpbyh3aWR0aCwgaGVpZ2h0KTtcbiAgICAgIHNldEFzcGVjdFJhdGlvLmNhbGwodGhpcyk7XG4gICAgfSk7XG5cbiAgICAvLyBTZXQgYXV0b3BhdXNlXG4gICAgcGxheWVyLmVtYmVkLnNldEF1dG9wYXVzZShwbGF5ZXIuY29uZmlnLmF1dG9wYXVzZSkudGhlbigoc3RhdGUpID0+IHtcbiAgICAgIHBsYXllci5jb25maWcuYXV0b3BhdXNlID0gc3RhdGU7XG4gICAgfSk7XG5cbiAgICAvLyBHZXQgdGl0bGVcbiAgICBwbGF5ZXIuZW1iZWQuZ2V0VmlkZW9UaXRsZSgpLnRoZW4oKHRpdGxlKSA9PiB7XG4gICAgICBwbGF5ZXIuY29uZmlnLnRpdGxlID0gdGl0bGU7XG4gICAgICB1aS5zZXRUaXRsZS5jYWxsKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgLy8gR2V0IGN1cnJlbnQgdGltZVxuICAgIHBsYXllci5lbWJlZC5nZXRDdXJyZW50VGltZSgpLnRoZW4oKHZhbHVlKSA9PiB7XG4gICAgICBjdXJyZW50VGltZSA9IHZhbHVlO1xuICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd0aW1ldXBkYXRlJyk7XG4gICAgfSk7XG5cbiAgICAvLyBHZXQgZHVyYXRpb25cbiAgICBwbGF5ZXIuZW1iZWQuZ2V0RHVyYXRpb24oKS50aGVuKCh2YWx1ZSkgPT4ge1xuICAgICAgcGxheWVyLm1lZGlhLmR1cmF0aW9uID0gdmFsdWU7XG4gICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2R1cmF0aW9uY2hhbmdlJyk7XG4gICAgfSk7XG5cbiAgICAvLyBHZXQgY2FwdGlvbnNcbiAgICBwbGF5ZXIuZW1iZWQuZ2V0VGV4dFRyYWNrcygpLnRoZW4oKHRyYWNrcykgPT4ge1xuICAgICAgcGxheWVyLm1lZGlhLnRleHRUcmFja3MgPSB0cmFja3M7XG4gICAgICBjYXB0aW9ucy5zZXR1cC5jYWxsKHBsYXllcik7XG4gICAgfSk7XG5cbiAgICBwbGF5ZXIuZW1iZWQub24oJ2N1ZWNoYW5nZScsICh7IGN1ZXMgPSBbXSB9KSA9PiB7XG4gICAgICBjb25zdCBzdHJpcHBlZEN1ZXMgPSBjdWVzLm1hcCgoY3VlKSA9PiBzdHJpcEhUTUwoY3VlLnRleHQpKTtcbiAgICAgIGNhcHRpb25zLnVwZGF0ZUN1ZXMuY2FsbChwbGF5ZXIsIHN0cmlwcGVkQ3Vlcyk7XG4gICAgfSk7XG5cbiAgICBwbGF5ZXIuZW1iZWQub24oJ2xvYWRlZCcsICgpID0+IHtcbiAgICAgIC8vIEFzc3VyZSBzdGF0ZSBhbmQgZXZlbnRzIGFyZSB1cGRhdGVkIG9uIGF1dG9wbGF5XG4gICAgICBwbGF5ZXIuZW1iZWQuZ2V0UGF1c2VkKCkudGhlbigocGF1c2VkKSA9PiB7XG4gICAgICAgIGFzc3VyZVBsYXliYWNrU3RhdGUuY2FsbChwbGF5ZXIsICFwYXVzZWQpO1xuICAgICAgICBpZiAoIXBhdXNlZCkge1xuICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncGxheWluZycpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKGlzLmVsZW1lbnQocGxheWVyLmVtYmVkLmVsZW1lbnQpICYmIHBsYXllci5zdXBwb3J0ZWQudWkpIHtcbiAgICAgICAgY29uc3QgZnJhbWUgPSBwbGF5ZXIuZW1iZWQuZWxlbWVudDtcblxuICAgICAgICAvLyBGaXgga2V5Ym9hcmQgZm9jdXMgaXNzdWVzXG4gICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1wb3R0cy9wbHlyL2lzc3Vlcy8zMTdcbiAgICAgICAgZnJhbWUuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIC0xKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHBsYXllci5lbWJlZC5vbignYnVmZmVyc3RhcnQnLCAoKSA9PiB7XG4gICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3dhaXRpbmcnKTtcbiAgICB9KTtcblxuICAgIHBsYXllci5lbWJlZC5vbignYnVmZmVyZW5kJywgKCkgPT4ge1xuICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdwbGF5aW5nJyk7XG4gICAgfSk7XG5cbiAgICBwbGF5ZXIuZW1iZWQub24oJ3BsYXknLCAoKSA9PiB7XG4gICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCB0cnVlKTtcbiAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncGxheWluZycpO1xuICAgIH0pO1xuXG4gICAgcGxheWVyLmVtYmVkLm9uKCdwYXVzZScsICgpID0+IHtcbiAgICAgIGFzc3VyZVBsYXliYWNrU3RhdGUuY2FsbChwbGF5ZXIsIGZhbHNlKTtcbiAgICB9KTtcblxuICAgIHBsYXllci5lbWJlZC5vbigndGltZXVwZGF0ZScsIChkYXRhKSA9PiB7XG4gICAgICBwbGF5ZXIubWVkaWEuc2Vla2luZyA9IGZhbHNlO1xuICAgICAgY3VycmVudFRpbWUgPSBkYXRhLnNlY29uZHM7XG4gICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3RpbWV1cGRhdGUnKTtcbiAgICB9KTtcblxuICAgIHBsYXllci5lbWJlZC5vbigncHJvZ3Jlc3MnLCAoZGF0YSkgPT4ge1xuICAgICAgcGxheWVyLm1lZGlhLmJ1ZmZlcmVkID0gZGF0YS5wZXJjZW50O1xuICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdwcm9ncmVzcycpO1xuXG4gICAgICAvLyBDaGVjayBhbGwgbG9hZGVkXG4gICAgICBpZiAocGFyc2VJbnQoZGF0YS5wZXJjZW50LCAxMCkgPT09IDEpIHtcbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdjYW5wbGF5dGhyb3VnaCcpO1xuICAgICAgfVxuXG4gICAgICAvLyBHZXQgZHVyYXRpb24gYXMgaWYgd2UgZG8gaXQgYmVmb3JlIGxvYWQsIGl0IGdpdmVzIGFuIGluY29ycmVjdCB2YWx1ZVxuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzg5MVxuICAgICAgcGxheWVyLmVtYmVkLmdldER1cmF0aW9uKCkudGhlbigodmFsdWUpID0+IHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSBwbGF5ZXIubWVkaWEuZHVyYXRpb24pIHtcbiAgICAgICAgICBwbGF5ZXIubWVkaWEuZHVyYXRpb24gPSB2YWx1ZTtcbiAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2R1cmF0aW9uY2hhbmdlJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgcGxheWVyLmVtYmVkLm9uKCdzZWVrZWQnLCAoKSA9PiB7XG4gICAgICBwbGF5ZXIubWVkaWEuc2Vla2luZyA9IGZhbHNlO1xuICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdzZWVrZWQnKTtcbiAgICB9KTtcblxuICAgIHBsYXllci5lbWJlZC5vbignZW5kZWQnLCAoKSA9PiB7XG4gICAgICBwbGF5ZXIubWVkaWEucGF1c2VkID0gdHJ1ZTtcbiAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZW5kZWQnKTtcbiAgICB9KTtcblxuICAgIHBsYXllci5lbWJlZC5vbignZXJyb3InLCAoZGV0YWlsKSA9PiB7XG4gICAgICBwbGF5ZXIubWVkaWEuZXJyb3IgPSBkZXRhaWw7XG4gICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2Vycm9yJyk7XG4gICAgfSk7XG5cbiAgICAvLyBSZWJ1aWxkIFVJXG4gICAgaWYgKGNvbmZpZy5jdXN0b21Db250cm9scykge1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB1aS5idWlsZC5jYWxsKHBsYXllciksIDApO1xuICAgIH1cbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHZpbWVvO1xuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFlvdVR1YmUgcGx1Z2luXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgdWkgZnJvbSAnLi4vdWknO1xuaW1wb3J0IHsgY3JlYXRlRWxlbWVudCwgcmVwbGFjZUVsZW1lbnQsIHRvZ2dsZUNsYXNzIH0gZnJvbSAnLi4vdXRpbHMvZWxlbWVudHMnO1xuaW1wb3J0IHsgdHJpZ2dlckV2ZW50IH0gZnJvbSAnLi4vdXRpbHMvZXZlbnRzJztcbmltcG9ydCBmZXRjaCBmcm9tICcuLi91dGlscy9mZXRjaCc7XG5pbXBvcnQgaXMgZnJvbSAnLi4vdXRpbHMvaXMnO1xuaW1wb3J0IGxvYWRJbWFnZSBmcm9tICcuLi91dGlscy9sb2FkLWltYWdlJztcbmltcG9ydCBsb2FkU2NyaXB0IGZyb20gJy4uL3V0aWxzL2xvYWQtc2NyaXB0JztcbmltcG9ydCB7IGV4dGVuZCB9IGZyb20gJy4uL3V0aWxzL29iamVjdHMnO1xuaW1wb3J0IHsgZm9ybWF0LCBnZW5lcmF0ZUlkIH0gZnJvbSAnLi4vdXRpbHMvc3RyaW5ncyc7XG5pbXBvcnQgeyByb3VuZEFzcGVjdFJhdGlvLCBzZXRBc3BlY3RSYXRpbyB9IGZyb20gJy4uL3V0aWxzL3N0eWxlJztcblxuLy8gUGFyc2UgWW91VHViZSBJRCBmcm9tIFVSTFxuZnVuY3Rpb24gcGFyc2VJZCh1cmwpIHtcbiAgaWYgKGlzLmVtcHR5KHVybCkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGNvbnN0IHJlZ2V4ID0gL14uKih5b3V0dS5iZVxcL3x2XFwvfHVcXC9cXHdcXC98ZW1iZWRcXC98d2F0Y2hcXD92PXwmdj0pKFteIyY/XSopLiovO1xuICByZXR1cm4gdXJsLm1hdGNoKHJlZ2V4KSA/IFJlZ0V4cC4kMiA6IHVybDtcbn1cblxuLy8gU2V0IHBsYXliYWNrIHN0YXRlIGFuZCB0cmlnZ2VyIGNoYW5nZSAob25seSBvbiBhY3R1YWwgY2hhbmdlKVxuZnVuY3Rpb24gYXNzdXJlUGxheWJhY2tTdGF0ZShwbGF5KSB7XG4gIGlmIChwbGF5ICYmICF0aGlzLmVtYmVkLmhhc1BsYXllZCkge1xuICAgIHRoaXMuZW1iZWQuaGFzUGxheWVkID0gdHJ1ZTtcbiAgfVxuICBpZiAodGhpcy5tZWRpYS5wYXVzZWQgPT09IHBsYXkpIHtcbiAgICB0aGlzLm1lZGlhLnBhdXNlZCA9ICFwbGF5O1xuICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMsIHRoaXMubWVkaWEsIHBsYXkgPyAncGxheScgOiAncGF1c2UnKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRIb3N0KGNvbmZpZykge1xuICBpZiAoY29uZmlnLm5vQ29va2llKSB7XG4gICAgcmV0dXJuICdodHRwczovL3d3dy55b3V0dWJlLW5vY29va2llLmNvbSc7XG4gIH1cblxuICBpZiAod2luZG93LmxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cDonKSB7XG4gICAgcmV0dXJuICdodHRwOi8vd3d3LnlvdXR1YmUuY29tJztcbiAgfVxuXG4gIC8vIFVzZSBZb3VUdWJlJ3MgZGVmYXVsdFxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG5jb25zdCB5b3V0dWJlID0ge1xuICBzZXR1cCgpIHtcbiAgICAvLyBBZGQgZW1iZWQgY2xhc3MgZm9yIHJlc3BvbnNpdmVcbiAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLndyYXBwZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuZW1iZWQsIHRydWUpO1xuXG4gICAgLy8gU2V0dXAgQVBJXG4gICAgaWYgKGlzLm9iamVjdCh3aW5kb3cuWVQpICYmIGlzLmZ1bmN0aW9uKHdpbmRvdy5ZVC5QbGF5ZXIpKSB7XG4gICAgICB5b3V0dWJlLnJlYWR5LmNhbGwodGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFJlZmVyZW5jZSBjdXJyZW50IGdsb2JhbCBjYWxsYmFja1xuICAgICAgY29uc3QgY2FsbGJhY2sgPSB3aW5kb3cub25Zb3VUdWJlSWZyYW1lQVBJUmVhZHk7XG5cbiAgICAgIC8vIFNldCBjYWxsYmFjayB0byBwcm9jZXNzIHF1ZXVlXG4gICAgICB3aW5kb3cub25Zb3VUdWJlSWZyYW1lQVBJUmVhZHkgPSAoKSA9PiB7XG4gICAgICAgIC8vIENhbGwgZ2xvYmFsIGNhbGxiYWNrIGlmIHNldFxuICAgICAgICBpZiAoaXMuZnVuY3Rpb24oY2FsbGJhY2spKSB7XG4gICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHlvdXR1YmUucmVhZHkuY2FsbCh0aGlzKTtcbiAgICAgIH07XG5cbiAgICAgIC8vIExvYWQgdGhlIFNES1xuICAgICAgbG9hZFNjcmlwdCh0aGlzLmNvbmZpZy51cmxzLnlvdXR1YmUuc2RrKS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdZb3VUdWJlIEFQSSBmYWlsZWQgdG8gbG9hZCcsIGVycm9yKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSxcblxuICAvLyBHZXQgdGhlIG1lZGlhIHRpdGxlXG4gIGdldFRpdGxlKHZpZGVvSWQpIHtcbiAgICBjb25zdCB1cmwgPSBmb3JtYXQodGhpcy5jb25maWcudXJscy55b3V0dWJlLmFwaSwgdmlkZW9JZCk7XG5cbiAgICBmZXRjaCh1cmwpXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICBpZiAoaXMub2JqZWN0KGRhdGEpKSB7XG4gICAgICAgICAgY29uc3QgeyB0aXRsZSwgaGVpZ2h0LCB3aWR0aCB9ID0gZGF0YTtcblxuICAgICAgICAgIC8vIFNldCB0aXRsZVxuICAgICAgICAgIHRoaXMuY29uZmlnLnRpdGxlID0gdGl0bGU7XG4gICAgICAgICAgdWkuc2V0VGl0bGUuY2FsbCh0aGlzKTtcblxuICAgICAgICAgIC8vIFNldCBhc3BlY3QgcmF0aW9cbiAgICAgICAgICB0aGlzLmVtYmVkLnJhdGlvID0gcm91bmRBc3BlY3RSYXRpbyh3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNldEFzcGVjdFJhdGlvLmNhbGwodGhpcyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKCgpID0+IHtcbiAgICAgICAgLy8gU2V0IGFzcGVjdCByYXRpb1xuICAgICAgICBzZXRBc3BlY3RSYXRpby5jYWxsKHRoaXMpO1xuICAgICAgfSk7XG4gIH0sXG5cbiAgLy8gQVBJIHJlYWR5XG4gIHJlYWR5KCkge1xuICAgIGNvbnN0IHBsYXllciA9IHRoaXM7XG4gICAgY29uc3QgY29uZmlnID0gcGxheWVyLmNvbmZpZy55b3V0dWJlO1xuICAgIC8vIElnbm9yZSBhbHJlYWR5IHNldHVwIChyYWNlIGNvbmRpdGlvbilcbiAgICBjb25zdCBjdXJyZW50SWQgPSBwbGF5ZXIubWVkaWEgJiYgcGxheWVyLm1lZGlhLmdldEF0dHJpYnV0ZSgnaWQnKTtcbiAgICBpZiAoIWlzLmVtcHR5KGN1cnJlbnRJZCkgJiYgY3VycmVudElkLnN0YXJ0c1dpdGgoJ3lvdXR1YmUtJykpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIHNvdXJjZSBVUkwgb3IgSURcbiAgICBsZXQgc291cmNlID0gcGxheWVyLm1lZGlhLmdldEF0dHJpYnV0ZSgnc3JjJyk7XG5cbiAgICAvLyBHZXQgZnJvbSA8ZGl2PiBpZiBuZWVkZWRcbiAgICBpZiAoaXMuZW1wdHkoc291cmNlKSkge1xuICAgICAgc291cmNlID0gcGxheWVyLm1lZGlhLmdldEF0dHJpYnV0ZSh0aGlzLmNvbmZpZy5hdHRyaWJ1dGVzLmVtYmVkLmlkKTtcbiAgICB9XG5cbiAgICAvLyBSZXBsYWNlIHRoZSA8aWZyYW1lPiB3aXRoIGEgPGRpdj4gZHVlIHRvIFlvdVR1YmUgQVBJIGlzc3Vlc1xuICAgIGNvbnN0IHZpZGVvSWQgPSBwYXJzZUlkKHNvdXJjZSk7XG4gICAgY29uc3QgaWQgPSBnZW5lcmF0ZUlkKHBsYXllci5wcm92aWRlcik7XG4gICAgLy8gUmVwbGFjZSBtZWRpYSBlbGVtZW50XG4gICAgY29uc3QgY29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2JywgeyBpZCwgJ2RhdGEtcG9zdGVyJzogY29uZmlnLmN1c3RvbUNvbnRyb2xzID8gcGxheWVyLnBvc3RlciA6IHVuZGVmaW5lZCB9KTtcbiAgICBwbGF5ZXIubWVkaWEgPSByZXBsYWNlRWxlbWVudChjb250YWluZXIsIHBsYXllci5tZWRpYSk7XG5cbiAgICAvLyBPbmx5IGxvYWQgdGhlIHBvc3RlciB3aGVuIHVzaW5nIGN1c3RvbSBjb250cm9sc1xuICAgIGlmIChjb25maWcuY3VzdG9tQ29udHJvbHMpIHtcbiAgICAgIGNvbnN0IHBvc3RlclNyYyA9IChzKSA9PiBgaHR0cHM6Ly9pLnl0aW1nLmNvbS92aS8ke3ZpZGVvSWR9LyR7c31kZWZhdWx0LmpwZ2A7XG5cbiAgICAgIC8vIENoZWNrIHRodW1ibmFpbCBpbWFnZXMgaW4gb3JkZXIgb2YgcXVhbGl0eSwgYnV0IHJlamVjdCBmYWxsYmFjayB0aHVtYm5haWxzICgxMjBweCB3aWRlKVxuICAgICAgbG9hZEltYWdlKHBvc3RlclNyYygnbWF4cmVzJyksIDEyMSkgLy8gSGlnZXN0IHF1YWxpdHkgYW5kIHVucGFkZGVkXG4gICAgICAgIC5jYXRjaCgoKSA9PiBsb2FkSW1hZ2UocG9zdGVyU3JjKCdzZCcpLCAxMjEpKSAvLyA0ODBwIHBhZGRlZCA0OjNcbiAgICAgICAgLmNhdGNoKCgpID0+IGxvYWRJbWFnZShwb3N0ZXJTcmMoJ2hxJykpKSAvLyAzNjBwIHBhZGRlZCA0OjMuIEFsd2F5cyBleGlzdHNcbiAgICAgICAgLnRoZW4oKGltYWdlKSA9PiB1aS5zZXRQb3N0ZXIuY2FsbChwbGF5ZXIsIGltYWdlLnNyYykpXG4gICAgICAgIC50aGVuKChzcmMpID0+IHtcbiAgICAgICAgICAvLyBJZiB0aGUgaW1hZ2UgaXMgcGFkZGVkLCB1c2UgYmFja2dyb3VuZC1zaXplIFwiY292ZXJcIiBpbnN0ZWFkIChsaWtlIHlvdXR1YmUgZG9lcyB0b28gd2l0aCB0aGVpciBwb3N0ZXJzKVxuICAgICAgICAgIGlmICghc3JjLmluY2x1ZGVzKCdtYXhyZXMnKSkge1xuICAgICAgICAgICAgcGxheWVyLmVsZW1lbnRzLnBvc3Rlci5zdHlsZS5iYWNrZ3JvdW5kU2l6ZSA9ICdjb3Zlcic7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKCkgPT4ge30pO1xuICAgIH1cblxuICAgIC8vIFNldHVwIGluc3RhbmNlXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20veW91dHViZS9pZnJhbWVfYXBpX3JlZmVyZW5jZVxuICAgIHBsYXllci5lbWJlZCA9IG5ldyB3aW5kb3cuWVQuUGxheWVyKHBsYXllci5tZWRpYSwge1xuICAgICAgdmlkZW9JZCxcbiAgICAgIGhvc3Q6IGdldEhvc3QoY29uZmlnKSxcbiAgICAgIHBsYXllclZhcnM6IGV4dGVuZChcbiAgICAgICAge30sXG4gICAgICAgIHtcbiAgICAgICAgICAvLyBBdXRvcGxheVxuICAgICAgICAgIGF1dG9wbGF5OiBwbGF5ZXIuY29uZmlnLmF1dG9wbGF5ID8gMSA6IDAsXG4gICAgICAgICAgLy8gaWZyYW1lIGludGVyZmFjZSBsYW5ndWFnZVxuICAgICAgICAgIGhsOiBwbGF5ZXIuY29uZmlnLmhsLFxuICAgICAgICAgIC8vIE9ubHkgc2hvdyBjb250cm9scyBpZiBub3QgZnVsbHkgc3VwcG9ydGVkIG9yIG9wdGVkIG91dFxuICAgICAgICAgIGNvbnRyb2xzOiBwbGF5ZXIuc3VwcG9ydGVkLnVpICYmIGNvbmZpZy5jdXN0b21Db250cm9scyA/IDAgOiAxLFxuICAgICAgICAgIC8vIERpc2FibGUga2V5Ym9hcmQgYXMgd2UgaGFuZGxlIGl0XG4gICAgICAgICAgZGlzYWJsZWtiOiAxLFxuICAgICAgICAgIC8vIEFsbG93IGlPUyBpbmxpbmUgcGxheWJhY2tcbiAgICAgICAgICBwbGF5c2lubGluZTogIXBsYXllci5jb25maWcuZnVsbHNjcmVlbi5pb3NOYXRpdmUgPyAxIDogMCxcbiAgICAgICAgICAvLyBDYXB0aW9ucyBhcmUgZmxha3kgb24gWW91VHViZVxuICAgICAgICAgIGNjX2xvYWRfcG9saWN5OiBwbGF5ZXIuY2FwdGlvbnMuYWN0aXZlID8gMSA6IDAsXG4gICAgICAgICAgY2NfbGFuZ19wcmVmOiBwbGF5ZXIuY29uZmlnLmNhcHRpb25zLmxhbmd1YWdlLFxuICAgICAgICAgIC8vIFRyYWNraW5nIGZvciBzdGF0c1xuICAgICAgICAgIHdpZGdldF9yZWZlcnJlcjogd2luZG93ID8gd2luZG93LmxvY2F0aW9uLmhyZWYgOiBudWxsLFxuICAgICAgICB9LFxuICAgICAgICBjb25maWcsXG4gICAgICApLFxuICAgICAgZXZlbnRzOiB7XG4gICAgICAgIG9uRXJyb3IoZXZlbnQpIHtcbiAgICAgICAgICAvLyBZb3VUdWJlIG1heSBmaXJlIG9uRXJyb3IgdHdpY2UsIHNvIG9ubHkgaGFuZGxlIGl0IG9uY2VcbiAgICAgICAgICBpZiAoIXBsYXllci5tZWRpYS5lcnJvcikge1xuICAgICAgICAgICAgY29uc3QgY29kZSA9IGV2ZW50LmRhdGE7XG4gICAgICAgICAgICAvLyBNZXNzYWdlcyBjb3BpZWQgZnJvbSBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS95b3V0dWJlL2lmcmFtZV9hcGlfcmVmZXJlbmNlI29uRXJyb3JcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPVxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgMjogJ1RoZSByZXF1ZXN0IGNvbnRhaW5zIGFuIGludmFsaWQgcGFyYW1ldGVyIHZhbHVlLiBGb3IgZXhhbXBsZSwgdGhpcyBlcnJvciBvY2N1cnMgaWYgeW91IHNwZWNpZnkgYSB2aWRlbyBJRCB0aGF0IGRvZXMgbm90IGhhdmUgMTEgY2hhcmFjdGVycywgb3IgaWYgdGhlIHZpZGVvIElEIGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycywgc3VjaCBhcyBleGNsYW1hdGlvbiBwb2ludHMgb3IgYXN0ZXJpc2tzLicsXG4gICAgICAgICAgICAgICAgNTogJ1RoZSByZXF1ZXN0ZWQgY29udGVudCBjYW5ub3QgYmUgcGxheWVkIGluIGFuIEhUTUw1IHBsYXllciBvciBhbm90aGVyIGVycm9yIHJlbGF0ZWQgdG8gdGhlIEhUTUw1IHBsYXllciBoYXMgb2NjdXJyZWQuJyxcbiAgICAgICAgICAgICAgICAxMDA6ICdUaGUgdmlkZW8gcmVxdWVzdGVkIHdhcyBub3QgZm91bmQuIFRoaXMgZXJyb3Igb2NjdXJzIHdoZW4gYSB2aWRlbyBoYXMgYmVlbiByZW1vdmVkIChmb3IgYW55IHJlYXNvbikgb3IgaGFzIGJlZW4gbWFya2VkIGFzIHByaXZhdGUuJyxcbiAgICAgICAgICAgICAgICAxMDE6ICdUaGUgb3duZXIgb2YgdGhlIHJlcXVlc3RlZCB2aWRlbyBkb2VzIG5vdCBhbGxvdyBpdCB0byBiZSBwbGF5ZWQgaW4gZW1iZWRkZWQgcGxheWVycy4nLFxuICAgICAgICAgICAgICAgIDE1MDogJ1RoZSBvd25lciBvZiB0aGUgcmVxdWVzdGVkIHZpZGVvIGRvZXMgbm90IGFsbG93IGl0IHRvIGJlIHBsYXllZCBpbiBlbWJlZGRlZCBwbGF5ZXJzLicsXG4gICAgICAgICAgICAgIH1bY29kZV0gfHwgJ0FuIHVua25vd24gZXJyb3Igb2NjdXJlZCc7XG5cbiAgICAgICAgICAgIHBsYXllci5tZWRpYS5lcnJvciA9IHsgY29kZSwgbWVzc2FnZSB9O1xuXG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2Vycm9yJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBvblBsYXliYWNrUmF0ZUNoYW5nZShldmVudCkge1xuICAgICAgICAgIC8vIEdldCB0aGUgaW5zdGFuY2VcbiAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IGV2ZW50LnRhcmdldDtcblxuICAgICAgICAgIC8vIEdldCBjdXJyZW50IHNwZWVkXG4gICAgICAgICAgcGxheWVyLm1lZGlhLnBsYXliYWNrUmF0ZSA9IGluc3RhbmNlLmdldFBsYXliYWNrUmF0ZSgpO1xuXG4gICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdyYXRlY2hhbmdlJyk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uUmVhZHkoZXZlbnQpIHtcbiAgICAgICAgICAvLyBCYWlsIGlmIG9uUmVhZHkgaGFzIGFscmVhZHkgYmVlbiBjYWxsZWQuIFNlZSBpc3N1ZSAjMTEwOFxuICAgICAgICAgIGlmIChpcy5mdW5jdGlvbihwbGF5ZXIubWVkaWEucGxheSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gR2V0IHRoZSBpbnN0YW5jZVxuICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gZXZlbnQudGFyZ2V0O1xuXG4gICAgICAgICAgLy8gR2V0IHRoZSB0aXRsZVxuICAgICAgICAgIHlvdXR1YmUuZ2V0VGl0bGUuY2FsbChwbGF5ZXIsIHZpZGVvSWQpO1xuXG4gICAgICAgICAgLy8gQ3JlYXRlIGEgZmF1eCBIVE1MNSBBUEkgdXNpbmcgdGhlIFlvdVR1YmUgQVBJXG4gICAgICAgICAgcGxheWVyLm1lZGlhLnBsYXkgPSAoKSA9PiB7XG4gICAgICAgICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCB0cnVlKTtcbiAgICAgICAgICAgIGluc3RhbmNlLnBsYXlWaWRlbygpO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICBwbGF5ZXIubWVkaWEucGF1c2UgPSAoKSA9PiB7XG4gICAgICAgICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCBmYWxzZSk7XG4gICAgICAgICAgICBpbnN0YW5jZS5wYXVzZVZpZGVvKCk7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHBsYXllci5tZWRpYS5zdG9wID0gKCkgPT4ge1xuICAgICAgICAgICAgaW5zdGFuY2Uuc3RvcFZpZGVvKCk7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHBsYXllci5tZWRpYS5kdXJhdGlvbiA9IGluc3RhbmNlLmdldER1cmF0aW9uKCk7XG4gICAgICAgICAgcGxheWVyLm1lZGlhLnBhdXNlZCA9IHRydWU7XG5cbiAgICAgICAgICAvLyBTZWVraW5nXG4gICAgICAgICAgcGxheWVyLm1lZGlhLmN1cnJlbnRUaW1lID0gMDtcbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnY3VycmVudFRpbWUnLCB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBOdW1iZXIoaW5zdGFuY2UuZ2V0Q3VycmVudFRpbWUoKSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0KHRpbWUpIHtcbiAgICAgICAgICAgICAgLy8gSWYgcGF1c2VkIGFuZCBuZXZlciBwbGF5ZWQsIG11dGUgYXVkaW8gcHJldmVudGl2ZWx5IChZb3VUdWJlIHN0YXJ0cyBwbGF5aW5nIG9uIHNlZWsgaWYgdGhlIHZpZGVvIGhhc24ndCBiZWVuIHBsYXllZCB5ZXQpLlxuICAgICAgICAgICAgICBpZiAocGxheWVyLnBhdXNlZCAmJiAhcGxheWVyLmVtYmVkLmhhc1BsYXllZCkge1xuICAgICAgICAgICAgICAgIHBsYXllci5lbWJlZC5tdXRlKCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyBTZXQgc2Vla2luZyBzdGF0ZSBhbmQgdHJpZ2dlciBldmVudFxuICAgICAgICAgICAgICBwbGF5ZXIubWVkaWEuc2Vla2luZyA9IHRydWU7XG4gICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnc2Vla2luZycpO1xuXG4gICAgICAgICAgICAgIC8vIFNlZWsgYWZ0ZXIgZXZlbnRzIHNlbnRcbiAgICAgICAgICAgICAgaW5zdGFuY2Uuc2Vla1RvKHRpbWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIFBsYXliYWNrIHNwZWVkXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ3BsYXliYWNrUmF0ZScsIHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGluc3RhbmNlLmdldFBsYXliYWNrUmF0ZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldChpbnB1dCkge1xuICAgICAgICAgICAgICBpbnN0YW5jZS5zZXRQbGF5YmFja1JhdGUoaW5wdXQpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIFZvbHVtZVxuICAgICAgICAgIGxldCB7IHZvbHVtZSB9ID0gcGxheWVyLmNvbmZpZztcbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAndm9sdW1lJywge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gdm9sdW1lO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldChpbnB1dCkge1xuICAgICAgICAgICAgICB2b2x1bWUgPSBpbnB1dDtcbiAgICAgICAgICAgICAgaW5zdGFuY2Uuc2V0Vm9sdW1lKHZvbHVtZSAqIDEwMCk7XG4gICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndm9sdW1lY2hhbmdlJyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gTXV0ZWRcbiAgICAgICAgICBsZXQgeyBtdXRlZCB9ID0gcGxheWVyLmNvbmZpZztcbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnbXV0ZWQnLCB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtdXRlZDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgICAgICAgY29uc3QgdG9nZ2xlID0gaXMuYm9vbGVhbihpbnB1dCkgPyBpbnB1dCA6IG11dGVkO1xuICAgICAgICAgICAgICBtdXRlZCA9IHRvZ2dsZTtcbiAgICAgICAgICAgICAgaW5zdGFuY2VbdG9nZ2xlID8gJ211dGUnIDogJ3VuTXV0ZSddKCk7XG4gICAgICAgICAgICAgIGluc3RhbmNlLnNldFZvbHVtZSh2b2x1bWUgKiAxMDApO1xuICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3ZvbHVtZWNoYW5nZScpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIFNvdXJjZVxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwbGF5ZXIubWVkaWEsICdjdXJyZW50U3JjJywge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gaW5zdGFuY2UuZ2V0VmlkZW9VcmwoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBFbmRlZFxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwbGF5ZXIubWVkaWEsICdlbmRlZCcsIHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHBsYXllci5jdXJyZW50VGltZSA9PT0gcGxheWVyLmR1cmF0aW9uO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIEdldCBhdmFpbGFibGUgc3BlZWRzXG4gICAgICAgICAgY29uc3Qgc3BlZWRzID0gaW5zdGFuY2UuZ2V0QXZhaWxhYmxlUGxheWJhY2tSYXRlcygpO1xuICAgICAgICAgIC8vIEZpbHRlciBiYXNlZCBvbiBjb25maWdcbiAgICAgICAgICBwbGF5ZXIub3B0aW9ucy5zcGVlZCA9IHNwZWVkcy5maWx0ZXIoKHMpID0+IHBsYXllci5jb25maWcuc3BlZWQub3B0aW9ucy5pbmNsdWRlcyhzKSk7XG5cbiAgICAgICAgICAvLyBTZXQgdGhlIHRhYmluZGV4IHRvIGF2b2lkIGZvY3VzIGVudGVyaW5nIGlmcmFtZVxuICAgICAgICAgIGlmIChwbGF5ZXIuc3VwcG9ydGVkLnVpICYmIGNvbmZpZy5jdXN0b21Db250cm9scykge1xuICAgICAgICAgICAgcGxheWVyLm1lZGlhLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAtMSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd0aW1ldXBkYXRlJyk7XG4gICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdkdXJhdGlvbmNoYW5nZScpO1xuXG4gICAgICAgICAgLy8gUmVzZXQgdGltZXJcbiAgICAgICAgICBjbGVhckludGVydmFsKHBsYXllci50aW1lcnMuYnVmZmVyaW5nKTtcblxuICAgICAgICAgIC8vIFNldHVwIGJ1ZmZlcmluZ1xuICAgICAgICAgIHBsYXllci50aW1lcnMuYnVmZmVyaW5nID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgLy8gR2V0IGxvYWRlZCAlIGZyb20gWW91VHViZVxuICAgICAgICAgICAgcGxheWVyLm1lZGlhLmJ1ZmZlcmVkID0gaW5zdGFuY2UuZ2V0VmlkZW9Mb2FkZWRGcmFjdGlvbigpO1xuXG4gICAgICAgICAgICAvLyBUcmlnZ2VyIHByb2dyZXNzIG9ubHkgd2hlbiB3ZSBhY3R1YWxseSBidWZmZXIgc29tZXRoaW5nXG4gICAgICAgICAgICBpZiAocGxheWVyLm1lZGlhLmxhc3RCdWZmZXJlZCA9PT0gbnVsbCB8fCBwbGF5ZXIubWVkaWEubGFzdEJ1ZmZlcmVkIDwgcGxheWVyLm1lZGlhLmJ1ZmZlcmVkKSB7XG4gICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncHJvZ3Jlc3MnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2V0IGxhc3QgYnVmZmVyIHBvaW50XG4gICAgICAgICAgICBwbGF5ZXIubWVkaWEubGFzdEJ1ZmZlcmVkID0gcGxheWVyLm1lZGlhLmJ1ZmZlcmVkO1xuXG4gICAgICAgICAgICAvLyBCYWlsIGlmIHdlJ3JlIGF0IDEwMCVcbiAgICAgICAgICAgIGlmIChwbGF5ZXIubWVkaWEuYnVmZmVyZWQgPT09IDEpIHtcbiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChwbGF5ZXIudGltZXJzLmJ1ZmZlcmluZyk7XG5cbiAgICAgICAgICAgICAgLy8gVHJpZ2dlciBldmVudFxuICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2NhbnBsYXl0aHJvdWdoJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgMjAwKTtcblxuICAgICAgICAgIC8vIFJlYnVpbGQgVUlcbiAgICAgICAgICBpZiAoY29uZmlnLmN1c3RvbUNvbnRyb2xzKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHVpLmJ1aWxkLmNhbGwocGxheWVyKSwgNTApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgb25TdGF0ZUNoYW5nZShldmVudCkge1xuICAgICAgICAgIC8vIEdldCB0aGUgaW5zdGFuY2VcbiAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IGV2ZW50LnRhcmdldDtcblxuICAgICAgICAgIC8vIFJlc2V0IHRpbWVyXG4gICAgICAgICAgY2xlYXJJbnRlcnZhbChwbGF5ZXIudGltZXJzLnBsYXlpbmcpO1xuXG4gICAgICAgICAgY29uc3Qgc2Vla2VkID0gcGxheWVyLm1lZGlhLnNlZWtpbmcgJiYgWzEsIDJdLmluY2x1ZGVzKGV2ZW50LmRhdGEpO1xuXG4gICAgICAgICAgaWYgKHNlZWtlZCkge1xuICAgICAgICAgICAgLy8gVW5zZXQgc2Vla2luZyBhbmQgZmlyZSBzZWVrZWQgZXZlbnRcbiAgICAgICAgICAgIHBsYXllci5tZWRpYS5zZWVraW5nID0gZmFsc2U7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3NlZWtlZCcpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEhhbmRsZSBldmVudHNcbiAgICAgICAgICAvLyAtMSAgIFVuc3RhcnRlZFxuICAgICAgICAgIC8vIDAgICAgRW5kZWRcbiAgICAgICAgICAvLyAxICAgIFBsYXlpbmdcbiAgICAgICAgICAvLyAyICAgIFBhdXNlZFxuICAgICAgICAgIC8vIDMgICAgQnVmZmVyaW5nXG4gICAgICAgICAgLy8gNSAgICBWaWRlbyBjdWVkXG4gICAgICAgICAgc3dpdGNoIChldmVudC5kYXRhKSB7XG4gICAgICAgICAgICBjYXNlIC0xOlxuICAgICAgICAgICAgICAvLyBVcGRhdGUgc2NydWJiZXJcbiAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd0aW1ldXBkYXRlJyk7XG5cbiAgICAgICAgICAgICAgLy8gR2V0IGxvYWRlZCAlIGZyb20gWW91VHViZVxuICAgICAgICAgICAgICBwbGF5ZXIubWVkaWEuYnVmZmVyZWQgPSBpbnN0YW5jZS5nZXRWaWRlb0xvYWRlZEZyYWN0aW9uKCk7XG4gICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncHJvZ3Jlc3MnKTtcblxuICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgLy8gWW91VHViZSBkb2Vzbid0IHN1cHBvcnQgbG9vcCBmb3IgYSBzaW5nbGUgdmlkZW8sIHNvIG1pbWljayBpdC5cbiAgICAgICAgICAgICAgaWYgKHBsYXllci5tZWRpYS5sb29wKSB7XG4gICAgICAgICAgICAgICAgLy8gWW91VHViZSBuZWVkcyBhIGNhbGwgdG8gYHN0b3BWaWRlb2AgYmVmb3JlIHBsYXlpbmcgYWdhaW5cbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5zdG9wVmlkZW8oKTtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5wbGF5VmlkZW8oKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2VuZGVkJyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAvLyBSZXN0b3JlIHBhdXNlZCBzdGF0ZSAoWW91VHViZSBzdGFydHMgcGxheWluZyBvbiBzZWVrIGlmIHRoZSB2aWRlbyBoYXNuJ3QgYmVlbiBwbGF5ZWQgeWV0KVxuICAgICAgICAgICAgICBpZiAoY29uZmlnLmN1c3RvbUNvbnRyb2xzICYmICFwbGF5ZXIuY29uZmlnLmF1dG9wbGF5ICYmIHBsYXllci5tZWRpYS5wYXVzZWQgJiYgIXBsYXllci5lbWJlZC5oYXNQbGF5ZWQpIHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIubWVkaWEucGF1c2UoKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCB0cnVlKTtcblxuICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncGxheWluZycpO1xuXG4gICAgICAgICAgICAgICAgLy8gUG9sbCB0byBnZXQgcGxheWJhY2sgcHJvZ3Jlc3NcbiAgICAgICAgICAgICAgICBwbGF5ZXIudGltZXJzLnBsYXlpbmcgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3RpbWV1cGRhdGUnKTtcbiAgICAgICAgICAgICAgICB9LCA1MCk7XG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBkdXJhdGlvbiBhZ2FpbiBkdWUgdG8gWW91VHViZSBidWdcbiAgICAgICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vc2FtcG90dHMvcGx5ci9pc3N1ZXMvMzc0XG4gICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9nZGF0YS1pc3N1ZXMvaXNzdWVzL2RldGFpbD9pZD04NjkwXG4gICAgICAgICAgICAgICAgaWYgKHBsYXllci5tZWRpYS5kdXJhdGlvbiAhPT0gaW5zdGFuY2UuZ2V0RHVyYXRpb24oKSkge1xuICAgICAgICAgICAgICAgICAgcGxheWVyLm1lZGlhLmR1cmF0aW9uID0gaW5zdGFuY2UuZ2V0RHVyYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZHVyYXRpb25jaGFuZ2UnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAvLyBSZXN0b3JlIGF1ZGlvIChZb3VUdWJlIHN0YXJ0cyBwbGF5aW5nIG9uIHNlZWsgaWYgdGhlIHZpZGVvIGhhc24ndCBiZWVuIHBsYXllZCB5ZXQpXG4gICAgICAgICAgICAgIGlmICghcGxheWVyLm11dGVkKSB7XG4gICAgICAgICAgICAgICAgcGxheWVyLmVtYmVkLnVuTXV0ZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGFzc3VyZVBsYXliYWNrU3RhdGUuY2FsbChwbGF5ZXIsIGZhbHNlKTtcblxuICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAvLyBUcmlnZ2VyIHdhaXRpbmcgZXZlbnQgdG8gYWRkIGxvYWRpbmcgY2xhc3NlcyB0byBjb250YWluZXIgYXMgdGhlIHZpZGVvIGJ1ZmZlcnMuXG4gICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnd2FpdGluZycpO1xuXG4gICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5lbGVtZW50cy5jb250YWluZXIsICdzdGF0ZWNoYW5nZScsIGZhbHNlLCB7XG4gICAgICAgICAgICBjb2RlOiBldmVudC5kYXRhLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHlvdXR1YmU7XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUGx5ciBNZWRpYVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IGh0bWw1IGZyb20gJy4vaHRtbDUnO1xuaW1wb3J0IHZpbWVvIGZyb20gJy4vcGx1Z2lucy92aW1lbyc7XG5pbXBvcnQgeW91dHViZSBmcm9tICcuL3BsdWdpbnMveW91dHViZSc7XG5pbXBvcnQgeyBjcmVhdGVFbGVtZW50LCB0b2dnbGVDbGFzcywgd3JhcCB9IGZyb20gJy4vdXRpbHMvZWxlbWVudHMnO1xuXG5jb25zdCBtZWRpYSA9IHtcbiAgLy8gU2V0dXAgbWVkaWFcbiAgc2V0dXAoKSB7XG4gICAgLy8gSWYgdGhlcmUncyBubyBtZWRpYSwgYmFpbFxuICAgIGlmICghdGhpcy5tZWRpYSkge1xuICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdObyBtZWRpYSBlbGVtZW50IGZvdW5kIScpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEFkZCB0eXBlIGNsYXNzXG4gICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMudHlwZS5yZXBsYWNlKCd7MH0nLCB0aGlzLnR5cGUpLCB0cnVlKTtcblxuICAgIC8vIEFkZCBwcm92aWRlciBjbGFzc1xuICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnByb3ZpZGVyLnJlcGxhY2UoJ3swfScsIHRoaXMucHJvdmlkZXIpLCB0cnVlKTtcblxuICAgIC8vIEFkZCB2aWRlbyBjbGFzcyBmb3IgZW1iZWRzXG4gICAgLy8gVGhpcyB3aWxsIHJlcXVpcmUgY2hhbmdlcyBpZiBhdWRpbyBlbWJlZHMgYXJlIGFkZGVkXG4gICAgaWYgKHRoaXMuaXNFbWJlZCkge1xuICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMudHlwZS5yZXBsYWNlKCd7MH0nLCAndmlkZW8nKSwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgLy8gSW5qZWN0IHRoZSBwbGF5ZXIgd3JhcHBlclxuICAgIGlmICh0aGlzLmlzVmlkZW8pIHtcbiAgICAgIC8vIENyZWF0ZSB0aGUgd3JhcHBlciBkaXZcbiAgICAgIHRoaXMuZWxlbWVudHMud3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgY2xhc3M6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMudmlkZW8sXG4gICAgICB9KTtcblxuICAgICAgLy8gV3JhcCB0aGUgdmlkZW8gaW4gYSBjb250YWluZXJcbiAgICAgIHdyYXAodGhpcy5tZWRpYSwgdGhpcy5lbGVtZW50cy53cmFwcGVyKTtcblxuICAgICAgLy8gUG9zdGVyIGltYWdlIGNvbnRhaW5lclxuICAgICAgdGhpcy5lbGVtZW50cy5wb3N0ZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnBvc3RlcixcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLmVsZW1lbnRzLndyYXBwZXIuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50cy5wb3N0ZXIpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgIGh0bWw1LnNldHVwLmNhbGwodGhpcyk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmlzWW91VHViZSkge1xuICAgICAgeW91dHViZS5zZXR1cC5jYWxsKHRoaXMpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5pc1ZpbWVvKSB7XG4gICAgICB2aW1lby5zZXR1cC5jYWxsKHRoaXMpO1xuICAgIH1cbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IG1lZGlhO1xuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEFkdmVydGlzZW1lbnQgcGx1Z2luIHVzaW5nIEdvb2dsZSBJTUEgSFRNTDUgU0RLXG4vLyBDcmVhdGUgYW4gYWNjb3VudCB3aXRoIG91ciBhZCBwYXJ0bmVyLCB2aSBoZXJlOlxuLy8gaHR0cHM6Ly93d3cudmkuYWkvcHVibGlzaGVyLXZpZGVvLW1vbmV0aXphdGlvbi9cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qIGdsb2JhbCBnb29nbGUgKi9cblxuaW1wb3J0IHsgY3JlYXRlRWxlbWVudCB9IGZyb20gJy4uL3V0aWxzL2VsZW1lbnRzJztcbmltcG9ydCB7IHRyaWdnZXJFdmVudCB9IGZyb20gJy4uL3V0aWxzL2V2ZW50cyc7XG5pbXBvcnQgaTE4biBmcm9tICcuLi91dGlscy9pMThuJztcbmltcG9ydCBpcyBmcm9tICcuLi91dGlscy9pcyc7XG5pbXBvcnQgbG9hZFNjcmlwdCBmcm9tICcuLi91dGlscy9sb2FkLXNjcmlwdCc7XG5pbXBvcnQgeyBzaWxlbmNlUHJvbWlzZSB9IGZyb20gJy4uL3V0aWxzL3Byb21pc2UnO1xuaW1wb3J0IHsgZm9ybWF0VGltZSB9IGZyb20gJy4uL3V0aWxzL3RpbWUnO1xuaW1wb3J0IHsgYnVpbGRVcmxQYXJhbXMgfSBmcm9tICcuLi91dGlscy91cmxzJztcblxuY29uc3QgZGVzdHJveSA9IChpbnN0YW5jZSkgPT4ge1xuICAvLyBEZXN0cm95IG91ciBhZHNNYW5hZ2VyXG4gIGlmIChpbnN0YW5jZS5tYW5hZ2VyKSB7XG4gICAgaW5zdGFuY2UubWFuYWdlci5kZXN0cm95KCk7XG4gIH1cblxuICAvLyBEZXN0cm95IG91ciBhZHNNYW5hZ2VyXG4gIGlmIChpbnN0YW5jZS5lbGVtZW50cy5kaXNwbGF5Q29udGFpbmVyKSB7XG4gICAgaW5zdGFuY2UuZWxlbWVudHMuZGlzcGxheUNvbnRhaW5lci5kZXN0cm95KCk7XG4gIH1cblxuICBpbnN0YW5jZS5lbGVtZW50cy5jb250YWluZXIucmVtb3ZlKCk7XG59O1xuXG5jbGFzcyBBZHMge1xuICAvKipcbiAgICogQWRzIGNvbnN0cnVjdG9yLlxuICAgKiBAcGFyYW0ge09iamVjdH0gcGxheWVyXG4gICAqIEByZXR1cm4ge0Fkc31cbiAgICovXG4gIGNvbnN0cnVjdG9yKHBsYXllcikge1xuICAgIHRoaXMucGxheWVyID0gcGxheWVyO1xuICAgIHRoaXMuY29uZmlnID0gcGxheWVyLmNvbmZpZy5hZHM7XG4gICAgdGhpcy5wbGF5aW5nID0gZmFsc2U7XG4gICAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuICAgIHRoaXMuZWxlbWVudHMgPSB7XG4gICAgICBjb250YWluZXI6IG51bGwsXG4gICAgICBkaXNwbGF5Q29udGFpbmVyOiBudWxsLFxuICAgIH07XG4gICAgdGhpcy5tYW5hZ2VyID0gbnVsbDtcbiAgICB0aGlzLmxvYWRlciA9IG51bGw7XG4gICAgdGhpcy5jdWVQb2ludHMgPSBudWxsO1xuICAgIHRoaXMuZXZlbnRzID0ge307XG4gICAgdGhpcy5zYWZldHlUaW1lciA9IG51bGw7XG4gICAgdGhpcy5jb3VudGRvd25UaW1lciA9IG51bGw7XG5cbiAgICAvLyBTZXR1cCBhIHByb21pc2UgdG8gcmVzb2x2ZSB3aGVuIHRoZSBJTUEgbWFuYWdlciBpcyByZWFkeVxuICAgIHRoaXMubWFuYWdlclByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAvLyBUaGUgYWQgaXMgbG9hZGVkIGFuZCByZWFkeVxuICAgICAgdGhpcy5vbignbG9hZGVkJywgcmVzb2x2ZSk7XG5cbiAgICAgIC8vIEFkcyBmYWlsZWRcbiAgICAgIHRoaXMub24oJ2Vycm9yJywgcmVqZWN0KTtcbiAgICB9KTtcblxuICAgIHRoaXMubG9hZCgpO1xuICB9XG5cbiAgZ2V0IGVuYWJsZWQoKSB7XG4gICAgY29uc3QgeyBjb25maWcgfSA9IHRoaXM7XG5cbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5wbGF5ZXIuaXNIVE1MNSAmJlxuICAgICAgdGhpcy5wbGF5ZXIuaXNWaWRlbyAmJlxuICAgICAgY29uZmlnLmVuYWJsZWQgJiZcbiAgICAgICghaXMuZW1wdHkoY29uZmlnLnB1Ymxpc2hlcklkKSB8fCBpcy51cmwoY29uZmlnLnRhZ1VybCkpXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2FkIHRoZSBJTUEgU0RLXG4gICAqL1xuICBsb2FkID0gKCkgPT4ge1xuICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgdGhlIEdvb2dsZSBJTUEzIFNESyBpcyBsb2FkZWQgb3IgbG9hZCBpdCBvdXJzZWx2ZXNcbiAgICBpZiAoIWlzLm9iamVjdCh3aW5kb3cuZ29vZ2xlKSB8fCAhaXMub2JqZWN0KHdpbmRvdy5nb29nbGUuaW1hKSkge1xuICAgICAgbG9hZFNjcmlwdCh0aGlzLnBsYXllci5jb25maWcudXJscy5nb29nbGVJTUEuc2RrKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgdGhpcy5yZWFkeSgpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgIC8vIFNjcmlwdCBmYWlsZWQgdG8gbG9hZCBvciBpcyBibG9ja2VkXG4gICAgICAgICAgdGhpcy50cmlnZ2VyKCdlcnJvcicsIG5ldyBFcnJvcignR29vZ2xlIElNQSBTREsgZmFpbGVkIHRvIGxvYWQnKSk7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlYWR5KCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGFkcyBpbnN0YW5jZSByZWFkeVxuICAgKi9cbiAgcmVhZHkgPSAoKSA9PiB7XG4gICAgLy8gRG91YmxlIGNoZWNrIHdlJ3JlIGVuYWJsZWRcbiAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xuICAgICAgZGVzdHJveSh0aGlzKTtcbiAgICB9XG5cbiAgICAvLyBTdGFydCB0aWNraW5nIG91ciBzYWZldHkgdGltZXIuIElmIHRoZSB3aG9sZSBhZHZlcnRpc2VtZW50XG4gICAgLy8gdGhpbmcgZG9lc24ndCByZXNvbHZlIHdpdGhpbiBvdXIgc2V0IHRpbWU7IHdlIGJhaWxcbiAgICB0aGlzLnN0YXJ0U2FmZXR5VGltZXIoMTIwMDAsICdyZWFkeSgpJyk7XG5cbiAgICAvLyBDbGVhciB0aGUgc2FmZXR5IHRpbWVyXG4gICAgdGhpcy5tYW5hZ2VyUHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgIHRoaXMuY2xlYXJTYWZldHlUaW1lcignb25BZHNNYW5hZ2VyTG9hZGVkKCknKTtcbiAgICB9KTtcblxuICAgIC8vIFNldCBsaXN0ZW5lcnMgb24gdGhlIFBseXIgaW5zdGFuY2VcbiAgICB0aGlzLmxpc3RlbmVycygpO1xuXG4gICAgLy8gU2V0dXAgdGhlIElNQSBTREtcbiAgICB0aGlzLnNldHVwSU1BKCk7XG4gIH07XG5cbiAgLy8gQnVpbGQgdGhlIHRhZyBVUkxcbiAgZ2V0IHRhZ1VybCgpIHtcbiAgICBjb25zdCB7IGNvbmZpZyB9ID0gdGhpcztcblxuICAgIGlmIChpcy51cmwoY29uZmlnLnRhZ1VybCkpIHtcbiAgICAgIHJldHVybiBjb25maWcudGFnVXJsO1xuICAgIH1cblxuICAgIGNvbnN0IHBhcmFtcyA9IHtcbiAgICAgIEFWX1BVQkxJU0hFUklEOiAnNThjMjViYjAwNzNlZjQ0OGIxMDg3YWQ2JyxcbiAgICAgIEFWX0NIQU5ORUxJRDogJzVhMDQ1OGRjMjhhMDYxNDVlNDUxOWQyMScsXG4gICAgICBBVl9VUkw6IHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSxcbiAgICAgIGNiOiBEYXRlLm5vdygpLFxuICAgICAgQVZfV0lEVEg6IDY0MCxcbiAgICAgIEFWX0hFSUdIVDogNDgwLFxuICAgICAgQVZfQ0RJTTI6IGNvbmZpZy5wdWJsaXNoZXJJZCxcbiAgICB9O1xuXG4gICAgY29uc3QgYmFzZSA9ICdodHRwczovL2dvLmFuaXZpZXcuY29tL2FwaS9hZHNlcnZlcjYvdmFzdC8nO1xuXG4gICAgcmV0dXJuIGAke2Jhc2V9PyR7YnVpbGRVcmxQYXJhbXMocGFyYW1zKX1gO1xuICB9XG5cbiAgLyoqXG4gICAqIEluIG9yZGVyIGZvciB0aGUgU0RLIHRvIGRpc3BsYXkgYWRzIGZvciBvdXIgdmlkZW8sIHdlIG5lZWQgdG8gdGVsbCBpdCB3aGVyZSB0byBwdXQgdGhlbSxcbiAgICogc28gaGVyZSB3ZSBkZWZpbmUgb3VyIGFkIGNvbnRhaW5lci4gVGhpcyBkaXYgaXMgc2V0IHVwIHRvIHJlbmRlciBvbiB0b3Agb2YgdGhlIHZpZGVvIHBsYXllci5cbiAgICogVXNpbmcgdGhlIGNvZGUgYmVsb3csIHdlIHRlbGwgdGhlIFNESyB0byByZW5kZXIgYWRzIHdpdGhpbiB0aGF0IGRpdi4gV2UgYWxzbyBwcm92aWRlIGFcbiAgICogaGFuZGxlIHRvIHRoZSBjb250ZW50IHZpZGVvIHBsYXllciAtIHRoZSBTREsgd2lsbCBwb2xsIHRoZSBjdXJyZW50IHRpbWUgb2Ygb3VyIHBsYXllciB0b1xuICAgKiBwcm9wZXJseSBwbGFjZSBtaWQtcm9sbHMuIEFmdGVyIHdlIGNyZWF0ZSB0aGUgYWQgZGlzcGxheSBjb250YWluZXIsIHdlIGluaXRpYWxpemUgaXQuIE9uXG4gICAqIG1vYmlsZSBkZXZpY2VzLCB0aGlzIGluaXRpYWxpemF0aW9uIGlzIGRvbmUgYXMgdGhlIHJlc3VsdCBvZiBhIHVzZXIgYWN0aW9uLlxuICAgKi9cbiAgc2V0dXBJTUEgPSAoKSA9PiB7XG4gICAgLy8gQ3JlYXRlIHRoZSBjb250YWluZXIgZm9yIG91ciBhZHZlcnRpc2VtZW50c1xuICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgY2xhc3M6IHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLmFkcyxcbiAgICB9KTtcblxuICAgIHRoaXMucGxheWVyLmVsZW1lbnRzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lcik7XG5cbiAgICAvLyBTbyB3ZSBjYW4gcnVuIFZQQUlEMlxuICAgIGdvb2dsZS5pbWEuc2V0dGluZ3Muc2V0VnBhaWRNb2RlKGdvb2dsZS5pbWEuSW1hU2RrU2V0dGluZ3MuVnBhaWRNb2RlLkVOQUJMRUQpO1xuXG4gICAgLy8gU2V0IGxhbmd1YWdlXG4gICAgZ29vZ2xlLmltYS5zZXR0aW5ncy5zZXRMb2NhbGUodGhpcy5wbGF5ZXIuY29uZmlnLmFkcy5sYW5ndWFnZSk7XG5cbiAgICAvLyBTZXQgcGxheWJhY2sgZm9yIGlPUzEwK1xuICAgIGdvb2dsZS5pbWEuc2V0dGluZ3Muc2V0RGlzYWJsZUN1c3RvbVBsYXliYWNrRm9ySU9TMTBQbHVzKHRoaXMucGxheWVyLmNvbmZpZy5wbGF5c2lubGluZSk7XG5cbiAgICAvLyBXZSBhc3N1bWUgdGhlIGFkQ29udGFpbmVyIGlzIHRoZSB2aWRlbyBjb250YWluZXIgb2YgdGhlIHBseXIgZWxlbWVudCB0aGF0IHdpbGwgaG91c2UgdGhlIGFkc1xuICAgIHRoaXMuZWxlbWVudHMuZGlzcGxheUNvbnRhaW5lciA9IG5ldyBnb29nbGUuaW1hLkFkRGlzcGxheUNvbnRhaW5lcih0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5wbGF5ZXIubWVkaWEpO1xuXG4gICAgLy8gQ3JlYXRlIGFkcyBsb2FkZXJcbiAgICB0aGlzLmxvYWRlciA9IG5ldyBnb29nbGUuaW1hLkFkc0xvYWRlcih0aGlzLmVsZW1lbnRzLmRpc3BsYXlDb250YWluZXIpO1xuXG4gICAgLy8gTGlzdGVuIGFuZCByZXNwb25kIHRvIGFkcyBsb2FkZWQgYW5kIGVycm9yIGV2ZW50c1xuICAgIHRoaXMubG9hZGVyLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICBnb29nbGUuaW1hLkFkc01hbmFnZXJMb2FkZWRFdmVudC5UeXBlLkFEU19NQU5BR0VSX0xPQURFRCxcbiAgICAgIChldmVudCkgPT4gdGhpcy5vbkFkc01hbmFnZXJMb2FkZWQoZXZlbnQpLFxuICAgICAgZmFsc2UsXG4gICAgKTtcbiAgICB0aGlzLmxvYWRlci5hZGRFdmVudExpc3RlbmVyKGdvb2dsZS5pbWEuQWRFcnJvckV2ZW50LlR5cGUuQURfRVJST1IsIChlcnJvcikgPT4gdGhpcy5vbkFkRXJyb3IoZXJyb3IpLCBmYWxzZSk7XG5cbiAgICAvLyBSZXF1ZXN0IHZpZGVvIGFkcyB0byBiZSBwcmUtbG9hZGVkXG4gICAgdGhpcy5yZXF1ZXN0QWRzKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlcXVlc3QgYWR2ZXJ0aXNlbWVudHNcbiAgICovXG4gIHJlcXVlc3RBZHMgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBjb250YWluZXIgfSA9IHRoaXMucGxheWVyLmVsZW1lbnRzO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFJlcXVlc3QgdmlkZW8gYWRzXG4gICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IGdvb2dsZS5pbWEuQWRzUmVxdWVzdCgpO1xuICAgICAgcmVxdWVzdC5hZFRhZ1VybCA9IHRoaXMudGFnVXJsO1xuXG4gICAgICAvLyBTcGVjaWZ5IHRoZSBsaW5lYXIgYW5kIG5vbmxpbmVhciBzbG90IHNpemVzLiBUaGlzIGhlbHBzIHRoZSBTREtcbiAgICAgIC8vIHRvIHNlbGVjdCB0aGUgY29ycmVjdCBjcmVhdGl2ZSBpZiBtdWx0aXBsZSBhcmUgcmV0dXJuZWRcbiAgICAgIHJlcXVlc3QubGluZWFyQWRTbG90V2lkdGggPSBjb250YWluZXIub2Zmc2V0V2lkdGg7XG4gICAgICByZXF1ZXN0LmxpbmVhckFkU2xvdEhlaWdodCA9IGNvbnRhaW5lci5vZmZzZXRIZWlnaHQ7XG4gICAgICByZXF1ZXN0Lm5vbkxpbmVhckFkU2xvdFdpZHRoID0gY29udGFpbmVyLm9mZnNldFdpZHRoO1xuICAgICAgcmVxdWVzdC5ub25MaW5lYXJBZFNsb3RIZWlnaHQgPSBjb250YWluZXIub2Zmc2V0SGVpZ2h0O1xuXG4gICAgICAvLyBXZSBvbmx5IG92ZXJsYXkgYWRzIGFzIHdlIG9ubHkgc3VwcG9ydCB2aWRlby5cbiAgICAgIHJlcXVlc3QuZm9yY2VOb25MaW5lYXJGdWxsU2xvdCA9IGZhbHNlO1xuXG4gICAgICAvLyBNdXRlIGJhc2VkIG9uIGN1cnJlbnQgc3RhdGVcbiAgICAgIHJlcXVlc3Quc2V0QWRXaWxsUGxheU11dGVkKCF0aGlzLnBsYXllci5tdXRlZCk7XG5cbiAgICAgIHRoaXMubG9hZGVyLnJlcXVlc3RBZHMocmVxdWVzdCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMub25BZEVycm9yKGVycm9yKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSB0aGUgYWQgY291bnRkb3duXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gc3RhcnRcbiAgICovXG4gIHBvbGxDb3VudGRvd24gPSAoc3RhcnQgPSBmYWxzZSkgPT4ge1xuICAgIGlmICghc3RhcnQpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5jb3VudGRvd25UaW1lcik7XG4gICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtYmFkZ2UtdGV4dCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHVwZGF0ZSA9ICgpID0+IHtcbiAgICAgIGNvbnN0IHRpbWUgPSBmb3JtYXRUaW1lKE1hdGgubWF4KHRoaXMubWFuYWdlci5nZXRSZW1haW5pbmdUaW1lKCksIDApKTtcbiAgICAgIGNvbnN0IGxhYmVsID0gYCR7aTE4bi5nZXQoJ2FkdmVydGlzZW1lbnQnLCB0aGlzLnBsYXllci5jb25maWcpfSAtICR7dGltZX1gO1xuICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIuc2V0QXR0cmlidXRlKCdkYXRhLWJhZGdlLXRleHQnLCBsYWJlbCk7XG4gICAgfTtcblxuICAgIHRoaXMuY291bnRkb3duVGltZXIgPSBzZXRJbnRlcnZhbCh1cGRhdGUsIDEwMCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFRoaXMgbWV0aG9kIGlzIGNhbGxlZCB3aGVuZXZlciB0aGUgYWRzIGFyZSByZWFkeSBpbnNpZGUgdGhlIEFkRGlzcGxheUNvbnRhaW5lclxuICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudCAtIGFkc01hbmFnZXJMb2FkZWRFdmVudFxuICAgKi9cbiAgb25BZHNNYW5hZ2VyTG9hZGVkID0gKGV2ZW50KSA9PiB7XG4gICAgLy8gTG9hZCBjb3VsZCBvY2N1ciBhZnRlciBhIHNvdXJjZSBjaGFuZ2UgKHJhY2UgY29uZGl0aW9uKVxuICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gR2V0IHRoZSBhZHMgbWFuYWdlclxuICAgIGNvbnN0IHNldHRpbmdzID0gbmV3IGdvb2dsZS5pbWEuQWRzUmVuZGVyaW5nU2V0dGluZ3MoKTtcblxuICAgIC8vIFRlbGwgdGhlIFNESyB0byBzYXZlIGFuZCByZXN0b3JlIGNvbnRlbnQgdmlkZW8gc3RhdGUgb24gb3VyIGJlaGFsZlxuICAgIHNldHRpbmdzLnJlc3RvcmVDdXN0b21QbGF5YmFja1N0YXRlT25BZEJyZWFrQ29tcGxldGUgPSB0cnVlO1xuICAgIHNldHRpbmdzLmVuYWJsZVByZWxvYWRpbmcgPSB0cnVlO1xuXG4gICAgLy8gVGhlIFNESyBpcyBwb2xsaW5nIGN1cnJlbnRUaW1lIG9uIHRoZSBjb250ZW50UGxheWJhY2suIEFuZCBuZWVkcyBhIGR1cmF0aW9uXG4gICAgLy8gc28gaXQgY2FuIGRldGVybWluZSB3aGVuIHRvIHN0YXJ0IHRoZSBtaWQtIGFuZCBwb3N0LXJvbGxcbiAgICB0aGlzLm1hbmFnZXIgPSBldmVudC5nZXRBZHNNYW5hZ2VyKHRoaXMucGxheWVyLCBzZXR0aW5ncyk7XG5cbiAgICAvLyBHZXQgdGhlIGN1ZSBwb2ludHMgZm9yIGFueSBtaWQtcm9sbHMgYnkgZmlsdGVyaW5nIG91dCB0aGUgcHJlLSBhbmQgcG9zdC1yb2xsXG4gICAgdGhpcy5jdWVQb2ludHMgPSB0aGlzLm1hbmFnZXIuZ2V0Q3VlUG9pbnRzKCk7XG5cbiAgICAvLyBBZGQgbGlzdGVuZXJzIHRvIHRoZSByZXF1aXJlZCBldmVudHNcbiAgICAvLyBBZHZlcnRpc2VtZW50IGVycm9yIGV2ZW50c1xuICAgIHRoaXMubWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGdvb2dsZS5pbWEuQWRFcnJvckV2ZW50LlR5cGUuQURfRVJST1IsIChlcnJvcikgPT4gdGhpcy5vbkFkRXJyb3IoZXJyb3IpKTtcblxuICAgIC8vIEFkdmVydGlzZW1lbnQgcmVndWxhciBldmVudHNcbiAgICBPYmplY3Qua2V5cyhnb29nbGUuaW1hLkFkRXZlbnQuVHlwZSkuZm9yRWFjaCgodHlwZSkgPT4ge1xuICAgICAgdGhpcy5tYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGVbdHlwZV0sIChlKSA9PiB0aGlzLm9uQWRFdmVudChlKSk7XG4gICAgfSk7XG5cbiAgICAvLyBSZXNvbHZlIG91ciBhZHNNYW5hZ2VyXG4gICAgdGhpcy50cmlnZ2VyKCdsb2FkZWQnKTtcbiAgfTtcblxuICBhZGRDdWVQb2ludHMgPSAoKSA9PiB7XG4gICAgLy8gQWRkIGFkdmVydGlzZW1lbnQgY3VlJ3Mgd2l0aGluIHRoZSB0aW1lIGxpbmUgaWYgYXZhaWxhYmxlXG4gICAgaWYgKCFpcy5lbXB0eSh0aGlzLmN1ZVBvaW50cykpIHtcbiAgICAgIHRoaXMuY3VlUG9pbnRzLmZvckVhY2goKGN1ZVBvaW50KSA9PiB7XG4gICAgICAgIGlmIChjdWVQb2ludCAhPT0gMCAmJiBjdWVQb2ludCAhPT0gLTEgJiYgY3VlUG9pbnQgPCB0aGlzLnBsYXllci5kdXJhdGlvbikge1xuICAgICAgICAgIGNvbnN0IHNlZWtFbGVtZW50ID0gdGhpcy5wbGF5ZXIuZWxlbWVudHMucHJvZ3Jlc3M7XG5cbiAgICAgICAgICBpZiAoaXMuZWxlbWVudChzZWVrRWxlbWVudCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGN1ZVBlcmNlbnRhZ2UgPSAoMTAwIC8gdGhpcy5wbGF5ZXIuZHVyYXRpb24pICogY3VlUG9pbnQ7XG4gICAgICAgICAgICBjb25zdCBjdWUgPSBjcmVhdGVFbGVtZW50KCdzcGFuJywge1xuICAgICAgICAgICAgICBjbGFzczogdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMuY3VlcyxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjdWUuc3R5bGUubGVmdCA9IGAke2N1ZVBlcmNlbnRhZ2UudG9TdHJpbmcoKX0lYDtcbiAgICAgICAgICAgIHNlZWtFbGVtZW50LmFwcGVuZENoaWxkKGN1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFRoaXMgaXMgd2hlcmUgYWxsIHRoZSBldmVudCBoYW5kbGluZyB0YWtlcyBwbGFjZS4gUmV0cmlldmUgdGhlIGFkIGZyb20gdGhlIGV2ZW50LiBTb21lXG4gICAqIGV2ZW50cyAoZS5nLiBBTExfQURTX0NPTVBMRVRFRCkgZG9uJ3QgaGF2ZSB0aGUgYWQgb2JqZWN0IGFzc29jaWF0ZWRcbiAgICogaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vaW50ZXJhY3RpdmUtbWVkaWEtYWRzL2RvY3Mvc2Rrcy9odG1sNS92My9hcGlzI2ltYS5BZEV2ZW50LlR5cGVcbiAgICogQHBhcmFtIHtFdmVudH0gZXZlbnRcbiAgICovXG4gIG9uQWRFdmVudCA9IChldmVudCkgPT4ge1xuICAgIGNvbnN0IHsgY29udGFpbmVyIH0gPSB0aGlzLnBsYXllci5lbGVtZW50cztcbiAgICAvLyBSZXRyaWV2ZSB0aGUgYWQgZnJvbSB0aGUgZXZlbnQuIFNvbWUgZXZlbnRzIChlLmcuIEFMTF9BRFNfQ09NUExFVEVEKVxuICAgIC8vIGRvbid0IGhhdmUgYWQgb2JqZWN0IGFzc29jaWF0ZWRcbiAgICBjb25zdCBhZCA9IGV2ZW50LmdldEFkKCk7XG4gICAgY29uc3QgYWREYXRhID0gZXZlbnQuZ2V0QWREYXRhKCk7XG5cbiAgICAvLyBQcm94eSBldmVudFxuICAgIGNvbnN0IGRpc3BhdGNoRXZlbnQgPSAodHlwZSkgPT4ge1xuICAgICAgdHJpZ2dlckV2ZW50LmNhbGwodGhpcy5wbGF5ZXIsIHRoaXMucGxheWVyLm1lZGlhLCBgYWRzJHt0eXBlLnJlcGxhY2UoL18vZywgJycpLnRvTG93ZXJDYXNlKCl9YCk7XG4gICAgfTtcblxuICAgIC8vIEJ1YmJsZSB0aGUgZXZlbnRcbiAgICBkaXNwYXRjaEV2ZW50KGV2ZW50LnR5cGUpO1xuXG4gICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4gICAgICBjYXNlIGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlLkxPQURFRDpcbiAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgZXZlbnQgc2VudCBmb3IgYW4gYWQgLSBpdCBpcyBwb3NzaWJsZSB0byBkZXRlcm1pbmUgd2hldGhlciB0aGVcbiAgICAgICAgLy8gYWQgaXMgYSB2aWRlbyBhZCBvciBhbiBvdmVybGF5XG4gICAgICAgIHRoaXMudHJpZ2dlcignbG9hZGVkJyk7XG5cbiAgICAgICAgLy8gU3RhcnQgY291bnRkb3duXG4gICAgICAgIHRoaXMucG9sbENvdW50ZG93bih0cnVlKTtcblxuICAgICAgICBpZiAoIWFkLmlzTGluZWFyKCkpIHtcbiAgICAgICAgICAvLyBQb3NpdGlvbiBBZERpc3BsYXlDb250YWluZXIgY29ycmVjdGx5IGZvciBvdmVybGF5XG4gICAgICAgICAgYWQud2lkdGggPSBjb250YWluZXIub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgYWQuaGVpZ2h0ID0gY29udGFpbmVyLm9mZnNldEhlaWdodDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNvbnNvbGUuaW5mbygnQWQgdHlwZTogJyArIGV2ZW50LmdldEFkKCkuZ2V0QWRQb2RJbmZvKCkuZ2V0UG9kSW5kZXgoKSk7XG4gICAgICAgIC8vIGNvbnNvbGUuaW5mbygnQWQgdGltZTogJyArIGV2ZW50LmdldEFkKCkuZ2V0QWRQb2RJbmZvKCkuZ2V0VGltZU9mZnNldCgpKTtcblxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5TVEFSVEVEOlxuICAgICAgICAvLyBTZXQgdm9sdW1lIHRvIG1hdGNoIHBsYXllclxuICAgICAgICB0aGlzLm1hbmFnZXIuc2V0Vm9sdW1lKHRoaXMucGxheWVyLnZvbHVtZSk7XG5cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuQUxMX0FEU19DT01QTEVURUQ6XG4gICAgICAgIC8vIEFsbCBhZHMgZm9yIHRoZSBjdXJyZW50IHZpZGVvcyBhcmUgZG9uZS4gV2UgY2FuIG5vdyByZXF1ZXN0IG5ldyBhZHZlcnRpc2VtZW50c1xuICAgICAgICAvLyBpbiBjYXNlIHRoZSB2aWRlbyBpcyByZS1wbGF5ZWRcblxuICAgICAgICAvLyBUT0RPOiBFeGFtcGxlIGZvciB3aGF0IGhhcHBlbnMgd2hlbiBhIG5leHQgdmlkZW8gaW4gYSBwbGF5bGlzdCB3b3VsZCBiZSBsb2FkZWQuXG4gICAgICAgIC8vIFNvIGhlcmUgd2UgbG9hZCBhIG5ldyB2aWRlbyB3aGVuIGFsbCBhZHMgYXJlIGRvbmUuXG4gICAgICAgIC8vIFRoZW4gd2UgbG9hZCBuZXcgYWRzIHdpdGhpbiBhIG5ldyBhZHNNYW5hZ2VyLiBXaGVuIHRoZSB2aWRlb1xuICAgICAgICAvLyBJcyBzdGFydGVkIC0gYWZ0ZXIgLSB0aGUgYWRzIGFyZSBsb2FkZWQsIHRoZW4gd2UgZ2V0IGFkcy5cbiAgICAgICAgLy8gWW91IGNhbiBhbHNvIGVhc2lseSB0ZXN0IGNhbmNlbGxpbmcgYW5kIHJlbG9hZGluZyBieSBydW5uaW5nXG4gICAgICAgIC8vIHBsYXllci5hZHMuY2FuY2VsKCkgYW5kIHBsYXllci5hZHMucGxheSBmcm9tIHRoZSBjb25zb2xlIEkgZ3Vlc3MuXG4gICAgICAgIC8vIHRoaXMucGxheWVyLnNvdXJjZSA9IHtcbiAgICAgICAgLy8gICAgIHR5cGU6ICd2aWRlbycsXG4gICAgICAgIC8vICAgICB0aXRsZTogJ1ZpZXcgRnJvbSBBIEJsdWUgTW9vbicsXG4gICAgICAgIC8vICAgICBzb3VyY2VzOiBbe1xuICAgICAgICAvLyAgICAgICAgIHNyYzpcbiAgICAgICAgLy8gJ2h0dHBzOi8vY2RuLnBseXIuaW8vc3RhdGljL2RlbW8vVmlld19Gcm9tX0FfQmx1ZV9Nb29uX1RyYWlsZXItSEQubXA0JywgdHlwZTpcbiAgICAgICAgLy8gJ3ZpZGVvL21wNCcsIH1dLCBwb3N0ZXI6XG4gICAgICAgIC8vICdodHRwczovL2Nkbi5wbHlyLmlvL3N0YXRpYy9kZW1vL1ZpZXdfRnJvbV9BX0JsdWVfTW9vbl9UcmFpbGVyLUhELmpwZycsIHRyYWNrczpcbiAgICAgICAgLy8gWyB7IGtpbmQ6ICdjYXB0aW9ucycsIGxhYmVsOiAnRW5nbGlzaCcsIHNyY2xhbmc6ICdlbicsIHNyYzpcbiAgICAgICAgLy8gJ2h0dHBzOi8vY2RuLnBseXIuaW8vc3RhdGljL2RlbW8vVmlld19Gcm9tX0FfQmx1ZV9Nb29uX1RyYWlsZXItSEQuZW4udnR0JyxcbiAgICAgICAgLy8gZGVmYXVsdDogdHJ1ZSwgfSwgeyBraW5kOiAnY2FwdGlvbnMnLCBsYWJlbDogJ0ZyZW5jaCcsIHNyY2xhbmc6ICdmcicsIHNyYzpcbiAgICAgICAgLy8gJ2h0dHBzOi8vY2RuLnBseXIuaW8vc3RhdGljL2RlbW8vVmlld19Gcm9tX0FfQmx1ZV9Nb29uX1RyYWlsZXItSEQuZnIudnR0JywgfSwgXSxcbiAgICAgICAgLy8gfTtcblxuICAgICAgICAvLyBUT0RPOiBTbyB0aGVyZSBpcyBzdGlsbCB0aGlzIHRoaW5nIHdoZXJlIGEgdmlkZW8gc2hvdWxkIG9ubHkgYmUgYWxsb3dlZCB0byBzdGFydFxuICAgICAgICAvLyBwbGF5aW5nIHdoZW4gdGhlIElNQSBTREsgaXMgcmVhZHkgb3IgaGFzIGZhaWxlZFxuXG4gICAgICAgIGlmICh0aGlzLnBsYXllci5lbmRlZCkge1xuICAgICAgICAgIHRoaXMubG9hZEFkcygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIFRoZSBTREsgd29uJ3QgYWxsb3cgbmV3IGFkcyB0byBiZSBjYWxsZWQgd2l0aG91dCByZWNlaXZpbmcgYSBjb250ZW50Q29tcGxldGUoKVxuICAgICAgICAgIHRoaXMubG9hZGVyLmNvbnRlbnRDb21wbGV0ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuQ09OVEVOVF9QQVVTRV9SRVFVRVNURUQ6XG4gICAgICAgIC8vIFRoaXMgZXZlbnQgaW5kaWNhdGVzIHRoZSBhZCBoYXMgc3RhcnRlZCAtIHRoZSB2aWRlbyBwbGF5ZXIgY2FuIGFkanVzdCB0aGUgVUksXG4gICAgICAgIC8vIGZvciBleGFtcGxlIGRpc3BsYXkgYSBwYXVzZSBidXR0b24gYW5kIHJlbWFpbmluZyB0aW1lLiBGaXJlZCB3aGVuIGNvbnRlbnQgc2hvdWxkXG4gICAgICAgIC8vIGJlIHBhdXNlZC4gVGhpcyB1c3VhbGx5IGhhcHBlbnMgcmlnaHQgYmVmb3JlIGFuIGFkIGlzIGFib3V0IHRvIGNvdmVyIHRoZSBjb250ZW50XG5cbiAgICAgICAgdGhpcy5wYXVzZUNvbnRlbnQoKTtcblxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5DT05URU5UX1JFU1VNRV9SRVFVRVNURUQ6XG4gICAgICAgIC8vIFRoaXMgZXZlbnQgaW5kaWNhdGVzIHRoZSBhZCBoYXMgZmluaXNoZWQgLSB0aGUgdmlkZW8gcGxheWVyIGNhbiBwZXJmb3JtXG4gICAgICAgIC8vIGFwcHJvcHJpYXRlIFVJIGFjdGlvbnMsIHN1Y2ggYXMgcmVtb3ZpbmcgdGhlIHRpbWVyIGZvciByZW1haW5pbmcgdGltZSBkZXRlY3Rpb24uXG4gICAgICAgIC8vIEZpcmVkIHdoZW4gY29udGVudCBzaG91bGQgYmUgcmVzdW1lZC4gVGhpcyB1c3VhbGx5IGhhcHBlbnMgd2hlbiBhbiBhZCBmaW5pc2hlc1xuICAgICAgICAvLyBvciBjb2xsYXBzZXNcblxuICAgICAgICB0aGlzLnBvbGxDb3VudGRvd24oKTtcblxuICAgICAgICB0aGlzLnJlc3VtZUNvbnRlbnQoKTtcblxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5MT0c6XG4gICAgICAgIGlmIChhZERhdGEuYWRFcnJvcikge1xuICAgICAgICAgIHRoaXMucGxheWVyLmRlYnVnLndhcm4oYE5vbi1mYXRhbCBhZCBlcnJvcjogJHthZERhdGEuYWRFcnJvci5nZXRNZXNzYWdlKCl9YCk7XG4gICAgICAgIH1cblxuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBBbnkgYWQgZXJyb3IgaGFuZGxpbmcgY29tZXMgdGhyb3VnaCBoZXJlXG4gICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAqL1xuICBvbkFkRXJyb3IgPSAoZXZlbnQpID0+IHtcbiAgICB0aGlzLmNhbmNlbCgpO1xuICAgIHRoaXMucGxheWVyLmRlYnVnLndhcm4oJ0FkcyBlcnJvcicsIGV2ZW50KTtcbiAgfTtcblxuICAvKipcbiAgICogU2V0dXAgaG9va3MgZm9yIFBseXIgYW5kIHdpbmRvdyBldmVudHMuIFRoaXMgZW5zdXJlc1xuICAgKiB0aGUgbWlkLSBhbmQgcG9zdC1yb2xsIGxhdW5jaCBhdCB0aGUgY29ycmVjdCB0aW1lLiBBbmRcbiAgICogcmVzaXplIHRoZSBhZHZlcnRpc2VtZW50IHdoZW4gdGhlIHBsYXllciByZXNpemVzXG4gICAqL1xuICBsaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBjb250YWluZXIgfSA9IHRoaXMucGxheWVyLmVsZW1lbnRzO1xuICAgIGxldCB0aW1lO1xuXG4gICAgdGhpcy5wbGF5ZXIub24oJ2NhbnBsYXknLCAoKSA9PiB7XG4gICAgICB0aGlzLmFkZEN1ZVBvaW50cygpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5wbGF5ZXIub24oJ2VuZGVkJywgKCkgPT4ge1xuICAgICAgdGhpcy5sb2FkZXIuY29udGVudENvbXBsZXRlKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnBsYXllci5vbigndGltZXVwZGF0ZScsICgpID0+IHtcbiAgICAgIHRpbWUgPSB0aGlzLnBsYXllci5jdXJyZW50VGltZTtcbiAgICB9KTtcblxuICAgIHRoaXMucGxheWVyLm9uKCdzZWVrZWQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzZWVrZWRUaW1lID0gdGhpcy5wbGF5ZXIuY3VycmVudFRpbWU7XG5cbiAgICAgIGlmIChpcy5lbXB0eSh0aGlzLmN1ZVBvaW50cykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmN1ZVBvaW50cy5mb3JFYWNoKChjdWVQb2ludCwgaW5kZXgpID0+IHtcbiAgICAgICAgaWYgKHRpbWUgPCBjdWVQb2ludCAmJiBjdWVQb2ludCA8IHNlZWtlZFRpbWUpIHtcbiAgICAgICAgICB0aGlzLm1hbmFnZXIuZGlzY2FyZEFkQnJlYWsoKTtcbiAgICAgICAgICB0aGlzLmN1ZVBvaW50cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIExpc3RlbiB0byB0aGUgcmVzaXppbmcgb2YgdGhlIHdpbmRvdy4gQW5kIHJlc2l6ZSBhZCBhY2NvcmRpbmdseVxuICAgIC8vIFRPRE86IGV2ZW50dWFsbHkgaW1wbGVtZW50IFJlc2l6ZU9ic2VydmVyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLm1hbmFnZXIpIHtcbiAgICAgICAgdGhpcy5tYW5hZ2VyLnJlc2l6ZShjb250YWluZXIub2Zmc2V0V2lkdGgsIGNvbnRhaW5lci5vZmZzZXRIZWlnaHQsIGdvb2dsZS5pbWEuVmlld01vZGUuTk9STUFMKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSB0aGUgYWRzTWFuYWdlciBhbmQgc3RhcnQgcGxheWluZyBhZHZlcnRpc2VtZW50c1xuICAgKi9cbiAgcGxheSA9ICgpID0+IHtcbiAgICBjb25zdCB7IGNvbnRhaW5lciB9ID0gdGhpcy5wbGF5ZXIuZWxlbWVudHM7XG5cbiAgICBpZiAoIXRoaXMubWFuYWdlclByb21pc2UpIHtcbiAgICAgIHRoaXMucmVzdW1lQ29udGVudCgpO1xuICAgIH1cblxuICAgIC8vIFBsYXkgdGhlIHJlcXVlc3RlZCBhZHZlcnRpc2VtZW50IHdoZW5ldmVyIHRoZSBhZHNNYW5hZ2VyIGlzIHJlYWR5XG4gICAgdGhpcy5tYW5hZ2VyUHJvbWlzZVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAvLyBTZXQgdm9sdW1lIHRvIG1hdGNoIHBsYXllclxuICAgICAgICB0aGlzLm1hbmFnZXIuc2V0Vm9sdW1lKHRoaXMucGxheWVyLnZvbHVtZSk7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgY29udGFpbmVyLiBNdXN0IGJlIGRvbmUgdmlhIGEgdXNlciBhY3Rpb24gb24gbW9iaWxlIGRldmljZXNcbiAgICAgICAgdGhpcy5lbGVtZW50cy5kaXNwbGF5Q29udGFpbmVyLmluaXRpYWxpemUoKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIGlmICghdGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgYWRzIG1hbmFnZXIuIEFkIHJ1bGVzIHBsYXlsaXN0IHdpbGwgc3RhcnQgYXQgdGhpcyB0aW1lXG4gICAgICAgICAgICB0aGlzLm1hbmFnZXIuaW5pdChjb250YWluZXIub2Zmc2V0V2lkdGgsIGNvbnRhaW5lci5vZmZzZXRIZWlnaHQsIGdvb2dsZS5pbWEuVmlld01vZGUuTk9STUFMKTtcblxuICAgICAgICAgICAgLy8gQ2FsbCBwbGF5IHRvIHN0YXJ0IHNob3dpbmcgdGhlIGFkLiBTaW5nbGUgdmlkZW8gYW5kIG92ZXJsYXkgYWRzIHdpbGxcbiAgICAgICAgICAgIC8vIHN0YXJ0IGF0IHRoaXMgdGltZTsgdGhlIGNhbGwgd2lsbCBiZSBpZ25vcmVkIGZvciBhZCBydWxlc1xuICAgICAgICAgICAgdGhpcy5tYW5hZ2VyLnN0YXJ0KCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgIH0gY2F0Y2ggKGFkRXJyb3IpIHtcbiAgICAgICAgICAvLyBBbiBlcnJvciBtYXkgYmUgdGhyb3duIGlmIHRoZXJlIHdhcyBhIHByb2JsZW0gd2l0aCB0aGVcbiAgICAgICAgICAvLyBWQVNUIHJlc3BvbnNlXG4gICAgICAgICAgdGhpcy5vbkFkRXJyb3IoYWRFcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKCkgPT4ge30pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXN1bWUgb3VyIHZpZGVvXG4gICAqL1xuICByZXN1bWVDb250ZW50ID0gKCkgPT4ge1xuICAgIC8vIEhpZGUgdGhlIGFkdmVydGlzZW1lbnQgY29udGFpbmVyXG4gICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIuc3R5bGUuekluZGV4ID0gJyc7XG5cbiAgICAvLyBBZCBpcyBzdG9wcGVkXG4gICAgdGhpcy5wbGF5aW5nID0gZmFsc2U7XG5cbiAgICAvLyBQbGF5IHZpZGVvXG4gICAgc2lsZW5jZVByb21pc2UodGhpcy5wbGF5ZXIubWVkaWEucGxheSgpKTtcbiAgfTtcblxuICAvKipcbiAgICogUGF1c2Ugb3VyIHZpZGVvXG4gICAqL1xuICBwYXVzZUNvbnRlbnQgPSAoKSA9PiB7XG4gICAgLy8gU2hvdyB0aGUgYWR2ZXJ0aXNlbWVudCBjb250YWluZXJcbiAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5zdHlsZS56SW5kZXggPSAzO1xuXG4gICAgLy8gQWQgaXMgcGxheWluZ1xuICAgIHRoaXMucGxheWluZyA9IHRydWU7XG5cbiAgICAvLyBQYXVzZSBvdXIgdmlkZW8uXG4gICAgdGhpcy5wbGF5ZXIubWVkaWEucGF1c2UoKTtcbiAgfTtcblxuICAvKipcbiAgICogRGVzdHJveSB0aGUgYWRzTWFuYWdlciBzbyB3ZSBjYW4gZ3JhYiBuZXcgYWRzIGFmdGVyIHRoaXMuIElmIHdlIGRvbid0IHRoZW4gd2UncmUgbm90XG4gICAqIGFsbG93ZWQgdG8gY2FsbCBuZXcgYWRzIGJhc2VkIG9uIGdvb2dsZSBwb2xpY2llcywgYXMgdGhleSBpbnRlcnByZXQgdGhpcyBhcyBhbiBhY2NpZGVudGFsXG4gICAqIHZpZGVvIHJlcXVlc3RzLiBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS9pbnRlcmFjdGl2ZS1cbiAgICogbWVkaWEtYWRzL2RvY3Mvc2Rrcy9hbmRyb2lkL2ZhcSM4XG4gICAqL1xuICBjYW5jZWwgPSAoKSA9PiB7XG4gICAgLy8gUGF1c2Ugb3VyIHZpZGVvXG4gICAgaWYgKHRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgIHRoaXMucmVzdW1lQ29udGVudCgpO1xuICAgIH1cblxuICAgIC8vIFRlbGwgb3VyIGluc3RhbmNlIHRoYXQgd2UncmUgZG9uZSBmb3Igbm93XG4gICAgdGhpcy50cmlnZ2VyKCdlcnJvcicpO1xuXG4gICAgLy8gUmUtY3JlYXRlIG91ciBhZHNNYW5hZ2VyXG4gICAgdGhpcy5sb2FkQWRzKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlLWNyZWF0ZSBvdXIgYWRzTWFuYWdlclxuICAgKi9cbiAgbG9hZEFkcyA9ICgpID0+IHtcbiAgICAvLyBUZWxsIG91ciBhZHNNYW5hZ2VyIHRvIGdvIGJ5ZSBieWVcbiAgICB0aGlzLm1hbmFnZXJQcm9taXNlXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIC8vIERlc3Ryb3kgb3VyIGFkc01hbmFnZXJcbiAgICAgICAgaWYgKHRoaXMubWFuYWdlcikge1xuICAgICAgICAgIHRoaXMubWFuYWdlci5kZXN0cm95KCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZS1zZXQgb3VyIGFkc01hbmFnZXIgcHJvbWlzZXNcbiAgICAgICAgdGhpcy5tYW5hZ2VyUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgdGhpcy5vbignbG9hZGVkJywgcmVzb2x2ZSk7XG4gICAgICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKHRoaXMubWFuYWdlcik7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBOb3cgdGhhdCB0aGUgbWFuYWdlciBoYXMgYmVlbiBkZXN0cm95ZWQgc2V0IGl0IHRvIGFsc28gYmUgdW4taW5pdGlhbGl6ZWRcbiAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXG4gICAgICAgIC8vIE5vdyByZXF1ZXN0IHNvbWUgbmV3IGFkdmVydGlzZW1lbnRzXG4gICAgICAgIHRoaXMucmVxdWVzdEFkcygpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoKSA9PiB7fSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgY2FsbGJhY2tzIGFmdGVyIGFuIGFkIGV2ZW50IHdhcyBpbnZva2VkXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudCAtIEV2ZW50IHR5cGVcbiAgICogQHBhcmFtIGFyZ3NcbiAgICovXG4gIHRyaWdnZXIgPSAoZXZlbnQsIC4uLmFyZ3MpID0+IHtcbiAgICBjb25zdCBoYW5kbGVycyA9IHRoaXMuZXZlbnRzW2V2ZW50XTtcblxuICAgIGlmIChpcy5hcnJheShoYW5kbGVycykpIHtcbiAgICAgIGhhbmRsZXJzLmZvckVhY2goKGhhbmRsZXIpID0+IHtcbiAgICAgICAgaWYgKGlzLmZ1bmN0aW9uKGhhbmRsZXIpKSB7XG4gICAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBBZGQgZXZlbnQgbGlzdGVuZXJzXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudCAtIEV2ZW50IHR5cGVcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmb3Igd2hlbiBldmVudCBvY2N1cnNcbiAgICogQHJldHVybiB7QWRzfVxuICAgKi9cbiAgb24gPSAoZXZlbnQsIGNhbGxiYWNrKSA9PiB7XG4gICAgaWYgKCFpcy5hcnJheSh0aGlzLmV2ZW50c1tldmVudF0pKSB7XG4gICAgICB0aGlzLmV2ZW50c1tldmVudF0gPSBbXTtcbiAgICB9XG5cbiAgICB0aGlzLmV2ZW50c1tldmVudF0ucHVzaChjYWxsYmFjayk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogU2V0dXAgYSBzYWZldHkgdGltZXIgZm9yIHdoZW4gdGhlIGFkIG5ldHdvcmsgZG9lc24ndCByZXNwb25kIGZvciB3aGF0ZXZlciByZWFzb24uXG4gICAqIFRoZSBhZHZlcnRpc2VtZW50IGhhcyAxMiBzZWNvbmRzIHRvIGdldCBpdHMgdGhpbmdzIHRvZ2V0aGVyLiBXZSBzdG9wIHRoaXMgdGltZXIgd2hlbiB0aGVcbiAgICogYWR2ZXJ0aXNlbWVudCBpcyBwbGF5aW5nLCBvciB3aGVuIGEgdXNlciBhY3Rpb24gaXMgcmVxdWlyZWQgdG8gc3RhcnQsIHRoZW4gd2UgY2xlYXIgdGhlXG4gICAqIHRpbWVyIG9uIGFkIHJlYWR5XG4gICAqIEBwYXJhbSB7TnVtYmVyfSB0aW1lXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBmcm9tXG4gICAqL1xuICBzdGFydFNhZmV0eVRpbWVyID0gKHRpbWUsIGZyb20pID0+IHtcbiAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coYFNhZmV0eSB0aW1lciBpbnZva2VkIGZyb206ICR7ZnJvbX1gKTtcblxuICAgIHRoaXMuc2FmZXR5VGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuY2FuY2VsKCk7XG4gICAgICB0aGlzLmNsZWFyU2FmZXR5VGltZXIoJ3N0YXJ0U2FmZXR5VGltZXIoKScpO1xuICAgIH0sIHRpbWUpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDbGVhciBvdXIgc2FmZXR5IHRpbWVyKHMpXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBmcm9tXG4gICAqL1xuICBjbGVhclNhZmV0eVRpbWVyID0gKGZyb20pID0+IHtcbiAgICBpZiAoIWlzLm51bGxPclVuZGVmaW5lZCh0aGlzLnNhZmV0eVRpbWVyKSkge1xuICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKGBTYWZldHkgdGltZXIgY2xlYXJlZCBmcm9tOiAke2Zyb219YCk7XG5cbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNhZmV0eVRpbWVyKTtcbiAgICAgIHRoaXMuc2FmZXR5VGltZXIgPSBudWxsO1xuICAgIH1cbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgQWRzO1xuIiwiLyoqXG4gKiBSZXR1cm5zIGEgbnVtYmVyIHdob3NlIHZhbHVlIGlzIGxpbWl0ZWQgdG8gdGhlIGdpdmVuIHJhbmdlLlxuICpcbiAqIEV4YW1wbGU6IGxpbWl0IHRoZSBvdXRwdXQgb2YgdGhpcyBjb21wdXRhdGlvbiB0byBiZXR3ZWVuIDAgYW5kIDI1NVxuICogKHggKiAyNTUpLmNsYW1wKDAsIDI1NSlcbiAqXG4gKiBAcGFyYW0ge051bWJlcn0gaW5wdXRcbiAqIEBwYXJhbSB7TnVtYmVyfSBtaW4gVGhlIGxvd2VyIGJvdW5kYXJ5IG9mIHRoZSBvdXRwdXQgcmFuZ2VcbiAqIEBwYXJhbSB7TnVtYmVyfSBtYXggVGhlIHVwcGVyIGJvdW5kYXJ5IG9mIHRoZSBvdXRwdXQgcmFuZ2VcbiAqIEByZXR1cm5zIEEgbnVtYmVyIHdpdGhpbiB0aGUgYm91bmRzIG9mIG1pbiBhbmQgbWF4XG4gKiBAdHlwZSBOdW1iZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsYW1wKGlucHV0ID0gMCwgbWluID0gMCwgbWF4ID0gMjU1KSB7XG4gIHJldHVybiBNYXRoLm1pbihNYXRoLm1heChpbnB1dCwgbWluKSwgbWF4KTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgeyBjbGFtcCB9O1xuIiwiaW1wb3J0IHsgY3JlYXRlRWxlbWVudCB9IGZyb20gJy4uL3V0aWxzL2VsZW1lbnRzJztcbmltcG9ydCB7IG9uY2UgfSBmcm9tICcuLi91dGlscy9ldmVudHMnO1xuaW1wb3J0IGZldGNoIGZyb20gJy4uL3V0aWxzL2ZldGNoJztcbmltcG9ydCBpcyBmcm9tICcuLi91dGlscy9pcyc7XG5pbXBvcnQgeyBjbGFtcCB9IGZyb20gJy4uL3V0aWxzL251bWJlcnMnO1xuaW1wb3J0IHsgZm9ybWF0VGltZSB9IGZyb20gJy4uL3V0aWxzL3RpbWUnO1xuXG4vLyBBcmc6IHZ0dERhdGFTdHJpbmcgZXhhbXBsZTogXCJXRUJWVFRcXG5cXG4xXFxuMDA6MDA6MDUuMDAwIC0tPiAwMDowMDoxMC4wMDBcXG4xMDgwcC0wMDAwMS5qcGdcIlxuY29uc3QgcGFyc2VWdHQgPSAodnR0RGF0YVN0cmluZykgPT4ge1xuICBjb25zdCBwcm9jZXNzZWRMaXN0ID0gW107XG4gIGNvbnN0IGZyYW1lcyA9IHZ0dERhdGFTdHJpbmcuc3BsaXQoL1xcclxcblxcclxcbnxcXG5cXG58XFxyXFxyLyk7XG5cbiAgZnJhbWVzLmZvckVhY2goKGZyYW1lKSA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgY29uc3QgbGluZXMgPSBmcmFtZS5zcGxpdCgvXFxyXFxufFxcbnxcXHIvKTtcblxuICAgIGxpbmVzLmZvckVhY2goKGxpbmUpID0+IHtcbiAgICAgIGlmICghaXMubnVtYmVyKHJlc3VsdC5zdGFydFRpbWUpKSB7XG4gICAgICAgIC8vIFRoZSBsaW5lIHdpdGggc3RhcnQgYW5kIGVuZCB0aW1lcyBvbiBpdCBpcyB0aGUgZmlyc3QgbGluZSBvZiBpbnRlcmVzdFxuICAgICAgICBjb25zdCBtYXRjaFRpbWVzID0gbGluZS5tYXRjaChcbiAgICAgICAgICAvKFswLTldezJ9KT86PyhbMC05XXsyfSk6KFswLTldezJ9KS4oWzAtOV17MiwzfSkoID8tLT4gPykoWzAtOV17Mn0pPzo/KFswLTldezJ9KTooWzAtOV17Mn0pLihbMC05XXsyLDN9KS8sXG4gICAgICAgICk7IC8vIE5vdGUgdGhhdCB0aGlzIGN1cnJlbnRseSBpZ25vcmVzIGNhcHRpb24gZm9ybWF0dGluZyBkaXJlY3RpdmVzIHRoYXQgYXJlIG9wdGlvbmFsbHkgb24gdGhlIGVuZCBvZiB0aGlzIGxpbmUgLSBmaW5lIGZvciBub24tY2FwdGlvbnMgVlRUXG5cbiAgICAgICAgaWYgKG1hdGNoVGltZXMpIHtcbiAgICAgICAgICByZXN1bHQuc3RhcnRUaW1lID1cbiAgICAgICAgICAgIE51bWJlcihtYXRjaFRpbWVzWzFdIHx8IDApICogNjAgKiA2MCArXG4gICAgICAgICAgICBOdW1iZXIobWF0Y2hUaW1lc1syXSkgKiA2MCArXG4gICAgICAgICAgICBOdW1iZXIobWF0Y2hUaW1lc1szXSkgK1xuICAgICAgICAgICAgTnVtYmVyKGAwLiR7bWF0Y2hUaW1lc1s0XX1gKTtcbiAgICAgICAgICByZXN1bHQuZW5kVGltZSA9XG4gICAgICAgICAgICBOdW1iZXIobWF0Y2hUaW1lc1s2XSB8fCAwKSAqIDYwICogNjAgK1xuICAgICAgICAgICAgTnVtYmVyKG1hdGNoVGltZXNbN10pICogNjAgK1xuICAgICAgICAgICAgTnVtYmVyKG1hdGNoVGltZXNbOF0pICtcbiAgICAgICAgICAgIE51bWJlcihgMC4ke21hdGNoVGltZXNbOV19YCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoIWlzLmVtcHR5KGxpbmUudHJpbSgpKSAmJiBpcy5lbXB0eShyZXN1bHQudGV4dCkpIHtcbiAgICAgICAgLy8gSWYgd2UgYWxyZWFkeSBoYXZlIHRoZSBzdGFydFRpbWUsIHRoZW4gd2UncmUgZGVmaW5pdGVseSB1cCB0byB0aGUgdGV4dCBsaW5lKHMpXG4gICAgICAgIGNvbnN0IGxpbmVTcGxpdCA9IGxpbmUudHJpbSgpLnNwbGl0KCcjeHl3aD0nKTtcbiAgICAgICAgW3Jlc3VsdC50ZXh0XSA9IGxpbmVTcGxpdDtcblxuICAgICAgICAvLyBJZiB0aGVyZSdzIGNvbnRlbnQgaW4gbGluZVNwbGl0WzFdLCB0aGVuIHdlIGhhdmUgc3ByaXRlcy4gSWYgbm90LCB0aGVuIGl0J3MganVzdCBvbmUgZnJhbWUgcGVyIGltYWdlXG4gICAgICAgIGlmIChsaW5lU3BsaXRbMV0pIHtcbiAgICAgICAgICBbcmVzdWx0LngsIHJlc3VsdC55LCByZXN1bHQudywgcmVzdWx0LmhdID0gbGluZVNwbGl0WzFdLnNwbGl0KCcsJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChyZXN1bHQudGV4dCkge1xuICAgICAgcHJvY2Vzc2VkTGlzdC5wdXNoKHJlc3VsdCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gcHJvY2Vzc2VkTGlzdDtcbn07XG5cbi8qKlxuICogUHJldmlldyB0aHVtYm5haWxzIGZvciBzZWVrIGhvdmVyIGFuZCBzY3J1YmJpbmdcbiAqIFNlZWtpbmc6IEhvdmVyIG92ZXIgdGhlIHNlZWsgYmFyIChkZXNrdG9wIG9ubHkpOiBzaG93cyBhIHNtYWxsIHByZXZpZXcgY29udGFpbmVyIGFib3ZlIHRoZSBzZWVrIGJhclxuICogU2NydWJiaW5nOiBDbGljayBhbmQgZHJhZyB0aGUgc2VlayBiYXIgKGRlc2t0b3AgYW5kIG1vYmlsZSk6IHNob3dzIHRoZSBwcmV2aWV3IGltYWdlIG92ZXIgdGhlIGVudGlyZSB2aWRlbywgYXMgaWYgdGhlIHZpZGVvIGlzIHNjcnViYmluZyBhdCB2ZXJ5IGhpZ2ggc3BlZWRcbiAqXG4gKiBOb3RlczpcbiAqIC0gVGh1bWJzIGFyZSBzZXQgdmlhIEpTIHNldHRpbmdzIG9uIFBseXIgaW5pdCwgbm90IEhUTUw1ICd0cmFjaycgcHJvcGVydHkuIFVzaW5nIHRoZSB0cmFjayBwcm9wZXJ0eSB3b3VsZCBiZSBhIGJpdCBncm9zcywgYmVjYXVzZSBpdCBkb2Vzbid0IHN1cHBvcnQgY3VzdG9tICdraW5kcycuIGtpbmQ9bWV0YWRhdGEgbWlnaHQgYmUgdXNlZCBmb3Igc29tZXRoaW5nIGVsc2UsIGFuZCB3ZSB3YW50IHRvIGFsbG93IG11bHRpcGxlIHRodW1ibmFpbHMgdHJhY2tzLiBUcmFja3MgbXVzdCBoYXZlIGEgdW5pcXVlIGNvbWJpbmF0aW9uIG9mICdraW5kJyBhbmQgJ2xhYmVsJy4gV2Ugd291bGQgaGF2ZSB0byBkbyBzb21ldGhpbmcgbGlrZSBraW5kPW1ldGFkYXRhLGxhYmVsPXRodW1ibmFpbHMxIC8ga2luZD1tZXRhZGF0YSxsYWJlbD10aHVtYm5haWxzMi4gU3F1YXJlIHBlZywgcm91bmQgaG9sZVxuICogLSBWVFQgaW5mbzogdGhlIGltYWdlIFVSTCBpcyByZWxhdGl2ZSB0byB0aGUgVlRULCBub3QgdGhlIGN1cnJlbnQgZG9jdW1lbnQuIEJ1dCBpZiB0aGUgdXJsIHN0YXJ0cyB3aXRoIGEgc2xhc2gsIGl0IHdpbGwgbmF0dXJhbGx5IGJlIHJlbGF0aXZlIHRvIHRoZSBjdXJyZW50IGRvbWFpbi4gaHR0cHM6Ly9zdXBwb3J0Lmp3cGxheWVyLmNvbS9hcnRpY2xlcy9ob3ctdG8tYWRkLXByZXZpZXctdGh1bWJuYWlsc1xuICogLSBUaGlzIGltcGxlbWVudGF0aW9uIHVzZXMgbXVsdGlwbGUgc2VwYXJhdGUgaW1nIGVsZW1lbnRzLiBPdGhlciBpbXBsZW1lbnRhdGlvbnMgdXNlIGJhY2tncm91bmQtaW1hZ2Ugb24gb25lIGVsZW1lbnQuIFRoaXMgd291bGQgYmUgbmljZSBhbmQgc2ltcGxlLCBidXQgRmlyZWZveCBhbmQgU2FmYXJpIGhhdmUgZmxpY2tlcmluZyBpc3N1ZXMgd2l0aCByZXBsYWNpbmcgYmFja2dyb3VuZHMgb2YgbGFyZ2VyIGltYWdlcy4gSXQgc2VlbXMgdGhhdCBZb3VUdWJlIHBlcmhhcHMgb25seSBhdm9pZHMgdGhpcyBiZWNhdXNlIHRoZXkgZG9uJ3QgaGF2ZSB0aGUgb3B0aW9uIGZvciBoaWdoLXJlcyBwcmV2aWV3cyAoZXZlbiB0aGUgZnVsbHNjcmVlbiBvbmVzLCB3aGVuIG1vdXNlZG93bi9zZWVraW5nKS4gSW1hZ2VzIGFwcGVhciBvdmVyIHRoZSB0b3Agb2YgZWFjaCBvdGhlciwgYW5kIHByZXZpb3VzIG9uZXMgYXJlIGRpc2NhcmRlZCBvbmNlIHRoZSBuZXcgb25lcyBoYXZlIGJlZW4gcmVuZGVyZWRcbiAqL1xuXG5jb25zdCBmaXRSYXRpbyA9IChyYXRpbywgb3V0ZXIpID0+IHtcbiAgY29uc3QgdGFyZ2V0UmF0aW8gPSBvdXRlci53aWR0aCAvIG91dGVyLmhlaWdodDtcbiAgY29uc3QgcmVzdWx0ID0ge307XG4gIGlmIChyYXRpbyA+IHRhcmdldFJhdGlvKSB7XG4gICAgcmVzdWx0LndpZHRoID0gb3V0ZXIud2lkdGg7XG4gICAgcmVzdWx0LmhlaWdodCA9ICgxIC8gcmF0aW8pICogb3V0ZXIud2lkdGg7XG4gIH0gZWxzZSB7XG4gICAgcmVzdWx0LmhlaWdodCA9IG91dGVyLmhlaWdodDtcbiAgICByZXN1bHQud2lkdGggPSByYXRpbyAqIG91dGVyLmhlaWdodDtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5jbGFzcyBQcmV2aWV3VGh1bWJuYWlscyB7XG4gIC8qKlxuICAgKiBQcmV2aWV3VGh1bWJuYWlscyBjb25zdHJ1Y3Rvci5cbiAgICogQHBhcmFtIHtQbHlyfSBwbGF5ZXJcbiAgICogQHJldHVybiB7UHJldmlld1RodW1ibmFpbHN9XG4gICAqL1xuICBjb25zdHJ1Y3RvcihwbGF5ZXIpIHtcbiAgICB0aGlzLnBsYXllciA9IHBsYXllcjtcbiAgICB0aGlzLnRodW1ibmFpbHMgPSBbXTtcbiAgICB0aGlzLmxvYWRlZCA9IGZhbHNlO1xuICAgIHRoaXMubGFzdE1vdXNlTW92ZVRpbWUgPSBEYXRlLm5vdygpO1xuICAgIHRoaXMubW91c2VEb3duID0gZmFsc2U7XG4gICAgdGhpcy5sb2FkZWRJbWFnZXMgPSBbXTtcblxuICAgIHRoaXMuZWxlbWVudHMgPSB7XG4gICAgICB0aHVtYjoge30sXG4gICAgICBzY3J1YmJpbmc6IHt9LFxuICAgIH07XG5cbiAgICB0aGlzLmxvYWQoKTtcbiAgfVxuXG4gIGdldCBlbmFibGVkKCkge1xuICAgIHJldHVybiB0aGlzLnBsYXllci5pc0hUTUw1ICYmIHRoaXMucGxheWVyLmlzVmlkZW8gJiYgdGhpcy5wbGF5ZXIuY29uZmlnLnByZXZpZXdUaHVtYm5haWxzLmVuYWJsZWQ7XG4gIH1cblxuICBsb2FkID0gKCkgPT4ge1xuICAgIC8vIFRvZ2dsZSB0aGUgcmVndWxhciBzZWVrIHRvb2x0aXBcbiAgICBpZiAodGhpcy5wbGF5ZXIuZWxlbWVudHMuZGlzcGxheS5zZWVrVG9vbHRpcCkge1xuICAgICAgdGhpcy5wbGF5ZXIuZWxlbWVudHMuZGlzcGxheS5zZWVrVG9vbHRpcC5oaWRkZW4gPSB0aGlzLmVuYWJsZWQ7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmVuYWJsZWQpIHJldHVybjtcblxuICAgIHRoaXMuZ2V0VGh1bWJuYWlscygpLnRoZW4oKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBSZW5kZXIgRE9NIGVsZW1lbnRzXG4gICAgICB0aGlzLnJlbmRlcigpO1xuXG4gICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGh1bWIgY29udGFpbmVyIHNpemUgd2FzIHNwZWNpZmllZCBtYW51YWxseSBpbiBDU1NcbiAgICAgIHRoaXMuZGV0ZXJtaW5lQ29udGFpbmVyQXV0b1NpemluZygpO1xuXG4gICAgICB0aGlzLmxvYWRlZCA9IHRydWU7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gRG93bmxvYWQgVlRUIGZpbGVzIGFuZCBwYXJzZSB0aGVtXG4gIGdldFRodW1ibmFpbHMgPSAoKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICBjb25zdCB7IHNyYyB9ID0gdGhpcy5wbGF5ZXIuY29uZmlnLnByZXZpZXdUaHVtYm5haWxzO1xuXG4gICAgICBpZiAoaXMuZW1wdHkoc3JjKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcHJldmlld1RodW1ibmFpbHMuc3JjIGNvbmZpZyBhdHRyaWJ1dGUnKTtcbiAgICAgIH1cblxuICAgICAgLy8gUmVzb2x2ZSBwcm9taXNlXG4gICAgICBjb25zdCBzb3J0QW5kUmVzb2x2ZSA9ICgpID0+IHtcbiAgICAgICAgLy8gU29ydCBzbWFsbGVzdCB0byBiaWdnZXN0IChlLmcuLCBbMTIwcCwgNDgwcCwgMTA4MHBdKVxuICAgICAgICB0aGlzLnRodW1ibmFpbHMuc29ydCgoeCwgeSkgPT4geC5oZWlnaHQgLSB5LmhlaWdodCk7XG5cbiAgICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKCdQcmV2aWV3IHRodW1ibmFpbHMnLCB0aGlzLnRodW1ibmFpbHMpO1xuXG4gICAgICAgIHJlc29sdmUoKTtcbiAgICAgIH07XG5cbiAgICAgIC8vIFZpYSBjYWxsYmFjaygpXG4gICAgICBpZiAoaXMuZnVuY3Rpb24oc3JjKSkge1xuICAgICAgICBzcmMoKHRodW1ibmFpbHMpID0+IHtcbiAgICAgICAgICB0aGlzLnRodW1ibmFpbHMgPSB0aHVtYm5haWxzO1xuICAgICAgICAgIHNvcnRBbmRSZXNvbHZlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgLy8gVlRUIHVybHNcbiAgICAgIGVsc2Uge1xuICAgICAgICAvLyBJZiBzdHJpbmcsIGNvbnZlcnQgaW50byBzaW5nbGUtZWxlbWVudCBsaXN0XG4gICAgICAgIGNvbnN0IHVybHMgPSBpcy5zdHJpbmcoc3JjKSA/IFtzcmNdIDogc3JjO1xuICAgICAgICAvLyBMb29wIHRocm91Z2ggZWFjaCBzcmMgVVJMLiBEb3dubG9hZCBhbmQgcHJvY2VzcyB0aGUgVlRUIGZpbGUsIHN0b3JpbmcgdGhlIHJlc3VsdGluZyBkYXRhIGluIHRoaXMudGh1bWJuYWlsc1xuICAgICAgICBjb25zdCBwcm9taXNlcyA9IHVybHMubWFwKCh1KSA9PiB0aGlzLmdldFRodW1ibmFpbCh1KSk7XG4gICAgICAgIC8vIFJlc29sdmVcbiAgICAgICAgUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oc29ydEFuZFJlc29sdmUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIC8vIFByb2Nlc3MgaW5kaXZpZHVhbCBWVFQgZmlsZVxuICBnZXRUaHVtYm5haWwgPSAodXJsKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICBmZXRjaCh1cmwpLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIGNvbnN0IHRodW1ibmFpbCA9IHtcbiAgICAgICAgICBmcmFtZXM6IHBhcnNlVnR0KHJlc3BvbnNlKSxcbiAgICAgICAgICBoZWlnaHQ6IG51bGwsXG4gICAgICAgICAgdXJsUHJlZml4OiAnJyxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBJZiB0aGUgVVJMcyBkb24ndCBzdGFydCB3aXRoICcvJywgdGhlbiB3ZSBuZWVkIHRvIHNldCB0aGVpciByZWxhdGl2ZSBwYXRoIHRvIGJlIHRoZSBsb2NhdGlvbiBvZiB0aGUgVlRUIGZpbGVcbiAgICAgICAgLy8gSWYgdGhlIFVSTHMgZG8gc3RhcnQgd2l0aCAnLycsIHRoZW4gdGhleSBvYnZpb3VzbHkgZG9uJ3QgbmVlZCBhIHByZWZpeCwgc28gaXQgd2lsbCByZW1haW4gYmxhbmtcbiAgICAgICAgLy8gSWYgdGhlIHRodW1ibmFpbCBVUkxzIHN0YXJ0IHdpdGggd2l0aCBub25lIG9mICcvJywgJ2h0dHA6Ly8nIG9yICdodHRwczovLycsIHRoZW4gd2UgbmVlZCB0byBzZXQgdGhlaXIgcmVsYXRpdmUgcGF0aCB0byBiZSB0aGUgbG9jYXRpb24gb2YgdGhlIFZUVCBmaWxlXG4gICAgICAgIGlmIChcbiAgICAgICAgICAhdGh1bWJuYWlsLmZyYW1lc1swXS50ZXh0LnN0YXJ0c1dpdGgoJy8nKSAmJlxuICAgICAgICAgICF0aHVtYm5haWwuZnJhbWVzWzBdLnRleHQuc3RhcnRzV2l0aCgnaHR0cDovLycpICYmXG4gICAgICAgICAgIXRodW1ibmFpbC5mcmFtZXNbMF0udGV4dC5zdGFydHNXaXRoKCdodHRwczovLycpXG4gICAgICAgICkge1xuICAgICAgICAgIHRodW1ibmFpbC51cmxQcmVmaXggPSB1cmwuc3Vic3RyaW5nKDAsIHVybC5sYXN0SW5kZXhPZignLycpICsgMSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEb3dubG9hZCB0aGUgZmlyc3QgZnJhbWUsIHNvIHRoYXQgd2UgY2FuIGRldGVybWluZS9zZXQgdGhlIGhlaWdodCBvZiB0aGlzIHRodW1ibmFpbHNEZWZcbiAgICAgICAgY29uc3QgdGVtcEltYWdlID0gbmV3IEltYWdlKCk7XG5cbiAgICAgICAgdGVtcEltYWdlLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICB0aHVtYm5haWwuaGVpZ2h0ID0gdGVtcEltYWdlLm5hdHVyYWxIZWlnaHQ7XG4gICAgICAgICAgdGh1bWJuYWlsLndpZHRoID0gdGVtcEltYWdlLm5hdHVyYWxXaWR0aDtcblxuICAgICAgICAgIHRoaXMudGh1bWJuYWlscy5wdXNoKHRodW1ibmFpbCk7XG5cbiAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGVtcEltYWdlLnNyYyA9IHRodW1ibmFpbC51cmxQcmVmaXggKyB0aHVtYm5haWwuZnJhbWVzWzBdLnRleHQ7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBzdGFydE1vdmUgPSAoZXZlbnQpID0+IHtcbiAgICBpZiAoIXRoaXMubG9hZGVkKSByZXR1cm47XG5cbiAgICBpZiAoIWlzLmV2ZW50KGV2ZW50KSB8fCAhWyd0b3VjaG1vdmUnLCAnbW91c2Vtb3ZlJ10uaW5jbHVkZXMoZXZlbnQudHlwZSkpIHJldHVybjtcblxuICAgIC8vIFdhaXQgdW50aWwgbWVkaWEgaGFzIGEgZHVyYXRpb25cbiAgICBpZiAoIXRoaXMucGxheWVyLm1lZGlhLmR1cmF0aW9uKSByZXR1cm47XG5cbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ3RvdWNobW92ZScpIHtcbiAgICAgIC8vIENhbGN1bGF0ZSBzZWVrIGhvdmVyIHBvc2l0aW9uIGFzIGFwcHJveCB2aWRlbyBzZWNvbmRzXG4gICAgICB0aGlzLnNlZWtUaW1lID0gdGhpcy5wbGF5ZXIubWVkaWEuZHVyYXRpb24gKiAodGhpcy5wbGF5ZXIuZWxlbWVudHMuaW5wdXRzLnNlZWsudmFsdWUgLyAxMDApO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDYWxjdWxhdGUgc2VlayBob3ZlciBwb3NpdGlvbiBhcyBhcHByb3ggdmlkZW8gc2Vjb25kc1xuICAgICAgY29uc3QgY2xpZW50UmVjdCA9IHRoaXMucGxheWVyLmVsZW1lbnRzLnByb2dyZXNzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgY29uc3QgcGVyY2VudGFnZSA9ICgxMDAgLyBjbGllbnRSZWN0LndpZHRoKSAqIChldmVudC5wYWdlWCAtIGNsaWVudFJlY3QubGVmdCk7XG4gICAgICB0aGlzLnNlZWtUaW1lID0gdGhpcy5wbGF5ZXIubWVkaWEuZHVyYXRpb24gKiAocGVyY2VudGFnZSAvIDEwMCk7XG5cbiAgICAgIGlmICh0aGlzLnNlZWtUaW1lIDwgMCkge1xuICAgICAgICAvLyBUaGUgbW91c2Vtb3ZlIGZpcmVzIGZvciAxMCtweCBvdXQgdG8gdGhlIGxlZnRcbiAgICAgICAgdGhpcy5zZWVrVGltZSA9IDA7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnNlZWtUaW1lID4gdGhpcy5wbGF5ZXIubWVkaWEuZHVyYXRpb24gLSAxKSB7XG4gICAgICAgIC8vIFRvb2sgMSBzZWNvbmQgb2ZmIHRoZSBkdXJhdGlvbiBmb3Igc2FmZXR5LCBiZWNhdXNlIGRpZmZlcmVudCBwbGF5ZXJzIGNhbiBkaXNhZ3JlZSBvbiB0aGUgcmVhbCBkdXJhdGlvbiBvZiBhIHZpZGVvXG4gICAgICAgIHRoaXMuc2Vla1RpbWUgPSB0aGlzLnBsYXllci5tZWRpYS5kdXJhdGlvbiAtIDE7XG4gICAgICB9XG5cbiAgICAgIHRoaXMubW91c2VQb3NYID0gZXZlbnQucGFnZVg7XG5cbiAgICAgIC8vIFNldCB0aW1lIHRleHQgaW5zaWRlIGltYWdlIGNvbnRhaW5lclxuICAgICAgdGhpcy5lbGVtZW50cy50aHVtYi50aW1lLmlubmVyVGV4dCA9IGZvcm1hdFRpbWUodGhpcy5zZWVrVGltZSk7XG5cbiAgICAgIC8vIEdldCBtYXJrZXIgcG9pbnQgZm9yIHRpbWVcbiAgICAgIGNvbnN0IHBvaW50ID0gdGhpcy5wbGF5ZXIuY29uZmlnLm1hcmtlcnM/LnBvaW50cz8uZmluZCgoeyB0aW1lOiB0IH0pID0+IHQgPT09IE1hdGgucm91bmQodGhpcy5zZWVrVGltZSkpO1xuXG4gICAgICAvLyBBcHBlbmQgdGhlIHBvaW50IGxhYmVsIHRvIHRoZSB0b29sdGlwXG4gICAgICBpZiAocG9pbnQpIHtcbiAgICAgICAgLy8gdGhpcy5lbGVtZW50cy50aHVtYi50aW1lLmlubmVyVGV4dC5jb25jYXQoJ1xcbicpO1xuICAgICAgICB0aGlzLmVsZW1lbnRzLnRodW1iLnRpbWUuaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlcmJlZ2luJywgYCR7cG9pbnQubGFiZWx9PGJyPmApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIERvd25sb2FkIGFuZCBzaG93IGltYWdlXG4gICAgdGhpcy5zaG93SW1hZ2VBdEN1cnJlbnRUaW1lKCk7XG4gIH07XG5cbiAgZW5kTW92ZSA9ICgpID0+IHtcbiAgICB0aGlzLnRvZ2dsZVRodW1iQ29udGFpbmVyKGZhbHNlLCB0cnVlKTtcbiAgfTtcblxuICBzdGFydFNjcnViYmluZyA9IChldmVudCkgPT4ge1xuICAgIC8vIE9ubHkgYWN0IG9uIGxlZnQgbW91c2UgYnV0dG9uICgwKSwgb3IgdG91Y2ggZGV2aWNlIChldmVudC5idXR0b24gZG9lcyBub3QgZXhpc3Qgb3IgaXMgZmFsc2UpXG4gICAgaWYgKGlzLm51bGxPclVuZGVmaW5lZChldmVudC5idXR0b24pIHx8IGV2ZW50LmJ1dHRvbiA9PT0gZmFsc2UgfHwgZXZlbnQuYnV0dG9uID09PSAwKSB7XG4gICAgICB0aGlzLm1vdXNlRG93biA9IHRydWU7XG5cbiAgICAgIC8vIFdhaXQgdW50aWwgbWVkaWEgaGFzIGEgZHVyYXRpb25cbiAgICAgIGlmICh0aGlzLnBsYXllci5tZWRpYS5kdXJhdGlvbikge1xuICAgICAgICB0aGlzLnRvZ2dsZVNjcnViYmluZ0NvbnRhaW5lcih0cnVlKTtcbiAgICAgICAgdGhpcy50b2dnbGVUaHVtYkNvbnRhaW5lcihmYWxzZSwgdHJ1ZSk7XG5cbiAgICAgICAgLy8gRG93bmxvYWQgYW5kIHNob3cgaW1hZ2VcbiAgICAgICAgdGhpcy5zaG93SW1hZ2VBdEN1cnJlbnRUaW1lKCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGVuZFNjcnViYmluZyA9ICgpID0+IHtcbiAgICB0aGlzLm1vdXNlRG93biA9IGZhbHNlO1xuXG4gICAgLy8gSGlkZSBzY3J1YmJpbmcgcHJldmlldy4gQnV0IHdhaXQgdW50aWwgdGhlIHZpZGVvIGhhcyBzdWNjZXNzZnVsbHkgc2Vla2VkIGJlZm9yZSBoaWRpbmcgdGhlIHNjcnViYmluZyBwcmV2aWV3XG4gICAgaWYgKE1hdGguY2VpbCh0aGlzLmxhc3RUaW1lKSA9PT0gTWF0aC5jZWlsKHRoaXMucGxheWVyLm1lZGlhLmN1cnJlbnRUaW1lKSkge1xuICAgICAgLy8gVGhlIHZpZGVvIHdhcyBhbHJlYWR5IHNlZWtlZC9sb2FkZWQgYXQgdGhlIGNob3NlbiB0aW1lIC0gaGlkZSBpbW1lZGlhdGVseVxuICAgICAgdGhpcy50b2dnbGVTY3J1YmJpbmdDb250YWluZXIoZmFsc2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBUaGUgdmlkZW8gaGFzbid0IHNlZWtlZCB5ZXQuIFdhaXQgZm9yIHRoYXRcbiAgICAgIG9uY2UuY2FsbCh0aGlzLnBsYXllciwgdGhpcy5wbGF5ZXIubWVkaWEsICd0aW1ldXBkYXRlJywgKCkgPT4ge1xuICAgICAgICAvLyBSZS1jaGVjayBtb3VzZWRvd24gLSB3ZSBtaWdodCBoYXZlIGFscmVhZHkgc3RhcnRlZCBzY3J1YmJpbmcgYWdhaW5cbiAgICAgICAgaWYgKCF0aGlzLm1vdXNlRG93bikge1xuICAgICAgICAgIHRoaXMudG9nZ2xlU2NydWJiaW5nQ29udGFpbmVyKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBTZXR1cCBob29rcyBmb3IgUGx5ciBhbmQgd2luZG93IGV2ZW50c1xuICAgKi9cbiAgbGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIC8vIEhpZGUgdGh1bWJuYWlsIHByZXZpZXcgLSBvbiBtb3VzZSBjbGljaywgbW91c2UgbGVhdmUgKGluIGxpc3RlbmVycy5qcyBmb3Igbm93KSwgYW5kIHZpZGVvIHBsYXkvc2Vlay4gQWxsIGZvdXIgYXJlIHJlcXVpcmVkLCBlLmcuLCBmb3IgYnVmZmVyaW5nXG4gICAgdGhpcy5wbGF5ZXIub24oJ3BsYXknLCAoKSA9PiB7XG4gICAgICB0aGlzLnRvZ2dsZVRodW1iQ29udGFpbmVyKGZhbHNlLCB0cnVlKTtcbiAgICB9KTtcblxuICAgIHRoaXMucGxheWVyLm9uKCdzZWVrZWQnLCAoKSA9PiB7XG4gICAgICB0aGlzLnRvZ2dsZVRodW1iQ29udGFpbmVyKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIHRoaXMucGxheWVyLm9uKCd0aW1ldXBkYXRlJywgKCkgPT4ge1xuICAgICAgdGhpcy5sYXN0VGltZSA9IHRoaXMucGxheWVyLm1lZGlhLmN1cnJlbnRUaW1lO1xuICAgIH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDcmVhdGUgSFRNTCBlbGVtZW50cyBmb3IgaW1hZ2UgY29udGFpbmVyc1xuICAgKi9cbiAgcmVuZGVyID0gKCkgPT4ge1xuICAgIC8vIENyZWF0ZSBIVE1MIGVsZW1lbnQ6IHBseXJfX3ByZXZpZXctdGh1bWJuYWlsLWNvbnRhaW5lclxuICAgIHRoaXMuZWxlbWVudHMudGh1bWIuY29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgY2xhc3M6IHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLnByZXZpZXdUaHVtYm5haWxzLnRodW1iQ29udGFpbmVyLFxuICAgIH0pO1xuXG4gICAgLy8gV3JhcHBlciBmb3IgdGhlIGltYWdlIGZvciBzdHlsaW5nXG4gICAgdGhpcy5lbGVtZW50cy50aHVtYi5pbWFnZUNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgIGNsYXNzOiB0aGlzLnBsYXllci5jb25maWcuY2xhc3NOYW1lcy5wcmV2aWV3VGh1bWJuYWlscy5pbWFnZUNvbnRhaW5lcixcbiAgICB9KTtcbiAgICB0aGlzLmVsZW1lbnRzLnRodW1iLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnRzLnRodW1iLmltYWdlQ29udGFpbmVyKTtcblxuICAgIC8vIENyZWF0ZSBIVE1MIGVsZW1lbnQsIHBhcmVudCtzcGFuOiB0aW1lIHRleHQgKGUuZy4sIDAxOjMyOjAwKVxuICAgIGNvbnN0IHRpbWVDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICBjbGFzczogdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMucHJldmlld1RodW1ibmFpbHMudGltZUNvbnRhaW5lcixcbiAgICB9KTtcblxuICAgIHRoaXMuZWxlbWVudHMudGh1bWIudGltZSA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7fSwgJzAwOjAwJyk7XG4gICAgdGltZUNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnRzLnRodW1iLnRpbWUpO1xuXG4gICAgdGhpcy5lbGVtZW50cy50aHVtYi5pbWFnZUNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aW1lQ29udGFpbmVyKTtcblxuICAgIC8vIEluamVjdCB0aGUgd2hvbGUgdGh1bWJcbiAgICBpZiAoaXMuZWxlbWVudCh0aGlzLnBsYXllci5lbGVtZW50cy5wcm9ncmVzcykpIHtcbiAgICAgIHRoaXMucGxheWVyLmVsZW1lbnRzLnByb2dyZXNzLmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudHMudGh1bWIuY29udGFpbmVyKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgSFRNTCBlbGVtZW50OiBwbHlyX19wcmV2aWV3LXNjcnViYmluZy1jb250YWluZXJcbiAgICB0aGlzLmVsZW1lbnRzLnNjcnViYmluZy5jb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICBjbGFzczogdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMucHJldmlld1RodW1ibmFpbHMuc2NydWJiaW5nQ29udGFpbmVyLFxuICAgIH0pO1xuXG4gICAgdGhpcy5wbGF5ZXIuZWxlbWVudHMud3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnRzLnNjcnViYmluZy5jb250YWluZXIpO1xuICB9O1xuXG4gIGRlc3Ryb3kgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMuZWxlbWVudHMudGh1bWIuY29udGFpbmVyKSB7XG4gICAgICB0aGlzLmVsZW1lbnRzLnRodW1iLmNvbnRhaW5lci5yZW1vdmUoKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lcikge1xuICAgICAgdGhpcy5lbGVtZW50cy5zY3J1YmJpbmcuY29udGFpbmVyLnJlbW92ZSgpO1xuICAgIH1cbiAgfTtcblxuICBzaG93SW1hZ2VBdEN1cnJlbnRUaW1lID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLm1vdXNlRG93bikge1xuICAgICAgdGhpcy5zZXRTY3J1YmJpbmdDb250YWluZXJTaXplKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2V0VGh1bWJDb250YWluZXJTaXplQW5kUG9zKCk7XG4gICAgfVxuXG4gICAgLy8gRmluZCB0aGUgZGVzaXJlZCB0aHVtYm5haWwgaW5kZXhcbiAgICAvLyBUT0RPOiBIYW5kbGUgYSB2aWRlbyBsb25nZXIgdGhhbiB0aGUgdGh1bWJzIHdoZXJlIHRodW1iTnVtIGlzIG51bGxcbiAgICBjb25zdCB0aHVtYk51bSA9IHRoaXMudGh1bWJuYWlsc1swXS5mcmFtZXMuZmluZEluZGV4KFxuICAgICAgKGZyYW1lKSA9PiB0aGlzLnNlZWtUaW1lID49IGZyYW1lLnN0YXJ0VGltZSAmJiB0aGlzLnNlZWtUaW1lIDw9IGZyYW1lLmVuZFRpbWUsXG4gICAgKTtcbiAgICBjb25zdCBoYXNUaHVtYiA9IHRodW1iTnVtID49IDA7XG4gICAgbGV0IHF1YWxpdHlJbmRleCA9IDA7XG5cbiAgICAvLyBTaG93IHRoZSB0aHVtYiBjb250YWluZXIgaWYgd2UncmUgbm90IHNjcnViYmluZ1xuICAgIGlmICghdGhpcy5tb3VzZURvd24pIHtcbiAgICAgIHRoaXMudG9nZ2xlVGh1bWJDb250YWluZXIoaGFzVGh1bWIpO1xuICAgIH1cblxuICAgIC8vIE5vIG1hdGNoaW5nIHRodW1iIGZvdW5kXG4gICAgaWYgKCFoYXNUaHVtYikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIENoZWNrIHRvIHNlZSBpZiB3ZSd2ZSBhbHJlYWR5IGRvd25sb2FkZWQgaGlnaGVyIHF1YWxpdHkgdmVyc2lvbnMgb2YgdGhpcyBpbWFnZVxuICAgIHRoaXMudGh1bWJuYWlscy5mb3JFYWNoKCh0aHVtYm5haWwsIGluZGV4KSA9PiB7XG4gICAgICBpZiAodGhpcy5sb2FkZWRJbWFnZXMuaW5jbHVkZXModGh1bWJuYWlsLmZyYW1lc1t0aHVtYk51bV0udGV4dCkpIHtcbiAgICAgICAgcXVhbGl0eUluZGV4ID0gaW5kZXg7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBPbmx5IHByb2NlZWQgaWYgZWl0aGVyIHRodW1iIG51bSBvciB0aHVtYmZpbGVuYW1lIGhhcyBjaGFuZ2VkXG4gICAgaWYgKHRodW1iTnVtICE9PSB0aGlzLnNob3dpbmdUaHVtYikge1xuICAgICAgdGhpcy5zaG93aW5nVGh1bWIgPSB0aHVtYk51bTtcbiAgICAgIHRoaXMubG9hZEltYWdlKHF1YWxpdHlJbmRleCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIFNob3cgdGhlIGltYWdlIHRoYXQncyBjdXJyZW50bHkgc3BlY2lmaWVkIGluIHRoaXMuc2hvd2luZ1RodW1iXG4gIGxvYWRJbWFnZSA9IChxdWFsaXR5SW5kZXggPSAwKSA9PiB7XG4gICAgY29uc3QgdGh1bWJOdW0gPSB0aGlzLnNob3dpbmdUaHVtYjtcbiAgICBjb25zdCB0aHVtYm5haWwgPSB0aGlzLnRodW1ibmFpbHNbcXVhbGl0eUluZGV4XTtcbiAgICBjb25zdCB7IHVybFByZWZpeCB9ID0gdGh1bWJuYWlsO1xuICAgIGNvbnN0IGZyYW1lID0gdGh1bWJuYWlsLmZyYW1lc1t0aHVtYk51bV07XG4gICAgY29uc3QgdGh1bWJGaWxlbmFtZSA9IHRodW1ibmFpbC5mcmFtZXNbdGh1bWJOdW1dLnRleHQ7XG4gICAgY29uc3QgdGh1bWJVcmwgPSB1cmxQcmVmaXggKyB0aHVtYkZpbGVuYW1lO1xuXG4gICAgaWYgKCF0aGlzLmN1cnJlbnRJbWFnZUVsZW1lbnQgfHwgdGhpcy5jdXJyZW50SW1hZ2VFbGVtZW50LmRhdGFzZXQuZmlsZW5hbWUgIT09IHRodW1iRmlsZW5hbWUpIHtcbiAgICAgIC8vIElmIHdlJ3JlIGFscmVhZHkgbG9hZGluZyBhIHByZXZpb3VzIGltYWdlLCByZW1vdmUgaXRzIG9ubG9hZCBoYW5kbGVyIC0gd2UgZG9uJ3Qgd2FudCBpdCB0byBsb2FkIGFmdGVyIHRoaXMgb25lXG4gICAgICAvLyBPbmx5IGRvIHRoaXMgaWYgbm90IHVzaW5nIHNwcml0ZXMuIFdpdGhvdXQgc3ByaXRlcyB3ZSByZWFsbHkgd2FudCB0byBzaG93IGFzIG1hbnkgaW1hZ2VzIGFzIHBvc3NpYmxlLCBhcyBhIGJlc3QtZWZmb3J0XG4gICAgICBpZiAodGhpcy5sb2FkaW5nSW1hZ2UgJiYgdGhpcy51c2luZ1Nwcml0ZXMpIHtcbiAgICAgICAgdGhpcy5sb2FkaW5nSW1hZ2Uub25sb2FkID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgLy8gV2UncmUgYnVpbGRpbmcgYW5kIGFkZGluZyBhIG5ldyBpbWFnZS4gSW4gb3RoZXIgaW1wbGVtZW50YXRpb25zIG9mIHNpbWlsYXIgZnVuY3Rpb25hbGl0eSAoWW91VHViZSksIGJhY2tncm91bmQgaW1hZ2VcbiAgICAgIC8vIGlzIGluc3RlYWQgdXNlZC4gQnV0IHRoaXMgY2F1c2VzIGlzc3VlcyB3aXRoIGxhcmdlciBpbWFnZXMgaW4gRmlyZWZveCBhbmQgU2FmYXJpIC0gc3dpdGNoaW5nIGJldHdlZW4gYmFja2dyb3VuZFxuICAgICAgLy8gaW1hZ2VzIGNhdXNlcyBhIGZsaWNrZXIuIFB1dHRpbmcgYSBuZXcgaW1hZ2Ugb3ZlciB0aGUgdG9wIGRvZXMgbm90XG4gICAgICBjb25zdCBwcmV2aWV3SW1hZ2UgPSBuZXcgSW1hZ2UoKTtcbiAgICAgIHByZXZpZXdJbWFnZS5zcmMgPSB0aHVtYlVybDtcbiAgICAgIHByZXZpZXdJbWFnZS5kYXRhc2V0LmluZGV4ID0gdGh1bWJOdW07XG4gICAgICBwcmV2aWV3SW1hZ2UuZGF0YXNldC5maWxlbmFtZSA9IHRodW1iRmlsZW5hbWU7XG4gICAgICB0aGlzLnNob3dpbmdUaHVtYkZpbGVuYW1lID0gdGh1bWJGaWxlbmFtZTtcblxuICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKGBMb2FkaW5nIGltYWdlOiAke3RodW1iVXJsfWApO1xuXG4gICAgICAvLyBGb3Igc29tZSByZWFzb24sIHBhc3NpbmcgdGhlIG5hbWVkIGZ1bmN0aW9uIGRpcmVjdGx5IGNhdXNlcyBpdCB0byBleGVjdXRlIGltbWVkaWF0ZWx5LiBTbyBJJ3ZlIHdyYXBwZWQgaXQgaW4gYW4gYW5vbnltb3VzIGZ1bmN0aW9uLi4uXG4gICAgICBwcmV2aWV3SW1hZ2Uub25sb2FkID0gKCkgPT4gdGhpcy5zaG93SW1hZ2UocHJldmlld0ltYWdlLCBmcmFtZSwgcXVhbGl0eUluZGV4LCB0aHVtYk51bSwgdGh1bWJGaWxlbmFtZSwgdHJ1ZSk7XG4gICAgICB0aGlzLmxvYWRpbmdJbWFnZSA9IHByZXZpZXdJbWFnZTtcbiAgICAgIHRoaXMucmVtb3ZlT2xkSW1hZ2VzKHByZXZpZXdJbWFnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFVwZGF0ZSB0aGUgZXhpc3RpbmcgaW1hZ2VcbiAgICAgIHRoaXMuc2hvd0ltYWdlKHRoaXMuY3VycmVudEltYWdlRWxlbWVudCwgZnJhbWUsIHF1YWxpdHlJbmRleCwgdGh1bWJOdW0sIHRodW1iRmlsZW5hbWUsIGZhbHNlKTtcbiAgICAgIHRoaXMuY3VycmVudEltYWdlRWxlbWVudC5kYXRhc2V0LmluZGV4ID0gdGh1bWJOdW07XG4gICAgICB0aGlzLnJlbW92ZU9sZEltYWdlcyh0aGlzLmN1cnJlbnRJbWFnZUVsZW1lbnQpO1xuICAgIH1cbiAgfTtcblxuICBzaG93SW1hZ2UgPSAocHJldmlld0ltYWdlLCBmcmFtZSwgcXVhbGl0eUluZGV4LCB0aHVtYk51bSwgdGh1bWJGaWxlbmFtZSwgbmV3SW1hZ2UgPSB0cnVlKSA9PiB7XG4gICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKFxuICAgICAgYFNob3dpbmcgdGh1bWI6ICR7dGh1bWJGaWxlbmFtZX0uIG51bTogJHt0aHVtYk51bX0uIHF1YWw6ICR7cXVhbGl0eUluZGV4fS4gbmV3aW1nOiAke25ld0ltYWdlfWAsXG4gICAgKTtcbiAgICB0aGlzLnNldEltYWdlU2l6ZUFuZE9mZnNldChwcmV2aWV3SW1hZ2UsIGZyYW1lKTtcblxuICAgIGlmIChuZXdJbWFnZSkge1xuICAgICAgdGhpcy5jdXJyZW50SW1hZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQocHJldmlld0ltYWdlKTtcbiAgICAgIHRoaXMuY3VycmVudEltYWdlRWxlbWVudCA9IHByZXZpZXdJbWFnZTtcblxuICAgICAgaWYgKCF0aGlzLmxvYWRlZEltYWdlcy5pbmNsdWRlcyh0aHVtYkZpbGVuYW1lKSkge1xuICAgICAgICB0aGlzLmxvYWRlZEltYWdlcy5wdXNoKHRodW1iRmlsZW5hbWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFByZWxvYWQgaW1hZ2VzIGJlZm9yZSBhbmQgYWZ0ZXIgdGhlIGN1cnJlbnQgb25lXG4gICAgLy8gU2hvdyBoaWdoZXIgcXVhbGl0eSBvZiB0aGUgc2FtZSBmcmFtZVxuICAgIC8vIEVhY2ggc3RlcCBoZXJlIGhhcyBhIHNob3J0IHRpbWUgZGVsYXksIGFuZCBvbmx5IGNvbnRpbnVlcyBpZiBzdGlsbCBob3ZlcmluZy9zZWVraW5nIHRoZSBzYW1lIHNwb3QuIFRoaXMgaXMgdG8gcHJvdGVjdCBzbG93IGNvbm5lY3Rpb25zIGZyb20gb3ZlcmxvYWRpbmdcbiAgICB0aGlzLnByZWxvYWROZWFyYnkodGh1bWJOdW0sIHRydWUpXG4gICAgICAudGhlbih0aGlzLnByZWxvYWROZWFyYnkodGh1bWJOdW0sIGZhbHNlKSlcbiAgICAgIC50aGVuKHRoaXMuZ2V0SGlnaGVyUXVhbGl0eShxdWFsaXR5SW5kZXgsIHByZXZpZXdJbWFnZSwgZnJhbWUsIHRodW1iRmlsZW5hbWUpKTtcbiAgfTtcblxuICAvLyBSZW1vdmUgYWxsIHByZXZpZXcgaW1hZ2VzIHRoYXQgYXJlbid0IHRoZSBkZXNpZ25hdGVkIGN1cnJlbnQgaW1hZ2VcbiAgcmVtb3ZlT2xkSW1hZ2VzID0gKGN1cnJlbnRJbWFnZSkgPT4ge1xuICAgIC8vIEdldCBhIGxpc3Qgb2YgYWxsIGltYWdlcywgY29udmVydCBpdCBmcm9tIGEgRE9NIGxpc3QgdG8gYW4gYXJyYXlcbiAgICBBcnJheS5mcm9tKHRoaXMuY3VycmVudEltYWdlQ29udGFpbmVyLmNoaWxkcmVuKS5mb3JFYWNoKChpbWFnZSkgPT4ge1xuICAgICAgaWYgKGltYWdlLnRhZ05hbWUudG9Mb3dlckNhc2UoKSAhPT0gJ2ltZycpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZW1vdmVEZWxheSA9IHRoaXMudXNpbmdTcHJpdGVzID8gNTAwIDogMTAwMDtcblxuICAgICAgaWYgKGltYWdlLmRhdGFzZXQuaW5kZXggIT09IGN1cnJlbnRJbWFnZS5kYXRhc2V0LmluZGV4ICYmICFpbWFnZS5kYXRhc2V0LmRlbGV0aW5nKSB7XG4gICAgICAgIC8vIFdhaXQgMjAwbXMsIGFzIHRoZSBuZXcgaW1hZ2UgY2FuIHRha2Ugc29tZSB0aW1lIHRvIHNob3cgb24gY2VydGFpbiBicm93c2VycyAoZXZlbiB0aG91Z2ggaXQgd2FzIGRvd25sb2FkZWQgYmVmb3JlIHNob3dpbmcpLiBUaGlzIHdpbGwgcHJldmVudCBmbGlja2VyLCBhbmQgc2hvdyBzb21lIGdlbmVyb3NpdHkgdG93YXJkcyBzbG93ZXIgY2xpZW50c1xuICAgICAgICAvLyBGaXJzdCBzZXQgYXR0cmlidXRlICdkZWxldGluZycgdG8gcHJldmVudCBtdWx0aS1oYW5kbGluZyBvZiB0aGlzIG9uIHJlcGVhdCBmaXJpbmcgb2YgdGhpcyBmdW5jdGlvblxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgICAgaW1hZ2UuZGF0YXNldC5kZWxldGluZyA9IHRydWU7XG5cbiAgICAgICAgLy8gVGhpcyBoYXMgdG8gYmUgc2V0IGJlZm9yZSB0aGUgdGltZW91dCAtIHRvIHByZXZlbnQgaXNzdWVzIHN3aXRjaGluZyBiZXR3ZWVuIGhvdmVyIGFuZCBzY3J1YlxuICAgICAgICBjb25zdCB7IGN1cnJlbnRJbWFnZUNvbnRhaW5lciB9ID0gdGhpcztcblxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBjdXJyZW50SW1hZ2VDb250YWluZXIucmVtb3ZlQ2hpbGQoaW1hZ2UpO1xuICAgICAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZyhgUmVtb3ZpbmcgdGh1bWI6ICR7aW1hZ2UuZGF0YXNldC5maWxlbmFtZX1gKTtcbiAgICAgICAgfSwgcmVtb3ZlRGVsYXkpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIC8vIFByZWxvYWQgaW1hZ2VzIGJlZm9yZSBhbmQgYWZ0ZXIgdGhlIGN1cnJlbnQgb25lLiBPbmx5IGlmIHRoZSB1c2VyIGlzIHN0aWxsIGhvdmVyaW5nL3NlZWtpbmcgdGhlIHNhbWUgZnJhbWVcbiAgLy8gVGhpcyB3aWxsIG9ubHkgcHJlbG9hZCB0aGUgbG93ZXN0IHF1YWxpdHlcbiAgcHJlbG9hZE5lYXJieSA9ICh0aHVtYk51bSwgZm9yd2FyZCA9IHRydWUpID0+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBjb25zdCBvbGRUaHVtYkZpbGVuYW1lID0gdGhpcy50aHVtYm5haWxzWzBdLmZyYW1lc1t0aHVtYk51bV0udGV4dDtcblxuICAgICAgICBpZiAodGhpcy5zaG93aW5nVGh1bWJGaWxlbmFtZSA9PT0gb2xkVGh1bWJGaWxlbmFtZSkge1xuICAgICAgICAgIC8vIEZpbmQgdGhlIG5lYXJlc3QgdGh1bWJzIHdpdGggZGlmZmVyZW50IGZpbGVuYW1lcy4gU29tZXRpbWVzIGl0J2xsIGJlIHRoZSBuZXh0IGluZGV4LCBidXQgaW4gdGhlIGNhc2Ugb2Ygc3ByaXRlcywgaXQgbWlnaHQgYmUgMTAwKyBhd2F5XG4gICAgICAgICAgbGV0IHRodW1ibmFpbHNDbG9uZTtcbiAgICAgICAgICBpZiAoZm9yd2FyZCkge1xuICAgICAgICAgICAgdGh1bWJuYWlsc0Nsb25lID0gdGhpcy50aHVtYm5haWxzWzBdLmZyYW1lcy5zbGljZSh0aHVtYk51bSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRodW1ibmFpbHNDbG9uZSA9IHRoaXMudGh1bWJuYWlsc1swXS5mcmFtZXMuc2xpY2UoMCwgdGh1bWJOdW0pLnJldmVyc2UoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBsZXQgZm91bmRPbmUgPSBmYWxzZTtcblxuICAgICAgICAgIHRodW1ibmFpbHNDbG9uZS5mb3JFYWNoKChmcmFtZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmV3VGh1bWJGaWxlbmFtZSA9IGZyYW1lLnRleHQ7XG5cbiAgICAgICAgICAgIGlmIChuZXdUaHVtYkZpbGVuYW1lICE9PSBvbGRUaHVtYkZpbGVuYW1lKSB7XG4gICAgICAgICAgICAgIC8vIEZvdW5kIG9uZSB3aXRoIGEgZGlmZmVyZW50IGZpbGVuYW1lLiBNYWtlIHN1cmUgaXQgaGFzbid0IGFscmVhZHkgYmVlbiBsb2FkZWQgb24gdGhpcyBwYWdlIHZpc2l0XG4gICAgICAgICAgICAgIGlmICghdGhpcy5sb2FkZWRJbWFnZXMuaW5jbHVkZXMobmV3VGh1bWJGaWxlbmFtZSkpIHtcbiAgICAgICAgICAgICAgICBmb3VuZE9uZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKGBQcmVsb2FkaW5nIHRodW1iIGZpbGVuYW1lOiAke25ld1RodW1iRmlsZW5hbWV9YCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCB7IHVybFByZWZpeCB9ID0gdGhpcy50aHVtYm5haWxzWzBdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRodW1iVVJMID0gdXJsUHJlZml4ICsgbmV3VGh1bWJGaWxlbmFtZTtcbiAgICAgICAgICAgICAgICBjb25zdCBwcmV2aWV3SW1hZ2UgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICAgICAgICBwcmV2aWV3SW1hZ2Uuc3JjID0gdGh1bWJVUkw7XG4gICAgICAgICAgICAgICAgcHJldmlld0ltYWdlLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZyhgUHJlbG9hZGVkIHRodW1iIGZpbGVuYW1lOiAke25ld1RodW1iRmlsZW5hbWV9YCk7XG4gICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubG9hZGVkSW1hZ2VzLmluY2x1ZGVzKG5ld1RodW1iRmlsZW5hbWUpKSB0aGlzLmxvYWRlZEltYWdlcy5wdXNoKG5ld1RodW1iRmlsZW5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAvLyBXZSBkb24ndCByZXNvbHZlIHVudGlsIHRoZSB0aHVtYiBpcyBsb2FkZWRcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBJZiB0aGVyZSBhcmUgbm9uZSB0byBwcmVsb2FkIHRoZW4gd2Ugd2FudCB0byByZXNvbHZlIGltbWVkaWF0ZWx5XG4gICAgICAgICAgaWYgKCFmb3VuZE9uZSkge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgMzAwKTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBJZiB1c2VyIGhhcyBiZWVuIGhvdmVyaW5nIGN1cnJlbnQgaW1hZ2UgZm9yIGhhbGYgYSBzZWNvbmQsIGxvb2sgZm9yIGEgaGlnaGVyIHF1YWxpdHkgb25lXG4gIGdldEhpZ2hlclF1YWxpdHkgPSAoY3VycmVudFF1YWxpdHlJbmRleCwgcHJldmlld0ltYWdlLCBmcmFtZSwgdGh1bWJGaWxlbmFtZSkgPT4ge1xuICAgIGlmIChjdXJyZW50UXVhbGl0eUluZGV4IDwgdGhpcy50aHVtYm5haWxzLmxlbmd0aCAtIDEpIHtcbiAgICAgIC8vIE9ubHkgdXNlIHRoZSBoaWdoZXIgcXVhbGl0eSB2ZXJzaW9uIGlmIGl0J3MgZ29pbmcgdG8gbG9vayBhbnkgYmV0dGVyIC0gaWYgdGhlIGN1cnJlbnQgdGh1bWIgaXMgb2YgYSBsb3dlciBwaXhlbCBkZW5zaXR5IHRoYW4gdGhlIHRodW1ibmFpbCBjb250YWluZXJcbiAgICAgIGxldCBwcmV2aWV3SW1hZ2VIZWlnaHQgPSBwcmV2aWV3SW1hZ2UubmF0dXJhbEhlaWdodDtcblxuICAgICAgaWYgKHRoaXMudXNpbmdTcHJpdGVzKSB7XG4gICAgICAgIHByZXZpZXdJbWFnZUhlaWdodCA9IGZyYW1lLmg7XG4gICAgICB9XG5cbiAgICAgIGlmIChwcmV2aWV3SW1hZ2VIZWlnaHQgPCB0aGlzLnRodW1iQ29udGFpbmVySGVpZ2h0KSB7XG4gICAgICAgIC8vIFJlY3Vyc2UgYmFjayB0byB0aGUgbG9hZEltYWdlIGZ1bmN0aW9uIC0gc2hvdyBhIGhpZ2hlciBxdWFsaXR5IG9uZSwgYnV0IG9ubHkgaWYgdGhlIHZpZXdlciBpcyBvbiB0aGlzIGZyYW1lIGZvciBhIHdoaWxlXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgbW91c2UgaGFzbid0IGFscmVhZHkgbW92ZWQgb24gYW5kIHN0YXJ0ZWQgaG92ZXJpbmcgYXQgYW5vdGhlciBpbWFnZVxuICAgICAgICAgIGlmICh0aGlzLnNob3dpbmdUaHVtYkZpbGVuYW1lID09PSB0aHVtYkZpbGVuYW1lKSB7XG4gICAgICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coYFNob3dpbmcgaGlnaGVyIHF1YWxpdHkgdGh1bWIgZm9yOiAke3RodW1iRmlsZW5hbWV9YCk7XG4gICAgICAgICAgICB0aGlzLmxvYWRJbWFnZShjdXJyZW50UXVhbGl0eUluZGV4ICsgMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCAzMDApO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBnZXQgY3VycmVudEltYWdlQ29udGFpbmVyKCkge1xuICAgIHJldHVybiB0aGlzLm1vdXNlRG93biA/IHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lciA6IHRoaXMuZWxlbWVudHMudGh1bWIuaW1hZ2VDb250YWluZXI7XG4gIH1cblxuICBnZXQgdXNpbmdTcHJpdGVzKCkge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnRodW1ibmFpbHNbMF0uZnJhbWVzWzBdKS5pbmNsdWRlcygndycpO1xuICB9XG5cbiAgZ2V0IHRodW1iQXNwZWN0UmF0aW8oKSB7XG4gICAgaWYgKHRoaXMudXNpbmdTcHJpdGVzKSB7XG4gICAgICByZXR1cm4gdGhpcy50aHVtYm5haWxzWzBdLmZyYW1lc1swXS53IC8gdGhpcy50aHVtYm5haWxzWzBdLmZyYW1lc1swXS5oO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnRodW1ibmFpbHNbMF0ud2lkdGggLyB0aGlzLnRodW1ibmFpbHNbMF0uaGVpZ2h0O1xuICB9XG5cbiAgZ2V0IHRodW1iQ29udGFpbmVySGVpZ2h0KCkge1xuICAgIGlmICh0aGlzLm1vdXNlRG93bikge1xuICAgICAgY29uc3QgeyBoZWlnaHQgfSA9IGZpdFJhdGlvKHRoaXMudGh1bWJBc3BlY3RSYXRpbywge1xuICAgICAgICB3aWR0aDogdGhpcy5wbGF5ZXIubWVkaWEuY2xpZW50V2lkdGgsXG4gICAgICAgIGhlaWdodDogdGhpcy5wbGF5ZXIubWVkaWEuY2xpZW50SGVpZ2h0LFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gaGVpZ2h0O1xuICAgIH1cblxuICAgIC8vIElmIGNzcyBpcyB1c2VkIHRoaXMgbmVlZHMgdG8gcmV0dXJuIHRoZSBjc3MgaGVpZ2h0IGZvciBzcHJpdGVzIHRvIHdvcmsgKHNlZSBzZXRJbWFnZVNpemVBbmRPZmZzZXQpXG4gICAgaWYgKHRoaXMuc2l6ZVNwZWNpZmllZEluQ1NTKSB7XG4gICAgICByZXR1cm4gdGhpcy5lbGVtZW50cy50aHVtYi5pbWFnZUNvbnRhaW5lci5jbGllbnRIZWlnaHQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIE1hdGguZmxvb3IodGhpcy5wbGF5ZXIubWVkaWEuY2xpZW50V2lkdGggLyB0aGlzLnRodW1iQXNwZWN0UmF0aW8gLyA0KTtcbiAgfVxuXG4gIGdldCBjdXJyZW50SW1hZ2VFbGVtZW50KCkge1xuICAgIHJldHVybiB0aGlzLm1vdXNlRG93biA/IHRoaXMuY3VycmVudFNjcnViYmluZ0ltYWdlRWxlbWVudCA6IHRoaXMuY3VycmVudFRodW1ibmFpbEltYWdlRWxlbWVudDtcbiAgfVxuXG4gIHNldCBjdXJyZW50SW1hZ2VFbGVtZW50KGVsZW1lbnQpIHtcbiAgICBpZiAodGhpcy5tb3VzZURvd24pIHtcbiAgICAgIHRoaXMuY3VycmVudFNjcnViYmluZ0ltYWdlRWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY3VycmVudFRodW1ibmFpbEltYWdlRWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgfVxuICB9XG5cbiAgdG9nZ2xlVGh1bWJDb250YWluZXIgPSAodG9nZ2xlID0gZmFsc2UsIGNsZWFyU2hvd2luZyA9IGZhbHNlKSA9PiB7XG4gICAgY29uc3QgY2xhc3NOYW1lID0gdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMucHJldmlld1RodW1ibmFpbHMudGh1bWJDb250YWluZXJTaG93bjtcbiAgICB0aGlzLmVsZW1lbnRzLnRodW1iLmNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKGNsYXNzTmFtZSwgdG9nZ2xlKTtcblxuICAgIGlmICghdG9nZ2xlICYmIGNsZWFyU2hvd2luZykge1xuICAgICAgdGhpcy5zaG93aW5nVGh1bWIgPSBudWxsO1xuICAgICAgdGhpcy5zaG93aW5nVGh1bWJGaWxlbmFtZSA9IG51bGw7XG4gICAgfVxuICB9O1xuXG4gIHRvZ2dsZVNjcnViYmluZ0NvbnRhaW5lciA9ICh0b2dnbGUgPSBmYWxzZSkgPT4ge1xuICAgIGNvbnN0IGNsYXNzTmFtZSA9IHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLnByZXZpZXdUaHVtYm5haWxzLnNjcnViYmluZ0NvbnRhaW5lclNob3duO1xuICAgIHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKGNsYXNzTmFtZSwgdG9nZ2xlKTtcblxuICAgIGlmICghdG9nZ2xlKSB7XG4gICAgICB0aGlzLnNob3dpbmdUaHVtYiA9IG51bGw7XG4gICAgICB0aGlzLnNob3dpbmdUaHVtYkZpbGVuYW1lID0gbnVsbDtcbiAgICB9XG4gIH07XG5cbiAgZGV0ZXJtaW5lQ29udGFpbmVyQXV0b1NpemluZyA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5lbGVtZW50cy50aHVtYi5pbWFnZUNvbnRhaW5lci5jbGllbnRIZWlnaHQgPiAyMCB8fCB0aGlzLmVsZW1lbnRzLnRodW1iLmltYWdlQ29udGFpbmVyLmNsaWVudFdpZHRoID4gMjApIHtcbiAgICAgIC8vIFRoaXMgd2lsbCBwcmV2ZW50IGF1dG8gc2l6aW5nIGluIHRoaXMuc2V0VGh1bWJDb250YWluZXJTaXplQW5kUG9zKClcbiAgICAgIHRoaXMuc2l6ZVNwZWNpZmllZEluQ1NTID0gdHJ1ZTtcbiAgICB9XG4gIH07XG5cbiAgLy8gU2V0IHRoZSBzaXplIHRvIGJlIGFib3V0IGEgcXVhcnRlciBvZiB0aGUgc2l6ZSBvZiB2aWRlby4gVW5sZXNzIG9wdGlvbiBkeW5hbWljU2l6ZSA9PT0gZmFsc2UsIGluIHdoaWNoIGNhc2UgaXQgbmVlZHMgdG8gYmUgc2V0IGluIENTU1xuICBzZXRUaHVtYkNvbnRhaW5lclNpemVBbmRQb3MgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBpbWFnZUNvbnRhaW5lciB9ID0gdGhpcy5lbGVtZW50cy50aHVtYjtcblxuICAgIGlmICghdGhpcy5zaXplU3BlY2lmaWVkSW5DU1MpIHtcbiAgICAgIGNvbnN0IHRodW1iV2lkdGggPSBNYXRoLmZsb29yKHRoaXMudGh1bWJDb250YWluZXJIZWlnaHQgKiB0aGlzLnRodW1iQXNwZWN0UmF0aW8pO1xuICAgICAgaW1hZ2VDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gYCR7dGhpcy50aHVtYkNvbnRhaW5lckhlaWdodH1weGA7XG4gICAgICBpbWFnZUNvbnRhaW5lci5zdHlsZS53aWR0aCA9IGAke3RodW1iV2lkdGh9cHhgO1xuICAgIH0gZWxzZSBpZiAoaW1hZ2VDb250YWluZXIuY2xpZW50SGVpZ2h0ID4gMjAgJiYgaW1hZ2VDb250YWluZXIuY2xpZW50V2lkdGggPCAyMCkge1xuICAgICAgY29uc3QgdGh1bWJXaWR0aCA9IE1hdGguZmxvb3IoaW1hZ2VDb250YWluZXIuY2xpZW50SGVpZ2h0ICogdGhpcy50aHVtYkFzcGVjdFJhdGlvKTtcbiAgICAgIGltYWdlQ29udGFpbmVyLnN0eWxlLndpZHRoID0gYCR7dGh1bWJXaWR0aH1weGA7XG4gICAgfSBlbHNlIGlmIChpbWFnZUNvbnRhaW5lci5jbGllbnRIZWlnaHQgPCAyMCAmJiBpbWFnZUNvbnRhaW5lci5jbGllbnRXaWR0aCA+IDIwKSB7XG4gICAgICBjb25zdCB0aHVtYkhlaWdodCA9IE1hdGguZmxvb3IoaW1hZ2VDb250YWluZXIuY2xpZW50V2lkdGggLyB0aGlzLnRodW1iQXNwZWN0UmF0aW8pO1xuICAgICAgaW1hZ2VDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gYCR7dGh1bWJIZWlnaHR9cHhgO1xuICAgIH1cblxuICAgIHRoaXMuc2V0VGh1bWJDb250YWluZXJQb3MoKTtcbiAgfTtcblxuICBzZXRUaHVtYkNvbnRhaW5lclBvcyA9ICgpID0+IHtcbiAgICBjb25zdCBzY3J1YmJlclJlY3QgPSB0aGlzLnBsYXllci5lbGVtZW50cy5wcm9ncmVzcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBjb25zdCBjb250YWluZXJSZWN0ID0gdGhpcy5wbGF5ZXIuZWxlbWVudHMuY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGNvbnN0IHsgY29udGFpbmVyIH0gPSB0aGlzLmVsZW1lbnRzLnRodW1iO1xuICAgIC8vIEZpbmQgdGhlIGxvd2VzdCBhbmQgaGlnaGVzdCBkZXNpcmVkIGxlZnQtcG9zaXRpb24sIHNvIHdlIGRvbid0IHNsaWRlIG91dCB0aGUgc2lkZSBvZiB0aGUgdmlkZW8gY29udGFpbmVyXG4gICAgY29uc3QgbWluID0gY29udGFpbmVyUmVjdC5sZWZ0IC0gc2NydWJiZXJSZWN0LmxlZnQgKyAxMDtcbiAgICBjb25zdCBtYXggPSBjb250YWluZXJSZWN0LnJpZ2h0IC0gc2NydWJiZXJSZWN0LmxlZnQgLSBjb250YWluZXIuY2xpZW50V2lkdGggLSAxMDtcbiAgICAvLyBTZXQgcHJldmlldyBjb250YWluZXIgcG9zaXRpb24gdG86IG1vdXNlcG9zLCBtaW51cyBzZWVrYmFyLmxlZnQsIG1pbnVzIGhhbGYgb2YgcHJldmlld0NvbnRhaW5lci5jbGllbnRXaWR0aFxuICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5tb3VzZVBvc1ggLSBzY3J1YmJlclJlY3QubGVmdCAtIGNvbnRhaW5lci5jbGllbnRXaWR0aCAvIDI7XG4gICAgY29uc3QgY2xhbXBlZCA9IGNsYW1wKHBvc2l0aW9uLCBtaW4sIG1heCk7XG5cbiAgICAvLyBNb3ZlIHRoZSBwb3BvdmVyIHBvc2l0aW9uXG4gICAgY29udGFpbmVyLnN0eWxlLmxlZnQgPSBgJHtjbGFtcGVkfXB4YDtcblxuICAgIC8vIFRoZSBhcnJvdyBjYW4gZm9sbG93IHRoZSBjdXJzb3JcbiAgICBjb250YWluZXIuc3R5bGUuc2V0UHJvcGVydHkoJy0tcHJldmlldy1hcnJvdy1vZmZzZXQnLCBgJHtwb3NpdGlvbiAtIGNsYW1wZWR9cHhgKTtcbiAgfTtcblxuICAvLyBDYW4ndCB1c2UgMTAwJSB3aWR0aCwgaW4gY2FzZSB0aGUgdmlkZW8gaXMgYSBkaWZmZXJlbnQgYXNwZWN0IHJhdGlvIHRvIHRoZSB2aWRlbyBjb250YWluZXJcbiAgc2V0U2NydWJiaW5nQ29udGFpbmVyU2l6ZSA9ICgpID0+IHtcbiAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IGZpdFJhdGlvKHRoaXMudGh1bWJBc3BlY3RSYXRpbywge1xuICAgICAgd2lkdGg6IHRoaXMucGxheWVyLm1lZGlhLmNsaWVudFdpZHRoLFxuICAgICAgaGVpZ2h0OiB0aGlzLnBsYXllci5tZWRpYS5jbGllbnRIZWlnaHQsXG4gICAgfSk7XG4gICAgdGhpcy5lbGVtZW50cy5zY3J1YmJpbmcuY29udGFpbmVyLnN0eWxlLndpZHRoID0gYCR7d2lkdGh9cHhgO1xuICAgIHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBgJHtoZWlnaHR9cHhgO1xuICB9O1xuXG4gIC8vIFNwcml0ZXMgbmVlZCB0byBiZSBvZmZzZXQgdG8gdGhlIGNvcnJlY3QgbG9jYXRpb25cbiAgc2V0SW1hZ2VTaXplQW5kT2Zmc2V0ID0gKHByZXZpZXdJbWFnZSwgZnJhbWUpID0+IHtcbiAgICBpZiAoIXRoaXMudXNpbmdTcHJpdGVzKSByZXR1cm47XG5cbiAgICAvLyBGaW5kIGRpZmZlcmVuY2UgYmV0d2VlbiBoZWlnaHQgYW5kIHByZXZpZXcgY29udGFpbmVyIGhlaWdodFxuICAgIGNvbnN0IG11bHRpcGxpZXIgPSB0aGlzLnRodW1iQ29udGFpbmVySGVpZ2h0IC8gZnJhbWUuaDtcblxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgIHByZXZpZXdJbWFnZS5zdHlsZS5oZWlnaHQgPSBgJHtwcmV2aWV3SW1hZ2UubmF0dXJhbEhlaWdodCAqIG11bHRpcGxpZXJ9cHhgO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgIHByZXZpZXdJbWFnZS5zdHlsZS53aWR0aCA9IGAke3ByZXZpZXdJbWFnZS5uYXR1cmFsV2lkdGggKiBtdWx0aXBsaWVyfXB4YDtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICBwcmV2aWV3SW1hZ2Uuc3R5bGUubGVmdCA9IGAtJHtmcmFtZS54ICogbXVsdGlwbGllcn1weGA7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgcHJldmlld0ltYWdlLnN0eWxlLnRvcCA9IGAtJHtmcmFtZS55ICogbXVsdGlwbGllcn1weGA7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IFByZXZpZXdUaHVtYm5haWxzO1xuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBseXIgc291cmNlIHVwZGF0ZVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IHsgcHJvdmlkZXJzIH0gZnJvbSAnLi9jb25maWcvdHlwZXMnO1xuaW1wb3J0IGh0bWw1IGZyb20gJy4vaHRtbDUnO1xuaW1wb3J0IG1lZGlhIGZyb20gJy4vbWVkaWEnO1xuaW1wb3J0IFByZXZpZXdUaHVtYm5haWxzIGZyb20gJy4vcGx1Z2lucy9wcmV2aWV3LXRodW1ibmFpbHMnO1xuaW1wb3J0IHN1cHBvcnQgZnJvbSAnLi9zdXBwb3J0JztcbmltcG9ydCB1aSBmcm9tICcuL3VpJztcbmltcG9ydCB7IGNyZWF0ZUVsZW1lbnQsIGluc2VydEVsZW1lbnQsIHJlbW92ZUVsZW1lbnQgfSBmcm9tICcuL3V0aWxzL2VsZW1lbnRzJztcbmltcG9ydCBpcyBmcm9tICcuL3V0aWxzL2lzJztcbmltcG9ydCB7IGdldERlZXAgfSBmcm9tICcuL3V0aWxzL29iamVjdHMnO1xuXG5jb25zdCBzb3VyY2UgPSB7XG4gIC8vIEFkZCBlbGVtZW50cyB0byBIVE1MNSBtZWRpYSAoc291cmNlLCB0cmFja3MsIGV0YylcbiAgaW5zZXJ0RWxlbWVudHModHlwZSwgYXR0cmlidXRlcykge1xuICAgIGlmIChpcy5zdHJpbmcoYXR0cmlidXRlcykpIHtcbiAgICAgIGluc2VydEVsZW1lbnQodHlwZSwgdGhpcy5tZWRpYSwge1xuICAgICAgICBzcmM6IGF0dHJpYnV0ZXMsXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKGlzLmFycmF5KGF0dHJpYnV0ZXMpKSB7XG4gICAgICBhdHRyaWJ1dGVzLmZvckVhY2goKGF0dHJpYnV0ZSkgPT4ge1xuICAgICAgICBpbnNlcnRFbGVtZW50KHR5cGUsIHRoaXMubWVkaWEsIGF0dHJpYnV0ZSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gVXBkYXRlIHNvdXJjZVxuICAvLyBTb3VyY2VzIGFyZSBub3QgY2hlY2tlZCBmb3Igc3VwcG9ydCBzbyBiZSBjYXJlZnVsXG4gIGNoYW5nZShpbnB1dCkge1xuICAgIGlmICghZ2V0RGVlcChpbnB1dCwgJ3NvdXJjZXMubGVuZ3RoJykpIHtcbiAgICAgIHRoaXMuZGVidWcud2FybignSW52YWxpZCBzb3VyY2UgZm9ybWF0Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ2FuY2VsIGN1cnJlbnQgbmV0d29yayByZXF1ZXN0c1xuICAgIGh0bWw1LmNhbmNlbFJlcXVlc3RzLmNhbGwodGhpcyk7XG5cbiAgICAvLyBEZXN0cm95IGluc3RhbmNlIGFuZCByZS1zZXR1cFxuICAgIHRoaXMuZGVzdHJveS5jYWxsKFxuICAgICAgdGhpcyxcbiAgICAgICgpID0+IHtcbiAgICAgICAgLy8gUmVzZXQgcXVhbGl0eSBvcHRpb25zXG4gICAgICAgIHRoaXMub3B0aW9ucy5xdWFsaXR5ID0gW107XG5cbiAgICAgICAgLy8gUmVtb3ZlIGVsZW1lbnRzXG4gICAgICAgIHJlbW92ZUVsZW1lbnQodGhpcy5tZWRpYSk7XG4gICAgICAgIHRoaXMubWVkaWEgPSBudWxsO1xuXG4gICAgICAgIC8vIFJlc2V0IGNsYXNzIG5hbWVcbiAgICAgICAgaWYgKGlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5jb250YWluZXIpKSB7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIucmVtb3ZlQXR0cmlidXRlKCdjbGFzcycpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2V0IHRoZSB0eXBlIGFuZCBwcm92aWRlclxuICAgICAgICBjb25zdCB7IHNvdXJjZXMsIHR5cGUgfSA9IGlucHV0O1xuICAgICAgICBjb25zdCBbeyBwcm92aWRlciA9IHByb3ZpZGVycy5odG1sNSwgc3JjIH1dID0gc291cmNlcztcbiAgICAgICAgY29uc3QgdGFnTmFtZSA9IHByb3ZpZGVyID09PSAnaHRtbDUnID8gdHlwZSA6ICdkaXYnO1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gcHJvdmlkZXIgPT09ICdodG1sNScgPyB7fSA6IHsgc3JjIH07XG5cbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCB7XG4gICAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgICAgdHlwZSxcbiAgICAgICAgICAvLyBDaGVjayBmb3Igc3VwcG9ydFxuICAgICAgICAgIHN1cHBvcnRlZDogc3VwcG9ydC5jaGVjayh0eXBlLCBwcm92aWRlciwgdGhpcy5jb25maWcucGxheXNpbmxpbmUpLFxuICAgICAgICAgIC8vIENyZWF0ZSBuZXcgZWxlbWVudFxuICAgICAgICAgIG1lZGlhOiBjcmVhdGVFbGVtZW50KHRhZ05hbWUsIGF0dHJpYnV0ZXMpLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBJbmplY3QgdGhlIG5ldyBlbGVtZW50XG4gICAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMubWVkaWEpO1xuXG4gICAgICAgIC8vIEF1dG9wbGF5IHRoZSBuZXcgc291cmNlP1xuICAgICAgICBpZiAoaXMuYm9vbGVhbihpbnB1dC5hdXRvcGxheSkpIHtcbiAgICAgICAgICB0aGlzLmNvbmZpZy5hdXRvcGxheSA9IGlucHV0LmF1dG9wbGF5O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2V0IGF0dHJpYnV0ZXMgZm9yIGF1ZGlvIGFuZCB2aWRlb1xuICAgICAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmNyb3Nzb3JpZ2luKSB7XG4gICAgICAgICAgICB0aGlzLm1lZGlhLnNldEF0dHJpYnV0ZSgnY3Jvc3NvcmlnaW4nLCAnJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5hdXRvcGxheSkge1xuICAgICAgICAgICAgdGhpcy5tZWRpYS5zZXRBdHRyaWJ1dGUoJ2F1dG9wbGF5JywgJycpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWlzLmVtcHR5KGlucHV0LnBvc3RlcikpIHtcbiAgICAgICAgICAgIHRoaXMucG9zdGVyID0gaW5wdXQucG9zdGVyO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodGhpcy5jb25maWcubG9vcC5hY3RpdmUpIHtcbiAgICAgICAgICAgIHRoaXMubWVkaWEuc2V0QXR0cmlidXRlKCdsb29wJywgJycpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodGhpcy5jb25maWcubXV0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubWVkaWEuc2V0QXR0cmlidXRlKCdtdXRlZCcsICcnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRoaXMuY29uZmlnLnBsYXlzaW5saW5lKSB7XG4gICAgICAgICAgICB0aGlzLm1lZGlhLnNldEF0dHJpYnV0ZSgncGxheXNpbmxpbmUnLCAnJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVzdG9yZSBjbGFzcyBob29rXG4gICAgICAgIHVpLmFkZFN0eWxlSG9vay5jYWxsKHRoaXMpO1xuXG4gICAgICAgIC8vIFNldCBuZXcgc291cmNlcyBmb3IgaHRtbDVcbiAgICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICAgIHNvdXJjZS5pbnNlcnRFbGVtZW50cy5jYWxsKHRoaXMsICdzb3VyY2UnLCBzb3VyY2VzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNldCB2aWRlbyB0aXRsZVxuICAgICAgICB0aGlzLmNvbmZpZy50aXRsZSA9IGlucHV0LnRpdGxlO1xuXG4gICAgICAgIC8vIFNldCB1cCBmcm9tIHNjcmF0Y2hcbiAgICAgICAgbWVkaWEuc2V0dXAuY2FsbCh0aGlzKTtcblxuICAgICAgICAvLyBIVE1MNSBzdHVmZlxuICAgICAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICAgICAgLy8gU2V0dXAgY2FwdGlvbnNcbiAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoaW5wdXQpLmluY2x1ZGVzKCd0cmFja3MnKSkge1xuICAgICAgICAgICAgc291cmNlLmluc2VydEVsZW1lbnRzLmNhbGwodGhpcywgJ3RyYWNrJywgaW5wdXQudHJhY2tzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiBIVE1MNSBvciBlbWJlZCBidXQgbm90IGZ1bGx5IHN1cHBvcnRlZCwgc2V0dXBJbnRlcmZhY2UgYW5kIGNhbGwgcmVhZHkgbm93XG4gICAgICAgIGlmICh0aGlzLmlzSFRNTDUgfHwgKHRoaXMuaXNFbWJlZCAmJiAhdGhpcy5zdXBwb3J0ZWQudWkpKSB7XG4gICAgICAgICAgLy8gU2V0dXAgaW50ZXJmYWNlXG4gICAgICAgICAgdWkuYnVpbGQuY2FsbCh0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIExvYWQgSFRNTDUgc291cmNlc1xuICAgICAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICAgICAgdGhpcy5tZWRpYS5sb2FkKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBVcGRhdGUgcHJldmlld1RodW1ibmFpbHMgY29uZmlnICYgcmVsb2FkIHBsdWdpblxuICAgICAgICBpZiAoIWlzLmVtcHR5KGlucHV0LnByZXZpZXdUaHVtYm5haWxzKSkge1xuICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5jb25maWcucHJldmlld1RodW1ibmFpbHMsIGlucHV0LnByZXZpZXdUaHVtYm5haWxzKTtcblxuICAgICAgICAgIC8vIENsZWFudXAgcHJldmlld1RodW1ibmFpbHMgcGx1Z2luIGlmIGl0IHdhcyBsb2FkZWRcbiAgICAgICAgICBpZiAodGhpcy5wcmV2aWV3VGh1bWJuYWlscyAmJiB0aGlzLnByZXZpZXdUaHVtYm5haWxzLmxvYWRlZCkge1xuICAgICAgICAgICAgdGhpcy5wcmV2aWV3VGh1bWJuYWlscy5kZXN0cm95KCk7XG4gICAgICAgICAgICB0aGlzLnByZXZpZXdUaHVtYm5haWxzID0gbnVsbDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBDcmVhdGUgbmV3IGluc3RhbmNlIGlmIGl0IGlzIHN0aWxsIGVuYWJsZWRcbiAgICAgICAgICBpZiAodGhpcy5jb25maWcucHJldmlld1RodW1ibmFpbHMuZW5hYmxlZCkge1xuICAgICAgICAgICAgdGhpcy5wcmV2aWV3VGh1bWJuYWlscyA9IG5ldyBQcmV2aWV3VGh1bWJuYWlscyh0aGlzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBVcGRhdGUgdGhlIGZ1bGxzY3JlZW4gc3VwcG9ydFxuICAgICAgICB0aGlzLmZ1bGxzY3JlZW4udXBkYXRlKCk7XG4gICAgICB9LFxuICAgICAgdHJ1ZSxcbiAgICApO1xuICB9LFxufTtcblxuZXhwb3J0IGRlZmF1bHQgc291cmNlO1xuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBseXJcbi8vIHBseXIuanMgdjMuNy4yXG4vLyBodHRwczovL2dpdGh1Yi5jb20vc2FtcG90dHMvcGx5clxuLy8gTGljZW5zZTogVGhlIE1JVCBMaWNlbnNlIChNSVQpXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgY2FwdGlvbnMgZnJvbSAnLi9jYXB0aW9ucyc7XG5pbXBvcnQgZGVmYXVsdHMgZnJvbSAnLi9jb25maWcvZGVmYXVsdHMnO1xuaW1wb3J0IHsgcGlwIH0gZnJvbSAnLi9jb25maWcvc3RhdGVzJztcbmltcG9ydCB7IGdldFByb3ZpZGVyQnlVcmwsIHByb3ZpZGVycywgdHlwZXMgfSBmcm9tICcuL2NvbmZpZy90eXBlcyc7XG5pbXBvcnQgQ29uc29sZSBmcm9tICcuL2NvbnNvbGUnO1xuaW1wb3J0IGNvbnRyb2xzIGZyb20gJy4vY29udHJvbHMnO1xuaW1wb3J0IEZ1bGxzY3JlZW4gZnJvbSAnLi9mdWxsc2NyZWVuJztcbmltcG9ydCBodG1sNSBmcm9tICcuL2h0bWw1JztcbmltcG9ydCBMaXN0ZW5lcnMgZnJvbSAnLi9saXN0ZW5lcnMnO1xuaW1wb3J0IG1lZGlhIGZyb20gJy4vbWVkaWEnO1xuaW1wb3J0IEFkcyBmcm9tICcuL3BsdWdpbnMvYWRzJztcbmltcG9ydCBQcmV2aWV3VGh1bWJuYWlscyBmcm9tICcuL3BsdWdpbnMvcHJldmlldy10aHVtYm5haWxzJztcbmltcG9ydCBzb3VyY2UgZnJvbSAnLi9zb3VyY2UnO1xuaW1wb3J0IFN0b3JhZ2UgZnJvbSAnLi9zdG9yYWdlJztcbmltcG9ydCBzdXBwb3J0IGZyb20gJy4vc3VwcG9ydCc7XG5pbXBvcnQgdWkgZnJvbSAnLi91aSc7XG5pbXBvcnQgeyBjbG9zZXN0IH0gZnJvbSAnLi91dGlscy9hcnJheXMnO1xuaW1wb3J0IHsgY3JlYXRlRWxlbWVudCwgaGFzQ2xhc3MsIHJlbW92ZUVsZW1lbnQsIHJlcGxhY2VFbGVtZW50LCB0b2dnbGVDbGFzcywgd3JhcCB9IGZyb20gJy4vdXRpbHMvZWxlbWVudHMnO1xuaW1wb3J0IHsgb2ZmLCBvbiwgb25jZSwgdHJpZ2dlckV2ZW50LCB1bmJpbmRMaXN0ZW5lcnMgfSBmcm9tICcuL3V0aWxzL2V2ZW50cyc7XG5pbXBvcnQgaXMgZnJvbSAnLi91dGlscy9pcyc7XG5pbXBvcnQgbG9hZFNwcml0ZSBmcm9tICcuL3V0aWxzL2xvYWQtc3ByaXRlJztcbmltcG9ydCB7IGNsYW1wIH0gZnJvbSAnLi91dGlscy9udW1iZXJzJztcbmltcG9ydCB7IGNsb25lRGVlcCwgZXh0ZW5kIH0gZnJvbSAnLi91dGlscy9vYmplY3RzJztcbmltcG9ydCB7IHNpbGVuY2VQcm9taXNlIH0gZnJvbSAnLi91dGlscy9wcm9taXNlJztcbmltcG9ydCB7IGdldEFzcGVjdFJhdGlvLCByZWR1Y2VBc3BlY3RSYXRpbywgc2V0QXNwZWN0UmF0aW8sIHZhbGlkYXRlQXNwZWN0UmF0aW8gfSBmcm9tICcuL3V0aWxzL3N0eWxlJztcbmltcG9ydCB7IHBhcnNlVXJsIH0gZnJvbSAnLi91dGlscy91cmxzJztcblxuLy8gUHJpdmF0ZSBwcm9wZXJ0aWVzXG4vLyBUT0RPOiBVc2UgYSBXZWFrTWFwIGZvciBwcml2YXRlIGdsb2JhbHNcbi8vIGNvbnN0IGdsb2JhbHMgPSBuZXcgV2Vha01hcCgpO1xuXG4vLyBQbHlyIGluc3RhbmNlXG5jbGFzcyBQbHlyIHtcbiAgY29uc3RydWN0b3IodGFyZ2V0LCBvcHRpb25zKSB7XG4gICAgdGhpcy50aW1lcnMgPSB7fTtcblxuICAgIC8vIFN0YXRlXG4gICAgdGhpcy5yZWFkeSA9IGZhbHNlO1xuICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgIHRoaXMuZmFpbGVkID0gZmFsc2U7XG5cbiAgICAvLyBUb3VjaCBkZXZpY2VcbiAgICB0aGlzLnRvdWNoID0gc3VwcG9ydC50b3VjaDtcblxuICAgIC8vIFNldCB0aGUgbWVkaWEgZWxlbWVudFxuICAgIHRoaXMubWVkaWEgPSB0YXJnZXQ7XG5cbiAgICAvLyBTdHJpbmcgc2VsZWN0b3IgcGFzc2VkXG4gICAgaWYgKGlzLnN0cmluZyh0aGlzLm1lZGlhKSkge1xuICAgICAgdGhpcy5tZWRpYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5tZWRpYSk7XG4gICAgfVxuXG4gICAgLy8galF1ZXJ5LCBOb2RlTGlzdCBvciBBcnJheSBwYXNzZWQsIHVzZSBmaXJzdCBlbGVtZW50XG4gICAgaWYgKCh3aW5kb3cualF1ZXJ5ICYmIHRoaXMubWVkaWEgaW5zdGFuY2VvZiBqUXVlcnkpIHx8IGlzLm5vZGVMaXN0KHRoaXMubWVkaWEpIHx8IGlzLmFycmF5KHRoaXMubWVkaWEpKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICAgIHRoaXMubWVkaWEgPSB0aGlzLm1lZGlhWzBdO1xuICAgIH1cblxuICAgIC8vIFNldCBjb25maWdcbiAgICB0aGlzLmNvbmZpZyA9IGV4dGVuZChcbiAgICAgIHt9LFxuICAgICAgZGVmYXVsdHMsXG4gICAgICBQbHlyLmRlZmF1bHRzLFxuICAgICAgb3B0aW9ucyB8fCB7fSxcbiAgICAgICgoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UodGhpcy5tZWRpYS5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGx5ci1jb25maWcnKSk7XG4gICAgICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgIH1cbiAgICAgIH0pKCksXG4gICAgKTtcblxuICAgIC8vIEVsZW1lbnRzIGNhY2hlXG4gICAgdGhpcy5lbGVtZW50cyA9IHtcbiAgICAgIGNvbnRhaW5lcjogbnVsbCxcbiAgICAgIGZ1bGxzY3JlZW46IG51bGwsXG4gICAgICBjYXB0aW9uczogbnVsbCxcbiAgICAgIGJ1dHRvbnM6IHt9LFxuICAgICAgZGlzcGxheToge30sXG4gICAgICBwcm9ncmVzczoge30sXG4gICAgICBpbnB1dHM6IHt9LFxuICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgcG9wdXA6IG51bGwsXG4gICAgICAgIG1lbnU6IG51bGwsXG4gICAgICAgIHBhbmVsczoge30sXG4gICAgICAgIGJ1dHRvbnM6IHt9LFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgLy8gQ2FwdGlvbnNcbiAgICB0aGlzLmNhcHRpb25zID0ge1xuICAgICAgYWN0aXZlOiBudWxsLFxuICAgICAgY3VycmVudFRyYWNrOiAtMSxcbiAgICAgIG1ldGE6IG5ldyBXZWFrTWFwKCksXG4gICAgfTtcblxuICAgIC8vIEZ1bGxzY3JlZW5cbiAgICB0aGlzLmZ1bGxzY3JlZW4gPSB7XG4gICAgICBhY3RpdmU6IGZhbHNlLFxuICAgIH07XG5cbiAgICAvLyBPcHRpb25zXG4gICAgdGhpcy5vcHRpb25zID0ge1xuICAgICAgc3BlZWQ6IFtdLFxuICAgICAgcXVhbGl0eTogW10sXG4gICAgfTtcblxuICAgIC8vIERlYnVnZ2luZ1xuICAgIC8vIFRPRE86IG1vdmUgdG8gZ2xvYmFsc1xuICAgIHRoaXMuZGVidWcgPSBuZXcgQ29uc29sZSh0aGlzLmNvbmZpZy5kZWJ1Zyk7XG5cbiAgICAvLyBMb2cgY29uZmlnIG9wdGlvbnMgYW5kIHN1cHBvcnRcbiAgICB0aGlzLmRlYnVnLmxvZygnQ29uZmlnJywgdGhpcy5jb25maWcpO1xuICAgIHRoaXMuZGVidWcubG9nKCdTdXBwb3J0Jywgc3VwcG9ydCk7XG5cbiAgICAvLyBXZSBuZWVkIGFuIGVsZW1lbnQgdG8gc2V0dXBcbiAgICBpZiAoaXMubnVsbE9yVW5kZWZpbmVkKHRoaXMubWVkaWEpIHx8ICFpcy5lbGVtZW50KHRoaXMubWVkaWEpKSB7XG4gICAgICB0aGlzLmRlYnVnLmVycm9yKCdTZXR1cCBmYWlsZWQ6IG5vIHN1aXRhYmxlIGVsZW1lbnQgcGFzc2VkJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQmFpbCBpZiB0aGUgZWxlbWVudCBpcyBpbml0aWFsaXplZFxuICAgIGlmICh0aGlzLm1lZGlhLnBseXIpIHtcbiAgICAgIHRoaXMuZGVidWcud2FybignVGFyZ2V0IGFscmVhZHkgc2V0dXAnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBCYWlsIGlmIG5vdCBlbmFibGVkXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5lbmFibGVkKSB7XG4gICAgICB0aGlzLmRlYnVnLmVycm9yKCdTZXR1cCBmYWlsZWQ6IGRpc2FibGVkIGJ5IGNvbmZpZycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEJhaWwgaWYgZGlzYWJsZWQgb3Igbm8gYmFzaWMgc3VwcG9ydFxuICAgIC8vIFlvdSBtYXkgd2FudCB0byBkaXNhYmxlIGNlcnRhaW4gVUFzIGV0Y1xuICAgIGlmICghc3VwcG9ydC5jaGVjaygpLmFwaSkge1xuICAgICAgdGhpcy5kZWJ1Zy5lcnJvcignU2V0dXAgZmFpbGVkOiBubyBzdXBwb3J0Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ2FjaGUgb3JpZ2luYWwgZWxlbWVudCBzdGF0ZSBmb3IgLmRlc3Ryb3koKVxuICAgIGNvbnN0IGNsb25lID0gdGhpcy5tZWRpYS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgY2xvbmUuYXV0b3BsYXkgPSBmYWxzZTtcbiAgICB0aGlzLmVsZW1lbnRzLm9yaWdpbmFsID0gY2xvbmU7XG5cbiAgICAvLyBTZXQgbWVkaWEgdHlwZSBiYXNlZCBvbiB0YWcgb3IgZGF0YSBhdHRyaWJ1dGVcbiAgICAvLyBTdXBwb3J0ZWQ6IHZpZGVvLCBhdWRpbywgdmltZW8sIHlvdXR1YmVcbiAgICBjb25zdCB0eXBlID0gdGhpcy5tZWRpYS50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgLy8gRW1iZWQgcHJvcGVydGllc1xuICAgIGxldCBpZnJhbWUgPSBudWxsO1xuICAgIGxldCB1cmwgPSBudWxsO1xuXG4gICAgLy8gRGlmZmVyZW50IHNldHVwIGJhc2VkIG9uIHR5cGVcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgJ2Rpdic6XG4gICAgICAgIC8vIEZpbmQgdGhlIGZyYW1lXG4gICAgICAgIGlmcmFtZSA9IHRoaXMubWVkaWEucXVlcnlTZWxlY3RvcignaWZyYW1lJyk7XG5cbiAgICAgICAgLy8gPGlmcmFtZT4gdHlwZVxuICAgICAgICBpZiAoaXMuZWxlbWVudChpZnJhbWUpKSB7XG4gICAgICAgICAgLy8gRGV0ZWN0IHByb3ZpZGVyXG4gICAgICAgICAgdXJsID0gcGFyc2VVcmwoaWZyYW1lLmdldEF0dHJpYnV0ZSgnc3JjJykpO1xuICAgICAgICAgIHRoaXMucHJvdmlkZXIgPSBnZXRQcm92aWRlckJ5VXJsKHVybC50b1N0cmluZygpKTtcblxuICAgICAgICAgIC8vIFJld29yayBlbGVtZW50c1xuICAgICAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyID0gdGhpcy5tZWRpYTtcbiAgICAgICAgICB0aGlzLm1lZGlhID0gaWZyYW1lO1xuXG4gICAgICAgICAgLy8gUmVzZXQgY2xhc3NuYW1lXG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIuY2xhc3NOYW1lID0gJyc7XG5cbiAgICAgICAgICAvLyBHZXQgYXR0cmlidXRlcyBmcm9tIFVSTCBhbmQgc2V0IGNvbmZpZ1xuICAgICAgICAgIGlmICh1cmwuc2VhcmNoLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgdHJ1dGh5ID0gWycxJywgJ3RydWUnXTtcblxuICAgICAgICAgICAgaWYgKHRydXRoeS5pbmNsdWRlcyh1cmwuc2VhcmNoUGFyYW1zLmdldCgnYXV0b3BsYXknKSkpIHtcbiAgICAgICAgICAgICAgdGhpcy5jb25maWcuYXV0b3BsYXkgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRydXRoeS5pbmNsdWRlcyh1cmwuc2VhcmNoUGFyYW1zLmdldCgnbG9vcCcpKSkge1xuICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRPRE86IHJlcGxhY2UgZnVsbHNjcmVlbi5pb3NOYXRpdmUgd2l0aCB0aGlzIHBsYXlzaW5saW5lIGNvbmZpZyBvcHRpb25cbiAgICAgICAgICAgIC8vIFlvdVR1YmUgcmVxdWlyZXMgdGhlIHBsYXlzaW5saW5lIGluIHRoZSBVUkxcbiAgICAgICAgICAgIGlmICh0aGlzLmlzWW91VHViZSkge1xuICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5wbGF5c2lubGluZSA9IHRydXRoeS5pbmNsdWRlcyh1cmwuc2VhcmNoUGFyYW1zLmdldCgncGxheXNpbmxpbmUnKSk7XG4gICAgICAgICAgICAgIHRoaXMuY29uZmlnLnlvdXR1YmUuaGwgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnaGwnKTsgLy8gVE9ETzogU2hvdWxkIHRoaXMgYmUgc2V0dGluZyBsYW5ndWFnZT9cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuY29uZmlnLnBsYXlzaW5saW5lID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gPGRpdj4gd2l0aCBhdHRyaWJ1dGVzXG4gICAgICAgICAgdGhpcy5wcm92aWRlciA9IHRoaXMubWVkaWEuZ2V0QXR0cmlidXRlKHRoaXMuY29uZmlnLmF0dHJpYnV0ZXMuZW1iZWQucHJvdmlkZXIpO1xuXG4gICAgICAgICAgLy8gUmVtb3ZlIGF0dHJpYnV0ZVxuICAgICAgICAgIHRoaXMubWVkaWEucmVtb3ZlQXR0cmlidXRlKHRoaXMuY29uZmlnLmF0dHJpYnV0ZXMuZW1iZWQucHJvdmlkZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVW5zdXBwb3J0ZWQgb3IgbWlzc2luZyBwcm92aWRlclxuICAgICAgICBpZiAoaXMuZW1wdHkodGhpcy5wcm92aWRlcikgfHwgIU9iamVjdC52YWx1ZXMocHJvdmlkZXJzKS5pbmNsdWRlcyh0aGlzLnByb3ZpZGVyKSkge1xuICAgICAgICAgIHRoaXMuZGVidWcuZXJyb3IoJ1NldHVwIGZhaWxlZDogSW52YWxpZCBwcm92aWRlcicpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEF1ZGlvIHdpbGwgY29tZSBsYXRlciBmb3IgZXh0ZXJuYWwgcHJvdmlkZXJzXG4gICAgICAgIHRoaXMudHlwZSA9IHR5cGVzLnZpZGVvO1xuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICd2aWRlbyc6XG4gICAgICBjYXNlICdhdWRpbyc6XG4gICAgICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgICAgIHRoaXMucHJvdmlkZXIgPSBwcm92aWRlcnMuaHRtbDU7XG5cbiAgICAgICAgLy8gR2V0IGNvbmZpZyBmcm9tIGF0dHJpYnV0ZXNcbiAgICAgICAgaWYgKHRoaXMubWVkaWEuaGFzQXR0cmlidXRlKCdjcm9zc29yaWdpbicpKSB7XG4gICAgICAgICAgdGhpcy5jb25maWcuY3Jvc3NvcmlnaW4gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1lZGlhLmhhc0F0dHJpYnV0ZSgnYXV0b3BsYXknKSkge1xuICAgICAgICAgIHRoaXMuY29uZmlnLmF1dG9wbGF5ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tZWRpYS5oYXNBdHRyaWJ1dGUoJ3BsYXlzaW5saW5lJykgfHwgdGhpcy5tZWRpYS5oYXNBdHRyaWJ1dGUoJ3dlYmtpdC1wbGF5c2lubGluZScpKSB7XG4gICAgICAgICAgdGhpcy5jb25maWcucGxheXNpbmxpbmUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1lZGlhLmhhc0F0dHJpYnV0ZSgnbXV0ZWQnKSkge1xuICAgICAgICAgIHRoaXMuY29uZmlnLm11dGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tZWRpYS5oYXNBdHRyaWJ1dGUoJ2xvb3AnKSkge1xuICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aGlzLmRlYnVnLmVycm9yKCdTZXR1cCBmYWlsZWQ6IHVuc3VwcG9ydGVkIHR5cGUnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBzdXBwb3J0IGFnYWluIGJ1dCB3aXRoIHR5cGVcbiAgICB0aGlzLnN1cHBvcnRlZCA9IHN1cHBvcnQuY2hlY2sodGhpcy50eXBlLCB0aGlzLnByb3ZpZGVyLCB0aGlzLmNvbmZpZy5wbGF5c2lubGluZSk7XG5cbiAgICAvLyBJZiBubyBzdXBwb3J0IGZvciBldmVuIEFQSSwgYmFpbFxuICAgIGlmICghdGhpcy5zdXBwb3J0ZWQuYXBpKSB7XG4gICAgICB0aGlzLmRlYnVnLmVycm9yKCdTZXR1cCBmYWlsZWQ6IG5vIHN1cHBvcnQnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmV2ZW50TGlzdGVuZXJzID0gW107XG5cbiAgICAvLyBDcmVhdGUgbGlzdGVuZXJzXG4gICAgdGhpcy5saXN0ZW5lcnMgPSBuZXcgTGlzdGVuZXJzKHRoaXMpO1xuXG4gICAgLy8gU2V0dXAgbG9jYWwgc3RvcmFnZSBmb3IgdXNlciBzZXR0aW5nc1xuICAgIHRoaXMuc3RvcmFnZSA9IG5ldyBTdG9yYWdlKHRoaXMpO1xuXG4gICAgLy8gU3RvcmUgcmVmZXJlbmNlXG4gICAgdGhpcy5tZWRpYS5wbHlyID0gdGhpcztcblxuICAgIC8vIFdyYXAgbWVkaWFcbiAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5jb250YWluZXIpKSB7XG4gICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgdGFiaW5kZXg6IDAgfSk7XG4gICAgICB3cmFwKHRoaXMubWVkaWEsIHRoaXMuZWxlbWVudHMuY29udGFpbmVyKTtcbiAgICB9XG5cbiAgICAvLyBNaWdyYXRlIGN1c3RvbSBwcm9wZXJ0aWVzIGZyb20gbWVkaWEgdG8gY29udGFpbmVyIChzbyB0aGV5IHdvcmsg8J+YiSlcbiAgICB1aS5taWdyYXRlU3R5bGVzLmNhbGwodGhpcyk7XG5cbiAgICAvLyBBZGQgc3R5bGUgaG9va1xuICAgIHVpLmFkZFN0eWxlSG9vay5jYWxsKHRoaXMpO1xuXG4gICAgLy8gU2V0dXAgbWVkaWFcbiAgICBtZWRpYS5zZXR1cC5jYWxsKHRoaXMpO1xuXG4gICAgLy8gTGlzdGVuIGZvciBldmVudHMgaWYgZGVidWdnaW5nXG4gICAgaWYgKHRoaXMuY29uZmlnLmRlYnVnKSB7XG4gICAgICBvbi5jYWxsKHRoaXMsIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5ldmVudHMuam9pbignICcpLCAoZXZlbnQpID0+IHtcbiAgICAgICAgdGhpcy5kZWJ1Zy5sb2coYGV2ZW50OiAke2V2ZW50LnR5cGV9YCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBTZXR1cCBmdWxsc2NyZWVuXG4gICAgdGhpcy5mdWxsc2NyZWVuID0gbmV3IEZ1bGxzY3JlZW4odGhpcyk7XG5cbiAgICAvLyBTZXR1cCBpbnRlcmZhY2VcbiAgICAvLyBJZiBlbWJlZCBidXQgbm90IGZ1bGx5IHN1cHBvcnRlZCwgYnVpbGQgaW50ZXJmYWNlIG5vdyB0byBhdm9pZCBmbGFzaCBvZiBjb250cm9sc1xuICAgIGlmICh0aGlzLmlzSFRNTDUgfHwgKHRoaXMuaXNFbWJlZCAmJiAhdGhpcy5zdXBwb3J0ZWQudWkpKSB7XG4gICAgICB1aS5idWlsZC5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIC8vIENvbnRhaW5lciBsaXN0ZW5lcnNcbiAgICB0aGlzLmxpc3RlbmVycy5jb250YWluZXIoKTtcblxuICAgIC8vIEdsb2JhbCBsaXN0ZW5lcnNcbiAgICB0aGlzLmxpc3RlbmVycy5nbG9iYWwoKTtcblxuICAgIC8vIFNldHVwIGFkcyBpZiBwcm92aWRlZFxuICAgIGlmICh0aGlzLmNvbmZpZy5hZHMuZW5hYmxlZCkge1xuICAgICAgdGhpcy5hZHMgPSBuZXcgQWRzKHRoaXMpO1xuICAgIH1cblxuICAgIC8vIEF1dG9wbGF5IGlmIHJlcXVpcmVkXG4gICAgaWYgKHRoaXMuaXNIVE1MNSAmJiB0aGlzLmNvbmZpZy5hdXRvcGxheSkge1xuICAgICAgdGhpcy5vbmNlKCdjYW5wbGF5JywgKCkgPT4gc2lsZW5jZVByb21pc2UodGhpcy5wbGF5KCkpKTtcbiAgICB9XG5cbiAgICAvLyBTZWVrIHRpbWUgd2lsbCBiZSByZWNvcmRlZCAoaW4gbGlzdGVuZXJzLmpzKSBzbyB3ZSBjYW4gcHJldmVudCBoaWRpbmcgY29udHJvbHMgZm9yIGEgZmV3IHNlY29uZHMgYWZ0ZXIgc2Vla1xuICAgIHRoaXMubGFzdFNlZWtUaW1lID0gMDtcblxuICAgIC8vIFNldHVwIHByZXZpZXcgdGh1bWJuYWlscyBpZiBlbmFibGVkXG4gICAgaWYgKHRoaXMuY29uZmlnLnByZXZpZXdUaHVtYm5haWxzLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMucHJldmlld1RodW1ibmFpbHMgPSBuZXcgUHJldmlld1RodW1ibmFpbHModGhpcyk7XG4gICAgfVxuICB9XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIEFQSVxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAvKipcbiAgICogVHlwZXMgYW5kIHByb3ZpZGVyIGhlbHBlcnNcbiAgICovXG4gIGdldCBpc0hUTUw1KCkge1xuICAgIHJldHVybiB0aGlzLnByb3ZpZGVyID09PSBwcm92aWRlcnMuaHRtbDU7XG4gIH1cblxuICBnZXQgaXNFbWJlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5pc1lvdVR1YmUgfHwgdGhpcy5pc1ZpbWVvO1xuICB9XG5cbiAgZ2V0IGlzWW91VHViZSgpIHtcbiAgICByZXR1cm4gdGhpcy5wcm92aWRlciA9PT0gcHJvdmlkZXJzLnlvdXR1YmU7XG4gIH1cblxuICBnZXQgaXNWaW1lbygpIHtcbiAgICByZXR1cm4gdGhpcy5wcm92aWRlciA9PT0gcHJvdmlkZXJzLnZpbWVvO1xuICB9XG5cbiAgZ2V0IGlzVmlkZW8oKSB7XG4gICAgcmV0dXJuIHRoaXMudHlwZSA9PT0gdHlwZXMudmlkZW87XG4gIH1cblxuICBnZXQgaXNBdWRpbygpIHtcbiAgICByZXR1cm4gdGhpcy50eXBlID09PSB0eXBlcy5hdWRpbztcbiAgfVxuXG4gIC8qKlxuICAgKiBQbGF5IHRoZSBtZWRpYSwgb3IgcGxheSB0aGUgYWR2ZXJ0aXNlbWVudCAoaWYgdGhleSBhcmUgbm90IGJsb2NrZWQpXG4gICAqL1xuICBwbGF5ID0gKCkgPT4ge1xuICAgIGlmICghaXMuZnVuY3Rpb24odGhpcy5tZWRpYS5wbGF5KSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLy8gSW50ZWNlcHQgcGxheSB3aXRoIGFkc1xuICAgIGlmICh0aGlzLmFkcyAmJiB0aGlzLmFkcy5lbmFibGVkKSB7XG4gICAgICB0aGlzLmFkcy5tYW5hZ2VyUHJvbWlzZS50aGVuKCgpID0+IHRoaXMuYWRzLnBsYXkoKSkuY2F0Y2goKCkgPT4gc2lsZW5jZVByb21pc2UodGhpcy5tZWRpYS5wbGF5KCkpKTtcbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gdGhlIHByb21pc2UgKGZvciBIVE1MNSlcbiAgICByZXR1cm4gdGhpcy5tZWRpYS5wbGF5KCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhdXNlIHRoZSBtZWRpYVxuICAgKi9cbiAgcGF1c2UgPSAoKSA9PiB7XG4gICAgaWYgKCF0aGlzLnBsYXlpbmcgfHwgIWlzLmZ1bmN0aW9uKHRoaXMubWVkaWEucGF1c2UpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5tZWRpYS5wYXVzZSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBHZXQgcGxheWluZyBzdGF0ZVxuICAgKi9cbiAgZ2V0IHBsYXlpbmcoKSB7XG4gICAgcmV0dXJuIEJvb2xlYW4odGhpcy5yZWFkeSAmJiAhdGhpcy5wYXVzZWQgJiYgIXRoaXMuZW5kZWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBwYXVzZWQgc3RhdGVcbiAgICovXG4gIGdldCBwYXVzZWQoKSB7XG4gICAgcmV0dXJuIEJvb2xlYW4odGhpcy5tZWRpYS5wYXVzZWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzdG9wcGVkIHN0YXRlXG4gICAqL1xuICBnZXQgc3RvcHBlZCgpIHtcbiAgICByZXR1cm4gQm9vbGVhbih0aGlzLnBhdXNlZCAmJiB0aGlzLmN1cnJlbnRUaW1lID09PSAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZW5kZWQgc3RhdGVcbiAgICovXG4gIGdldCBlbmRlZCgpIHtcbiAgICByZXR1cm4gQm9vbGVhbih0aGlzLm1lZGlhLmVuZGVkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUb2dnbGUgcGxheWJhY2sgYmFzZWQgb24gY3VycmVudCBzdGF0dXNcbiAgICogQHBhcmFtIHtCb29sZWFufSBpbnB1dFxuICAgKi9cbiAgdG9nZ2xlUGxheSA9IChpbnB1dCkgPT4ge1xuICAgIC8vIFRvZ2dsZSBiYXNlZCBvbiBjdXJyZW50IHN0YXRlIGlmIG5vdGhpbmcgcGFzc2VkXG4gICAgY29uc3QgdG9nZ2xlID0gaXMuYm9vbGVhbihpbnB1dCkgPyBpbnB1dCA6ICF0aGlzLnBsYXlpbmc7XG5cbiAgICBpZiAodG9nZ2xlKSB7XG4gICAgICByZXR1cm4gdGhpcy5wbGF5KCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucGF1c2UoKTtcbiAgfTtcblxuICAvKipcbiAgICogU3RvcCBwbGF5YmFja1xuICAgKi9cbiAgc3RvcCA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICB0aGlzLnBhdXNlKCk7XG4gICAgICB0aGlzLnJlc3RhcnQoKTtcbiAgICB9IGVsc2UgaWYgKGlzLmZ1bmN0aW9uKHRoaXMubWVkaWEuc3RvcCkpIHtcbiAgICAgIHRoaXMubWVkaWEuc3RvcCgpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogUmVzdGFydCBwbGF5YmFja1xuICAgKi9cbiAgcmVzdGFydCA9ICgpID0+IHtcbiAgICB0aGlzLmN1cnJlbnRUaW1lID0gMDtcbiAgfTtcblxuICAvKipcbiAgICogUmV3aW5kXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBzZWVrVGltZSAtIGhvdyBmYXIgdG8gcmV3aW5kIGluIHNlY29uZHMuIERlZmF1bHRzIHRvIHRoZSBjb25maWcuc2Vla1RpbWVcbiAgICovXG4gIHJld2luZCA9IChzZWVrVGltZSkgPT4ge1xuICAgIHRoaXMuY3VycmVudFRpbWUgLT0gaXMubnVtYmVyKHNlZWtUaW1lKSA/IHNlZWtUaW1lIDogdGhpcy5jb25maWcuc2Vla1RpbWU7XG4gIH07XG5cbiAgLyoqXG4gICAqIEZhc3QgZm9yd2FyZFxuICAgKiBAcGFyYW0ge051bWJlcn0gc2Vla1RpbWUgLSBob3cgZmFyIHRvIGZhc3QgZm9yd2FyZCBpbiBzZWNvbmRzLiBEZWZhdWx0cyB0byB0aGUgY29uZmlnLnNlZWtUaW1lXG4gICAqL1xuICBmb3J3YXJkID0gKHNlZWtUaW1lKSA9PiB7XG4gICAgdGhpcy5jdXJyZW50VGltZSArPSBpcy5udW1iZXIoc2Vla1RpbWUpID8gc2Vla1RpbWUgOiB0aGlzLmNvbmZpZy5zZWVrVGltZTtcbiAgfTtcblxuICAvKipcbiAgICogU2VlayB0byBhIHRpbWVcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGlucHV0IC0gd2hlcmUgdG8gc2VlayB0byBpbiBzZWNvbmRzLiBEZWZhdWx0cyB0byAwICh0aGUgc3RhcnQpXG4gICAqL1xuICBzZXQgY3VycmVudFRpbWUoaW5wdXQpIHtcbiAgICAvLyBCYWlsIGlmIG1lZGlhIGR1cmF0aW9uIGlzbid0IGF2YWlsYWJsZSB5ZXRcbiAgICBpZiAoIXRoaXMuZHVyYXRpb24pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBpbnB1dFxuICAgIGNvbnN0IGlucHV0SXNWYWxpZCA9IGlzLm51bWJlcihpbnB1dCkgJiYgaW5wdXQgPiAwO1xuXG4gICAgLy8gU2V0XG4gICAgdGhpcy5tZWRpYS5jdXJyZW50VGltZSA9IGlucHV0SXNWYWxpZCA/IE1hdGgubWluKGlucHV0LCB0aGlzLmR1cmF0aW9uKSA6IDA7XG5cbiAgICAvLyBMb2dnaW5nXG4gICAgdGhpcy5kZWJ1Zy5sb2coYFNlZWtpbmcgdG8gJHt0aGlzLmN1cnJlbnRUaW1lfSBzZWNvbmRzYCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGN1cnJlbnQgdGltZVxuICAgKi9cbiAgZ2V0IGN1cnJlbnRUaW1lKCkge1xuICAgIHJldHVybiBOdW1iZXIodGhpcy5tZWRpYS5jdXJyZW50VGltZSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGJ1ZmZlcmVkXG4gICAqL1xuICBnZXQgYnVmZmVyZWQoKSB7XG4gICAgY29uc3QgeyBidWZmZXJlZCB9ID0gdGhpcy5tZWRpYTtcblxuICAgIC8vIFlvdVR1YmUgLyBWaW1lbyByZXR1cm4gYSBmbG9hdCBiZXR3ZWVuIDAtMVxuICAgIGlmIChpcy5udW1iZXIoYnVmZmVyZWQpKSB7XG4gICAgICByZXR1cm4gYnVmZmVyZWQ7XG4gICAgfVxuXG4gICAgLy8gSFRNTDVcbiAgICAvLyBUT0RPOiBIYW5kbGUgYnVmZmVyZWQgY2h1bmtzIG9mIHRoZSBtZWRpYVxuICAgIC8vIChpLmUuIHNlZWsgdG8gYW5vdGhlciBzZWN0aW9uIGJ1ZmZlcnMgb25seSB0aGF0IHNlY3Rpb24pXG4gICAgaWYgKGJ1ZmZlcmVkICYmIGJ1ZmZlcmVkLmxlbmd0aCAmJiB0aGlzLmR1cmF0aW9uID4gMCkge1xuICAgICAgcmV0dXJuIGJ1ZmZlcmVkLmVuZCgwKSAvIHRoaXMuZHVyYXRpb247XG4gICAgfVxuXG4gICAgcmV0dXJuIDA7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHNlZWtpbmcgc3RhdHVzXG4gICAqL1xuICBnZXQgc2Vla2luZygpIHtcbiAgICByZXR1cm4gQm9vbGVhbih0aGlzLm1lZGlhLnNlZWtpbmcpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgZHVyYXRpb24gb2YgdGhlIGN1cnJlbnQgbWVkaWFcbiAgICovXG4gIGdldCBkdXJhdGlvbigpIHtcbiAgICAvLyBGYXV4IGR1cmF0aW9uIHNldCB2aWEgY29uZmlnXG4gICAgY29uc3QgZmF1eER1cmF0aW9uID0gcGFyc2VGbG9hdCh0aGlzLmNvbmZpZy5kdXJhdGlvbik7XG4gICAgLy8gTWVkaWEgZHVyYXRpb24gY2FuIGJlIE5hTiBvciBJbmZpbml0eSBiZWZvcmUgdGhlIG1lZGlhIGhhcyBsb2FkZWRcbiAgICBjb25zdCByZWFsRHVyYXRpb24gPSAodGhpcy5tZWRpYSB8fCB7fSkuZHVyYXRpb247XG4gICAgY29uc3QgZHVyYXRpb24gPSAhaXMubnVtYmVyKHJlYWxEdXJhdGlvbikgfHwgcmVhbER1cmF0aW9uID09PSBJbmZpbml0eSA/IDAgOiByZWFsRHVyYXRpb247XG5cbiAgICAvLyBJZiBjb25maWcgZHVyYXRpb24gaXMgZnVua3ksIHVzZSByZWd1bGFyIGR1cmF0aW9uXG4gICAgcmV0dXJuIGZhdXhEdXJhdGlvbiB8fCBkdXJhdGlvbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdGhlIHBsYXllciB2b2x1bWVcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHZhbHVlIC0gbXVzdCBiZSBiZXR3ZWVuIDAgYW5kIDEuIERlZmF1bHRzIHRvIHRoZSB2YWx1ZSBmcm9tIGxvY2FsIHN0b3JhZ2UgYW5kIGNvbmZpZy52b2x1bWUgaWYgbm90IHNldCBpbiBzdG9yYWdlXG4gICAqL1xuICBzZXQgdm9sdW1lKHZhbHVlKSB7XG4gICAgbGV0IHZvbHVtZSA9IHZhbHVlO1xuICAgIGNvbnN0IG1heCA9IDE7XG4gICAgY29uc3QgbWluID0gMDtcblxuICAgIGlmIChpcy5zdHJpbmcodm9sdW1lKSkge1xuICAgICAgdm9sdW1lID0gTnVtYmVyKHZvbHVtZSk7XG4gICAgfVxuXG4gICAgLy8gTG9hZCB2b2x1bWUgZnJvbSBzdG9yYWdlIGlmIG5vIHZhbHVlIHNwZWNpZmllZFxuICAgIGlmICghaXMubnVtYmVyKHZvbHVtZSkpIHtcbiAgICAgIHZvbHVtZSA9IHRoaXMuc3RvcmFnZS5nZXQoJ3ZvbHVtZScpO1xuICAgIH1cblxuICAgIC8vIFVzZSBjb25maWcgaWYgYWxsIGVsc2UgZmFpbHNcbiAgICBpZiAoIWlzLm51bWJlcih2b2x1bWUpKSB7XG4gICAgICAoeyB2b2x1bWUgfSA9IHRoaXMuY29uZmlnKTtcbiAgICB9XG5cbiAgICAvLyBNYXhpbXVtIGlzIHZvbHVtZU1heFxuICAgIGlmICh2b2x1bWUgPiBtYXgpIHtcbiAgICAgIHZvbHVtZSA9IG1heDtcbiAgICB9XG4gICAgLy8gTWluaW11bSBpcyB2b2x1bWVNaW5cbiAgICBpZiAodm9sdW1lIDwgbWluKSB7XG4gICAgICB2b2x1bWUgPSBtaW47XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGNvbmZpZ1xuICAgIHRoaXMuY29uZmlnLnZvbHVtZSA9IHZvbHVtZTtcblxuICAgIC8vIFNldCB0aGUgcGxheWVyIHZvbHVtZVxuICAgIHRoaXMubWVkaWEudm9sdW1lID0gdm9sdW1lO1xuXG4gICAgLy8gSWYgbXV0ZWQsIGFuZCB3ZSdyZSBpbmNyZWFzaW5nIHZvbHVtZSBtYW51YWxseSwgcmVzZXQgbXV0ZWQgc3RhdGVcbiAgICBpZiAoIWlzLmVtcHR5KHZhbHVlKSAmJiB0aGlzLm11dGVkICYmIHZvbHVtZSA+IDApIHtcbiAgICAgIHRoaXMubXV0ZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBjdXJyZW50IHBsYXllciB2b2x1bWVcbiAgICovXG4gIGdldCB2b2x1bWUoKSB7XG4gICAgcmV0dXJuIE51bWJlcih0aGlzLm1lZGlhLnZvbHVtZSk7XG4gIH1cblxuICAvKipcbiAgICogSW5jcmVhc2Ugdm9sdW1lXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gc3RlcCAtIEhvdyBtdWNoIHRvIGRlY3JlYXNlIGJ5IChiZXR3ZWVuIDAgYW5kIDEpXG4gICAqL1xuICBpbmNyZWFzZVZvbHVtZSA9IChzdGVwKSA9PiB7XG4gICAgY29uc3Qgdm9sdW1lID0gdGhpcy5tZWRpYS5tdXRlZCA/IDAgOiB0aGlzLnZvbHVtZTtcbiAgICB0aGlzLnZvbHVtZSA9IHZvbHVtZSArIChpcy5udW1iZXIoc3RlcCkgPyBzdGVwIDogMCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIERlY3JlYXNlIHZvbHVtZVxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IHN0ZXAgLSBIb3cgbXVjaCB0byBkZWNyZWFzZSBieSAoYmV0d2VlbiAwIGFuZCAxKVxuICAgKi9cbiAgZGVjcmVhc2VWb2x1bWUgPSAoc3RlcCkgPT4ge1xuICAgIHRoaXMuaW5jcmVhc2VWb2x1bWUoLXN0ZXApO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTZXQgbXV0ZWQgc3RhdGVcbiAgICogQHBhcmFtIHtCb29sZWFufSBtdXRlXG4gICAqL1xuICBzZXQgbXV0ZWQobXV0ZSkge1xuICAgIGxldCB0b2dnbGUgPSBtdXRlO1xuXG4gICAgLy8gTG9hZCBtdXRlZCBzdGF0ZSBmcm9tIHN0b3JhZ2VcbiAgICBpZiAoIWlzLmJvb2xlYW4odG9nZ2xlKSkge1xuICAgICAgdG9nZ2xlID0gdGhpcy5zdG9yYWdlLmdldCgnbXV0ZWQnKTtcbiAgICB9XG5cbiAgICAvLyBVc2UgY29uZmlnIGlmIGFsbCBlbHNlIGZhaWxzXG4gICAgaWYgKCFpcy5ib29sZWFuKHRvZ2dsZSkpIHtcbiAgICAgIHRvZ2dsZSA9IHRoaXMuY29uZmlnLm11dGVkO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjb25maWdcbiAgICB0aGlzLmNvbmZpZy5tdXRlZCA9IHRvZ2dsZTtcblxuICAgIC8vIFNldCBtdXRlIG9uIHRoZSBwbGF5ZXJcbiAgICB0aGlzLm1lZGlhLm11dGVkID0gdG9nZ2xlO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjdXJyZW50IG11dGVkIHN0YXRlXG4gICAqL1xuICBnZXQgbXV0ZWQoKSB7XG4gICAgcmV0dXJuIEJvb2xlYW4odGhpcy5tZWRpYS5tdXRlZCk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgdGhlIG1lZGlhIGhhcyBhdWRpb1xuICAgKi9cbiAgZ2V0IGhhc0F1ZGlvKCkge1xuICAgIC8vIEFzc3VtZSB5ZXMgZm9yIGFsbCBub24gSFRNTDUgKGFzIHdlIGNhbid0IHRlbGwuLi4pXG4gICAgaWYgKCF0aGlzLmlzSFRNTDUpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzQXVkaW8pIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8vIEdldCBhdWRpbyB0cmFja3NcbiAgICByZXR1cm4gKFxuICAgICAgQm9vbGVhbih0aGlzLm1lZGlhLm1vekhhc0F1ZGlvKSB8fFxuICAgICAgQm9vbGVhbih0aGlzLm1lZGlhLndlYmtpdEF1ZGlvRGVjb2RlZEJ5dGVDb3VudCkgfHxcbiAgICAgIEJvb2xlYW4odGhpcy5tZWRpYS5hdWRpb1RyYWNrcyAmJiB0aGlzLm1lZGlhLmF1ZGlvVHJhY2tzLmxlbmd0aClcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCBwbGF5YmFjayBzcGVlZFxuICAgKiBAcGFyYW0ge051bWJlcn0gaW5wdXQgLSB0aGUgc3BlZWQgb2YgcGxheWJhY2sgKDAuNS0yLjApXG4gICAqL1xuICBzZXQgc3BlZWQoaW5wdXQpIHtcbiAgICBsZXQgc3BlZWQgPSBudWxsO1xuXG4gICAgaWYgKGlzLm51bWJlcihpbnB1dCkpIHtcbiAgICAgIHNwZWVkID0gaW5wdXQ7XG4gICAgfVxuXG4gICAgaWYgKCFpcy5udW1iZXIoc3BlZWQpKSB7XG4gICAgICBzcGVlZCA9IHRoaXMuc3RvcmFnZS5nZXQoJ3NwZWVkJyk7XG4gICAgfVxuXG4gICAgaWYgKCFpcy5udW1iZXIoc3BlZWQpKSB7XG4gICAgICBzcGVlZCA9IHRoaXMuY29uZmlnLnNwZWVkLnNlbGVjdGVkO1xuICAgIH1cblxuICAgIC8vIENsYW1wIHRvIG1pbi9tYXhcbiAgICBjb25zdCB7IG1pbmltdW1TcGVlZDogbWluLCBtYXhpbXVtU3BlZWQ6IG1heCB9ID0gdGhpcztcbiAgICBzcGVlZCA9IGNsYW1wKHNwZWVkLCBtaW4sIG1heCk7XG5cbiAgICAvLyBVcGRhdGUgY29uZmlnXG4gICAgdGhpcy5jb25maWcuc3BlZWQuc2VsZWN0ZWQgPSBzcGVlZDtcblxuICAgIC8vIFNldCBtZWRpYSBzcGVlZFxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgaWYgKHRoaXMubWVkaWEpIHtcbiAgICAgICAgdGhpcy5tZWRpYS5wbGF5YmFja1JhdGUgPSBzcGVlZDtcbiAgICAgIH1cbiAgICB9LCAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBwbGF5YmFjayBzcGVlZFxuICAgKi9cbiAgZ2V0IHNwZWVkKCkge1xuICAgIHJldHVybiBOdW1iZXIodGhpcy5tZWRpYS5wbGF5YmFja1JhdGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgbWluaW11bSBhbGxvd2VkIHNwZWVkXG4gICAqL1xuICBnZXQgbWluaW11bVNwZWVkKCkge1xuICAgIGlmICh0aGlzLmlzWW91VHViZSkge1xuICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20veW91dHViZS9pZnJhbWVfYXBpX3JlZmVyZW5jZSNzZXRQbGF5YmFja1JhdGVcbiAgICAgIHJldHVybiBNYXRoLm1pbiguLi50aGlzLm9wdGlvbnMuc3BlZWQpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzVmltZW8pIHtcbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS92aW1lby9wbGF5ZXIuanMvI3NldHBsYXliYWNrcmF0ZXBsYXliYWNrcmF0ZS1udW1iZXItcHJvbWlzZW51bWJlci1yYW5nZWVycm9yZXJyb3JcbiAgICAgIHJldHVybiAwLjU7XG4gICAgfVxuXG4gICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzMyMzIwMDIwLzExOTEzMTlcbiAgICByZXR1cm4gMC4wNjI1O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgbWF4aW11bSBhbGxvd2VkIHNwZWVkXG4gICAqL1xuICBnZXQgbWF4aW11bVNwZWVkKCkge1xuICAgIGlmICh0aGlzLmlzWW91VHViZSkge1xuICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20veW91dHViZS9pZnJhbWVfYXBpX3JlZmVyZW5jZSNzZXRQbGF5YmFja1JhdGVcbiAgICAgIHJldHVybiBNYXRoLm1heCguLi50aGlzLm9wdGlvbnMuc3BlZWQpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzVmltZW8pIHtcbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS92aW1lby9wbGF5ZXIuanMvI3NldHBsYXliYWNrcmF0ZXBsYXliYWNrcmF0ZS1udW1iZXItcHJvbWlzZW51bWJlci1yYW5nZWVycm9yZXJyb3JcbiAgICAgIHJldHVybiAyO1xuICAgIH1cblxuICAgIC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8zMjMyMDAyMC8xMTkxMzE5XG4gICAgcmV0dXJuIDE2O1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCBwbGF5YmFjayBxdWFsaXR5XG4gICAqIEN1cnJlbnRseSBIVE1MNSAmIFlvdVR1YmUgb25seVxuICAgKiBAcGFyYW0ge051bWJlcn0gaW5wdXQgLSBRdWFsaXR5IGxldmVsXG4gICAqL1xuICBzZXQgcXVhbGl0eShpbnB1dCkge1xuICAgIGNvbnN0IGNvbmZpZyA9IHRoaXMuY29uZmlnLnF1YWxpdHk7XG4gICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMub3B0aW9ucy5xdWFsaXR5O1xuXG4gICAgaWYgKCFvcHRpb25zLmxlbmd0aCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBxdWFsaXR5ID0gW1xuICAgICAgIWlzLmVtcHR5KGlucHV0KSAmJiBOdW1iZXIoaW5wdXQpLFxuICAgICAgdGhpcy5zdG9yYWdlLmdldCgncXVhbGl0eScpLFxuICAgICAgY29uZmlnLnNlbGVjdGVkLFxuICAgICAgY29uZmlnLmRlZmF1bHQsXG4gICAgXS5maW5kKGlzLm51bWJlcik7XG5cbiAgICBsZXQgdXBkYXRlU3RvcmFnZSA9IHRydWU7XG5cbiAgICBpZiAoIW9wdGlvbnMuaW5jbHVkZXMocXVhbGl0eSkpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gY2xvc2VzdChvcHRpb25zLCBxdWFsaXR5KTtcbiAgICAgIHRoaXMuZGVidWcud2FybihgVW5zdXBwb3J0ZWQgcXVhbGl0eSBvcHRpb246ICR7cXVhbGl0eX0sIHVzaW5nICR7dmFsdWV9IGluc3RlYWRgKTtcbiAgICAgIHF1YWxpdHkgPSB2YWx1ZTtcblxuICAgICAgLy8gRG9uJ3QgdXBkYXRlIHN0b3JhZ2UgaWYgcXVhbGl0eSBpcyBub3Qgc3VwcG9ydGVkXG4gICAgICB1cGRhdGVTdG9yYWdlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGNvbmZpZ1xuICAgIGNvbmZpZy5zZWxlY3RlZCA9IHF1YWxpdHk7XG5cbiAgICAvLyBTZXQgcXVhbGl0eVxuICAgIHRoaXMubWVkaWEucXVhbGl0eSA9IHF1YWxpdHk7XG5cbiAgICAvLyBTYXZlIHRvIHN0b3JhZ2VcbiAgICBpZiAodXBkYXRlU3RvcmFnZSkge1xuICAgICAgdGhpcy5zdG9yYWdlLnNldCh7IHF1YWxpdHkgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjdXJyZW50IHF1YWxpdHkgbGV2ZWxcbiAgICovXG4gIGdldCBxdWFsaXR5KCkge1xuICAgIHJldHVybiB0aGlzLm1lZGlhLnF1YWxpdHk7XG4gIH1cblxuICAvKipcbiAgICogVG9nZ2xlIGxvb3BcbiAgICogVE9ETzogRmluaXNoIGZhbmN5IG5ldyBsb2dpYy4gU2V0IHRoZSBpbmRpY2F0b3Igb24gbG9hZCBhcyB1c2VyIG1heSBwYXNzIGxvb3AgYXMgY29uZmlnXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gaW5wdXQgLSBXaGV0aGVyIHRvIGxvb3Agb3Igbm90XG4gICAqL1xuICBzZXQgbG9vcChpbnB1dCkge1xuICAgIGNvbnN0IHRvZ2dsZSA9IGlzLmJvb2xlYW4oaW5wdXQpID8gaW5wdXQgOiB0aGlzLmNvbmZpZy5sb29wLmFjdGl2ZTtcbiAgICB0aGlzLmNvbmZpZy5sb29wLmFjdGl2ZSA9IHRvZ2dsZTtcbiAgICB0aGlzLm1lZGlhLmxvb3AgPSB0b2dnbGU7XG5cbiAgICAvLyBTZXQgZGVmYXVsdCB0byBiZSBhIHRydWUgdG9nZ2xlXG4gICAgLyogY29uc3QgdHlwZSA9IFsnc3RhcnQnLCAnZW5kJywgJ2FsbCcsICdub25lJywgJ3RvZ2dsZSddLmluY2x1ZGVzKGlucHV0KSA/IGlucHV0IDogJ3RvZ2dsZSc7XG5cbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICBjYXNlICdzdGFydCc6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmxvb3AuZW5kICYmIHRoaXMuY29uZmlnLmxvb3AuZW5kIDw9IHRoaXMuY3VycmVudFRpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5lbmQgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLnN0YXJ0ID0gdGhpcy5jdXJyZW50VGltZTtcbiAgICAgICAgICAgICAgICAvLyB0aGlzLmNvbmZpZy5sb29wLmluZGljYXRvci5zdGFydCA9IHRoaXMuZWxlbWVudHMuZGlzcGxheS5wbGF5ZWQudmFsdWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmxvb3Auc3RhcnQgPj0gdGhpcy5jdXJyZW50VGltZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5lbmQgPSB0aGlzLmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgICAgIC8vIHRoaXMuY29uZmlnLmxvb3AuaW5kaWNhdG9yLmVuZCA9IHRoaXMuZWxlbWVudHMuZGlzcGxheS5wbGF5ZWQudmFsdWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2FsbCc6XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5zdGFydCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5lbmQgPSB0aGlzLmR1cmF0aW9uIC0gMjtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLmluZGljYXRvci5zdGFydCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5pbmRpY2F0b3IuZW5kID0gMTAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICd0b2dnbGUnOlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5sb29wLmFjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLnN0YXJ0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5lbmQgPSBudWxsO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3Auc3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLmVuZCA9IHRoaXMuZHVyYXRpb24gLSAyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLnN0YXJ0ID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLmVuZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH0gKi9cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBsb29wIHN0YXRlXG4gICAqL1xuICBnZXQgbG9vcCgpIHtcbiAgICByZXR1cm4gQm9vbGVhbih0aGlzLm1lZGlhLmxvb3ApO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCBuZXcgbWVkaWEgc291cmNlXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBpbnB1dCAtIFRoZSBuZXcgc291cmNlIG9iamVjdCAoc2VlIGRvY3MpXG4gICAqL1xuICBzZXQgc291cmNlKGlucHV0KSB7XG4gICAgc291cmNlLmNoYW5nZS5jYWxsKHRoaXMsIGlucHV0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBzb3VyY2VcbiAgICovXG4gIGdldCBzb3VyY2UoKSB7XG4gICAgcmV0dXJuIHRoaXMubWVkaWEuY3VycmVudFNyYztcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYSBkb3dubG9hZCBVUkwgKGVpdGhlciBzb3VyY2Ugb3IgY3VzdG9tKVxuICAgKi9cbiAgZ2V0IGRvd25sb2FkKCkge1xuICAgIGNvbnN0IHsgZG93bmxvYWQgfSA9IHRoaXMuY29uZmlnLnVybHM7XG5cbiAgICByZXR1cm4gaXMudXJsKGRvd25sb2FkKSA/IGRvd25sb2FkIDogdGhpcy5zb3VyY2U7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRoZSBkb3dubG9hZCBVUkxcbiAgICovXG4gIHNldCBkb3dubG9hZChpbnB1dCkge1xuICAgIGlmICghaXMudXJsKGlucHV0KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuY29uZmlnLnVybHMuZG93bmxvYWQgPSBpbnB1dDtcblxuICAgIGNvbnRyb2xzLnNldERvd25sb2FkVXJsLmNhbGwodGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRoZSBwb3N0ZXIgaW1hZ2UgZm9yIGEgdmlkZW9cbiAgICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IC0gdGhlIFVSTCBmb3IgdGhlIG5ldyBwb3N0ZXIgaW1hZ2VcbiAgICovXG4gIHNldCBwb3N0ZXIoaW5wdXQpIHtcbiAgICBpZiAoIXRoaXMuaXNWaWRlbykge1xuICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdQb3N0ZXIgY2FuIG9ubHkgYmUgc2V0IGZvciB2aWRlbycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHVpLnNldFBvc3Rlci5jYWxsKHRoaXMsIGlucHV0LCBmYWxzZSkuY2F0Y2goKCkgPT4ge30pO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY3VycmVudCBwb3N0ZXIgaW1hZ2VcbiAgICovXG4gIGdldCBwb3N0ZXIoKSB7XG4gICAgaWYgKCF0aGlzLmlzVmlkZW8pIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLm1lZGlhLmdldEF0dHJpYnV0ZSgncG9zdGVyJykgfHwgdGhpcy5tZWRpYS5nZXRBdHRyaWJ1dGUoJ2RhdGEtcG9zdGVyJyk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBjdXJyZW50IGFzcGVjdCByYXRpbyBpbiB1c2VcbiAgICovXG4gIGdldCByYXRpbygpIHtcbiAgICBpZiAoIXRoaXMuaXNWaWRlbykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgcmF0aW8gPSByZWR1Y2VBc3BlY3RSYXRpbyhnZXRBc3BlY3RSYXRpby5jYWxsKHRoaXMpKTtcblxuICAgIHJldHVybiBpcy5hcnJheShyYXRpbykgPyByYXRpby5qb2luKCc6JykgOiByYXRpbztcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdmlkZW8gYXNwZWN0IHJhdGlvXG4gICAqL1xuICBzZXQgcmF0aW8oaW5wdXQpIHtcbiAgICBpZiAoIXRoaXMuaXNWaWRlbykge1xuICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdBc3BlY3QgcmF0aW8gY2FuIG9ubHkgYmUgc2V0IGZvciB2aWRlbycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghaXMuc3RyaW5nKGlucHV0KSB8fCAhdmFsaWRhdGVBc3BlY3RSYXRpbyhpbnB1dCkpIHtcbiAgICAgIHRoaXMuZGVidWcuZXJyb3IoYEludmFsaWQgYXNwZWN0IHJhdGlvIHNwZWNpZmllZCAoJHtpbnB1dH0pYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5jb25maWcucmF0aW8gPSByZWR1Y2VBc3BlY3RSYXRpbyhpbnB1dCk7XG5cbiAgICBzZXRBc3BlY3RSYXRpby5jYWxsKHRoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgYXV0b3BsYXkgc3RhdGVcbiAgICogQHBhcmFtIHtCb29sZWFufSBpbnB1dCAtIFdoZXRoZXIgdG8gYXV0b3BsYXkgb3Igbm90XG4gICAqL1xuICBzZXQgYXV0b3BsYXkoaW5wdXQpIHtcbiAgICB0aGlzLmNvbmZpZy5hdXRvcGxheSA9IGlzLmJvb2xlYW4oaW5wdXQpID8gaW5wdXQgOiB0aGlzLmNvbmZpZy5hdXRvcGxheTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGN1cnJlbnQgYXV0b3BsYXkgc3RhdGVcbiAgICovXG4gIGdldCBhdXRvcGxheSgpIHtcbiAgICByZXR1cm4gQm9vbGVhbih0aGlzLmNvbmZpZy5hdXRvcGxheSk7XG4gIH1cblxuICAvKipcbiAgICogVG9nZ2xlIGNhcHRpb25zXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gaW5wdXQgLSBXaGV0aGVyIHRvIGVuYWJsZSBjYXB0aW9uc1xuICAgKi9cbiAgdG9nZ2xlQ2FwdGlvbnMoaW5wdXQpIHtcbiAgICBjYXB0aW9ucy50b2dnbGUuY2FsbCh0aGlzLCBpbnB1dCwgZmFsc2UpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgY2FwdGlvbiB0cmFjayBieSBpbmRleFxuICAgKiBAcGFyYW0ge051bWJlcn0gaW5wdXQgLSBDYXB0aW9uIGluZGV4XG4gICAqL1xuICBzZXQgY3VycmVudFRyYWNrKGlucHV0KSB7XG4gICAgY2FwdGlvbnMuc2V0LmNhbGwodGhpcywgaW5wdXQsIGZhbHNlKTtcbiAgICBjYXB0aW9ucy5zZXR1cC5jYWxsKHRoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY3VycmVudCBjYXB0aW9uIHRyYWNrIGluZGV4ICgtMSBpZiBkaXNhYmxlZClcbiAgICovXG4gIGdldCBjdXJyZW50VHJhY2soKSB7XG4gICAgY29uc3QgeyB0b2dnbGVkLCBjdXJyZW50VHJhY2sgfSA9IHRoaXMuY2FwdGlvbnM7XG4gICAgcmV0dXJuIHRvZ2dsZWQgPyBjdXJyZW50VHJhY2sgOiAtMTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdGhlIHdhbnRlZCBsYW5ndWFnZSBmb3IgY2FwdGlvbnNcbiAgICogU2luY2UgdHJhY2tzIGNhbiBiZSBhZGRlZCBsYXRlciBpdCB3b24ndCB1cGRhdGUgdGhlIGFjdHVhbCBjYXB0aW9uIHRyYWNrIHVudGlsIHRoZXJlIGlzIGEgbWF0Y2hpbmcgdHJhY2tcbiAgICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IC0gVHdvIGNoYXJhY3RlciBJU08gbGFuZ3VhZ2UgY29kZSAoZS5nLiBFTiwgRlIsIFBULCBldGMpXG4gICAqL1xuICBzZXQgbGFuZ3VhZ2UoaW5wdXQpIHtcbiAgICBjYXB0aW9ucy5zZXRMYW5ndWFnZS5jYWxsKHRoaXMsIGlucHV0LCBmYWxzZSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBjdXJyZW50IHRyYWNrJ3MgbGFuZ3VhZ2VcbiAgICovXG4gIGdldCBsYW5ndWFnZSgpIHtcbiAgICByZXR1cm4gKGNhcHRpb25zLmdldEN1cnJlbnRUcmFjay5jYWxsKHRoaXMpIHx8IHt9KS5sYW5ndWFnZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUb2dnbGUgcGljdHVyZS1pbi1waWN0dXJlIHBsYXliYWNrIG9uIFdlYktpdC9NYWNPU1xuICAgKiBUT0RPOiB1cGRhdGUgcGxheWVyIHdpdGggc3RhdGUsIHN1cHBvcnQsIGVuYWJsZWRcbiAgICogVE9ETzogZGV0ZWN0IG91dHNpZGUgY2hhbmdlc1xuICAgKi9cbiAgc2V0IHBpcChpbnB1dCkge1xuICAgIC8vIEJhaWwgaWYgbm8gc3VwcG9ydFxuICAgIGlmICghc3VwcG9ydC5waXApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBUb2dnbGUgYmFzZWQgb24gY3VycmVudCBzdGF0ZSBpZiBub3QgcGFzc2VkXG4gICAgY29uc3QgdG9nZ2xlID0gaXMuYm9vbGVhbihpbnB1dCkgPyBpbnB1dCA6ICF0aGlzLnBpcDtcblxuICAgIC8vIFRvZ2dsZSBiYXNlZCBvbiBjdXJyZW50IHN0YXRlXG4gICAgLy8gU2FmYXJpXG4gICAgaWYgKGlzLmZ1bmN0aW9uKHRoaXMubWVkaWEud2Via2l0U2V0UHJlc2VudGF0aW9uTW9kZSkpIHtcbiAgICAgIHRoaXMubWVkaWEud2Via2l0U2V0UHJlc2VudGF0aW9uTW9kZSh0b2dnbGUgPyBwaXAuYWN0aXZlIDogcGlwLmluYWN0aXZlKTtcbiAgICB9XG5cbiAgICAvLyBDaHJvbWVcbiAgICBpZiAoaXMuZnVuY3Rpb24odGhpcy5tZWRpYS5yZXF1ZXN0UGljdHVyZUluUGljdHVyZSkpIHtcbiAgICAgIGlmICghdGhpcy5waXAgJiYgdG9nZ2xlKSB7XG4gICAgICAgIHRoaXMubWVkaWEucmVxdWVzdFBpY3R1cmVJblBpY3R1cmUoKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5waXAgJiYgIXRvZ2dsZSkge1xuICAgICAgICBkb2N1bWVudC5leGl0UGljdHVyZUluUGljdHVyZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGN1cnJlbnQgcGljdHVyZS1pbi1waWN0dXJlIHN0YXRlXG4gICAqL1xuICBnZXQgcGlwKCkge1xuICAgIGlmICghc3VwcG9ydC5waXApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIFNhZmFyaVxuICAgIGlmICghaXMuZW1wdHkodGhpcy5tZWRpYS53ZWJraXRQcmVzZW50YXRpb25Nb2RlKSkge1xuICAgICAgcmV0dXJuIHRoaXMubWVkaWEud2Via2l0UHJlc2VudGF0aW9uTW9kZSA9PT0gcGlwLmFjdGl2ZTtcbiAgICB9XG5cbiAgICAvLyBDaHJvbWVcbiAgICByZXR1cm4gdGhpcy5tZWRpYSA9PT0gZG9jdW1lbnQucGljdHVyZUluUGljdHVyZUVsZW1lbnQ7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgcHJldmlldyB0aHVibW5haWxzIGZvciB0aGUgY3VycmVudCBzb3VyY2VcbiAgICovXG4gIHNldFByZXZpZXdUaHVtYm5haWxzKHRodW1ibmFpbFNvdXJjZSkge1xuICAgIGlmICh0aGlzLnByZXZpZXdUaHVtYm5haWxzICYmIHRoaXMucHJldmlld1RodW1ibmFpbHMubG9hZGVkKSB7XG4gICAgICB0aGlzLnByZXZpZXdUaHVtYm5haWxzLmRlc3Ryb3koKTtcbiAgICAgIHRoaXMucHJldmlld1RodW1ibmFpbHMgPSBudWxsO1xuICAgIH1cblxuICAgIE9iamVjdC5hc3NpZ24odGhpcy5jb25maWcucHJldmlld1RodW1ibmFpbHMsIHRodW1ibmFpbFNvdXJjZSk7XG5cbiAgICAvLyBDcmVhdGUgbmV3IGluc3RhbmNlIGlmIGl0IGlzIHN0aWxsIGVuYWJsZWRcbiAgICBpZiAodGhpcy5jb25maWcucHJldmlld1RodW1ibmFpbHMuZW5hYmxlZCkge1xuICAgICAgdGhpcy5wcmV2aWV3VGh1bWJuYWlscyA9IG5ldyBQcmV2aWV3VGh1bWJuYWlscyh0aGlzKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVHJpZ2dlciB0aGUgYWlycGxheSBkaWFsb2dcbiAgICogVE9ETzogdXBkYXRlIHBsYXllciB3aXRoIHN0YXRlLCBzdXBwb3J0LCBlbmFibGVkXG4gICAqL1xuICBhaXJwbGF5ID0gKCkgPT4ge1xuICAgIC8vIFNob3cgZGlhbG9nIGlmIHN1cHBvcnRlZFxuICAgIGlmIChzdXBwb3J0LmFpcnBsYXkpIHtcbiAgICAgIHRoaXMubWVkaWEud2Via2l0U2hvd1BsYXliYWNrVGFyZ2V0UGlja2VyKCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBUb2dnbGUgdGhlIHBsYXllciBjb250cm9sc1xuICAgKiBAcGFyYW0ge0Jvb2xlYW59IFt0b2dnbGVdIC0gV2hldGhlciB0byBzaG93IHRoZSBjb250cm9sc1xuICAgKi9cbiAgdG9nZ2xlQ29udHJvbHMgPSAodG9nZ2xlKSA9PiB7XG4gICAgLy8gRG9uJ3QgdG9nZ2xlIGlmIG1pc3NpbmcgVUkgc3VwcG9ydCBvciBpZiBpdCdzIGF1ZGlvXG4gICAgaWYgKHRoaXMuc3VwcG9ydGVkLnVpICYmICF0aGlzLmlzQXVkaW8pIHtcbiAgICAgIC8vIEdldCBzdGF0ZSBiZWZvcmUgY2hhbmdlXG4gICAgICBjb25zdCBpc0hpZGRlbiA9IGhhc0NsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmhpZGVDb250cm9scyk7XG4gICAgICAvLyBOZWdhdGUgdGhlIGFyZ3VtZW50IGlmIG5vdCB1bmRlZmluZWQgc2luY2UgYWRkaW5nIHRoZSBjbGFzcyB0byBoaWRlcyB0aGUgY29udHJvbHNcbiAgICAgIGNvbnN0IGZvcmNlID0gdHlwZW9mIHRvZ2dsZSA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiAhdG9nZ2xlO1xuICAgICAgLy8gQXBwbHkgYW5kIGdldCB1cGRhdGVkIHN0YXRlXG4gICAgICBjb25zdCBoaWRpbmcgPSB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5oaWRlQ29udHJvbHMsIGZvcmNlKTtcblxuICAgICAgLy8gQ2xvc2UgbWVudVxuICAgICAgaWYgKFxuICAgICAgICBoaWRpbmcgJiZcbiAgICAgICAgaXMuYXJyYXkodGhpcy5jb25maWcuY29udHJvbHMpICYmXG4gICAgICAgIHRoaXMuY29uZmlnLmNvbnRyb2xzLmluY2x1ZGVzKCdzZXR0aW5ncycpICYmXG4gICAgICAgICFpcy5lbXB0eSh0aGlzLmNvbmZpZy5zZXR0aW5ncylcbiAgICAgICkge1xuICAgICAgICBjb250cm9scy50b2dnbGVNZW51LmNhbGwodGhpcywgZmFsc2UpO1xuICAgICAgfVxuXG4gICAgICAvLyBUcmlnZ2VyIGV2ZW50IG9uIGNoYW5nZVxuICAgICAgaWYgKGhpZGluZyAhPT0gaXNIaWRkZW4pIHtcbiAgICAgICAgY29uc3QgZXZlbnROYW1lID0gaGlkaW5nID8gJ2NvbnRyb2xzaGlkZGVuJyA6ICdjb250cm9sc3Nob3duJztcbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwodGhpcywgdGhpcy5tZWRpYSwgZXZlbnROYW1lKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuICFoaWRpbmc7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBZGQgZXZlbnQgbGlzdGVuZXJzXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudCAtIEV2ZW50IHR5cGVcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmb3Igd2hlbiBldmVudCBvY2N1cnNcbiAgICovXG4gIG9uID0gKGV2ZW50LCBjYWxsYmFjaykgPT4ge1xuICAgIG9uLmNhbGwodGhpcywgdGhpcy5lbGVtZW50cy5jb250YWluZXIsIGV2ZW50LCBjYWxsYmFjayk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZCBldmVudCBsaXN0ZW5lcnMgb25jZVxuICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnQgLSBFdmVudCB0eXBlXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZm9yIHdoZW4gZXZlbnQgb2NjdXJzXG4gICAqL1xuICBvbmNlID0gKGV2ZW50LCBjYWxsYmFjaykgPT4ge1xuICAgIG9uY2UuY2FsbCh0aGlzLCB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgZXZlbnQsIGNhbGxiYWNrKTtcbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlIGV2ZW50IGxpc3RlbmVyc1xuICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnQgLSBFdmVudCB0eXBlXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZm9yIHdoZW4gZXZlbnQgb2NjdXJzXG4gICAqL1xuICBvZmYgPSAoZXZlbnQsIGNhbGxiYWNrKSA9PiB7XG4gICAgb2ZmKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCBldmVudCwgY2FsbGJhY2spO1xuICB9O1xuXG4gIC8qKlxuICAgKiBEZXN0cm95IGFuIGluc3RhbmNlXG4gICAqIEV2ZW50IGxpc3RlbmVycyBhcmUgcmVtb3ZlZCB3aGVuIGVsZW1lbnRzIGFyZSByZW1vdmVkXG4gICAqIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTI1MjgwNDkvaWYtYS1kb20tZWxlbWVudC1pcy1yZW1vdmVkLWFyZS1pdHMtbGlzdGVuZXJzLWFsc28tcmVtb3ZlZC1mcm9tLW1lbW9yeVxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZvciB3aGVuIGRlc3Ryb3kgaXMgY29tcGxldGVcbiAgICogQHBhcmFtIHtCb29sZWFufSBzb2Z0IC0gV2hldGhlciBpdCdzIGEgc29mdCBkZXN0cm95IChmb3Igc291cmNlIGNoYW5nZXMgZXRjKVxuICAgKi9cbiAgZGVzdHJveSA9IChjYWxsYmFjaywgc29mdCA9IGZhbHNlKSA9PiB7XG4gICAgaWYgKCF0aGlzLnJlYWR5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgZG9uZSA9ICgpID0+IHtcbiAgICAgIC8vIFJlc2V0IG92ZXJmbG93IChpbmNhc2UgZGVzdHJveWVkIHdoaWxlIGluIGZ1bGxzY3JlZW4pXG4gICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJyc7XG5cbiAgICAgIC8vIEdDIGZvciBlbWJlZFxuICAgICAgdGhpcy5lbWJlZCA9IG51bGw7XG5cbiAgICAgIC8vIElmIGl0J3MgYSBzb2Z0IGRlc3Ryb3ksIG1ha2UgbWluaW1hbCBjaGFuZ2VzXG4gICAgICBpZiAoc29mdCkge1xuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5lbGVtZW50cykubGVuZ3RoKSB7XG4gICAgICAgICAgLy8gUmVtb3ZlIGVsZW1lbnRzXG4gICAgICAgICAgcmVtb3ZlRWxlbWVudCh0aGlzLmVsZW1lbnRzLmJ1dHRvbnMucGxheSk7XG4gICAgICAgICAgcmVtb3ZlRWxlbWVudCh0aGlzLmVsZW1lbnRzLmNhcHRpb25zKTtcbiAgICAgICAgICByZW1vdmVFbGVtZW50KHRoaXMuZWxlbWVudHMuY29udHJvbHMpO1xuICAgICAgICAgIHJlbW92ZUVsZW1lbnQodGhpcy5lbGVtZW50cy53cmFwcGVyKTtcblxuICAgICAgICAgIC8vIENsZWFyIGZvciBHQ1xuICAgICAgICAgIHRoaXMuZWxlbWVudHMuYnV0dG9ucy5wbGF5ID0gbnVsbDtcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLmNhcHRpb25zID0gbnVsbDtcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRyb2xzID0gbnVsbDtcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLndyYXBwZXIgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2FsbGJhY2tcbiAgICAgICAgaWYgKGlzLmZ1bmN0aW9uKGNhbGxiYWNrKSkge1xuICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFVuYmluZCBsaXN0ZW5lcnNcbiAgICAgICAgdW5iaW5kTGlzdGVuZXJzLmNhbGwodGhpcyk7XG5cbiAgICAgICAgLy8gQ2FuY2VsIGN1cnJlbnQgbmV0d29yayByZXF1ZXN0c1xuICAgICAgICBodG1sNS5jYW5jZWxSZXF1ZXN0cy5jYWxsKHRoaXMpO1xuXG4gICAgICAgIC8vIFJlcGxhY2UgdGhlIGNvbnRhaW5lciB3aXRoIHRoZSBvcmlnaW5hbCBlbGVtZW50IHByb3ZpZGVkXG4gICAgICAgIHJlcGxhY2VFbGVtZW50KHRoaXMuZWxlbWVudHMub3JpZ2luYWwsIHRoaXMuZWxlbWVudHMuY29udGFpbmVyKTtcblxuICAgICAgICAvLyBFdmVudFxuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbCh0aGlzLCB0aGlzLmVsZW1lbnRzLm9yaWdpbmFsLCAnZGVzdHJveWVkJywgdHJ1ZSk7XG5cbiAgICAgICAgLy8gQ2FsbGJhY2tcbiAgICAgICAgaWYgKGlzLmZ1bmN0aW9uKGNhbGxiYWNrKSkge1xuICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpcy5lbGVtZW50cy5vcmlnaW5hbCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZXNldCBzdGF0ZVxuICAgICAgICB0aGlzLnJlYWR5ID0gZmFsc2U7XG5cbiAgICAgICAgLy8gQ2xlYXIgZm9yIGdhcmJhZ2UgY29sbGVjdGlvblxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzID0gbnVsbDtcbiAgICAgICAgICB0aGlzLm1lZGlhID0gbnVsbDtcbiAgICAgICAgfSwgMjAwKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gU3RvcCBwbGF5YmFja1xuICAgIHRoaXMuc3RvcCgpO1xuXG4gICAgLy8gQ2xlYXIgdGltZW91dHNcbiAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcnMubG9hZGluZyk7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmNvbnRyb2xzKTtcbiAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcnMucmVzaXplZCk7XG5cbiAgICAvLyBQcm92aWRlciBzcGVjaWZpYyBzdHVmZlxuICAgIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgIC8vIFJlc3RvcmUgbmF0aXZlIHZpZGVvIGNvbnRyb2xzXG4gICAgICB1aS50b2dnbGVOYXRpdmVDb250cm9scy5jYWxsKHRoaXMsIHRydWUpO1xuXG4gICAgICAvLyBDbGVhbiB1cFxuICAgICAgZG9uZSgpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5pc1lvdVR1YmUpIHtcbiAgICAgIC8vIENsZWFyIHRpbWVyc1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVycy5idWZmZXJpbmcpO1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVycy5wbGF5aW5nKTtcblxuICAgICAgLy8gRGVzdHJveSBZb3VUdWJlIEFQSVxuICAgICAgaWYgKHRoaXMuZW1iZWQgIT09IG51bGwgJiYgaXMuZnVuY3Rpb24odGhpcy5lbWJlZC5kZXN0cm95KSkge1xuICAgICAgICB0aGlzLmVtYmVkLmRlc3Ryb3koKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2xlYW4gdXBcbiAgICAgIGRvbmUoKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuaXNWaW1lbykge1xuICAgICAgLy8gRGVzdHJveSBWaW1lbyBBUElcbiAgICAgIC8vIHRoZW4gY2xlYW4gdXAgKHdhaXQsIHRvIHByZXZlbnQgcG9zdG1lc3NhZ2UgZXJyb3JzKVxuICAgICAgaWYgKHRoaXMuZW1iZWQgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5lbWJlZC51bmxvYWQoKS50aGVuKGRvbmUpO1xuICAgICAgfVxuXG4gICAgICAvLyBWaW1lbyBkb2VzIG5vdCBhbHdheXMgcmV0dXJuXG4gICAgICBzZXRUaW1lb3V0KGRvbmUsIDIwMCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBDaGVjayBmb3Igc3VwcG9ydCBmb3IgYSBtaW1lIHR5cGUgKEhUTUw1IG9ubHkpXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIC0gTWltZSB0eXBlXG4gICAqL1xuICBzdXBwb3J0cyA9ICh0eXBlKSA9PiBzdXBwb3J0Lm1pbWUuY2FsbCh0aGlzLCB0eXBlKTtcblxuICAvKipcbiAgICogQ2hlY2sgZm9yIHN1cHBvcnRcbiAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgLSBQbGF5ZXIgdHlwZSAoYXVkaW8vdmlkZW8pXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBwcm92aWRlciAtIFByb3ZpZGVyIChodG1sNS95b3V0dWJlL3ZpbWVvKVxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlubGluZSAtIFdoZXJlIHBsYXllciBoYXMgYHBsYXlzaW5saW5lYCBzdHRyaWJ1dGVcbiAgICovXG4gIHN0YXRpYyBzdXBwb3J0ZWQodHlwZSwgcHJvdmlkZXIsIGlubGluZSkge1xuICAgIHJldHVybiBzdXBwb3J0LmNoZWNrKHR5cGUsIHByb3ZpZGVyLCBpbmxpbmUpO1xuICB9XG5cbiAgLyoqXG4gICAqIExvYWQgYW4gU1ZHIHNwcml0ZSBpbnRvIHRoZSBwYWdlXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgLSBVUkwgZm9yIHRoZSBTVkcgc3ByaXRlXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBbaWRdIC0gVW5pcXVlIElEXG4gICAqL1xuICBzdGF0aWMgbG9hZFNwcml0ZSh1cmwsIGlkKSB7XG4gICAgcmV0dXJuIGxvYWRTcHJpdGUodXJsLCBpZCk7XG4gIH1cblxuICAvKipcbiAgICogU2V0dXAgbXVsdGlwbGUgaW5zdGFuY2VzXG4gICAqIEBwYXJhbSB7Kn0gc2VsZWN0b3JcbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAgICovXG4gIHN0YXRpYyBzZXR1cChzZWxlY3Rvciwgb3B0aW9ucyA9IHt9KSB7XG4gICAgbGV0IHRhcmdldHMgPSBudWxsO1xuXG4gICAgaWYgKGlzLnN0cmluZyhzZWxlY3RvcikpIHtcbiAgICAgIHRhcmdldHMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcbiAgICB9IGVsc2UgaWYgKGlzLm5vZGVMaXN0KHNlbGVjdG9yKSkge1xuICAgICAgdGFyZ2V0cyA9IEFycmF5LmZyb20oc2VsZWN0b3IpO1xuICAgIH0gZWxzZSBpZiAoaXMuYXJyYXkoc2VsZWN0b3IpKSB7XG4gICAgICB0YXJnZXRzID0gc2VsZWN0b3IuZmlsdGVyKGlzLmVsZW1lbnQpO1xuICAgIH1cblxuICAgIGlmIChpcy5lbXB0eSh0YXJnZXRzKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRhcmdldHMubWFwKCh0KSA9PiBuZXcgUGx5cih0LCBvcHRpb25zKSk7XG4gIH1cbn1cblxuUGx5ci5kZWZhdWx0cyA9IGNsb25lRGVlcChkZWZhdWx0cyk7XG5cbmV4cG9ydCBkZWZhdWx0IFBseXI7XG4iLCJcInVzZSBjdHJpY3RcIjtcblxuZXhwb3J0IGNvbnN0IFN3aXBlcnMgPSAoKSA9PiB7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICBcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAgIHZhciBzd2lwZXIgPSBuZXcgU3dpcGVyKFwiLnNsaWRlci1qcy0yXCIsIHtcbiAgICAgIHNsaWRlc1BlclZpZXc6IDQsXG4gICAgICBkaXJlY3Rpb246IFwidmVydGljYWxcIixcbiAgICAgIGZyZWVNb2RlOiB0cnVlLFxuICAgICAgd2F0Y2hTbGlkZXNQcm9ncmVzczogdHJ1ZSxcbiAgICAgIC8vICBuYXZpZ2F0aW9uOiB7XG4gICAgICAvLyAgICAgIHByZXZFbDogXCIuanMtMS1wcmV2XCIsXG4gICAgICAvLyAgICAgIG5leHRFbDogXCIuanMtMS1uZXh0XCIsXG4gICAgICAvLyAgICB9LFxuICAgIH0pO1xuICAgIHZhciBzd2lwZXIyID0gbmV3IFN3aXBlcihcIi5zbGlkZXItanMtMVwiLCB7XG4gICAgICBzcGFjZUJldHdlZW46IDEwLFxuICAgICAgbmF2aWdhdGlvbjoge1xuICAgICAgICBuZXh0RWw6IFwiLnN3aXBlci1idXR0b24tbmV4dFwiLFxuICAgICAgICBwcmV2RWw6IFwiLnN3aXBlci1idXR0b24tcHJldlwiLFxuICAgICAgfSxcbiAgICAgIHRodW1iczoge1xuICAgICAgICBzd2lwZXI6IHN3aXBlcixcbiAgICAgIH0sXG4gICAgICBlZmZlY3Q6IFwiZmFkZVwiLFxuICAgICAgZmFkZUVmZmVjdDoge1xuICAgICAgICBjcm9zc0ZhZGU6IHRydWUsXG4gICAgICB9LFxuICAgIH0pO1xuICAgXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgY29uc3Qgc3dpcGVyRnVsbCA9IG5ldyBTd2lwZXIoXCIuc2xpZGVyLWZ1bGwtanNcIiwge1xuICAgICAgc2xpZGVzUGVyVmlldzogNCxcbiAgICAgIGxvb3A6IFwidHJ1ZVwiLFxuICAgICAgc3BlZWQ6IDMwMCxcbiAgICAgIHNwYWNlQmV0d2VlbjogMTQsXG4gICAgICAvLyBjZW50ZXJlZFNsaWRlczogdHJ1ZSxcbiAgICAgIGdyYWJDdXJzb3I6IHRydWUsXG4gICAgICAvLyBlZmZlY3Q6IFwiY292ZXJmbG93XCIsXG4gICAgICAvLyBjb3ZlcmZsb3dFZmZlY3Q6IHtcbiAgICAgIC8vICAgcm90YXRlOiAwLFxuICAgICAgLy8gICBzdHJldGNoOiAwLFxuICAgICAgLy8gICBkZXB0aDogMCxcbiAgICAgIC8vICAgLy8gbW9kaWZpZXI6IDEsXG4gICAgICAvLyAgIC8vIHNsaWRlU2hhZG93czogdHJ1ZSxcbiAgICAgIC8vIH0sXG4gICAgICAvLyB3YXRjaFNsaWRlc1Byb2dyZXNzOiB0cnVlLFxuXG4gICAgICBwYWdpbmF0aW9uOiB7XG4gICAgICAgIGVsOiBcIi5zd2lwZXItcGFnaW5hdGlvbi1yZXdcIixcbiAgICAgICAgY2xpY2thYmxlOiB0cnVlLFxuICAgICAgfSxcbiAgICAgIG5hdmlnYXRpb246IHtcbiAgICAgICAgcHJldkVsOiBcIi5qcy1yZXctcHJldlwiLFxuICAgICAgICBuZXh0RWw6IFwiLmpzLXJldy1uZXh0XCIsXG4gICAgICB9LFxuXG4gICAgICBicmVha3BvaW50czoge1xuICAgICAgICA5MDA6IHtcbiAgICAgICAgICBzcGFjZUJldHdlZW46IDIyLFxuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuXG4gIFxuICB9KTtcbn07XG4iLCJcInVzZSBjdHJpY3RcIjtcclxuXHJcblxyXG5leHBvcnQgY29uc3QgQW5pbSA9ICgpID0+IHtcclxuICBmdW5jdGlvbiBBbmltRm9yU2Nyb2xsVG9wKGNlbGwsIHJlYykge1xyXG4gICAgaWYgKHJlYy50b3AgPCBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodCAtIDIwMCkge1xyXG4gICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoXCJfaXMtYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gQW5pbUZvclNjcm9sbGxlZnQoY2VsbCwgcmVjKSB7XHJcbiAgICBpZiAocmVjLnRvcCA8IGRvY3VtZW50LmJvZHkub2Zmc2V0SGVpZ2h0IC0gMjAwKSB7XHJcbiAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZChcIl9pcy1hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBBbmltRm9yU2Nyb2xsUmlnaHQoY2VsbCwgcmVjKSB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGlmIChyZWMudG9wIDwgZG9jdW1lbnQuYm9keS5vZmZzZXRIZWlnaHQgLSAyMDApIHtcclxuICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoXCJfaXMtYWN0aXZlXCIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgYW5pbVRvcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuX2FuaW0tdG9wXCIpO1xyXG4gICAgbGV0IGFuaW1sZWZ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5fYW5pbS1sZWZ0XCIpO1xyXG4gICAgbGV0IGFuaW1SaWdodCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuX2FuaW0tcmlnaHRcIik7XHJcbiAgICBsZXQgc2luZ2xlc1RvcCA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFuaW1Ub3ApO1xyXG4gICAgbGV0IHNpbmdsZXNsZWZ0ID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYW5pbWxlZnQpO1xyXG4gICAgbGV0IHNpbmdsZXNSaWdodCA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFuaW1SaWdodCk7XHJcblxyXG5cclxuXHJcbiAgICBpZiAoc2luZ2xlc1RvcC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHNpbmdsZXNUb3AuZm9yRWFjaCgoY2VsbCkgPT4ge1xyXG5cclxuICAgICAgICAgbGV0IHJlYyA9IGNlbGwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgIGlmIChyZWMudG9wIDwgZG9jdW1lbnQuYm9keS5vZmZzZXRIZWlnaHQgLSAyMDApIHtcclxuICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZChcIl9pcy1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoc2luZ2xlc2xlZnQubGVuZ3RoID4gMCkge1xyXG4gICAgICBzaW5nbGVzbGVmdC5mb3JFYWNoKChjZWxsMSkgPT4ge1xyXG4gICAgICAgICBsZXQgcmVjID0gY2VsbDEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICBpZiAocmVjLnRvcCA8IGRvY3VtZW50LmJvZHkub2Zmc2V0SGVpZ2h0IC0gMjAwKSB7XHJcbiAgICAgICAgICAgICBjZWxsMS5jbGFzc0xpc3QuYWRkKFwiX2lzLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICB9XHJcbiAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoc2luZ2xlc1JpZ2h0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgc2luZ2xlc1JpZ2h0LmZvckVhY2goKGNlbGwyKSA9PiB7XHJcbiAgICAgICAgIGxldCByZWMgPSBjZWxsMi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgaWYgKHJlYy50b3AgPCBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodCAtIDIwMCkge1xyXG4gICAgICAgICAgICAgY2VsbDIuY2xhc3NMaXN0LmFkZChcIl9pcy1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBcclxuICB9KTtcclxuXHJcblxyXG59O1xyXG5cclxuXHJcblxyXG5cclxuIiwiXCJ1c2UgY3RyaWN0XCI7XHJcblxyXG5leHBvcnQgY29uc3QgQnV0dG9uID0gKGUpID0+IHtcclxuICBsZXQgdGFyZ2V0ID0gIGUudGFyZ2V0LmNsb3Nlc3QoJy5idXQtd2F2ZScpO1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgbGV0IG1WYWx1ZSA9IE1hdGgubWF4KHRhcmdldC5jbGllbnRXaWR0aCwgdGFyZ2V0LmNsaWVudEhlaWdodCksXHJcbiAgICAgIGFkZERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXHJcbiAgICAgIHJlY3QgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICBhZGREaXYuY2xhc3NMaXN0LmFkZChcImFkZERpdlwiKTtcclxuICAgIGFkZERpdi5zdHlsZS53aWR0aCA9IGFkZERpdi5zdHlsZS5oZWlnaHQgPSBtVmFsdWUgKyBcInB4XCI7XHJcbiAgICBhZGREaXYuc3R5bGUubGVmdCA9IGUuY2xpZW50WCAtIHJlY3QubGVmdCAtIG1WYWx1ZSAvIDIgKyBcInB4XCI7XHJcbiAgICBhZGREaXYuc3R5bGUudG9wID0gZS5jbGllbnRZIC0gcmVjdC50b3AgLSBtVmFsdWUgLyAyICsgXCJweFwiO1xyXG4gICAgdGFyZ2V0LmNsb3Nlc3QoXCIuYnV0LXdhdmVcIikuYXBwZW5kKGFkZERpdik7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgYWRkRGl2LnJlbW92ZSgpO1xyXG4gICAgfSwgMzAwKTtcclxufTtcclxuXHJcbiIsIi8vIGltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XHJcbmltcG9ydCBQbHlyIGZyb20gXCJwbHlyXCI7XHJcblxyXG5leHBvcnQgY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJib2R5XCIpO1xyXG5leHBvcnQgY29uc3Qgd2F2ZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJ1dC13YXZlXCIpO1xyXG5leHBvcnQgY29uc3QgcG9wdXBzSW5pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBzLWluaXQtanNcIik7XHJcbmV4cG9ydCBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaGVhZGVyXCIpO1xyXG5leHBvcnQgY29uc3QgdG95c1BseXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRveXNfX3BseXJcIik7XHJcblxyXG4vLyBleHBvcnQgY29uc3QgcGxheWVyRnVsbFRveXMgPSBuZXcgUGx5cihcIi5wbGF5ZXJGdWxsVG95c1wiKTtcclxuLy8gZXhwb3J0IGNvbnN0IHBsYXllclJldjEgPSBuZXcgUGx5cihcIi5wbGF5ZXItcmV3LTFcIik7XHJcbi8vIGV4cG9ydCBjb25zdCBwbGF5ZXJSZXYyID0gbmV3IFBseXIoXCIucGxheWVyLXJldy0yXCIpO1xyXG4vLyBleHBvcnQgY29uc3QgcGxheWVyUmV2MyA9IG5ldyBQbHlyKFwiLnBsYXllci1yZXctM1wiKTtcclxuLy8gZXhwb3J0IGNvbnN0IHBsYXllclJldjQgPSBuZXcgUGx5cihcIi5wbGF5ZXItcmV3LTRcIik7XHJcblxyXG4iLCJcInVzZSBjdHJpY3RcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBHYWwgPSAoaXRlbSkgPT4ge1xyXG4gIHZhciBzMiA9IG5ldyBTd2lwZXIoXCIuczJzd2lwZXJcIiwge1xyXG4gICAgc3BlZWQ6IDMwMCxcclxuICAgIGNlbnRlcmVkU2xpZGVzOiB0cnVlLFxyXG4gICAgc3BhY2VCZXR3ZWVuOiAxMSxcclxuICAgIGVmZmVjdDogXCJjb3ZlcmZsb3dcIixcclxuICAgIGNvdmVyZmxvd0VmZmVjdDoge1xyXG4gICAgICByb3RhdGU6IDAsXHJcbiAgICAgIHN0cmV0Y2g6IDAsXHJcbiAgICAgIGRlcHRoOiAwLFxyXG4gICAgICAvLyBtb2RpZmllcjogMSxcclxuICAgICAgLy8gc2xpZGVTaGFkb3dzOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIG5hdmlnYXRpb246IHtcclxuICAgICAgcHJldkVsOiBcIi5zMi1wcmV2XCIsXHJcbiAgICAgIG5leHRFbDogXCIuczItbmV4dFwiLFxyXG4gICAgfSxcclxuICAgIC8vIHNsaWRlc1BlclZpZXc6IFwiYXV0b1wiLFxyXG4gICAgLy8gaW5pdDogZmFsc2UsXHJcbiAgICBsb29wOiB0cnVlLFxyXG4gICAgLy8gc2xpZGVzUGVyR3JvdXA6IDMsXHJcbiAgICBzbGlkZXNQZXJWaWV3OiBcImF1dG9cIixcclxuICAgIHNsaWRlVG9DbGlja2VkU2xpZGU6ICd0cnVlJyxcclxuICAgIGdyYWJDdXJzb3I6IHRydWUsXHJcblxyXG4gIH0pO1xyXG5cclxuICBsZXQgdGVtcDtcclxuXHJcbiAgaWYgKHMyKSB7XHJcbiAgICBzMi5vbihcImJlZm9yZVRyYW5zaXRpb25TdGFydFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIC8vIHMyLm9uKFwic2xpZGVDaGFuZ2VUcmFuc2l0aW9uU3RhcnRcIiwgZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgY29uc3QgaGVhZCA9IFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnMyICAuc3dpcGVyLXNsaWRlXCIpXSxcclxuICAgICAgICBzMUl0ZW1zID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuczEgIC5zbGlkZVwiKV07XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgczFJdGVtcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgIGlmIChzMUl0ZW1zW2ldLmNsYXNzTGlzdC5jb250YWlucyhcIl9pcy1zdGFydFwiKSkge1xyXG4gICAgICAgICAgczFJdGVtc1tpXS5jbGFzc0xpc3QucmVtb3ZlKFwiX2lzLXN0YXJ0XCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHMxSXRlbXNbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKFwiX2lzLWFjdGl2ZVwiKSkge1xyXG4gICAgICAgICAgczFJdGVtc1tpXS5jbGFzc0xpc3QucmVtb3ZlKFwiX2lzLWFjdGl2ZVwiKTtcclxuICAgICAgICAgIHMxSXRlbXNbaV0uY2xhc3NMaXN0LmFkZChcIl9ub3QtYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhlYWQubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgIGlmIChoZWFkW2ldLmNsYXNzTGlzdC5jb250YWlucyhcInN3aXBlci1zbGlkZS1hY3RpdmVcIikpIHtcclxuICAgICAgICAgICAgdGVtcCA9IGhlYWRbaV0uZ2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiKTtcclxuICAgICAgICAgICAgczFJdGVtc1t0ZW1wXS5jbGFzc0xpc3QucmVtb3ZlKFwiX25vdC1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIHMxSXRlbXNbdGVtcF0uY2xhc3NMaXN0LmFkZChcIl9pcy1hY3RpdmVcIik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCAxMCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn07XHJcbiIsIlwidXNlIGN0cmljdFwiO1xuXG5leHBvcnQgY29uc3QgSGVhZGVycyA9ICgpID0+IHtcbiAgLy8gY29uc3QgYnVyZ2VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFkZXJfX2J1cmdlclwiKTtcbiAgLy8gY29uc3QgbWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVudVwiKTtcbiAgLy8gY29uc3QgaW5mbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cbiAgLy8gYnVyZ2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgLy8gICBtZW51LmNsYXNzTGlzdC5hZGQoXCJtZW51LWFjdGl2ZVwiKTtcbiAgLy8gICBpbmZvLmNsYXNzTGlzdC5hZGQoXCJoZWFkZXJfX2luZm9cIiwgXCJpbmZvXCIpO1xuICAvLyAgIGluZm8uaW5uZXJIVE1MID1cbiAgLy8gICAgIFwiPGEgY2xhc3M9J2luZm9fX3Bob25lJyBocmVmPScjISc+KzcoMDAwKSAxMjMgNDUgNjU8L2E+PGZvcm0gY2xhc3M9J2luZm9fX3NlYXJjaCAnPjxpbnB1dCB0eXBlPSd0ZXh0JyBwbGFjZWhvbGRlcj0n0J/QvtC40YHQuicgLz48c3ZnPiA8dXNlIHhsaW5rOmhyZWY9JyNzZWFyY2gnPjwvdXNlPjwvc3ZnPjxpbnB1dCB0eXBlPSdzdWJtaXQnLz48L2Zvcm0+XCI7XG4gIC8vICAgbWVudS5hcHBlbmQoaW5mbyk7XG4gIC8vICAgZnVuY3Rpb24gYWN0aXZlSW5mbygpIHtcbiAgLy8gICAgIGluZm8uY2xhc3NMaXN0LmFkZChcImluZm8tYWN0aXZlXCIpO1xuICAvLyAgIH1cbiAgLy8gICBzZXRUaW1lb3V0KGFjdGl2ZUluZm8sIDIwMCk7XG4gIC8vICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJvZHlcIikuY2xhc3NMaXN0LmFkZChcImxvY2tcIik7XG4gIC8vIH0pO1xuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gZG9jdW1lbnRcbiAgLy8gICAucXVlcnlTZWxlY3RvcihcIi5oZWFkZXJfX2Nsb3NlXCIpXG4gIC8vICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgLy8gICAgIG1lbnUuY2xhc3NMaXN0LnJlbW92ZShcIm1lbnUtYWN0aXZlXCIpO1xuICAvLyAgICAgbWVudS5xdWVyeVNlbGVjdG9yKFwiLmluZm9cIikucmVtb3ZlKCk7XG4gIC8vICAgICBpbmZvLmNsYXNzTGlzdC5yZW1vdmUoXCJpbmZvLWFjdGl2ZVwiKTtcbiAgLy8gICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJib2R5XCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJsb2NrXCIpO1xuICAvLyAgIH0pO1xuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgaWYgKHdpbmRvdy5wYWdlWU9mZnNldCA+IDEwMCkge1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kb3BfaGVhZGVyXCIpLmNsYXNzTGlzdC5hZGQoXCJyZXNwb25jaXZlSGVhZGVyXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRvcF9oZWFkZXJcIikuY2xhc3NMaXN0LnJlbW92ZShcInJlc3BvbmNpdmVIZWFkZXJcIik7XG4gICAgfVxuICB9KTtcblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgd2luZG93Lm9ucmVzaXplID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSA5OTkpIHtcbiAgICAgIGlmIChtZW51LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhZGVyX19pbmZvXCIpKSB7XG4gICAgICAgIG1lbnUucXVlcnlTZWxlY3RvcihcIi5oZWFkZXJfX2luZm9cIikucmVtb3ZlKCk7XG4gICAgICB9XG5cbiAgICAgIG1lbnUuY2xhc3NMaXN0LnJlbW92ZShcIm1lbnUtYWN0aXZlXCIpO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbmZvXCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJpbmZvLWFjdGl2ZVwiKTtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJib2R5XCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJsb2NrXCIpO1xuICAgIH1cbiAgfTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxufTtcblxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5pbXBvcnQgUGx5ciBmcm9tIFwicGx5clwiO1xuaW1wb3J0IHsgYm9keSB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuXG5leHBvcnQgY29uc3QgUG9wdXBzID0gKCkgPT4ge1xuICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtanNcIiksXG4gICAgY29udGVudHMgPSBwb3B1cC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19jb250ZW50XCIpLFxuICAgIFBsZWVycyA9IFtdO1xuXG4gIGxldCB0ZW1wb3IgPSBbLi4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5zbGlkZXItdmlkZW9cIildO1xuXG4gIHRlbXBvci5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgbGV0IGlkID0gY2VsbC5nZXRBdHRyaWJ1dGUoXCJpZFwiKTtcbiAgICBpZiAoaWQpIHtcbiAgICAgIGxldCByID0gYCMke2lkfWA7XG4gICAgICBjb25zdCBlID0gbmV3IFBseXIocik7XG4gICAgICBQbGVlcnMucHVzaCh7IGlkOiBpZCwgZTogZSB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0O1xuICAgIC8vICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICBjb25zdCBvcGVuUG9wID0gKCkgPT4ge1xuICAgICAgY29uc3QgaW5pdFRhcmdldCA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgIHRhcmdldC5jbG9zZXN0KFwiLnBvcHVwcy1pbml0LWpzXCIpLmdldEF0dHJpYnV0ZShcInJlbFwiKVxuICAgICAgKTtcblxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJfbm90LWFjdGl2ZVwiKTtcbiAgICAgICAgcG9wdXAuY2xhc3NMaXN0LmFkZChcIl9pcy1hY3RpdmVcIik7XG5cbiAgICAgICAgY29udGVudHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgICAgICAgIGlmIChjZWxsID09IGluaXRUYXJnZXQpIHtcbiAgICAgICAgICAgIGluaXRUYXJnZXQuc3R5bGUuZGlzcGxheSA9IFwiZ3JpZFwiO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjZWxsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSwgMjAwKTtcblxuICAgICAgbGV0IGxpbmtQbHlyID0gaW5pdFRhcmdldC5xdWVyeVNlbGVjdG9yKFwidmlkZW9cIikuZ2V0QXR0cmlidXRlKFwiaWRcIik7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGVtcG9yLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGlmIChQbGVlcnNbaV0uaWQgPT09IGxpbmtQbHlyKSB7XG4gICAgICAgICAgUGxlZXJzW2ldLmUucGxheSgpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGJvZHkuc3R5bGUuY3NzVGV4dCA9IFwib3ZlcmZsb3c6IGhpZGRlblwiO1xuICAgIH07XG4gICAgLy8gICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIGNvbnN0IGNsb3NlUG9wID0gKCkgPT4ge1xuICAgICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIl9pcy1hY3RpdmVcIik7XG4gICAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKFwiX25vdC1hY3RpdmVcIik7XG5cbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIGNvbnRlbnRzLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAgICAgICBjZWxsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgfSk7XG4gICAgICB9LCAzMDApO1xuXG4gICAgICBib2R5LnN0eWxlLmNzc1RleHQgPSBcIm92ZXJmbG93OiB2aXNpYmxlXCI7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IFBsZWVycy5sZW5ndGg7ICsraSkge1xuICAgICAgICBQbGVlcnNbaV0uZS5zdG9wKCk7XG4gICAgICB9XG4gICAgfTtcbiAgICAvLyAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICBpZiAoXG4gICAgICB0YXJnZXQuY2xvc2VzdChcIi5wb3B1cHMtaW5pdC1qc1wiKVxuICAgICAgLy8gICYmXG4gICAgICAvLyB0YXJnZXQuY2xvc2VzdChcIi5zbGlkZXJfX2l0ZW1cIikuY2xhc3NMaXN0LmNvbnRhaW5zKFwic3dpcGVyLXNsaWRlLWFjdGl2ZVwiKVxuICAgICkge1xuICAgICAgb3BlblBvcCgpO1xuICAgIH0gZWxzZSBpZiAoXG4gICAgICB0YXJnZXQubWF0Y2hlcyhcIi5wb3B1cC1vdmVybGF5LWpzXCIpIHx8XG4gICAgICB0YXJnZXQuY2xvc2VzdChcIi5wb3B1cC1jbG9zZS1qc1wiKVxuICAgICkge1xuICAgICAgY2xvc2VQb3AoKTtcbiAgICB9XG4gIH0pO1xufTtcbiIsIlwidXNlIGN0cmljdFwiO1xyXG5cclxuLy8gZXhwb3J0IGNvbnN0IFN3aXBlcjEgPSAoKSA9PiB7XHJcbi8vICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc2xpZGVyLWpzLTFcIikpIHtcclxuZXhwb3J0IGNvbnN0IERvdWJsZSA9ICgpPT57XHJcblxyXG5cclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCBEb3VibGVUb3AgPSBuZXcgU3dpcGVyKFwiLnNsaWRlci1kb3VibGUxLWpzXCIsIHtcclxuICAgICAgbG9vcDogXCJ0cnVlXCIsXHJcbiAgICAgIHNwZWVkOiA1MDAsXHJcblxyXG4gICAgICAvLyBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgIC8vICAgbmV4dEVsOiBcIi5qcy1kb3VibGUxLW5leHRcIixcclxuICAgICAgLy8gICBwcmV2RWw6IFwiLmpzLWRvdWJsZTEtcHJldlwiLFxyXG4gICAgICAvLyB9LFxyXG4gICAgICBzbGlkZXNQZXJWaWV3OiBcImF1dG9cIixcclxuICAgICAgLy8gZWZmZWN0OiBcImZhZGVcIixcclxuICAgICAgZ3JhYkN1cnNvcjogdHJ1ZSxcclxuICAgICAgdGh1bWJzOiB7XHJcbiAgICAgICAgc3dpcGVyOiBEb3VibGVCb3R0b20sXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIGNvbnN0IERvdWJsZUJvdHRvbSA9IG5ldyBTd2lwZXIoXCIuc2xpZGVyLWRvdWJsZTItanNcIiwge1xyXG4gICAgICBzbGlkZXNQZXJWaWV3OiBcImF1dG9cIixcclxuICAgICAgc2xpZGVUb0NsaWNrZWRTbGlkZTogXCJ0cnVlXCIsXHJcbiAgICAgIHNwYWNlQmV0d2VlbjogMTAsXHJcbiAgICAgIGxvb3A6IFwidHJ1ZVwiLFxyXG4gICAgICBzcGVlZDogNTAwLFxyXG4gICAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgICAgbmV4dEVsOiBcIi5qcy1kb3VibGUyLW5leHRcIixcclxuICAgICAgICBwcmV2RWw6IFwiLmpzLWRvdWJsZTItcHJldlwiLFxyXG4gICAgICB9LFxyXG4gICAgICBncmFiQ3Vyc29yOiB0cnVlLFxyXG4gICAgICB3YXRjaFNsaWRlc1Byb2dyZXNzOiB0cnVlLFxyXG4gICAgICAgY2VudGVyZWRTbGlkZXM6IHRydWUsXHJcblxyXG4gICAgICAvLyAgZWZmZWN0OiBcImZhZGVcIixcclxuICAgICAgLy8gIGZhZGVFZmZlY3Q6IHtcclxuICAgICAgLy8gICAgY3Jvc3NGYWRlOiB0cnVlLFxyXG4gICAgICAvLyAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIERvdWJsZVRvcC5jb250cm9sbGVyLmNvbnRyb2wgPSBEb3VibGVCb3R0b207XHJcbiAgICBEb3VibGVCb3R0b20uY29udHJvbGxlci5jb250cm9sID0gRG91YmxlVG9wO1xyXG4gIH0pO1xyXG59XHJcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG5cdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuXHRcdGZ1bmN0aW9uKCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuXHRcdGZ1bmN0aW9uKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCB7IGE6IGdldHRlciB9KTtcblx0cmV0dXJuIGdldHRlcjtcbn07IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgZGVmaW5pdGlvbikge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmcgPSAoZnVuY3Rpb24oKSB7XG5cdGlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcpIHJldHVybiBnbG9iYWxUaGlzO1xuXHR0cnkge1xuXHRcdHJldHVybiB0aGlzIHx8IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSByZXR1cm4gd2luZG93O1xuXHR9XG59KSgpOyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iaiwgcHJvcCkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7IH0iLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsIi8vIGltcG9ydCBheGlvcyBmcm9tIFwiYXhpb3NcIjtcclxuaW1wb3J0IHsgQW5pbSB9IGZyb20gXCIuL2Fzc2V0cy9qcy9hbmltYXRpb25cIjtcclxuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSBcIi4vYXNzZXRzL2pzL2J1dHRvblwiO1xyXG5pbXBvcnQgeyBIZWFkZXJzIH0gZnJvbSBcIi4vYXNzZXRzL2pzL2hlYWRlclwiO1xyXG5pbXBvcnQgeyBTd2lwZXJzIH0gZnJvbSBcIi4vYXNzZXRzL2pzL015U3dpcGVyXCI7XHJcbmltcG9ydCB7IFBvcHVwcyB9IGZyb20gXCIuL2Fzc2V0cy9qcy9wb3B1cFwiO1xyXG5pbXBvcnQgeyBHYWwgfSBmcm9tIFwiLi9hc3NldHMvanMvZ2FsU3dpcGVyXCI7XHJcbmltcG9ydCB7IERvdWJsZSB9IGZyb20gXCIuL2Fzc2V0cy9qcy9zZG91YmxlXCI7XHJcbmltcG9ydCB7XHJcbiAgd2F2ZXMsXHJcbiAgcG9wdXBzSW5pdCxcclxuICBoZWFkZXIsXHJcbiAgdG95c1BseXIsXHJcbiAgLy8gcGxheWVyMSxcclxuICAvLyBwbGF5ZXJSZXYxLFxyXG59IGZyb20gXCIuL2Fzc2V0cy9qcy9jb25zdGFudHMuanNcIjtcclxuXHJcbi8vIC0tLS0tLS0tc3R5bGVzLS0tLS0tLS0tLS0tLVxyXG5pbXBvcnQgXCIuL2Fzc2V0cy9zY3NzL2FwcC5zY3NzXCI7XHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuQW5pbSgpO1xyXG5Td2lwZXJzKCk7XHJcbkdhbCgpO1xyXG5Eb3VibGUoKTtcclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24gKCkge1xyXG4gIGlmIChwb3B1cHNJbml0Lmxlbmd0aCA+IDApIHtcclxuICAgIFBvcHVwcygpO1xyXG4gIH1cclxuXHJcbiAgaWYgKGhlYWRlcikge1xyXG4gICAgSGVhZGVycygpO1xyXG4gIH1cclxuXHJcbiAgd2F2ZXMuZm9yRWFjaCgoY2VsbCkgPT4ge1xyXG4gICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgQnV0dG9uKTtcclxuICB9KTtcclxuXHJcbiAgY29uc3QgcGx5clBsYXkgPSAoKSA9PiB7XHJcbiAgICAvLyBsZXQgcGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRveXMgLnBseXJfX2NvbnRyb2xzXCIpO1xyXG4gICAgaWYgKHBsYXllckZ1bGxUb3lzKSB7XHJcbiAgICAgIGxldCB0ZXJ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXJGdWxsVG95c1wiKSxcclxuICAgICAgICBzaGVhcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG95c19fdmlkZW8gLnRveXNfX3NoZWFwXCIpO1xyXG5cclxuICAgICAgc2hlYXAuaW5uZXJIVE1MID0gXCIwOjAwXCI7XHJcbiAgICAgIHRlcnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgICAgLy8gcGwuY2xhc3NMaXN0LmFkZChcIl9pcy1hY3RpdmVcIik7XHJcbiAgICAgICAgbGV0IHRyID0gcGxheWVyRnVsbFRveXMuY3VycmVudFRpbWUudG9GaXhlZCgyKTtcclxuICAgICAgICB0ciA9IHRyLnJlcGxhY2UoXCIuXCIsIFwiOlwiKTtcclxuICAgICAgICBzaGVhcC5pbm5lckhUTUwgPSB0cjtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcGx5clBsYXkoKTtcclxuXHJcbn0pO1xyXG4iXSwibmFtZXMiOlsibmF2aWdhdG9yIiwibW9kdWxlIiwiZXhwb3J0cyIsIl9kZWZpbmVQcm9wZXJ0eSQxIiwib2JqIiwia2V5IiwidmFsdWUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsIl9kZWZpbmVQcm9wZXJ0aWVzIiwiZSIsInQiLCJuIiwibGVuZ3RoIiwiciIsIl9kZWZpbmVQcm9wZXJ0eSIsIm93bktleXMiLCJrZXlzIiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwiZmlsdGVyIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwicHVzaCIsImFwcGx5IiwiX29iamVjdFNwcmVhZDIiLCJhcmd1bWVudHMiLCJmb3JFYWNoIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyIsImRlZmluZVByb3BlcnRpZXMiLCJkZWZhdWx0cyIsImFkZENTUyIsInRodW1iV2lkdGgiLCJ3YXRjaCIsIm1hdGNoZXMiLCJBcnJheSIsImZyb20iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbmNsdWRlcyIsInRoaXMiLCJjYWxsIiwiZ2V0Q29uc3RydWN0b3IiLCJjb25zdHJ1Y3RvciIsImluc3RhbmNlT2YiLCJpc1N0cmluZyIsIlN0cmluZyIsImlzQXJyYXkiLCJpc05vZGVMaXN0IiwiTm9kZUxpc3QiLCJpcyIsIkVsZW1lbnQiLCJFdmVudCIsImlzTnVsbE9yVW5kZWZpbmVkIiwiaXNPYmplY3QiLCJSYW5nZVRvdWNoIiwiVHlwZUVycm9yIiwiZWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJyYW5nZVRvdWNoIiwiY29uZmlnIiwiaW5pdCIsInByb3RvdHlwZSIsIl9jcmVhdGVDbGFzcyIsImVuYWJsZWQiLCJzdHlsZSIsInVzZXJTZWxlY3QiLCJ3ZWJLaXRVc2VyU2VsZWN0IiwidG91Y2hBY3Rpb24iLCJsaXN0ZW5lcnMiLCJzZXQiLCJ0YXJnZXQiLCJpIiwiY2hhbmdlZFRvdWNoZXMiLCJvIiwicGFyc2VGbG9hdCIsImdldEF0dHJpYnV0ZSIsInMiLCJ1IiwiYyIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImEiLCJ3aWR0aCIsImNsaWVudFgiLCJsZWZ0IiwiY29uY2F0IiwibWF0Y2giLCJNYXRoIiwibWF4IiwiZ2V0RGVjaW1hbFBsYWNlcyIsInRvRml4ZWQiLCJyb3VuZCIsImRpc2FibGVkIiwicHJldmVudERlZmF1bHQiLCJnZXQiLCJidWJibGVzIiwiZGlzcGF0Y2hFdmVudCIsInRyaWdnZXIiLCJ0eXBlIiwiTXV0YXRpb25PYnNlcnZlciIsImFkZGVkTm9kZXMiLCJvYnNlcnZlIiwiYm9keSIsImNoaWxkTGlzdCIsInN1YnRyZWUiLCJtYXAiLCJkb2N1bWVudEVsZW1lbnQiLCJpbnB1dCIsIkJvb2xlYW4iLCJpc0Z1bmN0aW9uIiwiRnVuY3Rpb24iLCJpc0VtcHR5IiwiTnVtYmVyIiwiaXNOYU4iLCJub2RlVHlwZSIsIm93bmVyRG9jdW1lbnQiLCJLZXlib2FyZEV2ZW50IiwiVGV4dFRyYWNrIiwia2luZCIsIndpbmRvdyIsIlVSTCIsInN0cmluZyIsInN0YXJ0c1dpdGgiLCJob3N0bmFtZSIsIl8iLCJ0cmFuc2l0aW9uRW5kRXZlbnQiLCJjcmVhdGVFbGVtZW50IiwiZXZlbnRzIiwiV2Via2l0VHJhbnNpdGlvbiIsIk1velRyYW5zaXRpb24iLCJPVHJhbnNpdGlvbiIsInRyYW5zaXRpb24iLCJmaW5kIiwiZXZlbnQiLCJyZXBhaW50IiwiZGVsYXkiLCJzZXRUaW1lb3V0IiwiaGlkZGVuIiwib2Zmc2V0SGVpZ2h0IiwiYnJvd3NlciIsImlzSUUiLCJkb2N1bWVudE1vZGUiLCJpc0VkZ2UiLCJ1c2VyQWdlbnQiLCJpc1dlYmtpdCIsInRlc3QiLCJpc0lQaG9uZSIsInBsYXRmb3JtIiwiaXNJb3MiLCJtYXhUb3VjaFBvaW50cyIsImdldERlZXAiLCJvYmplY3QiLCJwYXRoIiwic3BsaXQiLCJyZWR1Y2UiLCJleHRlbmQiLCJzb3VyY2VzIiwic291cmNlIiwic2hpZnQiLCJhc3NpZ24iLCJ3cmFwIiwiZWxlbWVudHMiLCJ3cmFwcGVyIiwidGFyZ2V0cyIsInJldmVyc2UiLCJpbmRleCIsImNoaWxkIiwiY2xvbmVOb2RlIiwicGFyZW50IiwicGFyZW50Tm9kZSIsInNpYmxpbmciLCJuZXh0U2libGluZyIsImFwcGVuZENoaWxkIiwiaW5zZXJ0QmVmb3JlIiwic2V0QXR0cmlidXRlcyIsImF0dHJpYnV0ZXMiLCJlbnRyaWVzIiwic2V0QXR0cmlidXRlIiwidGV4dCIsImlubmVyVGV4dCIsImluc2VydEVsZW1lbnQiLCJyZW1vdmVFbGVtZW50IiwicmVtb3ZlQ2hpbGQiLCJlbXB0eUVsZW1lbnQiLCJjaGlsZE5vZGVzIiwibGFzdENoaWxkIiwicmVwbGFjZUVsZW1lbnQiLCJuZXdDaGlsZCIsIm9sZENoaWxkIiwicmVwbGFjZUNoaWxkIiwiZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3RvciIsInNlbCIsImV4aXN0aW5nQXR0cmlidXRlcyIsImV4aXN0aW5nIiwic2VsZWN0b3IiLCJ0cmltIiwiY2xhc3NOYW1lIiwicmVwbGFjZSIsInBhcnRzIiwiY2hhckF0IiwiY2xhc3MiLCJpZCIsInRvZ2dsZUhpZGRlbiIsImhpZGUiLCJ0b2dnbGVDbGFzcyIsImZvcmNlIiwibWV0aG9kIiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJoYXNDbGFzcyIsIndlYmtpdE1hdGNoZXNTZWxlY3RvciIsIm1vek1hdGNoZXNTZWxlY3RvciIsIm1zTWF0Y2hlc1NlbGVjdG9yIiwiZ2V0RWxlbWVudHMiLCJjb250YWluZXIiLCJnZXRFbGVtZW50Iiwic2V0Rm9jdXMiLCJ0YWJGb2N1cyIsImZvY3VzIiwicHJldmVudFNjcm9sbCIsImNsYXNzTmFtZXMiLCJkZWZhdWx0Q29kZWNzIiwic3VwcG9ydCIsImF1ZGlvIiwidmlkZW8iLCJjaGVjayIsInByb3ZpZGVyIiwicGxheXNpbmxpbmUiLCJjYW5QbGF5SW5saW5lIiwiYXBpIiwidWkiLCJyYW5nZUlucHV0IiwicGlwIiwid2Via2l0U2V0UHJlc2VudGF0aW9uTW9kZSIsInBpY3R1cmVJblBpY3R1cmVFbmFibGVkIiwiZGlzYWJsZVBpY3R1cmVJblBpY3R1cmUiLCJhaXJwbGF5IiwiV2ViS2l0UGxheWJhY2tUYXJnZXRBdmFpbGFiaWxpdHlFdmVudCIsIm1pbWUiLCJtZWRpYVR5cGUiLCJpc0hUTUw1IiwibWVkaWEiLCJjYW5QbGF5VHlwZSIsInRleHRUcmFja3MiLCJyYW5nZSIsInRvdWNoIiwidHJhbnNpdGlvbnMiLCJyZWR1Y2VkTW90aW9uIiwibWF0Y2hNZWRpYSIsInN1cHBvcnRzUGFzc2l2ZUxpc3RlbmVycyIsInN1cHBvcnRlZCIsIm9wdGlvbnMiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInRvZ2dsZUxpc3RlbmVyIiwiY2FsbGJhY2siLCJ0b2dnbGUiLCJwYXNzaXZlIiwiY2FwdHVyZSIsImV2ZW50TGlzdGVuZXJzIiwib24iLCJvZmYiLCJvbmNlIiwib25jZUNhbGxiYWNrIiwiYXJncyIsInRyaWdnZXJFdmVudCIsImRldGFpbCIsIkN1c3RvbUV2ZW50IiwicGx5ciIsInVuYmluZExpc3RlbmVycyIsIml0ZW0iLCJyZWFkeSIsIlByb21pc2UiLCJyZXNvbHZlIiwidGhlbiIsInNpbGVuY2VQcm9taXNlIiwiZGVkdXBlIiwiYXJyYXkiLCJpbmRleE9mIiwiY2xvc2VzdCIsInByZXYiLCJjdXJyIiwiYWJzIiwic3VwcG9ydHNDU1MiLCJkZWNsYXJhdGlvbiIsIkNTUyIsInN1cHBvcnRzIiwic3RhbmRhcmRSYXRpb3MiLCJvdXQiLCJ4IiwieSIsInZhbGlkYXRlQXNwZWN0UmF0aW8iLCJldmVyeSIsInJlZHVjZUFzcGVjdFJhdGlvIiwicmF0aW8iLCJoZWlnaHQiLCJkaXZpZGVyIiwiZ2V0RGl2aWRlciIsInciLCJoIiwiZ2V0QXNwZWN0UmF0aW8iLCJwYXJzZSIsImVtYmVkIiwic2V0QXNwZWN0UmF0aW8iLCJpc1ZpZGVvIiwicGFkZGluZyIsImFzcGVjdFJhdGlvIiwicGFkZGluZ0JvdHRvbSIsImlzVmltZW8iLCJ2aW1lbyIsInByZW1pdW0iLCJvZmZzZXRXaWR0aCIsInBhcnNlSW50IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsIm9mZnNldCIsImZ1bGxzY3JlZW4iLCJhY3RpdmUiLCJ0cmFuc2Zvcm0iLCJhZGQiLCJ2aWRlb0ZpeGVkUmF0aW8iLCJyb3VuZEFzcGVjdFJhdGlvIiwidG9sZXJhbmNlIiwiY2xvc2VzdFJhdGlvIiwiaHRtbDUiLCJnZXRTb3VyY2VzIiwiZ2V0UXVhbGl0eU9wdGlvbnMiLCJxdWFsaXR5IiwiZm9yY2VkIiwic2V0dXAiLCJwbGF5ZXIiLCJzcGVlZCIsIm9uQ2hhbmdlIiwiY3VycmVudFRpbWUiLCJwYXVzZWQiLCJwcmVsb2FkIiwicmVhZHlTdGF0ZSIsInBsYXliYWNrUmF0ZSIsInNyYyIsInBsYXkiLCJsb2FkIiwiY2FuY2VsUmVxdWVzdHMiLCJibGFua1ZpZGVvIiwiZGVidWciLCJsb2ciLCJmb3JtYXQiLCJ0b1N0cmluZyIsInJlcGxhY2VBbGwiLCJSZWdFeHAiLCJ0b1RpdGxlQ2FzZSIsInRvVXBwZXJDYXNlIiwic2xpY2UiLCJ0b0xvd2VyQ2FzZSIsImdldEhUTUwiLCJpbm5lckhUTUwiLCJyZXNvdXJjZXMiLCJ5b3V0dWJlIiwiaTE4biIsInNlZWtUaW1lIiwidGl0bGUiLCJ2IiwiayIsIlN0b3JhZ2UiLCJzdG9yZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJqc29uIiwiSlNPTiIsInN0b3JhZ2UiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwicmVtb3ZlSXRlbSIsImZldGNoIiwidXJsIiwicmVzcG9uc2VUeXBlIiwicmVqZWN0IiwicmVxdWVzdCIsIlhNTEh0dHBSZXF1ZXN0IiwicmVzcG9uc2VUZXh0IiwicmVzcG9uc2UiLCJFcnJvciIsInN0YXR1cyIsIm9wZW4iLCJzZW5kIiwiZXJyb3IiLCJsb2FkU3ByaXRlIiwicHJlZml4IiwiaGFzSWQiLCJleGlzdHMiLCJnZXRFbGVtZW50QnlJZCIsInVwZGF0ZSIsImRhdGEiLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJ1c2VTdG9yYWdlIiwiY2FjaGVkIiwiY29udGVudCIsInJlc3VsdCIsImNhdGNoIiwiZ2V0SG91cnMiLCJ0cnVuYyIsImZvcm1hdFRpbWUiLCJ0aW1lIiwiZGlzcGxheUhvdXJzIiwiaW52ZXJ0ZWQiLCJob3VycyIsIm1pbnMiLCJzZWNzIiwiY29udHJvbHMiLCJnZXRJY29uVXJsIiwiaWNvblVybCIsImxvY2F0aW9uIiwiaG9zdCIsInRvcCIsImNvcnMiLCJzdmc0ZXZlcnlib2R5IiwiZmluZEVsZW1lbnRzIiwic2VsZWN0b3JzIiwiYnV0dG9ucyIsInBhdXNlIiwicmVzdGFydCIsInJld2luZCIsImZhc3RGb3J3YXJkIiwibXV0ZSIsInNldHRpbmdzIiwiY2FwdGlvbnMiLCJwcm9ncmVzcyIsImlucHV0cyIsInNlZWsiLCJ2b2x1bWUiLCJkaXNwbGF5IiwiYnVmZmVyIiwiZHVyYXRpb24iLCJzZWVrVG9vbHRpcCIsInRvb2x0aXAiLCJ3YXJuIiwidG9nZ2xlTmF0aXZlQ29udHJvbHMiLCJjcmVhdGVJY29uIiwibmFtZXNwYWNlIiwiaWNvblBhdGgiLCJpY29uUHJlZml4IiwiaWNvbiIsImNyZWF0ZUVsZW1lbnROUyIsImZvY3VzYWJsZSIsInVzZSIsInNldEF0dHJpYnV0ZU5TIiwiY3JlYXRlTGFiZWwiLCJhdHRyIiwiam9pbiIsImNyZWF0ZUJhZGdlIiwiYmFkZ2UiLCJtZW51IiwiY3JlYXRlQnV0dG9uIiwiYnV0dG9uVHlwZSIsInRvUGFzY2FsQ2FzZSIsInRvQ2FtZWxDYXNlIiwicHJvcHMiLCJsYWJlbCIsImxhYmVsUHJlc3NlZCIsImljb25QcmVzc2VkIiwic29tZSIsImNvbnRyb2wiLCJidXR0b24iLCJjcmVhdGVSYW5nZSIsIm1pbiIsInN0ZXAiLCJhdXRvY29tcGxldGUiLCJyb2xlIiwidXBkYXRlUmFuZ2VGaWxsIiwiY3JlYXRlUHJvZ3Jlc3MiLCJzdWZmaXhLZXkiLCJwbGF5ZWQiLCJzdWZmaXgiLCJjcmVhdGVUaW1lIiwiYXR0cnMiLCJiaW5kTWVudUl0ZW1TaG9ydGN1dHMiLCJtZW51SXRlbSIsInN0b3BQcm9wYWdhdGlvbiIsImlzUmFkaW9CdXR0b24iLCJzaG93TWVudVBhbmVsIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwibGFzdEVsZW1lbnRDaGlsZCIsImZvY3VzRmlyc3RNZW51SXRlbSIsImNyZWF0ZU1lbnVJdGVtIiwibGlzdCIsImNoZWNrZWQiLCJmbGV4IiwiY2hpbGRyZW4iLCJub2RlIiwiYmluZCIsImN1cnJlbnRUcmFjayIsInVwZGF0ZVRpbWVEaXNwbGF5IiwidXBkYXRlVm9sdW1lIiwic2V0UmFuZ2UiLCJtdXRlZCIsInByZXNzZWQiLCJ1cGRhdGVQcm9ncmVzcyIsImN1cnJlbnQiLCJ2YWwiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsIm5vZGVWYWx1ZSIsInNldFByb2dyZXNzIiwiYnVmZmVyZWQiLCJwZXJjZW50Iiwic2V0UHJvcGVydHkiLCJ1cGRhdGVTZWVrVG9vbHRpcCIsInRvb2x0aXBzIiwidGlwRWxlbWVudCIsInZpc2libGUiLCJzaG93IiwiY2xpZW50UmVjdCIsInBhZ2VYIiwicG9pbnQiLCJfdGhpcyRjb25maWckbWFya2VycyIsIm1hcmtlcnMiLCJfdGhpcyRjb25maWckbWFya2VycyQiLCJwb2ludHMiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJ0aW1lVXBkYXRlIiwiaW52ZXJ0IiwiaW52ZXJ0VGltZSIsInNlZWtpbmciLCJkdXJhdGlvblVwZGF0ZSIsImhhc0R1cmF0aW9uIiwiZGlzcGxheUR1cmF0aW9uIiwic2V0TWFya2VycyIsInRvZ2dsZU1lbnVCdXR0b24iLCJzZXR0aW5nIiwidXBkYXRlU2V0dGluZyIsInBhbmUiLCJwYW5lbHMiLCJkZWZhdWx0IiwiZ2V0TGFiZWwiLCJzZXRRdWFsaXR5TWVudSIsImNoZWNrTWVudSIsImdldEJhZGdlIiwic29ydCIsImIiLCJzb3J0aW5nIiwic2V0Q2FwdGlvbnNNZW51IiwidHJhY2tzIiwiZ2V0VHJhY2tzIiwidHJhY2siLCJ0b2dnbGVkIiwibGFuZ3VhZ2UiLCJ1bnNoaWZ0Iiwic2V0U3BlZWRNZW51IiwibWluaW11bVNwZWVkIiwibWF4aW11bVNwZWVkIiwidmFsdWVzIiwicG9wdXAiLCJwIiwiZmlyc3RJdGVtIiwidG9nZ2xlTWVudSIsImNvbXBvc2VkUGF0aCIsImlzTWVudUl0ZW0iLCJnZXRNZW51U2l6ZSIsInRhYiIsImNsb25lIiwicG9zaXRpb24iLCJvcGFjaXR5IiwicmVtb3ZlQXR0cmlidXRlIiwic2Nyb2xsV2lkdGgiLCJzY3JvbGxIZWlnaHQiLCJzaXplIiwicmVzdG9yZSIsInByb3BlcnR5TmFtZSIsInNldERvd25sb2FkVXJsIiwiZG93bmxvYWQiLCJjcmVhdGUiLCJkZWZhdWx0QXR0cmlidXRlcyIsInByb2dyZXNzQ29udGFpbmVyIiwiaW5uZXIiLCJob21lIiwiYmFja0J1dHRvbiIsImhyZWYiLCJ1cmxzIiwiaXNFbWJlZCIsImluamVjdCIsImZsb29yIiwicmFuZG9tIiwic2Vla3RpbWUiLCJhZGRQcm9wZXJ0eSIsImNvbnRyb2xQcmVzc2VkIiwibGFiZWxzIiwic2V0TWVkaWFNZXRhZGF0YSIsIm1lZGlhU2Vzc2lvbiIsIm1ldGFkYXRhIiwiTWVkaWFNZXRhZGF0YSIsIm1lZGlhTWV0YWRhdGEiLCJhcnRpc3QiLCJhbGJ1bSIsImFydHdvcmsiLCJfdGhpcyRjb25maWckbWFya2VyczIiLCJfdGhpcyRjb25maWckbWFya2VyczMiLCJjb250YWluZXJGcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJwb2ludHNGcmFnbWVudCIsInRpcFZpc2libGUiLCJ0b2dnbGVUaXAiLCJtYXJrZXJFbGVtZW50IiwibWFya2VyIiwidGlwIiwicGFyc2VVcmwiLCJwYXJzZXIiLCJidWlsZFVybFBhcmFtcyIsInBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsImlzWW91VHViZSIsInByb3RvY29sIiwiYmxvYiIsImNyZWF0ZU9iamVjdFVSTCIsImxhbmd1YWdlcyIsInVzZXJMYW5ndWFnZSIsInRyYWNrRXZlbnRzIiwibWV0YSIsImN1cnJlbnRUcmFja05vZGUiLCJsYW5ndWFnZUV4aXN0cyIsIm1vZGUiLCJ1cGRhdGVDdWVzIiwic2V0TGFuZ3VhZ2UiLCJhY3RpdmVDbGFzcyIsImZpbmRUcmFjayIsImVuYWJsZVRleHRUcmFjayIsImhhcyIsInNvcnRJc0RlZmF1bHQiLCJzb3J0ZWQiLCJ1bmRlZmluZWQiLCJnZXRDdXJyZW50VHJhY2siLCJjdWVzIiwiYWN0aXZlQ3VlcyIsImN1ZSIsImdldEN1ZUFzSFRNTCIsImN1ZVRleHQiLCJjYXB0aW9uIiwiYXV0b3BsYXkiLCJhdXRvcGF1c2UiLCJ0b2dnbGVJbnZlcnQiLCJjbGlja1RvUGxheSIsImhpZGVDb250cm9scyIsInJlc2V0T25FbmQiLCJkaXNhYmxlQ29udGV4dE1lbnUiLCJsb29wIiwic2VsZWN0ZWQiLCJrZXlib2FyZCIsImZvY3VzZWQiLCJnbG9iYWwiLCJmYWxsYmFjayIsImlvc05hdGl2ZSIsInNlZWtMYWJlbCIsInVubXV0ZSIsImVuYWJsZUNhcHRpb25zIiwiZGlzYWJsZUNhcHRpb25zIiwiZW50ZXJGdWxsc2NyZWVuIiwiZXhpdEZ1bGxzY3JlZW4iLCJmcmFtZVRpdGxlIiwibWVudUJhY2siLCJub3JtYWwiLCJzdGFydCIsImVuZCIsImFsbCIsInJlc2V0IiwiYWR2ZXJ0aXNlbWVudCIsInF1YWxpdHlCYWRnZSIsInNkayIsImlmcmFtZSIsImdvb2dsZUlNQSIsImVkaXRhYmxlIiwiZW1iZWRDb250YWluZXIiLCJwb3N0ZXIiLCJwb3N0ZXJFbmFibGVkIiwiYWRzIiwicGxheWluZyIsInN0b3BwZWQiLCJsb2FkaW5nIiwiaG92ZXIiLCJpc1RvdWNoIiwidWlTdXBwb3J0ZWQiLCJub1RyYW5zaXRpb24iLCJwcmV2aWV3VGh1bWJuYWlscyIsInRodW1iQ29udGFpbmVyIiwidGh1bWJDb250YWluZXJTaG93biIsImltYWdlQ29udGFpbmVyIiwidGltZUNvbnRhaW5lciIsInNjcnViYmluZ0NvbnRhaW5lciIsInNjcnViYmluZ0NvbnRhaW5lclNob3duIiwiaGFzaCIsInB1Ymxpc2hlcklkIiwidGFnVXJsIiwiYnlsaW5lIiwicG9ydHJhaXQiLCJ0cmFuc3BhcmVudCIsImN1c3RvbUNvbnRyb2xzIiwicmVmZXJyZXJQb2xpY3kiLCJyZWwiLCJzaG93aW5mbyIsIml2X2xvYWRfcG9saWN5IiwibW9kZXN0YnJhbmRpbmciLCJub0Nvb2tpZSIsInByb3ZpZGVycyIsInR5cGVzIiwibm9vcCIsIkNvbnNvbGUiLCJjb25zb2xlIiwiRnVsbHNjcmVlbiIsInNjcm9sbFBvc2l0aW9uIiwic2Nyb2xsWCIsInNjcm9sbFkiLCJzY3JvbGxUbyIsIm92ZXJmbG93Iiwidmlld3BvcnQiLCJoZWFkIiwicHJvcGVydHkiLCJoYXNQcm9wZXJ0eSIsImNsZWFudXBWaWV3cG9ydCIsInBhcnQiLCJhY3RpdmVFbGVtZW50IiwiZmlyc3QiLCJsYXN0Iiwic2hpZnRLZXkiLCJmb3JjZUZhbGxiYWNrIiwibmF0aXZlIiwicmVxdWVzdEZ1bGxzY3JlZW4iLCJ3ZWJraXRFbnRlckZ1bGxzY3JlZW4iLCJ0b2dnbGVGYWxsYmFjayIsIm5hdmlnYXRpb25VSSIsIndlYmtpdEV4aXRGdWxsc2NyZWVuIiwiYWN0aW9uIiwiY2FuY2VsRnVsbFNjcmVlbiIsImV4aXQiLCJlbnRlciIsImVsIiwicGFyZW50RWxlbWVudCIsInByb3h5IiwidHJhcEZvY3VzIiwidXNpbmdOYXRpdmUiLCJnZXRSb290Tm9kZSIsImZ1bGxzY3JlZW5FbGVtZW50Iiwic2hhZG93Um9vdCIsImZ1bGxzY3JlZW5FbmFibGVkIiwid2Via2l0RnVsbHNjcmVlbkVuYWJsZWQiLCJtb3pGdWxsU2NyZWVuRW5hYmxlZCIsIm1zRnVsbHNjcmVlbkVuYWJsZWQiLCJwcmUiLCJsb2FkSW1hZ2UiLCJtaW5XaWR0aCIsImltYWdlIiwiSW1hZ2UiLCJoYW5kbGVyIiwib25sb2FkIiwib25lcnJvciIsIm5hdHVyYWxXaWR0aCIsImFkZFN0eWxlSG9vayIsImJ1aWxkIiwiY2hlY2tQbGF5aW5nIiwic2V0VGl0bGUiLCJzZXRQb3N0ZXIiLCJ0b2dnbGVQb3N0ZXIiLCJlbmFibGUiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJiYWNrZ3JvdW5kU2l6ZSIsInRvZ2dsZUNvbnRyb2xzIiwiY2hlY2tMb2FkaW5nIiwiY2xlYXJUaW1lb3V0IiwidGltZXJzIiwiY29udHJvbHNFbGVtZW50IiwicmVjZW50VG91Y2hTZWVrIiwibGFzdFNlZWtUaW1lIiwiRGF0ZSIsIm5vdyIsIm1pZ3JhdGVTdHlsZXMiLCJnZXRQcm9wZXJ0eVZhbHVlIiwicmVtb3ZlUHJvcGVydHkiLCJMaXN0ZW5lcnMiLCJ0aW1lU3RhbXAiLCJmb2N1c1RpbWVyIiwibGFzdEtleURvd24iLCJyZW1vdmVDdXJyZW50Iiwid2FzS2V5RG93biIsImhhbmRsZUtleSIsImZpcnN0VG91Y2giLCJzZXRUYWJGb2N1cyIsInNldEd1dHRlciIsInZpZGVvV2lkdGgiLCJ2aWRlb0hlaWdodCIsInVzZU5hdGl2ZUFzcGVjdFJhdGlvIiwiY2xpZW50V2lkdGgiLCJpbm5lcldpZHRoIiwiY2xpZW50SGVpZ2h0IiwiaW5uZXJIZWlnaHQiLCJ2aWV3cG9ydEhlaWdodCIsIm1heFdpZHRoIiwibWFyZ2luIiwicmVzaXplZCIsImlzQXVkaW8iLCJlbmRlZCIsInRvZ2dsZVBsYXkiLCJwcm94eUV2ZW50cyIsImRlZmF1bHRIYW5kbGVyIiwiY3VzdG9tSGFuZGxlcktleSIsImN1c3RvbUhhbmRsZXIiLCJyZXR1cm5lZCIsImhhc0N1c3RvbUhhbmRsZXIiLCJpbnB1dEV2ZW50IiwiZm9yd2FyZCIsInRvZ2dsZUNhcHRpb25zIiwicmVjdCIsImN1cnJlbnRUYXJnZXQiLCJhdHRyaWJ1dGUiLCJoYXNBdHRyaWJ1dGUiLCJkb25lIiwic2Vla1RvIiwibG9hZGVkIiwic3RhcnRNb3ZlIiwiZW5kTW92ZSIsInN0YXJ0U2NydWJiaW5nIiwiZW5kU2NydWJiaW5nIiwid2Via2l0RGlyZWN0aW9uSW52ZXJ0ZWRGcm9tRGV2aWNlIiwiZGVsdGFYIiwiZGVsdGFZIiwiZGlyZWN0aW9uIiwic2lnbiIsImluY3JlYXNlVm9sdW1lIiwibGFzdEtleSIsImluY3JlbWVudCIsImFsdEtleSIsImN0cmxLZXkiLCJtZXRhS2V5IiwicmVwZWF0IiwiZGVjcmVhc2VWb2x1bWUiLCJnbG9iYWxUaGlzIiwic2VsZiIsImxvYWRqc191bWQiLCJmbiIsImRldm51bGwiLCJidW5kbGVJZENhY2hlIiwiYnVuZGxlUmVzdWx0Q2FjaGUiLCJidW5kbGVDYWxsYmFja1F1ZXVlIiwic3Vic2NyaWJlIiwiYnVuZGxlSWRzIiwiY2FsbGJhY2tGbiIsImRlcHNOb3RGb3VuZCIsImJ1bmRsZUlkIiwibnVtV2FpdGluZyIsInBhdGhzTm90Rm91bmQiLCJwdWJsaXNoIiwicSIsInNwbGljZSIsImV4ZWN1dGVDYWxsYmFja3MiLCJzdWNjZXNzIiwibG9hZEZpbGUiLCJudW1UcmllcyIsImRvYyIsImlzTGVnYWN5SUVDc3MiLCJhc3luYyIsIm1heFRyaWVzIiwibnVtUmV0cmllcyIsImJlZm9yZUNhbGxiYWNrRm4iLCJiZWZvcmUiLCJwYXRobmFtZSIsInBhdGhTdHJpcHBlZCIsInJlbExpc3QiLCJhcyIsIm9uYmVmb3JlbG9hZCIsImV2Iiwic2hlZXQiLCJjc3NUZXh0IiwiY29kZSIsImRlZmF1bHRQcmV2ZW50ZWQiLCJsb2FkRmlsZXMiLCJwYXRocyIsImxvYWRqcyIsImFyZzEiLCJhcmcyIiwibG9hZEZuIiwicmV0dXJuUHJvbWlzZSIsImRlcHMiLCJpc0RlZmluZWQiLCJmYWN0b3J5IiwiY3JlYXRlQ29tbW9uanNNb2R1bGUiLCJsb2FkU2NyaXB0IiwiYXNzdXJlUGxheWJhY2tTdGF0ZSIsImhhc1BsYXllZCIsIlZpbWVvIiwiZnJhbWVQYXJhbXMiLCJyZWdleCIsImZvdW5kIiwicGFyc2VIYXNoIiwiaGFzaFBhcmFtIiwic2lkZWRvY2siLCJnZXN0dXJlIiwiJDIiLCJ0aHVtYm5haWxfdXJsIiwiUGxheWVyIiwiZGlzYWJsZVRleHRUcmFjayIsInN0b3AiLCJyZXN0b3JlUGF1c2UiLCJzZXRWb2x1bWUiLCJzZXRDdXJyZW50VGltZSIsInNldFBsYXliYWNrUmF0ZSIsImN1cnJlbnRTcmMiLCJzZXRMb29wIiwiZ2V0VmlkZW9VcmwiLCJnZXRWaWRlb1dpZHRoIiwiZ2V0VmlkZW9IZWlnaHQiLCJkaW1lbnNpb25zIiwic2V0QXV0b3BhdXNlIiwic3RhdGUiLCJnZXRWaWRlb1RpdGxlIiwiZ2V0Q3VycmVudFRpbWUiLCJnZXREdXJhdGlvbiIsImdldFRleHRUcmFja3MiLCJzdHJpcHBlZEN1ZXMiLCJmcmFnbWVudCIsImZpcnN0Q2hpbGQiLCJzdHJpcEhUTUwiLCJnZXRQYXVzZWQiLCJzZWNvbmRzIiwiZ2V0SG9zdCIsIllUIiwib25Zb3VUdWJlSWZyYW1lQVBJUmVhZHkiLCJnZXRUaXRsZSIsInZpZGVvSWQiLCJjdXJyZW50SWQiLCJwb3N0ZXJTcmMiLCJwbGF5ZXJWYXJzIiwiaGwiLCJkaXNhYmxla2IiLCJjY19sb2FkX3BvbGljeSIsImNjX2xhbmdfcHJlZiIsIndpZGdldF9yZWZlcnJlciIsIm9uRXJyb3IiLCJtZXNzYWdlIiwib25QbGF5YmFja1JhdGVDaGFuZ2UiLCJpbnN0YW5jZSIsImdldFBsYXliYWNrUmF0ZSIsIm9uUmVhZHkiLCJwbGF5VmlkZW8iLCJwYXVzZVZpZGVvIiwic3RvcFZpZGVvIiwic3BlZWRzIiwiZ2V0QXZhaWxhYmxlUGxheWJhY2tSYXRlcyIsImNsZWFySW50ZXJ2YWwiLCJidWZmZXJpbmciLCJzZXRJbnRlcnZhbCIsImdldFZpZGVvTG9hZGVkRnJhY3Rpb24iLCJsYXN0QnVmZmVyZWQiLCJvblN0YXRlQ2hhbmdlIiwidW5NdXRlIiwiQWRzIiwiZ29vZ2xlIiwiaW1hIiwibWFuYWdlciIsImRlc3Ryb3kiLCJkaXNwbGF5Q29udGFpbmVyIiwicmVtb3ZlIiwic3RhcnRTYWZldHlUaW1lciIsIm1hbmFnZXJQcm9taXNlIiwiY2xlYXJTYWZldHlUaW1lciIsInNldHVwSU1BIiwic2V0VnBhaWRNb2RlIiwiSW1hU2RrU2V0dGluZ3MiLCJWcGFpZE1vZGUiLCJFTkFCTEVEIiwic2V0TG9jYWxlIiwic2V0RGlzYWJsZUN1c3RvbVBsYXliYWNrRm9ySU9TMTBQbHVzIiwiQWREaXNwbGF5Q29udGFpbmVyIiwibG9hZGVyIiwiQWRzTG9hZGVyIiwiQWRzTWFuYWdlckxvYWRlZEV2ZW50IiwiVHlwZSIsIkFEU19NQU5BR0VSX0xPQURFRCIsIm9uQWRzTWFuYWdlckxvYWRlZCIsIkFkRXJyb3JFdmVudCIsIkFEX0VSUk9SIiwib25BZEVycm9yIiwicmVxdWVzdEFkcyIsIkFkc1JlcXVlc3QiLCJhZFRhZ1VybCIsImxpbmVhckFkU2xvdFdpZHRoIiwibGluZWFyQWRTbG90SGVpZ2h0Iiwibm9uTGluZWFyQWRTbG90V2lkdGgiLCJub25MaW5lYXJBZFNsb3RIZWlnaHQiLCJmb3JjZU5vbkxpbmVhckZ1bGxTbG90Iiwic2V0QWRXaWxsUGxheU11dGVkIiwiY291bnRkb3duVGltZXIiLCJnZXRSZW1haW5pbmdUaW1lIiwiQWRzUmVuZGVyaW5nU2V0dGluZ3MiLCJyZXN0b3JlQ3VzdG9tUGxheWJhY2tTdGF0ZU9uQWRCcmVha0NvbXBsZXRlIiwiZW5hYmxlUHJlbG9hZGluZyIsImdldEFkc01hbmFnZXIiLCJjdWVQb2ludHMiLCJnZXRDdWVQb2ludHMiLCJBZEV2ZW50Iiwib25BZEV2ZW50IiwiY3VlUG9pbnQiLCJzZWVrRWxlbWVudCIsImN1ZVBlcmNlbnRhZ2UiLCJhZCIsImdldEFkIiwiYWREYXRhIiwiZ2V0QWREYXRhIiwiTE9BREVEIiwicG9sbENvdW50ZG93biIsImlzTGluZWFyIiwiU1RBUlRFRCIsIkFMTF9BRFNfQ09NUExFVEVEIiwibG9hZEFkcyIsImNvbnRlbnRDb21wbGV0ZSIsIkNPTlRFTlRfUEFVU0VfUkVRVUVTVEVEIiwicGF1c2VDb250ZW50IiwiQ09OVEVOVF9SRVNVTUVfUkVRVUVTVEVEIiwicmVzdW1lQ29udGVudCIsIkxPRyIsImFkRXJyb3IiLCJnZXRNZXNzYWdlIiwiY2FuY2VsIiwiYWRkQ3VlUG9pbnRzIiwic2Vla2VkVGltZSIsImRpc2NhcmRBZEJyZWFrIiwicmVzaXplIiwiVmlld01vZGUiLCJOT1JNQUwiLCJpbml0aWFsaXplIiwiaW5pdGlhbGl6ZWQiLCJ6SW5kZXgiLCJoYW5kbGVycyIsInNhZmV0eVRpbWVyIiwiQVZfUFVCTElTSEVSSUQiLCJBVl9DSEFOTkVMSUQiLCJBVl9VUkwiLCJjYiIsIkFWX1dJRFRIIiwiQVZfSEVJR0hUIiwiQVZfQ0RJTTIiLCJjbGFtcCIsInBhcnNlVnR0IiwidnR0RGF0YVN0cmluZyIsInByb2Nlc3NlZExpc3QiLCJmcmFtZSIsImxpbmUiLCJzdGFydFRpbWUiLCJsaW5lU3BsaXQiLCJtYXRjaFRpbWVzIiwiZW5kVGltZSIsImZpdFJhdGlvIiwib3V0ZXIiLCJ0YXJnZXRSYXRpbyIsIlByZXZpZXdUaHVtYm5haWxzIiwiZ2V0VGh1bWJuYWlscyIsInJlbmRlciIsImRldGVybWluZUNvbnRhaW5lckF1dG9TaXppbmciLCJzb3J0QW5kUmVzb2x2ZSIsInRodW1ibmFpbHMiLCJwcm9taXNlcyIsImdldFRodW1ibmFpbCIsInRodW1ibmFpbCIsImZyYW1lcyIsInVybFByZWZpeCIsInN1YnN0cmluZyIsImxhc3RJbmRleE9mIiwidGVtcEltYWdlIiwibmF0dXJhbEhlaWdodCIsInBlcmNlbnRhZ2UiLCJtb3VzZVBvc1giLCJ0aHVtYiIsIl90aGlzJHBsYXllciRjb25maWckbSIsIl90aGlzJHBsYXllciRjb25maWckbTIiLCJzaG93SW1hZ2VBdEN1cnJlbnRUaW1lIiwidG9nZ2xlVGh1bWJDb250YWluZXIiLCJtb3VzZURvd24iLCJ0b2dnbGVTY3J1YmJpbmdDb250YWluZXIiLCJjZWlsIiwibGFzdFRpbWUiLCJzY3J1YmJpbmciLCJzZXRTY3J1YmJpbmdDb250YWluZXJTaXplIiwic2V0VGh1bWJDb250YWluZXJTaXplQW5kUG9zIiwidGh1bWJOdW0iLCJmaW5kSW5kZXgiLCJoYXNUaHVtYiIsInF1YWxpdHlJbmRleCIsImxvYWRlZEltYWdlcyIsInNob3dpbmdUaHVtYiIsInRodW1iRmlsZW5hbWUiLCJ0aHVtYlVybCIsImN1cnJlbnRJbWFnZUVsZW1lbnQiLCJkYXRhc2V0IiwiZmlsZW5hbWUiLCJzaG93SW1hZ2UiLCJyZW1vdmVPbGRJbWFnZXMiLCJsb2FkaW5nSW1hZ2UiLCJ1c2luZ1Nwcml0ZXMiLCJwcmV2aWV3SW1hZ2UiLCJzaG93aW5nVGh1bWJGaWxlbmFtZSIsIm5ld0ltYWdlIiwic2V0SW1hZ2VTaXplQW5kT2Zmc2V0IiwiY3VycmVudEltYWdlQ29udGFpbmVyIiwicHJlbG9hZE5lYXJieSIsImdldEhpZ2hlclF1YWxpdHkiLCJjdXJyZW50SW1hZ2UiLCJ0YWdOYW1lIiwicmVtb3ZlRGVsYXkiLCJkZWxldGluZyIsIm9sZFRodW1iRmlsZW5hbWUiLCJ0aHVtYm5haWxzQ2xvbmUiLCJmb3VuZE9uZSIsIm5ld1RodW1iRmlsZW5hbWUiLCJ0aHVtYlVSTCIsImN1cnJlbnRRdWFsaXR5SW5kZXgiLCJwcmV2aWV3SW1hZ2VIZWlnaHQiLCJ0aHVtYkNvbnRhaW5lckhlaWdodCIsImNsZWFyU2hvd2luZyIsInNpemVTcGVjaWZpZWRJbkNTUyIsInRodW1iQXNwZWN0UmF0aW8iLCJ0aHVtYkhlaWdodCIsInNldFRodW1iQ29udGFpbmVyUG9zIiwic2NydWJiZXJSZWN0IiwiY29udGFpbmVyUmVjdCIsInJpZ2h0IiwiY2xhbXBlZCIsIm11bHRpcGxpZXIiLCJsYXN0TW91c2VNb3ZlVGltZSIsImN1cnJlbnRTY3J1YmJpbmdJbWFnZUVsZW1lbnQiLCJjdXJyZW50VGh1bWJuYWlsSW1hZ2VFbGVtZW50IiwiaW5zZXJ0RWxlbWVudHMiLCJjaGFuZ2UiLCJjcm9zc29yaWdpbiIsIlBseXIiLCJ3ZWJraXRTaG93UGxheWJhY2tUYXJnZXRQaWNrZXIiLCJpc0hpZGRlbiIsImhpZGluZyIsImV2ZW50TmFtZSIsInNvZnQiLCJvcmlnaW5hbCIsInVubG9hZCIsImZhaWxlZCIsImpRdWVyeSIsIldlYWtNYXAiLCJnZXRQcm92aWRlckJ5VXJsIiwic2VhcmNoIiwidHJ1dGh5Iiwic2VhcmNoUGFyYW1zIiwidGFiaW5kZXgiLCJpbnB1dElzVmFsaWQiLCJmYXV4RHVyYXRpb24iLCJyZWFsRHVyYXRpb24iLCJJbmZpbml0eSIsImhhc0F1ZGlvIiwibW96SGFzQXVkaW8iLCJ3ZWJraXRBdWRpb0RlY29kZWRCeXRlQ291bnQiLCJhdWRpb1RyYWNrcyIsInVwZGF0ZVN0b3JhZ2UiLCJ3ZWJraXRQcmVzZW50YXRpb25Nb2RlIiwicGljdHVyZUluUGljdHVyZUVsZW1lbnQiLCJzZXRQcmV2aWV3VGh1bWJuYWlscyIsInJlcXVlc3RQaWN0dXJlSW5QaWN0dXJlIiwiZXhpdFBpY3R1cmVJblBpY3R1cmUiLCJ0aHVtYm5haWxTb3VyY2UiLCJzdGF0aWMiLCJpbmxpbmUiLCJTd2lwZXJzIiwic3dpcGVyIiwiU3dpcGVyIiwic2xpZGVzUGVyVmlldyIsImZyZWVNb2RlIiwid2F0Y2hTbGlkZXNQcm9ncmVzcyIsInNwYWNlQmV0d2VlbiIsIm5hdmlnYXRpb24iLCJuZXh0RWwiLCJwcmV2RWwiLCJ0aHVtYnMiLCJlZmZlY3QiLCJmYWRlRWZmZWN0IiwiY3Jvc3NGYWRlIiwiZ3JhYkN1cnNvciIsInBhZ2luYXRpb24iLCJjbGlja2FibGUiLCJicmVha3BvaW50cyIsIkFuaW0iLCJhbmltVG9wIiwiYW5pbWxlZnQiLCJhbmltUmlnaHQiLCJzaW5nbGVzVG9wIiwic2luZ2xlc2xlZnQiLCJzaW5nbGVzUmlnaHQiLCJjZWxsIiwicmVjIiwiY2VsbDEiLCJjZWxsMiIsIkJ1dHRvbiIsIm1WYWx1ZSIsImFkZERpdiIsImNsaWVudFkiLCJhcHBlbmQiLCJ3YXZlcyIsInBvcHVwc0luaXQiLCJoZWFkZXIiLCJ0b3lzUGx5ciIsIkdhbCIsInRlbXAiLCJzMiIsImNlbnRlcmVkU2xpZGVzIiwiY292ZXJmbG93RWZmZWN0Iiwicm90YXRlIiwic3RyZXRjaCIsImRlcHRoIiwic2xpZGVUb0NsaWNrZWRTbGlkZSIsInMxSXRlbXMiLCJIZWFkZXJzIiwicGFnZVlPZmZzZXQiLCJvbnJlc2l6ZSIsIlBvcHVwcyIsImNvbnRlbnRzIiwiUGxlZXJzIiwidGVtcG9yIiwiaW5pdFRhcmdldCIsImxpbmtQbHlyIiwib3BlblBvcCIsImNsb3NlUG9wIiwiRG91YmxlIiwiRG91YmxlVG9wIiwiRG91YmxlQm90dG9tIiwiY29udHJvbGxlciIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJnZXR0ZXIiLCJfX2VzTW9kdWxlIiwiZCIsImRlZmluaXRpb24iLCJnIiwicHJvcCIsImhhc093blByb3BlcnR5IiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJwbGF5ZXJGdWxsVG95cyIsInRlcnQiLCJzaGVhcCIsInRyIiwicGx5clBsYXkiXSwic291cmNlUm9vdCI6IiJ9
